(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const d of c)if(d.type==="childList")for(const p of d.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&o(p)}).observe(document,{childList:!0,subtree:!0});function a(c){const d={};return c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function o(c){if(c.ep)return;c.ep=!0;const d=a(c);fetch(c.href,d)}})();function dg(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Yc={exports:{}},Vl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xm;function mv(){if(xm)return Vl;xm=1;var s=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function a(o,c,d){var p=null;if(d!==void 0&&(p=""+d),c.key!==void 0&&(p=""+c.key),"key"in c){d={};for(var g in c)g!=="key"&&(d[g]=c[g])}else d=c;return c=d.ref,{$$typeof:s,type:o,key:p,ref:c!==void 0?c:null,props:d}}return Vl.Fragment=t,Vl.jsx=a,Vl.jsxs=a,Vl}var vm;function hv(){return vm||(vm=1,Yc.exports=mv()),Yc.exports}var i=hv(),$c={exports:{}},Le={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ym;function gv(){if(ym)return Le;ym=1;var s=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),d=Symbol.for("react.consumer"),p=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),v=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),S=Symbol.iterator;function N(C){return C===null||typeof C!="object"?null:(C=S&&C[S]||C["@@iterator"],typeof C=="function"?C:null)}var k={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,M={};function J(C,_,O){this.props=C,this.context=_,this.refs=M,this.updater=O||k}J.prototype.isReactComponent={},J.prototype.setState=function(C,_){if(typeof C!="object"&&typeof C!="function"&&C!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,C,_,"setState")},J.prototype.forceUpdate=function(C){this.updater.enqueueForceUpdate(this,C,"forceUpdate")};function ce(){}ce.prototype=J.prototype;function ee(C,_,O){this.props=C,this.context=_,this.refs=M,this.updater=O||k}var P=ee.prototype=new ce;P.constructor=ee,w(P,J.prototype),P.isPureReactComponent=!0;var Q=Array.isArray;function H(){}var V={H:null,A:null,T:null,S:null},q=Object.prototype.hasOwnProperty;function X(C,_,O){var z=O.ref;return{$$typeof:s,type:C,key:_,ref:z!==void 0?z:null,props:O}}function fe(C,_){return X(C.type,_,C.props)}function F(C){return typeof C=="object"&&C!==null&&C.$$typeof===s}function re(C){var _={"=":"=0",":":"=2"};return"$"+C.replace(/[=:]/g,function(O){return _[O]})}var oe=/\/+/g;function se(C,_){return typeof C=="object"&&C!==null&&C.key!=null?re(""+C.key):_.toString(36)}function ae(C){switch(C.status){case"fulfilled":return C.value;case"rejected":throw C.reason;default:switch(typeof C.status=="string"?C.then(H,H):(C.status="pending",C.then(function(_){C.status==="pending"&&(C.status="fulfilled",C.value=_)},function(_){C.status==="pending"&&(C.status="rejected",C.reason=_)})),C.status){case"fulfilled":return C.value;case"rejected":throw C.reason}}throw C}function A(C,_,O,z,ne){var xe=typeof C;(xe==="undefined"||xe==="boolean")&&(C=null);var ge=!1;if(C===null)ge=!0;else switch(xe){case"bigint":case"string":case"number":ge=!0;break;case"object":switch(C.$$typeof){case s:case t:ge=!0;break;case y:return ge=C._init,A(ge(C._payload),_,O,z,ne)}}if(ge)return ne=ne(C),ge=z===""?"."+se(C,0):z,Q(ne)?(O="",ge!=null&&(O=ge.replace(oe,"$&/")+"/"),A(ne,_,O,"",function(nt){return nt})):ne!=null&&(F(ne)&&(ne=fe(ne,O+(ne.key==null||C&&C.key===ne.key?"":(""+ne.key).replace(oe,"$&/")+"/")+ge)),_.push(ne)),1;ge=0;var Se=z===""?".":z+":";if(Q(C))for(var _e=0;_e<C.length;_e++)z=C[_e],xe=Se+se(z,_e),ge+=A(z,_,O,xe,ne);else if(_e=N(C),typeof _e=="function")for(C=_e.call(C),_e=0;!(z=C.next()).done;)z=z.value,xe=Se+se(z,_e++),ge+=A(z,_,O,xe,ne);else if(xe==="object"){if(typeof C.then=="function")return A(ae(C),_,O,z,ne);throw _=String(C),Error("Objects are not valid as a React child (found: "+(_==="[object Object]"?"object with keys {"+Object.keys(C).join(", ")+"}":_)+"). If you meant to render a collection of children, use an array instead.")}return ge}function U(C,_,O){if(C==null)return C;var z=[],ne=0;return A(C,z,"","",function(xe){return _.call(O,xe,ne++)}),z}function ue(C){if(C._status===-1){var _=C._result;_=_(),_.then(function(O){(C._status===0||C._status===-1)&&(C._status=1,C._result=O)},function(O){(C._status===0||C._status===-1)&&(C._status=2,C._result=O)}),C._status===-1&&(C._status=0,C._result=_)}if(C._status===1)return C._result.default;throw C._result}var L=typeof reportError=="function"?reportError:function(C){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var _=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof C=="object"&&C!==null&&typeof C.message=="string"?String(C.message):String(C),error:C});if(!window.dispatchEvent(_))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",C);return}console.error(C)},W={map:U,forEach:function(C,_,O){U(C,function(){_.apply(this,arguments)},O)},count:function(C){var _=0;return U(C,function(){_++}),_},toArray:function(C){return U(C,function(_){return _})||[]},only:function(C){if(!F(C))throw Error("React.Children.only expected to receive a single React element child.");return C}};return Le.Activity=b,Le.Children=W,Le.Component=J,Le.Fragment=a,Le.Profiler=c,Le.PureComponent=ee,Le.StrictMode=o,Le.Suspense=v,Le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=V,Le.__COMPILER_RUNTIME={__proto__:null,c:function(C){return V.H.useMemoCache(C)}},Le.cache=function(C){return function(){return C.apply(null,arguments)}},Le.cacheSignal=function(){return null},Le.cloneElement=function(C,_,O){if(C==null)throw Error("The argument must be a React element, but you passed "+C+".");var z=w({},C.props),ne=C.key;if(_!=null)for(xe in _.key!==void 0&&(ne=""+_.key),_)!q.call(_,xe)||xe==="key"||xe==="__self"||xe==="__source"||xe==="ref"&&_.ref===void 0||(z[xe]=_[xe]);var xe=arguments.length-2;if(xe===1)z.children=O;else if(1<xe){for(var ge=Array(xe),Se=0;Se<xe;Se++)ge[Se]=arguments[Se+2];z.children=ge}return X(C.type,ne,z)},Le.createContext=function(C){return C={$$typeof:p,_currentValue:C,_currentValue2:C,_threadCount:0,Provider:null,Consumer:null},C.Provider=C,C.Consumer={$$typeof:d,_context:C},C},Le.createElement=function(C,_,O){var z,ne={},xe=null;if(_!=null)for(z in _.key!==void 0&&(xe=""+_.key),_)q.call(_,z)&&z!=="key"&&z!=="__self"&&z!=="__source"&&(ne[z]=_[z]);var ge=arguments.length-2;if(ge===1)ne.children=O;else if(1<ge){for(var Se=Array(ge),_e=0;_e<ge;_e++)Se[_e]=arguments[_e+2];ne.children=Se}if(C&&C.defaultProps)for(z in ge=C.defaultProps,ge)ne[z]===void 0&&(ne[z]=ge[z]);return X(C,xe,ne)},Le.createRef=function(){return{current:null}},Le.forwardRef=function(C){return{$$typeof:g,render:C}},Le.isValidElement=F,Le.lazy=function(C){return{$$typeof:y,_payload:{_status:-1,_result:C},_init:ue}},Le.memo=function(C,_){return{$$typeof:h,type:C,compare:_===void 0?null:_}},Le.startTransition=function(C){var _=V.T,O={};V.T=O;try{var z=C(),ne=V.S;ne!==null&&ne(O,z),typeof z=="object"&&z!==null&&typeof z.then=="function"&&z.then(H,L)}catch(xe){L(xe)}finally{_!==null&&O.types!==null&&(_.types=O.types),V.T=_}},Le.unstable_useCacheRefresh=function(){return V.H.useCacheRefresh()},Le.use=function(C){return V.H.use(C)},Le.useActionState=function(C,_,O){return V.H.useActionState(C,_,O)},Le.useCallback=function(C,_){return V.H.useCallback(C,_)},Le.useContext=function(C){return V.H.useContext(C)},Le.useDebugValue=function(){},Le.useDeferredValue=function(C,_){return V.H.useDeferredValue(C,_)},Le.useEffect=function(C,_){return V.H.useEffect(C,_)},Le.useEffectEvent=function(C){return V.H.useEffectEvent(C)},Le.useId=function(){return V.H.useId()},Le.useImperativeHandle=function(C,_,O){return V.H.useImperativeHandle(C,_,O)},Le.useInsertionEffect=function(C,_){return V.H.useInsertionEffect(C,_)},Le.useLayoutEffect=function(C,_){return V.H.useLayoutEffect(C,_)},Le.useMemo=function(C,_){return V.H.useMemo(C,_)},Le.useOptimistic=function(C,_){return V.H.useOptimistic(C,_)},Le.useReducer=function(C,_,O){return V.H.useReducer(C,_,O)},Le.useRef=function(C){return V.H.useRef(C)},Le.useState=function(C){return V.H.useState(C)},Le.useSyncExternalStore=function(C,_,O){return V.H.useSyncExternalStore(C,_,O)},Le.useTransition=function(){return V.H.useTransition()},Le.version="19.2.3",Le}var bm;function xu(){return bm||(bm=1,$c.exports=gv()),$c.exports}var I=xu();const fg=dg(I);var Kc={exports:{}},ql={},Xc={exports:{}},Qc={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sm;function xv(){return Sm||(Sm=1,(function(s){function t(A,U){var ue=A.length;A.push(U);e:for(;0<ue;){var L=ue-1>>>1,W=A[L];if(0<c(W,U))A[L]=U,A[ue]=W,ue=L;else break e}}function a(A){return A.length===0?null:A[0]}function o(A){if(A.length===0)return null;var U=A[0],ue=A.pop();if(ue!==U){A[0]=ue;e:for(var L=0,W=A.length,C=W>>>1;L<C;){var _=2*(L+1)-1,O=A[_],z=_+1,ne=A[z];if(0>c(O,ue))z<W&&0>c(ne,O)?(A[L]=ne,A[z]=ue,L=z):(A[L]=O,A[_]=ue,L=_);else if(z<W&&0>c(ne,ue))A[L]=ne,A[z]=ue,L=z;else break e}}return U}function c(A,U){var ue=A.sortIndex-U.sortIndex;return ue!==0?ue:A.id-U.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var d=performance;s.unstable_now=function(){return d.now()}}else{var p=Date,g=p.now();s.unstable_now=function(){return p.now()-g}}var v=[],h=[],y=1,b=null,S=3,N=!1,k=!1,w=!1,M=!1,J=typeof setTimeout=="function"?setTimeout:null,ce=typeof clearTimeout=="function"?clearTimeout:null,ee=typeof setImmediate<"u"?setImmediate:null;function P(A){for(var U=a(h);U!==null;){if(U.callback===null)o(h);else if(U.startTime<=A)o(h),U.sortIndex=U.expirationTime,t(v,U);else break;U=a(h)}}function Q(A){if(w=!1,P(A),!k)if(a(v)!==null)k=!0,H||(H=!0,re());else{var U=a(h);U!==null&&ae(Q,U.startTime-A)}}var H=!1,V=-1,q=5,X=-1;function fe(){return M?!0:!(s.unstable_now()-X<q)}function F(){if(M=!1,H){var A=s.unstable_now();X=A;var U=!0;try{e:{k=!1,w&&(w=!1,ce(V),V=-1),N=!0;var ue=S;try{t:{for(P(A),b=a(v);b!==null&&!(b.expirationTime>A&&fe());){var L=b.callback;if(typeof L=="function"){b.callback=null,S=b.priorityLevel;var W=L(b.expirationTime<=A);if(A=s.unstable_now(),typeof W=="function"){b.callback=W,P(A),U=!0;break t}b===a(v)&&o(v),P(A)}else o(v);b=a(v)}if(b!==null)U=!0;else{var C=a(h);C!==null&&ae(Q,C.startTime-A),U=!1}}break e}finally{b=null,S=ue,N=!1}U=void 0}}finally{U?re():H=!1}}}var re;if(typeof ee=="function")re=function(){ee(F)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,se=oe.port2;oe.port1.onmessage=F,re=function(){se.postMessage(null)}}else re=function(){J(F,0)};function ae(A,U){V=J(function(){A(s.unstable_now())},U)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(A){A.callback=null},s.unstable_forceFrameRate=function(A){0>A||125<A?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<A?Math.floor(1e3/A):5},s.unstable_getCurrentPriorityLevel=function(){return S},s.unstable_next=function(A){switch(S){case 1:case 2:case 3:var U=3;break;default:U=S}var ue=S;S=U;try{return A()}finally{S=ue}},s.unstable_requestPaint=function(){M=!0},s.unstable_runWithPriority=function(A,U){switch(A){case 1:case 2:case 3:case 4:case 5:break;default:A=3}var ue=S;S=A;try{return U()}finally{S=ue}},s.unstable_scheduleCallback=function(A,U,ue){var L=s.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?L+ue:L):ue=L,A){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=ue+W,A={id:y++,callback:U,priorityLevel:A,startTime:ue,expirationTime:W,sortIndex:-1},ue>L?(A.sortIndex=ue,t(h,A),a(v)===null&&A===a(h)&&(w?(ce(V),V=-1):w=!0,ae(Q,ue-L))):(A.sortIndex=W,t(v,A),k||N||(k=!0,H||(H=!0,re()))),A},s.unstable_shouldYield=fe,s.unstable_wrapCallback=function(A){var U=S;return function(){var ue=S;S=U;try{return A.apply(this,arguments)}finally{S=ue}}}})(Qc)),Qc}var Tm;function vv(){return Tm||(Tm=1,Xc.exports=xv()),Xc.exports}var Wc={exports:{}},kt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nm;function yv(){if(Nm)return kt;Nm=1;var s=xu();function t(v){var h="https://react.dev/errors/"+v;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)h+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+v+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var o={d:{f:a,r:function(){throw Error(t(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},c=Symbol.for("react.portal");function d(v,h,y){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:b==null?null:""+b,children:v,containerInfo:h,implementation:y}}var p=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(v,h){if(v==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return kt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,kt.createPortal=function(v,h){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(t(299));return d(v,h,null,y)},kt.flushSync=function(v){var h=p.T,y=o.p;try{if(p.T=null,o.p=2,v)return v()}finally{p.T=h,o.p=y,o.d.f()}},kt.preconnect=function(v,h){typeof v=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,o.d.C(v,h))},kt.prefetchDNS=function(v){typeof v=="string"&&o.d.D(v)},kt.preinit=function(v,h){if(typeof v=="string"&&h&&typeof h.as=="string"){var y=h.as,b=g(y,h.crossOrigin),S=typeof h.integrity=="string"?h.integrity:void 0,N=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;y==="style"?o.d.S(v,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:b,integrity:S,fetchPriority:N}):y==="script"&&o.d.X(v,{crossOrigin:b,integrity:S,fetchPriority:N,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},kt.preinitModule=function(v,h){if(typeof v=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var y=g(h.as,h.crossOrigin);o.d.M(v,{crossOrigin:y,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&o.d.M(v)},kt.preload=function(v,h){if(typeof v=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var y=h.as,b=g(y,h.crossOrigin);o.d.L(v,y,{crossOrigin:b,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},kt.preloadModule=function(v,h){if(typeof v=="string")if(h){var y=g(h.as,h.crossOrigin);o.d.m(v,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:y,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else o.d.m(v)},kt.requestFormReset=function(v){o.d.r(v)},kt.unstable_batchedUpdates=function(v,h){return v(h)},kt.useFormState=function(v,h,y){return p.H.useFormState(v,h,y)},kt.useFormStatus=function(){return p.H.useHostTransitionStatus()},kt.version="19.2.3",kt}var Em;function bv(){if(Em)return Wc.exports;Em=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(t){console.error(t)}}return s(),Wc.exports=yv(),Wc.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cm;function Sv(){if(Cm)return ql;Cm=1;var s=vv(),t=xu(),a=bv();function o(e){var n="https://react.dev/errors/"+e;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)n+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function c(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function d(e){var n=e,l=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(l=n.return),e=n.return;while(e)}return n.tag===3?l:null}function p(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function g(e){if(e.tag===31){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function v(e){if(d(e)!==e)throw Error(o(188))}function h(e){var n=e.alternate;if(!n){if(n=d(e),n===null)throw Error(o(188));return n!==e?null:e}for(var l=e,r=n;;){var m=l.return;if(m===null)break;var x=m.alternate;if(x===null){if(r=m.return,r!==null){l=r;continue}break}if(m.child===x.child){for(x=m.child;x;){if(x===l)return v(m),e;if(x===r)return v(m),n;x=x.sibling}throw Error(o(188))}if(l.return!==r.return)l=m,r=x;else{for(var T=!1,E=m.child;E;){if(E===l){T=!0,l=m,r=x;break}if(E===r){T=!0,r=m,l=x;break}E=E.sibling}if(!T){for(E=x.child;E;){if(E===l){T=!0,l=x,r=m;break}if(E===r){T=!0,r=x,l=m;break}E=E.sibling}if(!T)throw Error(o(189))}}if(l.alternate!==r)throw Error(o(190))}if(l.tag!==3)throw Error(o(188));return l.stateNode.current===l?e:n}function y(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e;for(e=e.child;e!==null;){if(n=y(e),n!==null)return n;e=e.sibling}return null}var b=Object.assign,S=Symbol.for("react.element"),N=Symbol.for("react.transitional.element"),k=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),J=Symbol.for("react.profiler"),ce=Symbol.for("react.consumer"),ee=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),Q=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),V=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),X=Symbol.for("react.activity"),fe=Symbol.for("react.memo_cache_sentinel"),F=Symbol.iterator;function re(e){return e===null||typeof e!="object"?null:(e=F&&e[F]||e["@@iterator"],typeof e=="function"?e:null)}var oe=Symbol.for("react.client.reference");function se(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===oe?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case w:return"Fragment";case J:return"Profiler";case M:return"StrictMode";case Q:return"Suspense";case H:return"SuspenseList";case X:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case k:return"Portal";case ee:return e.displayName||"Context";case ce:return(e._context.displayName||"Context")+".Consumer";case P:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case V:return n=e.displayName||null,n!==null?n:se(e.type)||"Memo";case q:n=e._payload,e=e._init;try{return se(e(n))}catch{}}return null}var ae=Array.isArray,A=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue={pending:!1,data:null,method:null,action:null},L=[],W=-1;function C(e){return{current:e}}function _(e){0>W||(e.current=L[W],L[W]=null,W--)}function O(e,n){W++,L[W]=e.current,e.current=n}var z=C(null),ne=C(null),xe=C(null),ge=C(null);function Se(e,n){switch(O(xe,n),O(ne,e),O(z,null),n.nodeType){case 9:case 11:e=(e=n.documentElement)&&(e=e.namespaceURI)?Hp(e):0;break;default:if(e=n.tagName,n=n.namespaceURI)n=Hp(n),e=Bp(n,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}_(z),O(z,e)}function _e(){_(z),_(ne),_(xe)}function nt(e){e.memoizedState!==null&&O(ge,e);var n=z.current,l=Bp(n,e.type);n!==l&&(O(ne,e),O(z,l))}function G(e){ne.current===e&&(_(z),_(ne)),ge.current===e&&(_(ge),Ol._currentValue=ue)}var he,be;function Pe(e){if(he===void 0)try{throw Error()}catch(l){var n=l.stack.trim().match(/\n( *(at )?)/);he=n&&n[1]||"",be=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+he+e+be}var ke=!1;function me(e,n){if(!e||ke)return"";ke=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(n){var pe=function(){throw Error()};if(Object.defineProperty(pe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(pe,[])}catch(te){var K=te}Reflect.construct(e,[],pe)}else{try{pe.call()}catch(te){K=te}e.call(pe.prototype)}}else{try{throw Error()}catch(te){K=te}(pe=e())&&typeof pe.catch=="function"&&pe.catch(function(){})}}catch(te){if(te&&K&&typeof te.stack=="string")return[te.stack,K.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=r.DetermineComponentFrameRoot(),T=x[0],E=x[1];if(T&&E){var R=T.split(`
`),$=E.split(`
`);for(m=r=0;r<R.length&&!R[r].includes("DetermineComponentFrameRoot");)r++;for(;m<$.length&&!$[m].includes("DetermineComponentFrameRoot");)m++;if(r===R.length||m===$.length)for(r=R.length-1,m=$.length-1;1<=r&&0<=m&&R[r]!==$[m];)m--;for(;1<=r&&0<=m;r--,m--)if(R[r]!==$[m]){if(r!==1||m!==1)do if(r--,m--,0>m||R[r]!==$[m]){var ie=`
`+R[r].replace(" at new "," at ");return e.displayName&&ie.includes("<anonymous>")&&(ie=ie.replace("<anonymous>",e.displayName)),ie}while(1<=r&&0<=m);break}}}finally{ke=!1,Error.prepareStackTrace=l}return(l=e?e.displayName||e.name:"")?Pe(l):""}function Ze(e,n){switch(e.tag){case 26:case 27:case 5:return Pe(e.type);case 16:return Pe("Lazy");case 13:return e.child!==n&&n!==null?Pe("Suspense Fallback"):Pe("Suspense");case 19:return Pe("SuspenseList");case 0:case 15:return me(e.type,!1);case 11:return me(e.type.render,!1);case 1:return me(e.type,!0);case 31:return Pe("Activity");default:return""}}function ut(e){try{var n="",l=null;do n+=Ze(e,l),l=e,e=e.return;while(e);return n}catch(r){return`
Error generating stack: `+r.message+`
`+r.stack}}var Ut=Object.prototype.hasOwnProperty,Fe=s.unstable_scheduleCallback,Lt=s.unstable_cancelCallback,_s=s.unstable_shouldYield,Ws=s.unstable_requestPaint,Gt=s.unstable_now,$a=s.unstable_getCurrentPriorityLevel,$t=s.unstable_ImmediatePriority,Zs=s.unstable_UserBlockingPriority,Wn=s.unstable_NormalPriority,ea=s.unstable_LowPriority,Nn=s.unstable_IdlePriority,Rs=s.log,Gi=s.unstable_setDisableYieldValue,Zn=null,wt=null;function Kt(e){if(typeof Rs=="function"&&Gi(e),wt&&typeof wt.setStrictMode=="function")try{wt.setStrictMode(Zn,e)}catch{}}var Dt=Math.clz32?Math.clz32:Xl,Kl=Math.log,Ka=Math.LN2;function Xl(e){return e>>>=0,e===0?32:31-(Kl(e)/Ka|0)|0}var Is=256,ta=262144,na=4194304;function Rn(e){var n=e&42;if(n!==0)return n;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function sa(e,n,l){var r=e.pendingLanes;if(r===0)return 0;var m=0,x=e.suspendedLanes,T=e.pingedLanes;e=e.warmLanes;var E=r&134217727;return E!==0?(r=E&~x,r!==0?m=Rn(r):(T&=E,T!==0?m=Rn(T):l||(l=E&~e,l!==0&&(m=Rn(l))))):(E=r&~x,E!==0?m=Rn(E):T!==0?m=Rn(T):l||(l=r&~e,l!==0&&(m=Rn(l)))),m===0?0:n!==0&&n!==m&&(n&x)===0&&(x=m&-m,l=n&-n,x>=l||x===32&&(l&4194048)!==0)?n:m}function Ms(e,n){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&n)===0}function Oi(e,n){switch(e){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ql(){var e=na;return na<<=1,(na&62914560)===0&&(na=4194304),e}function Xa(e){for(var n=[],l=0;31>l;l++)n.push(e);return n}function Ds(e,n){e.pendingLanes|=n,n!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Pi(e,n,l,r,m,x){var T=e.pendingLanes;e.pendingLanes=l,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=l,e.entangledLanes&=l,e.errorRecoveryDisabledLanes&=l,e.shellSuspendCounter=0;var E=e.entanglements,R=e.expirationTimes,$=e.hiddenUpdates;for(l=T&~l;0<l;){var ie=31-Dt(l),pe=1<<ie;E[ie]=0,R[ie]=-1;var K=$[ie];if(K!==null)for($[ie]=null,ie=0;ie<K.length;ie++){var te=K[ie];te!==null&&(te.lane&=-536870913)}l&=~pe}r!==0&&Wl(e,r,0),x!==0&&m===0&&e.tag!==0&&(e.suspendedLanes|=x&~(T&~n))}function Wl(e,n,l){e.pendingLanes|=n,e.suspendedLanes&=~n;var r=31-Dt(n);e.entangledLanes|=n,e.entanglements[r]=e.entanglements[r]|1073741824|l&261930}function Zl(e,n){var l=e.entangledLanes|=n;for(e=e.entanglements;l;){var r=31-Dt(l),m=1<<r;m&n|e[r]&n&&(e[r]|=n),l&=~m}}function eo(e,n){var l=n&-n;return l=(l&42)!==0?1:Qa(l),(l&(e.suspendedLanes|n))!==0?0:l}function Qa(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Wa(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function to(){var e=U.p;return e!==0?e:(e=window.event,e===void 0?32:um(e.type))}function no(e,n){var l=U.p;try{return U.p=e,n()}finally{U.p=l}}var En=Math.random().toString(36).slice(2),ft="__reactFiber$"+En,At="__reactProps$"+En,es="__reactContainer$"+En,ts="__reactEvents$"+En,Za="__reactListeners$"+En,D="__reactHandles$"+En,le="__reactResources$"+En,Z="__reactMarker$"+En;function ve(e){delete e[ft],delete e[At],delete e[ts],delete e[Za],delete e[D]}function ye(e){var n=e[ft];if(n)return n;for(var l=e.parentNode;l;){if(n=l[es]||l[ft]){if(l=n.alternate,n.child!==null||l!==null&&l.child!==null)for(e=$p(e);e!==null;){if(l=e[ft])return l;e=$p(e)}return n}e=l,l=e.parentNode}return null}function je(e){if(e=e[ft]||e[es]){var n=e.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return e}return null}function Re(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e.stateNode;throw Error(o(33))}function pt(e){var n=e[le];return n||(n=e[le]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function Oe(e){e[Z]=!0}var ns=new Set,Ot={};function Qe(e,n){dt(e,n),dt(e+"Capture",n)}function dt(e,n){for(Ot[e]=n,e=0;e<n.length;e++)ns.add(n[e])}var aa=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),la={},sn={};function el(e){return Ut.call(sn,e)?!0:Ut.call(la,e)?!1:aa.test(e)?sn[e]=!0:(la[e]=!0,!1)}function oa(e,n,l){if(el(n))if(l===null)e.removeAttribute(n);else{switch(typeof l){case"undefined":case"function":case"symbol":e.removeAttribute(n);return;case"boolean":var r=n.toLowerCase().slice(0,5);if(r!=="data-"&&r!=="aria-"){e.removeAttribute(n);return}}e.setAttribute(n,""+l)}}function so(e,n,l){if(l===null)e.removeAttribute(n);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttribute(n,""+l)}}function In(e,n,l,r){if(r===null)e.removeAttribute(l);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(l);return}e.setAttributeNS(n,l,""+r)}}function an(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Mu(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function i0(e,n,l){var r=Object.getOwnPropertyDescriptor(e.constructor.prototype,n);if(!e.hasOwnProperty(n)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var m=r.get,x=r.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return m.call(this)},set:function(T){l=""+T,x.call(this,T)}}),Object.defineProperty(e,n,{enumerable:r.enumerable}),{getValue:function(){return l},setValue:function(T){l=""+T},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function Hi(e){if(!e._valueTracker){var n=Mu(e)?"checked":"value";e._valueTracker=i0(e,n,""+e[n])}}function Du(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var l=n.getValue(),r="";return e&&(r=Mu(e)?e.checked?"true":"false":e.value),e=r,e!==l?(n.setValue(e),!0):!1}function ao(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var r0=/[\n"\\]/g;function ln(e){return e.replace(r0,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function Bi(e,n,l,r,m,x,T,E){e.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?e.type=T:e.removeAttribute("type"),n!=null?T==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+an(n)):e.value!==""+an(n)&&(e.value=""+an(n)):T!=="submit"&&T!=="reset"||e.removeAttribute("value"),n!=null?Vi(e,T,an(n)):l!=null?Vi(e,T,an(l)):r!=null&&e.removeAttribute("value"),m==null&&x!=null&&(e.defaultChecked=!!x),m!=null&&(e.checked=m&&typeof m!="function"&&typeof m!="symbol"),E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?e.name=""+an(E):e.removeAttribute("name")}function ku(e,n,l,r,m,x,T,E){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(e.type=x),n!=null||l!=null){if(!(x!=="submit"&&x!=="reset"||n!=null)){Hi(e);return}l=l!=null?""+an(l):"",n=n!=null?""+an(n):l,E||n===e.value||(e.value=n),e.defaultValue=n}r=r??m,r=typeof r!="function"&&typeof r!="symbol"&&!!r,e.checked=E?e.checked:!!r,e.defaultChecked=!!r,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(e.name=T),Hi(e)}function Vi(e,n,l){n==="number"&&ao(e.ownerDocument)===e||e.defaultValue===""+l||(e.defaultValue=""+l)}function ia(e,n,l,r){if(e=e.options,n){n={};for(var m=0;m<l.length;m++)n["$"+l[m]]=!0;for(l=0;l<e.length;l++)m=n.hasOwnProperty("$"+e[l].value),e[l].selected!==m&&(e[l].selected=m),m&&r&&(e[l].defaultSelected=!0)}else{for(l=""+an(l),n=null,m=0;m<e.length;m++){if(e[m].value===l){e[m].selected=!0,r&&(e[m].defaultSelected=!0);return}n!==null||e[m].disabled||(n=e[m])}n!==null&&(n.selected=!0)}}function ju(e,n,l){if(n!=null&&(n=""+an(n),n!==e.value&&(e.value=n),l==null)){e.defaultValue!==n&&(e.defaultValue=n);return}e.defaultValue=l!=null?""+an(l):""}function Uu(e,n,l,r){if(n==null){if(r!=null){if(l!=null)throw Error(o(92));if(ae(r)){if(1<r.length)throw Error(o(93));r=r[0]}l=r}l==null&&(l=""),n=l}l=an(n),e.defaultValue=l,r=e.textContent,r===l&&r!==""&&r!==null&&(e.value=r),Hi(e)}function ra(e,n){if(n){var l=e.firstChild;if(l&&l===e.lastChild&&l.nodeType===3){l.nodeValue=n;return}}e.textContent=n}var c0=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Lu(e,n,l){var r=n.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?r?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="":r?e.setProperty(n,l):typeof l!="number"||l===0||c0.has(n)?n==="float"?e.cssFloat=l:e[n]=(""+l).trim():e[n]=l+"px"}function Gu(e,n,l){if(n!=null&&typeof n!="object")throw Error(o(62));if(e=e.style,l!=null){for(var r in l)!l.hasOwnProperty(r)||n!=null&&n.hasOwnProperty(r)||(r.indexOf("--")===0?e.setProperty(r,""):r==="float"?e.cssFloat="":e[r]="");for(var m in n)r=n[m],n.hasOwnProperty(m)&&l[m]!==r&&Lu(e,m,r)}else for(var x in n)n.hasOwnProperty(x)&&Lu(e,x,n[x])}function qi(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var u0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),d0=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function lo(e){return d0.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Mn(){}var Ji=null;function zi(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ca=null,ua=null;function Ou(e){var n=je(e);if(n&&(e=n.stateNode)){var l=e[At]||null;e:switch(e=n.stateNode,n.type){case"input":if(Bi(e,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),n=l.name,l.type==="radio"&&n!=null){for(l=e;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+ln(""+n)+'"][type="radio"]'),n=0;n<l.length;n++){var r=l[n];if(r!==e&&r.form===e.form){var m=r[At]||null;if(!m)throw Error(o(90));Bi(r,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(n=0;n<l.length;n++)r=l[n],r.form===e.form&&Du(r)}break e;case"textarea":ju(e,l.value,l.defaultValue);break e;case"select":n=l.value,n!=null&&ia(e,!!l.multiple,n,!1)}}}var Fi=!1;function Pu(e,n,l){if(Fi)return e(n,l);Fi=!0;try{var r=e(n);return r}finally{if(Fi=!1,(ca!==null||ua!==null)&&(Yo(),ca&&(n=ca,e=ua,ua=ca=null,Ou(n),e)))for(n=0;n<e.length;n++)Ou(e[n])}}function tl(e,n){var l=e.stateNode;if(l===null)return null;var r=l[At]||null;if(r===null)return null;l=r[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(l&&typeof l!="function")throw Error(o(231,n,typeof l));return l}var Dn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yi=!1;if(Dn)try{var nl={};Object.defineProperty(nl,"passive",{get:function(){Yi=!0}}),window.addEventListener("test",nl,nl),window.removeEventListener("test",nl,nl)}catch{Yi=!1}var ss=null,$i=null,oo=null;function Hu(){if(oo)return oo;var e,n=$i,l=n.length,r,m="value"in ss?ss.value:ss.textContent,x=m.length;for(e=0;e<l&&n[e]===m[e];e++);var T=l-e;for(r=1;r<=T&&n[l-r]===m[x-r];r++);return oo=m.slice(e,1<r?1-r:void 0)}function io(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function ro(){return!0}function Bu(){return!1}function Vt(e){function n(l,r,m,x,T){this._reactName=l,this._targetInst=m,this.type=r,this.nativeEvent=x,this.target=T,this.currentTarget=null;for(var E in e)e.hasOwnProperty(E)&&(l=e[E],this[E]=l?l(x):x[E]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?ro:Bu,this.isPropagationStopped=Bu,this}return b(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=ro)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=ro)},persist:function(){},isPersistent:ro}),n}var ks={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},co=Vt(ks),sl=b({},ks,{view:0,detail:0}),f0=Vt(sl),Ki,Xi,al,uo=b({},sl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wi,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==al&&(al&&e.type==="mousemove"?(Ki=e.screenX-al.screenX,Xi=e.screenY-al.screenY):Xi=Ki=0,al=e),Ki)},movementY:function(e){return"movementY"in e?e.movementY:Xi}}),Vu=Vt(uo),p0=b({},uo,{dataTransfer:0}),m0=Vt(p0),h0=b({},sl,{relatedTarget:0}),Qi=Vt(h0),g0=b({},ks,{animationName:0,elapsedTime:0,pseudoElement:0}),x0=Vt(g0),v0=b({},ks,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),y0=Vt(v0),b0=b({},ks,{data:0}),qu=Vt(b0),S0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},T0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},N0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function E0(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=N0[e])?!!n[e]:!1}function Wi(){return E0}var C0=b({},sl,{key:function(e){if(e.key){var n=S0[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=io(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?T0[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wi,charCode:function(e){return e.type==="keypress"?io(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?io(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),w0=Vt(C0),A0=b({},uo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ju=Vt(A0),_0=b({},sl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wi}),R0=Vt(_0),I0=b({},ks,{propertyName:0,elapsedTime:0,pseudoElement:0}),M0=Vt(I0),D0=b({},uo,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),k0=Vt(D0),j0=b({},ks,{newState:0,oldState:0}),U0=Vt(j0),L0=[9,13,27,32],Zi=Dn&&"CompositionEvent"in window,ll=null;Dn&&"documentMode"in document&&(ll=document.documentMode);var G0=Dn&&"TextEvent"in window&&!ll,zu=Dn&&(!Zi||ll&&8<ll&&11>=ll),Fu=" ",Yu=!1;function $u(e,n){switch(e){case"keyup":return L0.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ku(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var da=!1;function O0(e,n){switch(e){case"compositionend":return Ku(n);case"keypress":return n.which!==32?null:(Yu=!0,Fu);case"textInput":return e=n.data,e===Fu&&Yu?null:e;default:return null}}function P0(e,n){if(da)return e==="compositionend"||!Zi&&$u(e,n)?(e=Hu(),oo=$i=ss=null,da=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return zu&&n.locale!=="ko"?null:n.data;default:return null}}var H0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xu(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!H0[e.type]:n==="textarea"}function Qu(e,n,l,r){ca?ua?ua.push(r):ua=[r]:ca=r,n=ei(n,"onChange"),0<n.length&&(l=new co("onChange","change",null,l,r),e.push({event:l,listeners:n}))}var ol=null,il=null;function B0(e){jp(e,0)}function fo(e){var n=Re(e);if(Du(n))return e}function Wu(e,n){if(e==="change")return n}var Zu=!1;if(Dn){var er;if(Dn){var tr="oninput"in document;if(!tr){var ed=document.createElement("div");ed.setAttribute("oninput","return;"),tr=typeof ed.oninput=="function"}er=tr}else er=!1;Zu=er&&(!document.documentMode||9<document.documentMode)}function td(){ol&&(ol.detachEvent("onpropertychange",nd),il=ol=null)}function nd(e){if(e.propertyName==="value"&&fo(il)){var n=[];Qu(n,il,e,zi(e)),Pu(B0,n)}}function V0(e,n,l){e==="focusin"?(td(),ol=n,il=l,ol.attachEvent("onpropertychange",nd)):e==="focusout"&&td()}function q0(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return fo(il)}function J0(e,n){if(e==="click")return fo(n)}function z0(e,n){if(e==="input"||e==="change")return fo(n)}function F0(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var Xt=typeof Object.is=="function"?Object.is:F0;function rl(e,n){if(Xt(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var l=Object.keys(e),r=Object.keys(n);if(l.length!==r.length)return!1;for(r=0;r<l.length;r++){var m=l[r];if(!Ut.call(n,m)||!Xt(e[m],n[m]))return!1}return!0}function sd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ad(e,n){var l=sd(e);e=0;for(var r;l;){if(l.nodeType===3){if(r=e+l.textContent.length,e<=n&&r>=n)return{node:l,offset:n-e};e=r}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=sd(l)}}function ld(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?ld(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function od(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var n=ao(e.document);n instanceof e.HTMLIFrameElement;){try{var l=typeof n.contentWindow.location.href=="string"}catch{l=!1}if(l)e=n.contentWindow;else break;n=ao(e.document)}return n}function nr(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}var Y0=Dn&&"documentMode"in document&&11>=document.documentMode,fa=null,sr=null,cl=null,ar=!1;function id(e,n,l){var r=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;ar||fa==null||fa!==ao(r)||(r=fa,"selectionStart"in r&&nr(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),cl&&rl(cl,r)||(cl=r,r=ei(sr,"onSelect"),0<r.length&&(n=new co("onSelect","select",null,n,l),e.push({event:n,listeners:r}),n.target=fa)))}function js(e,n){var l={};return l[e.toLowerCase()]=n.toLowerCase(),l["Webkit"+e]="webkit"+n,l["Moz"+e]="moz"+n,l}var pa={animationend:js("Animation","AnimationEnd"),animationiteration:js("Animation","AnimationIteration"),animationstart:js("Animation","AnimationStart"),transitionrun:js("Transition","TransitionRun"),transitionstart:js("Transition","TransitionStart"),transitioncancel:js("Transition","TransitionCancel"),transitionend:js("Transition","TransitionEnd")},lr={},rd={};Dn&&(rd=document.createElement("div").style,"AnimationEvent"in window||(delete pa.animationend.animation,delete pa.animationiteration.animation,delete pa.animationstart.animation),"TransitionEvent"in window||delete pa.transitionend.transition);function Us(e){if(lr[e])return lr[e];if(!pa[e])return e;var n=pa[e],l;for(l in n)if(n.hasOwnProperty(l)&&l in rd)return lr[e]=n[l];return e}var cd=Us("animationend"),ud=Us("animationiteration"),dd=Us("animationstart"),$0=Us("transitionrun"),K0=Us("transitionstart"),X0=Us("transitioncancel"),fd=Us("transitionend"),pd=new Map,or="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");or.push("scrollEnd");function xn(e,n){pd.set(e,n),Qe(n,[e])}var po=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},on=[],ma=0,ir=0;function mo(){for(var e=ma,n=ir=ma=0;n<e;){var l=on[n];on[n++]=null;var r=on[n];on[n++]=null;var m=on[n];on[n++]=null;var x=on[n];if(on[n++]=null,r!==null&&m!==null){var T=r.pending;T===null?m.next=m:(m.next=T.next,T.next=m),r.pending=m}x!==0&&md(l,m,x)}}function ho(e,n,l,r){on[ma++]=e,on[ma++]=n,on[ma++]=l,on[ma++]=r,ir|=r,e.lanes|=r,e=e.alternate,e!==null&&(e.lanes|=r)}function rr(e,n,l,r){return ho(e,n,l,r),go(e)}function Ls(e,n){return ho(e,null,null,n),go(e)}function md(e,n,l){e.lanes|=l;var r=e.alternate;r!==null&&(r.lanes|=l);for(var m=!1,x=e.return;x!==null;)x.childLanes|=l,r=x.alternate,r!==null&&(r.childLanes|=l),x.tag===22&&(e=x.stateNode,e===null||e._visibility&1||(m=!0)),e=x,x=x.return;return e.tag===3?(x=e.stateNode,m&&n!==null&&(m=31-Dt(l),e=x.hiddenUpdates,r=e[m],r===null?e[m]=[n]:r.push(n),n.lane=l|536870912),x):null}function go(e){if(50<Ml)throw Ml=0,xc=null,Error(o(185));for(var n=e.return;n!==null;)e=n,n=e.return;return e.tag===3?e.stateNode:null}var ha={};function Q0(e,n,l,r){this.tag=e,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qt(e,n,l,r){return new Q0(e,n,l,r)}function cr(e){return e=e.prototype,!(!e||!e.isReactComponent)}function kn(e,n){var l=e.alternate;return l===null?(l=Qt(e.tag,n,e.key,e.mode),l.elementType=e.elementType,l.type=e.type,l.stateNode=e.stateNode,l.alternate=e,e.alternate=l):(l.pendingProps=n,l.type=e.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=e.flags&65011712,l.childLanes=e.childLanes,l.lanes=e.lanes,l.child=e.child,l.memoizedProps=e.memoizedProps,l.memoizedState=e.memoizedState,l.updateQueue=e.updateQueue,n=e.dependencies,l.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},l.sibling=e.sibling,l.index=e.index,l.ref=e.ref,l.refCleanup=e.refCleanup,l}function hd(e,n){e.flags&=65011714;var l=e.alternate;return l===null?(e.childLanes=0,e.lanes=n,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=l.childLanes,e.lanes=l.lanes,e.child=l.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=l.memoizedProps,e.memoizedState=l.memoizedState,e.updateQueue=l.updateQueue,e.type=l.type,n=l.dependencies,e.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),e}function xo(e,n,l,r,m,x){var T=0;if(r=e,typeof e=="function")cr(e)&&(T=1);else if(typeof e=="string")T=nv(e,l,z.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case X:return e=Qt(31,l,n,m),e.elementType=X,e.lanes=x,e;case w:return Gs(l.children,m,x,n);case M:T=8,m|=24;break;case J:return e=Qt(12,l,n,m|2),e.elementType=J,e.lanes=x,e;case Q:return e=Qt(13,l,n,m),e.elementType=Q,e.lanes=x,e;case H:return e=Qt(19,l,n,m),e.elementType=H,e.lanes=x,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ee:T=10;break e;case ce:T=9;break e;case P:T=11;break e;case V:T=14;break e;case q:T=16,r=null;break e}T=29,l=Error(o(130,e===null?"null":typeof e,"")),r=null}return n=Qt(T,l,n,m),n.elementType=e,n.type=r,n.lanes=x,n}function Gs(e,n,l,r){return e=Qt(7,e,r,n),e.lanes=l,e}function ur(e,n,l){return e=Qt(6,e,null,n),e.lanes=l,e}function gd(e){var n=Qt(18,null,null,0);return n.stateNode=e,n}function dr(e,n,l){return n=Qt(4,e.children!==null?e.children:[],e.key,n),n.lanes=l,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}var xd=new WeakMap;function rn(e,n){if(typeof e=="object"&&e!==null){var l=xd.get(e);return l!==void 0?l:(n={value:e,source:n,stack:ut(n)},xd.set(e,n),n)}return{value:e,source:n,stack:ut(n)}}var ga=[],xa=0,vo=null,ul=0,cn=[],un=0,as=null,Cn=1,wn="";function jn(e,n){ga[xa++]=ul,ga[xa++]=vo,vo=e,ul=n}function vd(e,n,l){cn[un++]=Cn,cn[un++]=wn,cn[un++]=as,as=e;var r=Cn;e=wn;var m=32-Dt(r)-1;r&=~(1<<m),l+=1;var x=32-Dt(n)+m;if(30<x){var T=m-m%5;x=(r&(1<<T)-1).toString(32),r>>=T,m-=T,Cn=1<<32-Dt(n)+m|l<<m|r,wn=x+e}else Cn=1<<x|l<<m|r,wn=e}function fr(e){e.return!==null&&(jn(e,1),vd(e,1,0))}function pr(e){for(;e===vo;)vo=ga[--xa],ga[xa]=null,ul=ga[--xa],ga[xa]=null;for(;e===as;)as=cn[--un],cn[un]=null,wn=cn[--un],cn[un]=null,Cn=cn[--un],cn[un]=null}function yd(e,n){cn[un++]=Cn,cn[un++]=wn,cn[un++]=as,Cn=n.id,wn=n.overflow,as=e}var _t=null,it=null,Ye=!1,ls=null,dn=!1,mr=Error(o(519));function os(e){var n=Error(o(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw dl(rn(n,e)),mr}function bd(e){var n=e.stateNode,l=e.type,r=e.memoizedProps;switch(n[ft]=e,n[At]=r,l){case"dialog":qe("cancel",n),qe("close",n);break;case"iframe":case"object":case"embed":qe("load",n);break;case"video":case"audio":for(l=0;l<kl.length;l++)qe(kl[l],n);break;case"source":qe("error",n);break;case"img":case"image":case"link":qe("error",n),qe("load",n);break;case"details":qe("toggle",n);break;case"input":qe("invalid",n),ku(n,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case"select":qe("invalid",n);break;case"textarea":qe("invalid",n),Uu(n,r.value,r.defaultValue,r.children)}l=r.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||n.textContent===""+l||r.suppressHydrationWarning===!0||Op(n.textContent,l)?(r.popover!=null&&(qe("beforetoggle",n),qe("toggle",n)),r.onScroll!=null&&qe("scroll",n),r.onScrollEnd!=null&&qe("scrollend",n),r.onClick!=null&&(n.onclick=Mn),n=!0):n=!1,n||os(e,!0)}function Sd(e){for(_t=e.return;_t;)switch(_t.tag){case 5:case 31:case 13:dn=!1;return;case 27:case 3:dn=!0;return;default:_t=_t.return}}function va(e){if(e!==_t)return!1;if(!Ye)return Sd(e),Ye=!0,!1;var n=e.tag,l;if((l=n!==3&&n!==27)&&((l=n===5)&&(l=e.type,l=!(l!=="form"&&l!=="button")||Dc(e.type,e.memoizedProps)),l=!l),l&&it&&os(e),Sd(e),n===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(317));it=Yp(e)}else if(n===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(317));it=Yp(e)}else n===27?(n=it,bs(e.type)?(e=Gc,Gc=null,it=e):it=n):it=_t?pn(e.stateNode.nextSibling):null;return!0}function Os(){it=_t=null,Ye=!1}function hr(){var e=ls;return e!==null&&(Ft===null?Ft=e:Ft.push.apply(Ft,e),ls=null),e}function dl(e){ls===null?ls=[e]:ls.push(e)}var gr=C(null),Ps=null,Un=null;function is(e,n,l){O(gr,n._currentValue),n._currentValue=l}function Ln(e){e._currentValue=gr.current,_(gr)}function xr(e,n,l){for(;e!==null;){var r=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,r!==null&&(r.childLanes|=n)):r!==null&&(r.childLanes&n)!==n&&(r.childLanes|=n),e===l)break;e=e.return}}function vr(e,n,l,r){var m=e.child;for(m!==null&&(m.return=e);m!==null;){var x=m.dependencies;if(x!==null){var T=m.child;x=x.firstContext;e:for(;x!==null;){var E=x;x=m;for(var R=0;R<n.length;R++)if(E.context===n[R]){x.lanes|=l,E=x.alternate,E!==null&&(E.lanes|=l),xr(x.return,l,e),r||(T=null);break e}x=E.next}}else if(m.tag===18){if(T=m.return,T===null)throw Error(o(341));T.lanes|=l,x=T.alternate,x!==null&&(x.lanes|=l),xr(T,l,e),T=null}else T=m.child;if(T!==null)T.return=m;else for(T=m;T!==null;){if(T===e){T=null;break}if(m=T.sibling,m!==null){m.return=T.return,T=m;break}T=T.return}m=T}}function ya(e,n,l,r){e=null;for(var m=n,x=!1;m!==null;){if(!x){if((m.flags&524288)!==0)x=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var T=m.alternate;if(T===null)throw Error(o(387));if(T=T.memoizedProps,T!==null){var E=m.type;Xt(m.pendingProps.value,T.value)||(e!==null?e.push(E):e=[E])}}else if(m===ge.current){if(T=m.alternate,T===null)throw Error(o(387));T.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(e!==null?e.push(Ol):e=[Ol])}m=m.return}e!==null&&vr(n,e,l,r),n.flags|=262144}function yo(e){for(e=e.firstContext;e!==null;){if(!Xt(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Hs(e){Ps=e,Un=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Rt(e){return Td(Ps,e)}function bo(e,n){return Ps===null&&Hs(e),Td(e,n)}function Td(e,n){var l=n._currentValue;if(n={context:n,memoizedValue:l,next:null},Un===null){if(e===null)throw Error(o(308));Un=n,e.dependencies={lanes:0,firstContext:n},e.flags|=524288}else Un=Un.next=n;return l}var W0=typeof AbortController<"u"?AbortController:function(){var e=[],n=this.signal={aborted:!1,addEventListener:function(l,r){e.push(r)}};this.abort=function(){n.aborted=!0,e.forEach(function(l){return l()})}},Z0=s.unstable_scheduleCallback,ex=s.unstable_NormalPriority,yt={$$typeof:ee,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function yr(){return{controller:new W0,data:new Map,refCount:0}}function fl(e){e.refCount--,e.refCount===0&&Z0(ex,function(){e.controller.abort()})}var pl=null,br=0,ba=0,Sa=null;function tx(e,n){if(pl===null){var l=pl=[];br=0,ba=Nc(),Sa={status:"pending",value:void 0,then:function(r){l.push(r)}}}return br++,n.then(Nd,Nd),n}function Nd(){if(--br===0&&pl!==null){Sa!==null&&(Sa.status="fulfilled");var e=pl;pl=null,ba=0,Sa=null;for(var n=0;n<e.length;n++)(0,e[n])()}}function nx(e,n){var l=[],r={status:"pending",value:null,reason:null,then:function(m){l.push(m)}};return e.then(function(){r.status="fulfilled",r.value=n;for(var m=0;m<l.length;m++)(0,l[m])(n)},function(m){for(r.status="rejected",r.reason=m,m=0;m<l.length;m++)(0,l[m])(void 0)}),r}var Ed=A.S;A.S=function(e,n){rp=Gt(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&tx(e,n),Ed!==null&&Ed(e,n)};var Bs=C(null);function Sr(){var e=Bs.current;return e!==null?e:ot.pooledCache}function So(e,n){n===null?O(Bs,Bs.current):O(Bs,n.pool)}function Cd(){var e=Sr();return e===null?null:{parent:yt._currentValue,pool:e}}var Ta=Error(o(460)),Tr=Error(o(474)),To=Error(o(542)),No={then:function(){}};function wd(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Ad(e,n,l){switch(l=e[l],l===void 0?e.push(n):l!==n&&(n.then(Mn,Mn),n=l),n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,Rd(e),e;default:if(typeof n.status=="string")n.then(Mn,Mn);else{if(e=ot,e!==null&&100<e.shellSuspendCounter)throw Error(o(482));e=n,e.status="pending",e.then(function(r){if(n.status==="pending"){var m=n;m.status="fulfilled",m.value=r}},function(r){if(n.status==="pending"){var m=n;m.status="rejected",m.reason=r}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,Rd(e),e}throw qs=n,Ta}}function Vs(e){try{var n=e._init;return n(e._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(qs=l,Ta):l}}var qs=null;function _d(){if(qs===null)throw Error(o(459));var e=qs;return qs=null,e}function Rd(e){if(e===Ta||e===To)throw Error(o(483))}var Na=null,ml=0;function Eo(e){var n=ml;return ml+=1,Na===null&&(Na=[]),Ad(Na,e,n)}function hl(e,n){n=n.props.ref,e.ref=n!==void 0?n:null}function Co(e,n){throw n.$$typeof===S?Error(o(525)):(e=Object.prototype.toString.call(n),Error(o(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)))}function Id(e){function n(B,j){if(e){var Y=B.deletions;Y===null?(B.deletions=[j],B.flags|=16):Y.push(j)}}function l(B,j){if(!e)return null;for(;j!==null;)n(B,j),j=j.sibling;return null}function r(B){for(var j=new Map;B!==null;)B.key!==null?j.set(B.key,B):j.set(B.index,B),B=B.sibling;return j}function m(B,j){return B=kn(B,j),B.index=0,B.sibling=null,B}function x(B,j,Y){return B.index=Y,e?(Y=B.alternate,Y!==null?(Y=Y.index,Y<j?(B.flags|=67108866,j):Y):(B.flags|=67108866,j)):(B.flags|=1048576,j)}function T(B){return e&&B.alternate===null&&(B.flags|=67108866),B}function E(B,j,Y,de){return j===null||j.tag!==6?(j=ur(Y,B.mode,de),j.return=B,j):(j=m(j,Y),j.return=B,j)}function R(B,j,Y,de){var Ae=Y.type;return Ae===w?ie(B,j,Y.props.children,de,Y.key):j!==null&&(j.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===q&&Vs(Ae)===j.type)?(j=m(j,Y.props),hl(j,Y),j.return=B,j):(j=xo(Y.type,Y.key,Y.props,null,B.mode,de),hl(j,Y),j.return=B,j)}function $(B,j,Y,de){return j===null||j.tag!==4||j.stateNode.containerInfo!==Y.containerInfo||j.stateNode.implementation!==Y.implementation?(j=dr(Y,B.mode,de),j.return=B,j):(j=m(j,Y.children||[]),j.return=B,j)}function ie(B,j,Y,de,Ae){return j===null||j.tag!==7?(j=Gs(Y,B.mode,de,Ae),j.return=B,j):(j=m(j,Y),j.return=B,j)}function pe(B,j,Y){if(typeof j=="string"&&j!==""||typeof j=="number"||typeof j=="bigint")return j=ur(""+j,B.mode,Y),j.return=B,j;if(typeof j=="object"&&j!==null){switch(j.$$typeof){case N:return Y=xo(j.type,j.key,j.props,null,B.mode,Y),hl(Y,j),Y.return=B,Y;case k:return j=dr(j,B.mode,Y),j.return=B,j;case q:return j=Vs(j),pe(B,j,Y)}if(ae(j)||re(j))return j=Gs(j,B.mode,Y,null),j.return=B,j;if(typeof j.then=="function")return pe(B,Eo(j),Y);if(j.$$typeof===ee)return pe(B,bo(B,j),Y);Co(B,j)}return null}function K(B,j,Y,de){var Ae=j!==null?j.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return Ae!==null?null:E(B,j,""+Y,de);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case N:return Y.key===Ae?R(B,j,Y,de):null;case k:return Y.key===Ae?$(B,j,Y,de):null;case q:return Y=Vs(Y),K(B,j,Y,de)}if(ae(Y)||re(Y))return Ae!==null?null:ie(B,j,Y,de,null);if(typeof Y.then=="function")return K(B,j,Eo(Y),de);if(Y.$$typeof===ee)return K(B,j,bo(B,Y),de);Co(B,Y)}return null}function te(B,j,Y,de,Ae){if(typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint")return B=B.get(Y)||null,E(j,B,""+de,Ae);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case N:return B=B.get(de.key===null?Y:de.key)||null,R(j,B,de,Ae);case k:return B=B.get(de.key===null?Y:de.key)||null,$(j,B,de,Ae);case q:return de=Vs(de),te(B,j,Y,de,Ae)}if(ae(de)||re(de))return B=B.get(Y)||null,ie(j,B,de,Ae,null);if(typeof de.then=="function")return te(B,j,Y,Eo(de),Ae);if(de.$$typeof===ee)return te(B,j,Y,bo(j,de),Ae);Co(j,de)}return null}function Ne(B,j,Y,de){for(var Ae=null,$e=null,Ce=j,Be=j=0,ze=null;Ce!==null&&Be<Y.length;Be++){Ce.index>Be?(ze=Ce,Ce=null):ze=Ce.sibling;var Ke=K(B,Ce,Y[Be],de);if(Ke===null){Ce===null&&(Ce=ze);break}e&&Ce&&Ke.alternate===null&&n(B,Ce),j=x(Ke,j,Be),$e===null?Ae=Ke:$e.sibling=Ke,$e=Ke,Ce=ze}if(Be===Y.length)return l(B,Ce),Ye&&jn(B,Be),Ae;if(Ce===null){for(;Be<Y.length;Be++)Ce=pe(B,Y[Be],de),Ce!==null&&(j=x(Ce,j,Be),$e===null?Ae=Ce:$e.sibling=Ce,$e=Ce);return Ye&&jn(B,Be),Ae}for(Ce=r(Ce);Be<Y.length;Be++)ze=te(Ce,B,Be,Y[Be],de),ze!==null&&(e&&ze.alternate!==null&&Ce.delete(ze.key===null?Be:ze.key),j=x(ze,j,Be),$e===null?Ae=ze:$e.sibling=ze,$e=ze);return e&&Ce.forEach(function(Cs){return n(B,Cs)}),Ye&&jn(B,Be),Ae}function Me(B,j,Y,de){if(Y==null)throw Error(o(151));for(var Ae=null,$e=null,Ce=j,Be=j=0,ze=null,Ke=Y.next();Ce!==null&&!Ke.done;Be++,Ke=Y.next()){Ce.index>Be?(ze=Ce,Ce=null):ze=Ce.sibling;var Cs=K(B,Ce,Ke.value,de);if(Cs===null){Ce===null&&(Ce=ze);break}e&&Ce&&Cs.alternate===null&&n(B,Ce),j=x(Cs,j,Be),$e===null?Ae=Cs:$e.sibling=Cs,$e=Cs,Ce=ze}if(Ke.done)return l(B,Ce),Ye&&jn(B,Be),Ae;if(Ce===null){for(;!Ke.done;Be++,Ke=Y.next())Ke=pe(B,Ke.value,de),Ke!==null&&(j=x(Ke,j,Be),$e===null?Ae=Ke:$e.sibling=Ke,$e=Ke);return Ye&&jn(B,Be),Ae}for(Ce=r(Ce);!Ke.done;Be++,Ke=Y.next())Ke=te(Ce,B,Be,Ke.value,de),Ke!==null&&(e&&Ke.alternate!==null&&Ce.delete(Ke.key===null?Be:Ke.key),j=x(Ke,j,Be),$e===null?Ae=Ke:$e.sibling=Ke,$e=Ke);return e&&Ce.forEach(function(pv){return n(B,pv)}),Ye&&jn(B,Be),Ae}function lt(B,j,Y,de){if(typeof Y=="object"&&Y!==null&&Y.type===w&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case N:e:{for(var Ae=Y.key;j!==null;){if(j.key===Ae){if(Ae=Y.type,Ae===w){if(j.tag===7){l(B,j.sibling),de=m(j,Y.props.children),de.return=B,B=de;break e}}else if(j.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===q&&Vs(Ae)===j.type){l(B,j.sibling),de=m(j,Y.props),hl(de,Y),de.return=B,B=de;break e}l(B,j);break}else n(B,j);j=j.sibling}Y.type===w?(de=Gs(Y.props.children,B.mode,de,Y.key),de.return=B,B=de):(de=xo(Y.type,Y.key,Y.props,null,B.mode,de),hl(de,Y),de.return=B,B=de)}return T(B);case k:e:{for(Ae=Y.key;j!==null;){if(j.key===Ae)if(j.tag===4&&j.stateNode.containerInfo===Y.containerInfo&&j.stateNode.implementation===Y.implementation){l(B,j.sibling),de=m(j,Y.children||[]),de.return=B,B=de;break e}else{l(B,j);break}else n(B,j);j=j.sibling}de=dr(Y,B.mode,de),de.return=B,B=de}return T(B);case q:return Y=Vs(Y),lt(B,j,Y,de)}if(ae(Y))return Ne(B,j,Y,de);if(re(Y)){if(Ae=re(Y),typeof Ae!="function")throw Error(o(150));return Y=Ae.call(Y),Me(B,j,Y,de)}if(typeof Y.then=="function")return lt(B,j,Eo(Y),de);if(Y.$$typeof===ee)return lt(B,j,bo(B,Y),de);Co(B,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint"?(Y=""+Y,j!==null&&j.tag===6?(l(B,j.sibling),de=m(j,Y),de.return=B,B=de):(l(B,j),de=ur(Y,B.mode,de),de.return=B,B=de),T(B)):l(B,j)}return function(B,j,Y,de){try{ml=0;var Ae=lt(B,j,Y,de);return Na=null,Ae}catch(Ce){if(Ce===Ta||Ce===To)throw Ce;var $e=Qt(29,Ce,null,B.mode);return $e.lanes=de,$e.return=B,$e}finally{}}}var Js=Id(!0),Md=Id(!1),rs=!1;function Nr(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Er(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function cs(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function us(e,n,l){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,(We&2)!==0){var m=r.pending;return m===null?n.next=n:(n.next=m.next,m.next=n),r.pending=n,n=go(e),md(e,null,l),n}return ho(e,r,n,l),go(e)}function gl(e,n,l){if(n=n.updateQueue,n!==null&&(n=n.shared,(l&4194048)!==0)){var r=n.lanes;r&=e.pendingLanes,l|=r,n.lanes=l,Zl(e,l)}}function Cr(e,n){var l=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,l===r)){var m=null,x=null;if(l=l.firstBaseUpdate,l!==null){do{var T={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};x===null?m=x=T:x=x.next=T,l=l.next}while(l!==null);x===null?m=x=n:x=x.next=n}else m=x=n;l={baseState:r.baseState,firstBaseUpdate:m,lastBaseUpdate:x,shared:r.shared,callbacks:r.callbacks},e.updateQueue=l;return}e=l.lastBaseUpdate,e===null?l.firstBaseUpdate=n:e.next=n,l.lastBaseUpdate=n}var wr=!1;function xl(){if(wr){var e=Sa;if(e!==null)throw e}}function vl(e,n,l,r){wr=!1;var m=e.updateQueue;rs=!1;var x=m.firstBaseUpdate,T=m.lastBaseUpdate,E=m.shared.pending;if(E!==null){m.shared.pending=null;var R=E,$=R.next;R.next=null,T===null?x=$:T.next=$,T=R;var ie=e.alternate;ie!==null&&(ie=ie.updateQueue,E=ie.lastBaseUpdate,E!==T&&(E===null?ie.firstBaseUpdate=$:E.next=$,ie.lastBaseUpdate=R))}if(x!==null){var pe=m.baseState;T=0,ie=$=R=null,E=x;do{var K=E.lane&-536870913,te=K!==E.lane;if(te?(Je&K)===K:(r&K)===K){K!==0&&K===ba&&(wr=!0),ie!==null&&(ie=ie.next={lane:0,tag:E.tag,payload:E.payload,callback:null,next:null});e:{var Ne=e,Me=E;K=n;var lt=l;switch(Me.tag){case 1:if(Ne=Me.payload,typeof Ne=="function"){pe=Ne.call(lt,pe,K);break e}pe=Ne;break e;case 3:Ne.flags=Ne.flags&-65537|128;case 0:if(Ne=Me.payload,K=typeof Ne=="function"?Ne.call(lt,pe,K):Ne,K==null)break e;pe=b({},pe,K);break e;case 2:rs=!0}}K=E.callback,K!==null&&(e.flags|=64,te&&(e.flags|=8192),te=m.callbacks,te===null?m.callbacks=[K]:te.push(K))}else te={lane:K,tag:E.tag,payload:E.payload,callback:E.callback,next:null},ie===null?($=ie=te,R=pe):ie=ie.next=te,T|=K;if(E=E.next,E===null){if(E=m.shared.pending,E===null)break;te=E,E=te.next,te.next=null,m.lastBaseUpdate=te,m.shared.pending=null}}while(!0);ie===null&&(R=pe),m.baseState=R,m.firstBaseUpdate=$,m.lastBaseUpdate=ie,x===null&&(m.shared.lanes=0),hs|=T,e.lanes=T,e.memoizedState=pe}}function Dd(e,n){if(typeof e!="function")throw Error(o(191,e));e.call(n)}function kd(e,n){var l=e.callbacks;if(l!==null)for(e.callbacks=null,e=0;e<l.length;e++)Dd(l[e],n)}var Ea=C(null),wo=C(0);function jd(e,n){e=zn,O(wo,e),O(Ea,n),zn=e|n.baseLanes}function Ar(){O(wo,zn),O(Ea,Ea.current)}function _r(){zn=wo.current,_(Ea),_(wo)}var Wt=C(null),fn=null;function ds(e){var n=e.alternate;O(xt,xt.current&1),O(Wt,e),fn===null&&(n===null||Ea.current!==null||n.memoizedState!==null)&&(fn=e)}function Rr(e){O(xt,xt.current),O(Wt,e),fn===null&&(fn=e)}function Ud(e){e.tag===22?(O(xt,xt.current),O(Wt,e),fn===null&&(fn=e)):fs()}function fs(){O(xt,xt.current),O(Wt,Wt.current)}function Zt(e){_(Wt),fn===e&&(fn=null),_(xt)}var xt=C(0);function Ao(e){for(var n=e;n!==null;){if(n.tag===13){var l=n.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Uc(l)||Lc(l)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var Gn=0,He=null,st=null,bt=null,_o=!1,Ca=!1,zs=!1,Ro=0,yl=0,wa=null,sx=0;function mt(){throw Error(o(321))}function Ir(e,n){if(n===null)return!1;for(var l=0;l<n.length&&l<e.length;l++)if(!Xt(e[l],n[l]))return!1;return!0}function Mr(e,n,l,r,m,x){return Gn=x,He=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,A.H=e===null||e.memoizedState===null?yf:Fr,zs=!1,x=l(r,m),zs=!1,Ca&&(x=Gd(n,l,r,m)),Ld(e),x}function Ld(e){A.H=Tl;var n=st!==null&&st.next!==null;if(Gn=0,bt=st=He=null,_o=!1,yl=0,wa=null,n)throw Error(o(300));e===null||St||(e=e.dependencies,e!==null&&yo(e)&&(St=!0))}function Gd(e,n,l,r){He=e;var m=0;do{if(Ca&&(wa=null),yl=0,Ca=!1,25<=m)throw Error(o(301));if(m+=1,bt=st=null,e.updateQueue!=null){var x=e.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}A.H=bf,x=n(l,r)}while(Ca);return x}function ax(){var e=A.H,n=e.useState()[0];return n=typeof n.then=="function"?bl(n):n,e=e.useState()[0],(st!==null?st.memoizedState:null)!==e&&(He.flags|=1024),n}function Dr(){var e=Ro!==0;return Ro=0,e}function kr(e,n,l){n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~l}function jr(e){if(_o){for(e=e.memoizedState;e!==null;){var n=e.queue;n!==null&&(n.pending=null),e=e.next}_o=!1}Gn=0,bt=st=He=null,Ca=!1,yl=Ro=0,wa=null}function Pt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bt===null?He.memoizedState=bt=e:bt=bt.next=e,bt}function vt(){if(st===null){var e=He.alternate;e=e!==null?e.memoizedState:null}else e=st.next;var n=bt===null?He.memoizedState:bt.next;if(n!==null)bt=n,st=e;else{if(e===null)throw He.alternate===null?Error(o(467)):Error(o(310));st=e,e={memoizedState:st.memoizedState,baseState:st.baseState,baseQueue:st.baseQueue,queue:st.queue,next:null},bt===null?He.memoizedState=bt=e:bt=bt.next=e}return bt}function Io(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function bl(e){var n=yl;return yl+=1,wa===null&&(wa=[]),e=Ad(wa,e,n),n=He,(bt===null?n.memoizedState:bt.next)===null&&(n=n.alternate,A.H=n===null||n.memoizedState===null?yf:Fr),e}function Mo(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return bl(e);if(e.$$typeof===ee)return Rt(e)}throw Error(o(438,String(e)))}function Ur(e){var n=null,l=He.updateQueue;if(l!==null&&(n=l.memoCache),n==null){var r=He.alternate;r!==null&&(r=r.updateQueue,r!==null&&(r=r.memoCache,r!=null&&(n={data:r.data.map(function(m){return m.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),l===null&&(l=Io(),He.updateQueue=l),l.memoCache=n,l=n.data[n.index],l===void 0)for(l=n.data[n.index]=Array(e),r=0;r<e;r++)l[r]=fe;return n.index++,l}function On(e,n){return typeof n=="function"?n(e):n}function Do(e){var n=vt();return Lr(n,st,e)}function Lr(e,n,l){var r=e.queue;if(r===null)throw Error(o(311));r.lastRenderedReducer=l;var m=e.baseQueue,x=r.pending;if(x!==null){if(m!==null){var T=m.next;m.next=x.next,x.next=T}n.baseQueue=m=x,r.pending=null}if(x=e.baseState,m===null)e.memoizedState=x;else{n=m.next;var E=T=null,R=null,$=n,ie=!1;do{var pe=$.lane&-536870913;if(pe!==$.lane?(Je&pe)===pe:(Gn&pe)===pe){var K=$.revertLane;if(K===0)R!==null&&(R=R.next={lane:0,revertLane:0,gesture:null,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null}),pe===ba&&(ie=!0);else if((Gn&K)===K){$=$.next,K===ba&&(ie=!0);continue}else pe={lane:0,revertLane:$.revertLane,gesture:null,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null},R===null?(E=R=pe,T=x):R=R.next=pe,He.lanes|=K,hs|=K;pe=$.action,zs&&l(x,pe),x=$.hasEagerState?$.eagerState:l(x,pe)}else K={lane:pe,revertLane:$.revertLane,gesture:$.gesture,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null},R===null?(E=R=K,T=x):R=R.next=K,He.lanes|=pe,hs|=pe;$=$.next}while($!==null&&$!==n);if(R===null?T=x:R.next=E,!Xt(x,e.memoizedState)&&(St=!0,ie&&(l=Sa,l!==null)))throw l;e.memoizedState=x,e.baseState=T,e.baseQueue=R,r.lastRenderedState=x}return m===null&&(r.lanes=0),[e.memoizedState,r.dispatch]}function Gr(e){var n=vt(),l=n.queue;if(l===null)throw Error(o(311));l.lastRenderedReducer=e;var r=l.dispatch,m=l.pending,x=n.memoizedState;if(m!==null){l.pending=null;var T=m=m.next;do x=e(x,T.action),T=T.next;while(T!==m);Xt(x,n.memoizedState)||(St=!0),n.memoizedState=x,n.baseQueue===null&&(n.baseState=x),l.lastRenderedState=x}return[x,r]}function Od(e,n,l){var r=He,m=vt(),x=Ye;if(x){if(l===void 0)throw Error(o(407));l=l()}else l=n();var T=!Xt((st||m).memoizedState,l);if(T&&(m.memoizedState=l,St=!0),m=m.queue,Hr(Bd.bind(null,r,m,e),[e]),m.getSnapshot!==n||T||bt!==null&&bt.memoizedState.tag&1){if(r.flags|=2048,Aa(9,{destroy:void 0},Hd.bind(null,r,m,l,n),null),ot===null)throw Error(o(349));x||(Gn&127)!==0||Pd(r,n,l)}return l}function Pd(e,n,l){e.flags|=16384,e={getSnapshot:n,value:l},n=He.updateQueue,n===null?(n=Io(),He.updateQueue=n,n.stores=[e]):(l=n.stores,l===null?n.stores=[e]:l.push(e))}function Hd(e,n,l,r){n.value=l,n.getSnapshot=r,Vd(n)&&qd(e)}function Bd(e,n,l){return l(function(){Vd(n)&&qd(e)})}function Vd(e){var n=e.getSnapshot;e=e.value;try{var l=n();return!Xt(e,l)}catch{return!0}}function qd(e){var n=Ls(e,2);n!==null&&Yt(n,e,2)}function Or(e){var n=Pt();if(typeof e=="function"){var l=e;if(e=l(),zs){Kt(!0);try{l()}finally{Kt(!1)}}}return n.memoizedState=n.baseState=e,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:On,lastRenderedState:e},n}function Jd(e,n,l,r){return e.baseState=l,Lr(e,st,typeof r=="function"?r:On)}function lx(e,n,l,r,m){if(Uo(e))throw Error(o(485));if(e=n.action,e!==null){var x={payload:m,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){x.listeners.push(T)}};A.T!==null?l(!0):x.isTransition=!1,r(x),l=n.pending,l===null?(x.next=n.pending=x,zd(n,x)):(x.next=l.next,n.pending=l.next=x)}}function zd(e,n){var l=n.action,r=n.payload,m=e.state;if(n.isTransition){var x=A.T,T={};A.T=T;try{var E=l(m,r),R=A.S;R!==null&&R(T,E),Fd(e,n,E)}catch($){Pr(e,n,$)}finally{x!==null&&T.types!==null&&(x.types=T.types),A.T=x}}else try{x=l(m,r),Fd(e,n,x)}catch($){Pr(e,n,$)}}function Fd(e,n,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(r){Yd(e,n,r)},function(r){return Pr(e,n,r)}):Yd(e,n,l)}function Yd(e,n,l){n.status="fulfilled",n.value=l,$d(n),e.state=l,n=e.pending,n!==null&&(l=n.next,l===n?e.pending=null:(l=l.next,n.next=l,zd(e,l)))}function Pr(e,n,l){var r=e.pending;if(e.pending=null,r!==null){r=r.next;do n.status="rejected",n.reason=l,$d(n),n=n.next;while(n!==r)}e.action=null}function $d(e){e=e.listeners;for(var n=0;n<e.length;n++)(0,e[n])()}function Kd(e,n){return n}function Xd(e,n){if(Ye){var l=ot.formState;if(l!==null){e:{var r=He;if(Ye){if(it){t:{for(var m=it,x=dn;m.nodeType!==8;){if(!x){m=null;break t}if(m=pn(m.nextSibling),m===null){m=null;break t}}x=m.data,m=x==="F!"||x==="F"?m:null}if(m){it=pn(m.nextSibling),r=m.data==="F!";break e}}os(r)}r=!1}r&&(n=l[0])}}return l=Pt(),l.memoizedState=l.baseState=n,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Kd,lastRenderedState:n},l.queue=r,l=gf.bind(null,He,r),r.dispatch=l,r=Or(!1),x=zr.bind(null,He,!1,r.queue),r=Pt(),m={state:n,dispatch:null,action:e,pending:null},r.queue=m,l=lx.bind(null,He,m,x,l),m.dispatch=l,r.memoizedState=e,[n,l,!1]}function Qd(e){var n=vt();return Wd(n,st,e)}function Wd(e,n,l){if(n=Lr(e,n,Kd)[0],e=Do(On)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var r=bl(n)}catch(T){throw T===Ta?To:T}else r=n;n=vt();var m=n.queue,x=m.dispatch;return l!==n.memoizedState&&(He.flags|=2048,Aa(9,{destroy:void 0},ox.bind(null,m,l),null)),[r,x,e]}function ox(e,n){e.action=n}function Zd(e){var n=vt(),l=st;if(l!==null)return Wd(n,l,e);vt(),n=n.memoizedState,l=vt();var r=l.queue.dispatch;return l.memoizedState=e,[n,r,!1]}function Aa(e,n,l,r){return e={tag:e,create:l,deps:r,inst:n,next:null},n=He.updateQueue,n===null&&(n=Io(),He.updateQueue=n),l=n.lastEffect,l===null?n.lastEffect=e.next=e:(r=l.next,l.next=e,e.next=r,n.lastEffect=e),e}function ef(){return vt().memoizedState}function ko(e,n,l,r){var m=Pt();He.flags|=e,m.memoizedState=Aa(1|n,{destroy:void 0},l,r===void 0?null:r)}function jo(e,n,l,r){var m=vt();r=r===void 0?null:r;var x=m.memoizedState.inst;st!==null&&r!==null&&Ir(r,st.memoizedState.deps)?m.memoizedState=Aa(n,x,l,r):(He.flags|=e,m.memoizedState=Aa(1|n,x,l,r))}function tf(e,n){ko(8390656,8,e,n)}function Hr(e,n){jo(2048,8,e,n)}function ix(e){He.flags|=4;var n=He.updateQueue;if(n===null)n=Io(),He.updateQueue=n,n.events=[e];else{var l=n.events;l===null?n.events=[e]:l.push(e)}}function nf(e){var n=vt().memoizedState;return ix({ref:n,nextImpl:e}),function(){if((We&2)!==0)throw Error(o(440));return n.impl.apply(void 0,arguments)}}function sf(e,n){return jo(4,2,e,n)}function af(e,n){return jo(4,4,e,n)}function lf(e,n){if(typeof n=="function"){e=e();var l=n(e);return function(){typeof l=="function"?l():n(null)}}if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function of(e,n,l){l=l!=null?l.concat([e]):null,jo(4,4,lf.bind(null,n,e),l)}function Br(){}function rf(e,n){var l=vt();n=n===void 0?null:n;var r=l.memoizedState;return n!==null&&Ir(n,r[1])?r[0]:(l.memoizedState=[e,n],e)}function cf(e,n){var l=vt();n=n===void 0?null:n;var r=l.memoizedState;if(n!==null&&Ir(n,r[1]))return r[0];if(r=e(),zs){Kt(!0);try{e()}finally{Kt(!1)}}return l.memoizedState=[r,n],r}function Vr(e,n,l){return l===void 0||(Gn&1073741824)!==0&&(Je&261930)===0?e.memoizedState=n:(e.memoizedState=l,e=up(),He.lanes|=e,hs|=e,l)}function uf(e,n,l,r){return Xt(l,n)?l:Ea.current!==null?(e=Vr(e,l,r),Xt(e,n)||(St=!0),e):(Gn&42)===0||(Gn&1073741824)!==0&&(Je&261930)===0?(St=!0,e.memoizedState=l):(e=up(),He.lanes|=e,hs|=e,n)}function df(e,n,l,r,m){var x=U.p;U.p=x!==0&&8>x?x:8;var T=A.T,E={};A.T=E,zr(e,!1,n,l);try{var R=m(),$=A.S;if($!==null&&$(E,R),R!==null&&typeof R=="object"&&typeof R.then=="function"){var ie=nx(R,r);Sl(e,n,ie,nn(e))}else Sl(e,n,r,nn(e))}catch(pe){Sl(e,n,{then:function(){},status:"rejected",reason:pe},nn())}finally{U.p=x,T!==null&&E.types!==null&&(T.types=E.types),A.T=T}}function rx(){}function qr(e,n,l,r){if(e.tag!==5)throw Error(o(476));var m=ff(e).queue;df(e,m,n,ue,l===null?rx:function(){return pf(e),l(r)})}function ff(e){var n=e.memoizedState;if(n!==null)return n;n={memoizedState:ue,baseState:ue,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:On,lastRenderedState:ue},next:null};var l={};return n.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:On,lastRenderedState:l},next:null},e.memoizedState=n,e=e.alternate,e!==null&&(e.memoizedState=n),n}function pf(e){var n=ff(e);n.next===null&&(n=e.alternate.memoizedState),Sl(e,n.next.queue,{},nn())}function Jr(){return Rt(Ol)}function mf(){return vt().memoizedState}function hf(){return vt().memoizedState}function cx(e){for(var n=e.return;n!==null;){switch(n.tag){case 24:case 3:var l=nn();e=cs(l);var r=us(n,e,l);r!==null&&(Yt(r,n,l),gl(r,n,l)),n={cache:yr()},e.payload=n;return}n=n.return}}function ux(e,n,l){var r=nn();l={lane:r,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Uo(e)?xf(n,l):(l=rr(e,n,l,r),l!==null&&(Yt(l,e,r),vf(l,n,r)))}function gf(e,n,l){var r=nn();Sl(e,n,l,r)}function Sl(e,n,l,r){var m={lane:r,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Uo(e))xf(n,m);else{var x=e.alternate;if(e.lanes===0&&(x===null||x.lanes===0)&&(x=n.lastRenderedReducer,x!==null))try{var T=n.lastRenderedState,E=x(T,l);if(m.hasEagerState=!0,m.eagerState=E,Xt(E,T))return ho(e,n,m,0),ot===null&&mo(),!1}catch{}finally{}if(l=rr(e,n,m,r),l!==null)return Yt(l,e,r),vf(l,n,r),!0}return!1}function zr(e,n,l,r){if(r={lane:2,revertLane:Nc(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},Uo(e)){if(n)throw Error(o(479))}else n=rr(e,l,r,2),n!==null&&Yt(n,e,2)}function Uo(e){var n=e.alternate;return e===He||n!==null&&n===He}function xf(e,n){Ca=_o=!0;var l=e.pending;l===null?n.next=n:(n.next=l.next,l.next=n),e.pending=n}function vf(e,n,l){if((l&4194048)!==0){var r=n.lanes;r&=e.pendingLanes,l|=r,n.lanes=l,Zl(e,l)}}var Tl={readContext:Rt,use:Mo,useCallback:mt,useContext:mt,useEffect:mt,useImperativeHandle:mt,useLayoutEffect:mt,useInsertionEffect:mt,useMemo:mt,useReducer:mt,useRef:mt,useState:mt,useDebugValue:mt,useDeferredValue:mt,useTransition:mt,useSyncExternalStore:mt,useId:mt,useHostTransitionStatus:mt,useFormState:mt,useActionState:mt,useOptimistic:mt,useMemoCache:mt,useCacheRefresh:mt};Tl.useEffectEvent=mt;var yf={readContext:Rt,use:Mo,useCallback:function(e,n){return Pt().memoizedState=[e,n===void 0?null:n],e},useContext:Rt,useEffect:tf,useImperativeHandle:function(e,n,l){l=l!=null?l.concat([e]):null,ko(4194308,4,lf.bind(null,n,e),l)},useLayoutEffect:function(e,n){return ko(4194308,4,e,n)},useInsertionEffect:function(e,n){ko(4,2,e,n)},useMemo:function(e,n){var l=Pt();n=n===void 0?null:n;var r=e();if(zs){Kt(!0);try{e()}finally{Kt(!1)}}return l.memoizedState=[r,n],r},useReducer:function(e,n,l){var r=Pt();if(l!==void 0){var m=l(n);if(zs){Kt(!0);try{l(n)}finally{Kt(!1)}}}else m=n;return r.memoizedState=r.baseState=m,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:m},r.queue=e,e=e.dispatch=ux.bind(null,He,e),[r.memoizedState,e]},useRef:function(e){var n=Pt();return e={current:e},n.memoizedState=e},useState:function(e){e=Or(e);var n=e.queue,l=gf.bind(null,He,n);return n.dispatch=l,[e.memoizedState,l]},useDebugValue:Br,useDeferredValue:function(e,n){var l=Pt();return Vr(l,e,n)},useTransition:function(){var e=Or(!1);return e=df.bind(null,He,e.queue,!0,!1),Pt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,n,l){var r=He,m=Pt();if(Ye){if(l===void 0)throw Error(o(407));l=l()}else{if(l=n(),ot===null)throw Error(o(349));(Je&127)!==0||Pd(r,n,l)}m.memoizedState=l;var x={value:l,getSnapshot:n};return m.queue=x,tf(Bd.bind(null,r,x,e),[e]),r.flags|=2048,Aa(9,{destroy:void 0},Hd.bind(null,r,x,l,n),null),l},useId:function(){var e=Pt(),n=ot.identifierPrefix;if(Ye){var l=wn,r=Cn;l=(r&~(1<<32-Dt(r)-1)).toString(32)+l,n="_"+n+"R_"+l,l=Ro++,0<l&&(n+="H"+l.toString(32)),n+="_"}else l=sx++,n="_"+n+"r_"+l.toString(32)+"_";return e.memoizedState=n},useHostTransitionStatus:Jr,useFormState:Xd,useActionState:Xd,useOptimistic:function(e){var n=Pt();n.memoizedState=n.baseState=e;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=l,n=zr.bind(null,He,!0,l),l.dispatch=n,[e,n]},useMemoCache:Ur,useCacheRefresh:function(){return Pt().memoizedState=cx.bind(null,He)},useEffectEvent:function(e){var n=Pt(),l={impl:e};return n.memoizedState=l,function(){if((We&2)!==0)throw Error(o(440));return l.impl.apply(void 0,arguments)}}},Fr={readContext:Rt,use:Mo,useCallback:rf,useContext:Rt,useEffect:Hr,useImperativeHandle:of,useInsertionEffect:sf,useLayoutEffect:af,useMemo:cf,useReducer:Do,useRef:ef,useState:function(){return Do(On)},useDebugValue:Br,useDeferredValue:function(e,n){var l=vt();return uf(l,st.memoizedState,e,n)},useTransition:function(){var e=Do(On)[0],n=vt().memoizedState;return[typeof e=="boolean"?e:bl(e),n]},useSyncExternalStore:Od,useId:mf,useHostTransitionStatus:Jr,useFormState:Qd,useActionState:Qd,useOptimistic:function(e,n){var l=vt();return Jd(l,st,e,n)},useMemoCache:Ur,useCacheRefresh:hf};Fr.useEffectEvent=nf;var bf={readContext:Rt,use:Mo,useCallback:rf,useContext:Rt,useEffect:Hr,useImperativeHandle:of,useInsertionEffect:sf,useLayoutEffect:af,useMemo:cf,useReducer:Gr,useRef:ef,useState:function(){return Gr(On)},useDebugValue:Br,useDeferredValue:function(e,n){var l=vt();return st===null?Vr(l,e,n):uf(l,st.memoizedState,e,n)},useTransition:function(){var e=Gr(On)[0],n=vt().memoizedState;return[typeof e=="boolean"?e:bl(e),n]},useSyncExternalStore:Od,useId:mf,useHostTransitionStatus:Jr,useFormState:Zd,useActionState:Zd,useOptimistic:function(e,n){var l=vt();return st!==null?Jd(l,st,e,n):(l.baseState=e,[e,l.queue.dispatch])},useMemoCache:Ur,useCacheRefresh:hf};bf.useEffectEvent=nf;function Yr(e,n,l,r){n=e.memoizedState,l=l(r,n),l=l==null?n:b({},n,l),e.memoizedState=l,e.lanes===0&&(e.updateQueue.baseState=l)}var $r={enqueueSetState:function(e,n,l){e=e._reactInternals;var r=nn(),m=cs(r);m.payload=n,l!=null&&(m.callback=l),n=us(e,m,r),n!==null&&(Yt(n,e,r),gl(n,e,r))},enqueueReplaceState:function(e,n,l){e=e._reactInternals;var r=nn(),m=cs(r);m.tag=1,m.payload=n,l!=null&&(m.callback=l),n=us(e,m,r),n!==null&&(Yt(n,e,r),gl(n,e,r))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var l=nn(),r=cs(l);r.tag=2,n!=null&&(r.callback=n),n=us(e,r,l),n!==null&&(Yt(n,e,l),gl(n,e,l))}};function Sf(e,n,l,r,m,x,T){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,x,T):n.prototype&&n.prototype.isPureReactComponent?!rl(l,r)||!rl(m,x):!0}function Tf(e,n,l,r){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(l,r),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(l,r),n.state!==e&&$r.enqueueReplaceState(n,n.state,null)}function Fs(e,n){var l=n;if("ref"in n){l={};for(var r in n)r!=="ref"&&(l[r]=n[r])}if(e=e.defaultProps){l===n&&(l=b({},l));for(var m in e)l[m]===void 0&&(l[m]=e[m])}return l}function Nf(e){po(e)}function Ef(e){console.error(e)}function Cf(e){po(e)}function Lo(e,n){try{var l=e.onUncaughtError;l(n.value,{componentStack:n.stack})}catch(r){setTimeout(function(){throw r})}}function wf(e,n,l){try{var r=e.onCaughtError;r(l.value,{componentStack:l.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function Kr(e,n,l){return l=cs(l),l.tag=3,l.payload={element:null},l.callback=function(){Lo(e,n)},l}function Af(e){return e=cs(e),e.tag=3,e}function _f(e,n,l,r){var m=l.type.getDerivedStateFromError;if(typeof m=="function"){var x=r.value;e.payload=function(){return m(x)},e.callback=function(){wf(n,l,r)}}var T=l.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(e.callback=function(){wf(n,l,r),typeof m!="function"&&(gs===null?gs=new Set([this]):gs.add(this));var E=r.stack;this.componentDidCatch(r.value,{componentStack:E!==null?E:""})})}function dx(e,n,l,r,m){if(l.flags|=32768,r!==null&&typeof r=="object"&&typeof r.then=="function"){if(n=l.alternate,n!==null&&ya(n,l,m,!0),l=Wt.current,l!==null){switch(l.tag){case 31:case 13:return fn===null?$o():l.alternate===null&&ht===0&&(ht=3),l.flags&=-257,l.flags|=65536,l.lanes=m,r===No?l.flags|=16384:(n=l.updateQueue,n===null?l.updateQueue=new Set([r]):n.add(r),bc(e,r,m)),!1;case 22:return l.flags|=65536,r===No?l.flags|=16384:(n=l.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([r])},l.updateQueue=n):(l=n.retryQueue,l===null?n.retryQueue=new Set([r]):l.add(r)),bc(e,r,m)),!1}throw Error(o(435,l.tag))}return bc(e,r,m),$o(),!1}if(Ye)return n=Wt.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=m,r!==mr&&(e=Error(o(422),{cause:r}),dl(rn(e,l)))):(r!==mr&&(n=Error(o(423),{cause:r}),dl(rn(n,l))),e=e.current.alternate,e.flags|=65536,m&=-m,e.lanes|=m,r=rn(r,l),m=Kr(e.stateNode,r,m),Cr(e,m),ht!==4&&(ht=2)),!1;var x=Error(o(520),{cause:r});if(x=rn(x,l),Il===null?Il=[x]:Il.push(x),ht!==4&&(ht=2),n===null)return!0;r=rn(r,l),l=n;do{switch(l.tag){case 3:return l.flags|=65536,e=m&-m,l.lanes|=e,e=Kr(l.stateNode,r,e),Cr(l,e),!1;case 1:if(n=l.type,x=l.stateNode,(l.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(gs===null||!gs.has(x))))return l.flags|=65536,m&=-m,l.lanes|=m,m=Af(m),_f(m,e,l,r),Cr(l,m),!1}l=l.return}while(l!==null);return!1}var Xr=Error(o(461)),St=!1;function It(e,n,l,r){n.child=e===null?Md(n,null,l,r):Js(n,e.child,l,r)}function Rf(e,n,l,r,m){l=l.render;var x=n.ref;if("ref"in r){var T={};for(var E in r)E!=="ref"&&(T[E]=r[E])}else T=r;return Hs(n),r=Mr(e,n,l,T,x,m),E=Dr(),e!==null&&!St?(kr(e,n,m),Pn(e,n,m)):(Ye&&E&&fr(n),n.flags|=1,It(e,n,r,m),n.child)}function If(e,n,l,r,m){if(e===null){var x=l.type;return typeof x=="function"&&!cr(x)&&x.defaultProps===void 0&&l.compare===null?(n.tag=15,n.type=x,Mf(e,n,x,r,m)):(e=xo(l.type,null,r,n,n.mode,m),e.ref=n.ref,e.return=n,n.child=e)}if(x=e.child,!ac(e,m)){var T=x.memoizedProps;if(l=l.compare,l=l!==null?l:rl,l(T,r)&&e.ref===n.ref)return Pn(e,n,m)}return n.flags|=1,e=kn(x,r),e.ref=n.ref,e.return=n,n.child=e}function Mf(e,n,l,r,m){if(e!==null){var x=e.memoizedProps;if(rl(x,r)&&e.ref===n.ref)if(St=!1,n.pendingProps=r=x,ac(e,m))(e.flags&131072)!==0&&(St=!0);else return n.lanes=e.lanes,Pn(e,n,m)}return Qr(e,n,l,r,m)}function Df(e,n,l,r){var m=r.children,x=e!==null?e.memoizedState:null;if(e===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.mode==="hidden"){if((n.flags&128)!==0){if(x=x!==null?x.baseLanes|l:l,e!==null){for(r=n.child=e.child,m=0;r!==null;)m=m|r.lanes|r.childLanes,r=r.sibling;r=m&~x}else r=0,n.child=null;return kf(e,n,x,l,r)}if((l&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},e!==null&&So(n,x!==null?x.cachePool:null),x!==null?jd(n,x):Ar(),Ud(n);else return r=n.lanes=536870912,kf(e,n,x!==null?x.baseLanes|l:l,l,r)}else x!==null?(So(n,x.cachePool),jd(n,x),fs(),n.memoizedState=null):(e!==null&&So(n,null),Ar(),fs());return It(e,n,m,l),n.child}function Nl(e,n){return e!==null&&e.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function kf(e,n,l,r,m){var x=Sr();return x=x===null?null:{parent:yt._currentValue,pool:x},n.memoizedState={baseLanes:l,cachePool:x},e!==null&&So(n,null),Ar(),Ud(n),e!==null&&ya(e,n,r,!0),n.childLanes=m,null}function Go(e,n){return n=Po({mode:n.mode,children:n.children},e.mode),n.ref=e.ref,e.child=n,n.return=e,n}function jf(e,n,l){return Js(n,e.child,null,l),e=Go(n,n.pendingProps),e.flags|=2,Zt(n),n.memoizedState=null,e}function fx(e,n,l){var r=n.pendingProps,m=(n.flags&128)!==0;if(n.flags&=-129,e===null){if(Ye){if(r.mode==="hidden")return e=Go(n,r),n.lanes=536870912,Nl(null,e);if(Rr(n),(e=it)?(e=Fp(e,dn),e=e!==null&&e.data==="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:as!==null?{id:Cn,overflow:wn}:null,retryLane:536870912,hydrationErrors:null},l=gd(e),l.return=n,n.child=l,_t=n,it=null)):e=null,e===null)throw os(n);return n.lanes=536870912,null}return Go(n,r)}var x=e.memoizedState;if(x!==null){var T=x.dehydrated;if(Rr(n),m)if(n.flags&256)n.flags&=-257,n=jf(e,n,l);else if(n.memoizedState!==null)n.child=e.child,n.flags|=128,n=null;else throw Error(o(558));else if(St||ya(e,n,l,!1),m=(l&e.childLanes)!==0,St||m){if(r=ot,r!==null&&(T=eo(r,l),T!==0&&T!==x.retryLane))throw x.retryLane=T,Ls(e,T),Yt(r,e,T),Xr;$o(),n=jf(e,n,l)}else e=x.treeContext,it=pn(T.nextSibling),_t=n,Ye=!0,ls=null,dn=!1,e!==null&&yd(n,e),n=Go(n,r),n.flags|=4096;return n}return e=kn(e.child,{mode:r.mode,children:r.children}),e.ref=n.ref,n.child=e,e.return=n,e}function Oo(e,n){var l=n.ref;if(l===null)e!==null&&e.ref!==null&&(n.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(o(284));(e===null||e.ref!==l)&&(n.flags|=4194816)}}function Qr(e,n,l,r,m){return Hs(n),l=Mr(e,n,l,r,void 0,m),r=Dr(),e!==null&&!St?(kr(e,n,m),Pn(e,n,m)):(Ye&&r&&fr(n),n.flags|=1,It(e,n,l,m),n.child)}function Uf(e,n,l,r,m,x){return Hs(n),n.updateQueue=null,l=Gd(n,r,l,m),Ld(e),r=Dr(),e!==null&&!St?(kr(e,n,x),Pn(e,n,x)):(Ye&&r&&fr(n),n.flags|=1,It(e,n,l,x),n.child)}function Lf(e,n,l,r,m){if(Hs(n),n.stateNode===null){var x=ha,T=l.contextType;typeof T=="object"&&T!==null&&(x=Rt(T)),x=new l(r,x),n.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=$r,n.stateNode=x,x._reactInternals=n,x=n.stateNode,x.props=r,x.state=n.memoizedState,x.refs={},Nr(n),T=l.contextType,x.context=typeof T=="object"&&T!==null?Rt(T):ha,x.state=n.memoizedState,T=l.getDerivedStateFromProps,typeof T=="function"&&(Yr(n,l,T,r),x.state=n.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(T=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),T!==x.state&&$r.enqueueReplaceState(x,x.state,null),vl(n,r,x,m),xl(),x.state=n.memoizedState),typeof x.componentDidMount=="function"&&(n.flags|=4194308),r=!0}else if(e===null){x=n.stateNode;var E=n.memoizedProps,R=Fs(l,E);x.props=R;var $=x.context,ie=l.contextType;T=ha,typeof ie=="object"&&ie!==null&&(T=Rt(ie));var pe=l.getDerivedStateFromProps;ie=typeof pe=="function"||typeof x.getSnapshotBeforeUpdate=="function",E=n.pendingProps!==E,ie||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(E||$!==T)&&Tf(n,x,r,T),rs=!1;var K=n.memoizedState;x.state=K,vl(n,r,x,m),xl(),$=n.memoizedState,E||K!==$||rs?(typeof pe=="function"&&(Yr(n,l,pe,r),$=n.memoizedState),(R=rs||Sf(n,l,R,r,K,$,T))?(ie||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(n.flags|=4194308)):(typeof x.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=r,n.memoizedState=$),x.props=r,x.state=$,x.context=T,r=R):(typeof x.componentDidMount=="function"&&(n.flags|=4194308),r=!1)}else{x=n.stateNode,Er(e,n),T=n.memoizedProps,ie=Fs(l,T),x.props=ie,pe=n.pendingProps,K=x.context,$=l.contextType,R=ha,typeof $=="object"&&$!==null&&(R=Rt($)),E=l.getDerivedStateFromProps,($=typeof E=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(T!==pe||K!==R)&&Tf(n,x,r,R),rs=!1,K=n.memoizedState,x.state=K,vl(n,r,x,m),xl();var te=n.memoizedState;T!==pe||K!==te||rs||e!==null&&e.dependencies!==null&&yo(e.dependencies)?(typeof E=="function"&&(Yr(n,l,E,r),te=n.memoizedState),(ie=rs||Sf(n,l,ie,r,K,te,R)||e!==null&&e.dependencies!==null&&yo(e.dependencies))?($||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(r,te,R),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(r,te,R)),typeof x.componentDidUpdate=="function"&&(n.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof x.componentDidUpdate!="function"||T===e.memoizedProps&&K===e.memoizedState||(n.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||T===e.memoizedProps&&K===e.memoizedState||(n.flags|=1024),n.memoizedProps=r,n.memoizedState=te),x.props=r,x.state=te,x.context=R,r=ie):(typeof x.componentDidUpdate!="function"||T===e.memoizedProps&&K===e.memoizedState||(n.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||T===e.memoizedProps&&K===e.memoizedState||(n.flags|=1024),r=!1)}return x=r,Oo(e,n),r=(n.flags&128)!==0,x||r?(x=n.stateNode,l=r&&typeof l.getDerivedStateFromError!="function"?null:x.render(),n.flags|=1,e!==null&&r?(n.child=Js(n,e.child,null,m),n.child=Js(n,null,l,m)):It(e,n,l,m),n.memoizedState=x.state,e=n.child):e=Pn(e,n,m),e}function Gf(e,n,l,r){return Os(),n.flags|=256,It(e,n,l,r),n.child}var Wr={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Zr(e){return{baseLanes:e,cachePool:Cd()}}function ec(e,n,l){return e=e!==null?e.childLanes&~l:0,n&&(e|=tn),e}function Of(e,n,l){var r=n.pendingProps,m=!1,x=(n.flags&128)!==0,T;if((T=x)||(T=e!==null&&e.memoizedState===null?!1:(xt.current&2)!==0),T&&(m=!0,n.flags&=-129),T=(n.flags&32)!==0,n.flags&=-33,e===null){if(Ye){if(m?ds(n):fs(),(e=it)?(e=Fp(e,dn),e=e!==null&&e.data!=="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:as!==null?{id:Cn,overflow:wn}:null,retryLane:536870912,hydrationErrors:null},l=gd(e),l.return=n,n.child=l,_t=n,it=null)):e=null,e===null)throw os(n);return Lc(e)?n.lanes=32:n.lanes=536870912,null}var E=r.children;return r=r.fallback,m?(fs(),m=n.mode,E=Po({mode:"hidden",children:E},m),r=Gs(r,m,l,null),E.return=n,r.return=n,E.sibling=r,n.child=E,r=n.child,r.memoizedState=Zr(l),r.childLanes=ec(e,T,l),n.memoizedState=Wr,Nl(null,r)):(ds(n),tc(n,E))}var R=e.memoizedState;if(R!==null&&(E=R.dehydrated,E!==null)){if(x)n.flags&256?(ds(n),n.flags&=-257,n=nc(e,n,l)):n.memoizedState!==null?(fs(),n.child=e.child,n.flags|=128,n=null):(fs(),E=r.fallback,m=n.mode,r=Po({mode:"visible",children:r.children},m),E=Gs(E,m,l,null),E.flags|=2,r.return=n,E.return=n,r.sibling=E,n.child=r,Js(n,e.child,null,l),r=n.child,r.memoizedState=Zr(l),r.childLanes=ec(e,T,l),n.memoizedState=Wr,n=Nl(null,r));else if(ds(n),Lc(E)){if(T=E.nextSibling&&E.nextSibling.dataset,T)var $=T.dgst;T=$,r=Error(o(419)),r.stack="",r.digest=T,dl({value:r,source:null,stack:null}),n=nc(e,n,l)}else if(St||ya(e,n,l,!1),T=(l&e.childLanes)!==0,St||T){if(T=ot,T!==null&&(r=eo(T,l),r!==0&&r!==R.retryLane))throw R.retryLane=r,Ls(e,r),Yt(T,e,r),Xr;Uc(E)||$o(),n=nc(e,n,l)}else Uc(E)?(n.flags|=192,n.child=e.child,n=null):(e=R.treeContext,it=pn(E.nextSibling),_t=n,Ye=!0,ls=null,dn=!1,e!==null&&yd(n,e),n=tc(n,r.children),n.flags|=4096);return n}return m?(fs(),E=r.fallback,m=n.mode,R=e.child,$=R.sibling,r=kn(R,{mode:"hidden",children:r.children}),r.subtreeFlags=R.subtreeFlags&65011712,$!==null?E=kn($,E):(E=Gs(E,m,l,null),E.flags|=2),E.return=n,r.return=n,r.sibling=E,n.child=r,Nl(null,r),r=n.child,E=e.child.memoizedState,E===null?E=Zr(l):(m=E.cachePool,m!==null?(R=yt._currentValue,m=m.parent!==R?{parent:R,pool:R}:m):m=Cd(),E={baseLanes:E.baseLanes|l,cachePool:m}),r.memoizedState=E,r.childLanes=ec(e,T,l),n.memoizedState=Wr,Nl(e.child,r)):(ds(n),l=e.child,e=l.sibling,l=kn(l,{mode:"visible",children:r.children}),l.return=n,l.sibling=null,e!==null&&(T=n.deletions,T===null?(n.deletions=[e],n.flags|=16):T.push(e)),n.child=l,n.memoizedState=null,l)}function tc(e,n){return n=Po({mode:"visible",children:n},e.mode),n.return=e,e.child=n}function Po(e,n){return e=Qt(22,e,null,n),e.lanes=0,e}function nc(e,n,l){return Js(n,e.child,null,l),e=tc(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function Pf(e,n,l){e.lanes|=n;var r=e.alternate;r!==null&&(r.lanes|=n),xr(e.return,n,l)}function sc(e,n,l,r,m,x){var T=e.memoizedState;T===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:r,tail:l,tailMode:m,treeForkCount:x}:(T.isBackwards=n,T.rendering=null,T.renderingStartTime=0,T.last=r,T.tail=l,T.tailMode=m,T.treeForkCount=x)}function Hf(e,n,l){var r=n.pendingProps,m=r.revealOrder,x=r.tail;r=r.children;var T=xt.current,E=(T&2)!==0;if(E?(T=T&1|2,n.flags|=128):T&=1,O(xt,T),It(e,n,r,l),r=Ye?ul:0,!E&&e!==null&&(e.flags&128)!==0)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Pf(e,l,n);else if(e.tag===19)Pf(e,l,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(m){case"forwards":for(l=n.child,m=null;l!==null;)e=l.alternate,e!==null&&Ao(e)===null&&(m=l),l=l.sibling;l=m,l===null?(m=n.child,n.child=null):(m=l.sibling,l.sibling=null),sc(n,!1,m,l,x,r);break;case"backwards":case"unstable_legacy-backwards":for(l=null,m=n.child,n.child=null;m!==null;){if(e=m.alternate,e!==null&&Ao(e)===null){n.child=m;break}e=m.sibling,m.sibling=l,l=m,m=e}sc(n,!0,l,null,x,r);break;case"together":sc(n,!1,null,null,void 0,r);break;default:n.memoizedState=null}return n.child}function Pn(e,n,l){if(e!==null&&(n.dependencies=e.dependencies),hs|=n.lanes,(l&n.childLanes)===0)if(e!==null){if(ya(e,n,l,!1),(l&n.childLanes)===0)return null}else return null;if(e!==null&&n.child!==e.child)throw Error(o(153));if(n.child!==null){for(e=n.child,l=kn(e,e.pendingProps),n.child=l,l.return=n;e.sibling!==null;)e=e.sibling,l=l.sibling=kn(e,e.pendingProps),l.return=n;l.sibling=null}return n.child}function ac(e,n){return(e.lanes&n)!==0?!0:(e=e.dependencies,!!(e!==null&&yo(e)))}function px(e,n,l){switch(n.tag){case 3:Se(n,n.stateNode.containerInfo),is(n,yt,e.memoizedState.cache),Os();break;case 27:case 5:nt(n);break;case 4:Se(n,n.stateNode.containerInfo);break;case 10:is(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,Rr(n),null;break;case 13:var r=n.memoizedState;if(r!==null)return r.dehydrated!==null?(ds(n),n.flags|=128,null):(l&n.child.childLanes)!==0?Of(e,n,l):(ds(n),e=Pn(e,n,l),e!==null?e.sibling:null);ds(n);break;case 19:var m=(e.flags&128)!==0;if(r=(l&n.childLanes)!==0,r||(ya(e,n,l,!1),r=(l&n.childLanes)!==0),m){if(r)return Hf(e,n,l);n.flags|=128}if(m=n.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),O(xt,xt.current),r)break;return null;case 22:return n.lanes=0,Df(e,n,l,n.pendingProps);case 24:is(n,yt,e.memoizedState.cache)}return Pn(e,n,l)}function Bf(e,n,l){if(e!==null)if(e.memoizedProps!==n.pendingProps)St=!0;else{if(!ac(e,l)&&(n.flags&128)===0)return St=!1,px(e,n,l);St=(e.flags&131072)!==0}else St=!1,Ye&&(n.flags&1048576)!==0&&vd(n,ul,n.index);switch(n.lanes=0,n.tag){case 16:e:{var r=n.pendingProps;if(e=Vs(n.elementType),n.type=e,typeof e=="function")cr(e)?(r=Fs(e,r),n.tag=1,n=Lf(null,n,e,r,l)):(n.tag=0,n=Qr(null,n,e,r,l));else{if(e!=null){var m=e.$$typeof;if(m===P){n.tag=11,n=Rf(null,n,e,r,l);break e}else if(m===V){n.tag=14,n=If(null,n,e,r,l);break e}}throw n=se(e)||e,Error(o(306,n,""))}}return n;case 0:return Qr(e,n,n.type,n.pendingProps,l);case 1:return r=n.type,m=Fs(r,n.pendingProps),Lf(e,n,r,m,l);case 3:e:{if(Se(n,n.stateNode.containerInfo),e===null)throw Error(o(387));r=n.pendingProps;var x=n.memoizedState;m=x.element,Er(e,n),vl(n,r,null,l);var T=n.memoizedState;if(r=T.cache,is(n,yt,r),r!==x.cache&&vr(n,[yt],l,!0),xl(),r=T.element,x.isDehydrated)if(x={element:r,isDehydrated:!1,cache:T.cache},n.updateQueue.baseState=x,n.memoizedState=x,n.flags&256){n=Gf(e,n,r,l);break e}else if(r!==m){m=rn(Error(o(424)),n),dl(m),n=Gf(e,n,r,l);break e}else{switch(e=n.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(it=pn(e.firstChild),_t=n,Ye=!0,ls=null,dn=!0,l=Md(n,null,r,l),n.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Os(),r===m){n=Pn(e,n,l);break e}It(e,n,r,l)}n=n.child}return n;case 26:return Oo(e,n),e===null?(l=Wp(n.type,null,n.pendingProps,null))?n.memoizedState=l:Ye||(l=n.type,e=n.pendingProps,r=ti(xe.current).createElement(l),r[ft]=n,r[At]=e,Mt(r,l,e),Oe(r),n.stateNode=r):n.memoizedState=Wp(n.type,e.memoizedProps,n.pendingProps,e.memoizedState),null;case 27:return nt(n),e===null&&Ye&&(r=n.stateNode=Kp(n.type,n.pendingProps,xe.current),_t=n,dn=!0,m=it,bs(n.type)?(Gc=m,it=pn(r.firstChild)):it=m),It(e,n,n.pendingProps.children,l),Oo(e,n),e===null&&(n.flags|=4194304),n.child;case 5:return e===null&&Ye&&((m=r=it)&&(r=qx(r,n.type,n.pendingProps,dn),r!==null?(n.stateNode=r,_t=n,it=pn(r.firstChild),dn=!1,m=!0):m=!1),m||os(n)),nt(n),m=n.type,x=n.pendingProps,T=e!==null?e.memoizedProps:null,r=x.children,Dc(m,x)?r=null:T!==null&&Dc(m,T)&&(n.flags|=32),n.memoizedState!==null&&(m=Mr(e,n,ax,null,null,l),Ol._currentValue=m),Oo(e,n),It(e,n,r,l),n.child;case 6:return e===null&&Ye&&((e=l=it)&&(l=Jx(l,n.pendingProps,dn),l!==null?(n.stateNode=l,_t=n,it=null,e=!0):e=!1),e||os(n)),null;case 13:return Of(e,n,l);case 4:return Se(n,n.stateNode.containerInfo),r=n.pendingProps,e===null?n.child=Js(n,null,r,l):It(e,n,r,l),n.child;case 11:return Rf(e,n,n.type,n.pendingProps,l);case 7:return It(e,n,n.pendingProps,l),n.child;case 8:return It(e,n,n.pendingProps.children,l),n.child;case 12:return It(e,n,n.pendingProps.children,l),n.child;case 10:return r=n.pendingProps,is(n,n.type,r.value),It(e,n,r.children,l),n.child;case 9:return m=n.type._context,r=n.pendingProps.children,Hs(n),m=Rt(m),r=r(m),n.flags|=1,It(e,n,r,l),n.child;case 14:return If(e,n,n.type,n.pendingProps,l);case 15:return Mf(e,n,n.type,n.pendingProps,l);case 19:return Hf(e,n,l);case 31:return fx(e,n,l);case 22:return Df(e,n,l,n.pendingProps);case 24:return Hs(n),r=Rt(yt),e===null?(m=Sr(),m===null&&(m=ot,x=yr(),m.pooledCache=x,x.refCount++,x!==null&&(m.pooledCacheLanes|=l),m=x),n.memoizedState={parent:r,cache:m},Nr(n),is(n,yt,m)):((e.lanes&l)!==0&&(Er(e,n),vl(n,null,null,l),xl()),m=e.memoizedState,x=n.memoizedState,m.parent!==r?(m={parent:r,cache:r},n.memoizedState=m,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=m),is(n,yt,r)):(r=x.cache,is(n,yt,r),r!==m.cache&&vr(n,[yt],l,!0))),It(e,n,n.pendingProps.children,l),n.child;case 29:throw n.pendingProps}throw Error(o(156,n.tag))}function Hn(e){e.flags|=4}function lc(e,n,l,r,m){if((n=(e.mode&32)!==0)&&(n=!1),n){if(e.flags|=16777216,(m&335544128)===m)if(e.stateNode.complete)e.flags|=8192;else if(mp())e.flags|=8192;else throw qs=No,Tr}else e.flags&=-16777217}function Vf(e,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!sm(n))if(mp())e.flags|=8192;else throw qs=No,Tr}function Ho(e,n){n!==null&&(e.flags|=4),e.flags&16384&&(n=e.tag!==22?Ql():536870912,e.lanes|=n,Ma|=n)}function El(e,n){if(!Ye)switch(e.tailMode){case"hidden":n=e.tail;for(var l=null;n!==null;)n.alternate!==null&&(l=n),n=n.sibling;l===null?e.tail=null:l.sibling=null;break;case"collapsed":l=e.tail;for(var r=null;l!==null;)l.alternate!==null&&(r=l),l=l.sibling;r===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function rt(e){var n=e.alternate!==null&&e.alternate.child===e.child,l=0,r=0;if(n)for(var m=e.child;m!==null;)l|=m.lanes|m.childLanes,r|=m.subtreeFlags&65011712,r|=m.flags&65011712,m.return=e,m=m.sibling;else for(m=e.child;m!==null;)l|=m.lanes|m.childLanes,r|=m.subtreeFlags,r|=m.flags,m.return=e,m=m.sibling;return e.subtreeFlags|=r,e.childLanes=l,n}function mx(e,n,l){var r=n.pendingProps;switch(pr(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rt(n),null;case 1:return rt(n),null;case 3:return l=n.stateNode,r=null,e!==null&&(r=e.memoizedState.cache),n.memoizedState.cache!==r&&(n.flags|=2048),Ln(yt),_e(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(va(n)?Hn(n):e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,hr())),rt(n),null;case 26:var m=n.type,x=n.memoizedState;return e===null?(Hn(n),x!==null?(rt(n),Vf(n,x)):(rt(n),lc(n,m,null,r,l))):x?x!==e.memoizedState?(Hn(n),rt(n),Vf(n,x)):(rt(n),n.flags&=-16777217):(e=e.memoizedProps,e!==r&&Hn(n),rt(n),lc(n,m,e,r,l)),null;case 27:if(G(n),l=xe.current,m=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==r&&Hn(n);else{if(!r){if(n.stateNode===null)throw Error(o(166));return rt(n),null}e=z.current,va(n)?bd(n):(e=Kp(m,r,l),n.stateNode=e,Hn(n))}return rt(n),null;case 5:if(G(n),m=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==r&&Hn(n);else{if(!r){if(n.stateNode===null)throw Error(o(166));return rt(n),null}if(x=z.current,va(n))bd(n);else{var T=ti(xe.current);switch(x){case 1:x=T.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:x=T.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":x=T.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":x=T.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":x=T.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof r.is=="string"?T.createElement("select",{is:r.is}):T.createElement("select"),r.multiple?x.multiple=!0:r.size&&(x.size=r.size);break;default:x=typeof r.is=="string"?T.createElement(m,{is:r.is}):T.createElement(m)}}x[ft]=n,x[At]=r;e:for(T=n.child;T!==null;){if(T.tag===5||T.tag===6)x.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===n)break e;for(;T.sibling===null;){if(T.return===null||T.return===n)break e;T=T.return}T.sibling.return=T.return,T=T.sibling}n.stateNode=x;e:switch(Mt(x,m,r),m){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&Hn(n)}}return rt(n),lc(n,n.type,e===null?null:e.memoizedProps,n.pendingProps,l),null;case 6:if(e&&n.stateNode!=null)e.memoizedProps!==r&&Hn(n);else{if(typeof r!="string"&&n.stateNode===null)throw Error(o(166));if(e=xe.current,va(n)){if(e=n.stateNode,l=n.memoizedProps,r=null,m=_t,m!==null)switch(m.tag){case 27:case 5:r=m.memoizedProps}e[ft]=n,e=!!(e.nodeValue===l||r!==null&&r.suppressHydrationWarning===!0||Op(e.nodeValue,l)),e||os(n,!0)}else e=ti(e).createTextNode(r),e[ft]=n,n.stateNode=e}return rt(n),null;case 31:if(l=n.memoizedState,e===null||e.memoizedState!==null){if(r=va(n),l!==null){if(e===null){if(!r)throw Error(o(318));if(e=n.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(o(557));e[ft]=n}else Os(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;rt(n),e=!1}else l=hr(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=l),e=!0;if(!e)return n.flags&256?(Zt(n),n):(Zt(n),null);if((n.flags&128)!==0)throw Error(o(558))}return rt(n),null;case 13:if(r=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(m=va(n),r!==null&&r.dehydrated!==null){if(e===null){if(!m)throw Error(o(318));if(m=n.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(o(317));m[ft]=n}else Os(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;rt(n),m=!1}else m=hr(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=m),m=!0;if(!m)return n.flags&256?(Zt(n),n):(Zt(n),null)}return Zt(n),(n.flags&128)!==0?(n.lanes=l,n):(l=r!==null,e=e!==null&&e.memoizedState!==null,l&&(r=n.child,m=null,r.alternate!==null&&r.alternate.memoizedState!==null&&r.alternate.memoizedState.cachePool!==null&&(m=r.alternate.memoizedState.cachePool.pool),x=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(x=r.memoizedState.cachePool.pool),x!==m&&(r.flags|=2048)),l!==e&&l&&(n.child.flags|=8192),Ho(n,n.updateQueue),rt(n),null);case 4:return _e(),e===null&&Ac(n.stateNode.containerInfo),rt(n),null;case 10:return Ln(n.type),rt(n),null;case 19:if(_(xt),r=n.memoizedState,r===null)return rt(n),null;if(m=(n.flags&128)!==0,x=r.rendering,x===null)if(m)El(r,!1);else{if(ht!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(x=Ao(e),x!==null){for(n.flags|=128,El(r,!1),e=x.updateQueue,n.updateQueue=e,Ho(n,e),n.subtreeFlags=0,e=l,l=n.child;l!==null;)hd(l,e),l=l.sibling;return O(xt,xt.current&1|2),Ye&&jn(n,r.treeForkCount),n.child}e=e.sibling}r.tail!==null&&Gt()>zo&&(n.flags|=128,m=!0,El(r,!1),n.lanes=4194304)}else{if(!m)if(e=Ao(x),e!==null){if(n.flags|=128,m=!0,e=e.updateQueue,n.updateQueue=e,Ho(n,e),El(r,!0),r.tail===null&&r.tailMode==="hidden"&&!x.alternate&&!Ye)return rt(n),null}else 2*Gt()-r.renderingStartTime>zo&&l!==536870912&&(n.flags|=128,m=!0,El(r,!1),n.lanes=4194304);r.isBackwards?(x.sibling=n.child,n.child=x):(e=r.last,e!==null?e.sibling=x:n.child=x,r.last=x)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=Gt(),e.sibling=null,l=xt.current,O(xt,m?l&1|2:l&1),Ye&&jn(n,r.treeForkCount),e):(rt(n),null);case 22:case 23:return Zt(n),_r(),r=n.memoizedState!==null,e!==null?e.memoizedState!==null!==r&&(n.flags|=8192):r&&(n.flags|=8192),r?(l&536870912)!==0&&(n.flags&128)===0&&(rt(n),n.subtreeFlags&6&&(n.flags|=8192)):rt(n),l=n.updateQueue,l!==null&&Ho(n,l.retryQueue),l=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(l=e.memoizedState.cachePool.pool),r=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(r=n.memoizedState.cachePool.pool),r!==l&&(n.flags|=2048),e!==null&&_(Bs),null;case 24:return l=null,e!==null&&(l=e.memoizedState.cache),n.memoizedState.cache!==l&&(n.flags|=2048),Ln(yt),rt(n),null;case 25:return null;case 30:return null}throw Error(o(156,n.tag))}function hx(e,n){switch(pr(n),n.tag){case 1:return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Ln(yt),_e(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 26:case 27:case 5:return G(n),null;case 31:if(n.memoizedState!==null){if(Zt(n),n.alternate===null)throw Error(o(340));Os()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 13:if(Zt(n),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(o(340));Os()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return _(xt),null;case 4:return _e(),null;case 10:return Ln(n.type),null;case 22:case 23:return Zt(n),_r(),e!==null&&_(Bs),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 24:return Ln(yt),null;case 25:return null;default:return null}}function qf(e,n){switch(pr(n),n.tag){case 3:Ln(yt),_e();break;case 26:case 27:case 5:G(n);break;case 4:_e();break;case 31:n.memoizedState!==null&&Zt(n);break;case 13:Zt(n);break;case 19:_(xt);break;case 10:Ln(n.type);break;case 22:case 23:Zt(n),_r(),e!==null&&_(Bs);break;case 24:Ln(yt)}}function Cl(e,n){try{var l=n.updateQueue,r=l!==null?l.lastEffect:null;if(r!==null){var m=r.next;l=m;do{if((l.tag&e)===e){r=void 0;var x=l.create,T=l.inst;r=x(),T.destroy=r}l=l.next}while(l!==m)}}catch(E){tt(n,n.return,E)}}function ps(e,n,l){try{var r=n.updateQueue,m=r!==null?r.lastEffect:null;if(m!==null){var x=m.next;r=x;do{if((r.tag&e)===e){var T=r.inst,E=T.destroy;if(E!==void 0){T.destroy=void 0,m=n;var R=l,$=E;try{$()}catch(ie){tt(m,R,ie)}}}r=r.next}while(r!==x)}}catch(ie){tt(n,n.return,ie)}}function Jf(e){var n=e.updateQueue;if(n!==null){var l=e.stateNode;try{kd(n,l)}catch(r){tt(e,e.return,r)}}}function zf(e,n,l){l.props=Fs(e.type,e.memoizedProps),l.state=e.memoizedState;try{l.componentWillUnmount()}catch(r){tt(e,n,r)}}function wl(e,n){try{var l=e.ref;if(l!==null){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;case 30:r=e.stateNode;break;default:r=e.stateNode}typeof l=="function"?e.refCleanup=l(r):l.current=r}}catch(m){tt(e,n,m)}}function An(e,n){var l=e.ref,r=e.refCleanup;if(l!==null)if(typeof r=="function")try{r()}catch(m){tt(e,n,m)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(m){tt(e,n,m)}else l.current=null}function Ff(e){var n=e.type,l=e.memoizedProps,r=e.stateNode;try{e:switch(n){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break e;case"img":l.src?r.src=l.src:l.srcSet&&(r.srcset=l.srcSet)}}catch(m){tt(e,e.return,m)}}function oc(e,n,l){try{var r=e.stateNode;Gx(r,e.type,l,n),r[At]=n}catch(m){tt(e,e.return,m)}}function Yf(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&bs(e.type)||e.tag===4}function ic(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Yf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&bs(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function rc(e,n,l){var r=e.tag;if(r===5||r===6)e=e.stateNode,n?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(e,n):(n=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,n.appendChild(e),l=l._reactRootContainer,l!=null||n.onclick!==null||(n.onclick=Mn));else if(r!==4&&(r===27&&bs(e.type)&&(l=e.stateNode,n=null),e=e.child,e!==null))for(rc(e,n,l),e=e.sibling;e!==null;)rc(e,n,l),e=e.sibling}function Bo(e,n,l){var r=e.tag;if(r===5||r===6)e=e.stateNode,n?l.insertBefore(e,n):l.appendChild(e);else if(r!==4&&(r===27&&bs(e.type)&&(l=e.stateNode),e=e.child,e!==null))for(Bo(e,n,l),e=e.sibling;e!==null;)Bo(e,n,l),e=e.sibling}function $f(e){var n=e.stateNode,l=e.memoizedProps;try{for(var r=e.type,m=n.attributes;m.length;)n.removeAttributeNode(m[0]);Mt(n,r,l),n[ft]=e,n[At]=l}catch(x){tt(e,e.return,x)}}var Bn=!1,Tt=!1,cc=!1,Kf=typeof WeakSet=="function"?WeakSet:Set,Et=null;function gx(e,n){if(e=e.containerInfo,Ic=ri,e=od(e),nr(e)){if("selectionStart"in e)var l={start:e.selectionStart,end:e.selectionEnd};else e:{l=(l=e.ownerDocument)&&l.defaultView||window;var r=l.getSelection&&l.getSelection();if(r&&r.rangeCount!==0){l=r.anchorNode;var m=r.anchorOffset,x=r.focusNode;r=r.focusOffset;try{l.nodeType,x.nodeType}catch{l=null;break e}var T=0,E=-1,R=-1,$=0,ie=0,pe=e,K=null;t:for(;;){for(var te;pe!==l||m!==0&&pe.nodeType!==3||(E=T+m),pe!==x||r!==0&&pe.nodeType!==3||(R=T+r),pe.nodeType===3&&(T+=pe.nodeValue.length),(te=pe.firstChild)!==null;)K=pe,pe=te;for(;;){if(pe===e)break t;if(K===l&&++$===m&&(E=T),K===x&&++ie===r&&(R=T),(te=pe.nextSibling)!==null)break;pe=K,K=pe.parentNode}pe=te}l=E===-1||R===-1?null:{start:E,end:R}}else l=null}l=l||{start:0,end:0}}else l=null;for(Mc={focusedElem:e,selectionRange:l},ri=!1,Et=n;Et!==null;)if(n=Et,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,Et=e;else for(;Et!==null;){switch(n=Et,x=n.alternate,e=n.flags,n.tag){case 0:if((e&4)!==0&&(e=n.updateQueue,e=e!==null?e.events:null,e!==null))for(l=0;l<e.length;l++)m=e[l],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&x!==null){e=void 0,l=n,m=x.memoizedProps,x=x.memoizedState,r=l.stateNode;try{var Ne=Fs(l.type,m);e=r.getSnapshotBeforeUpdate(Ne,x),r.__reactInternalSnapshotBeforeUpdate=e}catch(Me){tt(l,l.return,Me)}}break;case 3:if((e&1024)!==0){if(e=n.stateNode.containerInfo,l=e.nodeType,l===9)jc(e);else if(l===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":jc(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(o(163))}if(e=n.sibling,e!==null){e.return=n.return,Et=e;break}Et=n.return}}function Xf(e,n,l){var r=l.flags;switch(l.tag){case 0:case 11:case 15:qn(e,l),r&4&&Cl(5,l);break;case 1:if(qn(e,l),r&4)if(e=l.stateNode,n===null)try{e.componentDidMount()}catch(T){tt(l,l.return,T)}else{var m=Fs(l.type,n.memoizedProps);n=n.memoizedState;try{e.componentDidUpdate(m,n,e.__reactInternalSnapshotBeforeUpdate)}catch(T){tt(l,l.return,T)}}r&64&&Jf(l),r&512&&wl(l,l.return);break;case 3:if(qn(e,l),r&64&&(e=l.updateQueue,e!==null)){if(n=null,l.child!==null)switch(l.child.tag){case 27:case 5:n=l.child.stateNode;break;case 1:n=l.child.stateNode}try{kd(e,n)}catch(T){tt(l,l.return,T)}}break;case 27:n===null&&r&4&&$f(l);case 26:case 5:qn(e,l),n===null&&r&4&&Ff(l),r&512&&wl(l,l.return);break;case 12:qn(e,l);break;case 31:qn(e,l),r&4&&Zf(e,l);break;case 13:qn(e,l),r&4&&ep(e,l),r&64&&(e=l.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(l=Cx.bind(null,l),zx(e,l))));break;case 22:if(r=l.memoizedState!==null||Bn,!r){n=n!==null&&n.memoizedState!==null||Tt,m=Bn;var x=Tt;Bn=r,(Tt=n)&&!x?Jn(e,l,(l.subtreeFlags&8772)!==0):qn(e,l),Bn=m,Tt=x}break;case 30:break;default:qn(e,l)}}function Qf(e){var n=e.alternate;n!==null&&(e.alternate=null,Qf(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&ve(n)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var ct=null,qt=!1;function Vn(e,n,l){for(l=l.child;l!==null;)Wf(e,n,l),l=l.sibling}function Wf(e,n,l){if(wt&&typeof wt.onCommitFiberUnmount=="function")try{wt.onCommitFiberUnmount(Zn,l)}catch{}switch(l.tag){case 26:Tt||An(l,n),Vn(e,n,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Tt||An(l,n);var r=ct,m=qt;bs(l.type)&&(ct=l.stateNode,qt=!1),Vn(e,n,l),Ul(l.stateNode),ct=r,qt=m;break;case 5:Tt||An(l,n);case 6:if(r=ct,m=qt,ct=null,Vn(e,n,l),ct=r,qt=m,ct!==null)if(qt)try{(ct.nodeType===9?ct.body:ct.nodeName==="HTML"?ct.ownerDocument.body:ct).removeChild(l.stateNode)}catch(x){tt(l,n,x)}else try{ct.removeChild(l.stateNode)}catch(x){tt(l,n,x)}break;case 18:ct!==null&&(qt?(e=ct,Jp(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,l.stateNode),Pa(e)):Jp(ct,l.stateNode));break;case 4:r=ct,m=qt,ct=l.stateNode.containerInfo,qt=!0,Vn(e,n,l),ct=r,qt=m;break;case 0:case 11:case 14:case 15:ps(2,l,n),Tt||ps(4,l,n),Vn(e,n,l);break;case 1:Tt||(An(l,n),r=l.stateNode,typeof r.componentWillUnmount=="function"&&zf(l,n,r)),Vn(e,n,l);break;case 21:Vn(e,n,l);break;case 22:Tt=(r=Tt)||l.memoizedState!==null,Vn(e,n,l),Tt=r;break;default:Vn(e,n,l)}}function Zf(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Pa(e)}catch(l){tt(n,n.return,l)}}}function ep(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Pa(e)}catch(l){tt(n,n.return,l)}}function xx(e){switch(e.tag){case 31:case 13:case 19:var n=e.stateNode;return n===null&&(n=e.stateNode=new Kf),n;case 22:return e=e.stateNode,n=e._retryCache,n===null&&(n=e._retryCache=new Kf),n;default:throw Error(o(435,e.tag))}}function Vo(e,n){var l=xx(e);n.forEach(function(r){if(!l.has(r)){l.add(r);var m=wx.bind(null,e,r);r.then(m,m)}})}function Jt(e,n){var l=n.deletions;if(l!==null)for(var r=0;r<l.length;r++){var m=l[r],x=e,T=n,E=T;e:for(;E!==null;){switch(E.tag){case 27:if(bs(E.type)){ct=E.stateNode,qt=!1;break e}break;case 5:ct=E.stateNode,qt=!1;break e;case 3:case 4:ct=E.stateNode.containerInfo,qt=!0;break e}E=E.return}if(ct===null)throw Error(o(160));Wf(x,T,m),ct=null,qt=!1,x=m.alternate,x!==null&&(x.return=null),m.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)tp(n,e),n=n.sibling}var vn=null;function tp(e,n){var l=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Jt(n,e),zt(e),r&4&&(ps(3,e,e.return),Cl(3,e),ps(5,e,e.return));break;case 1:Jt(n,e),zt(e),r&512&&(Tt||l===null||An(l,l.return)),r&64&&Bn&&(e=e.updateQueue,e!==null&&(r=e.callbacks,r!==null&&(l=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=l===null?r:l.concat(r))));break;case 26:var m=vn;if(Jt(n,e),zt(e),r&512&&(Tt||l===null||An(l,l.return)),r&4){var x=l!==null?l.memoizedState:null;if(r=e.memoizedState,l===null)if(r===null)if(e.stateNode===null){e:{r=e.type,l=e.memoizedProps,m=m.ownerDocument||m;t:switch(r){case"title":x=m.getElementsByTagName("title")[0],(!x||x[Z]||x[ft]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=m.createElement(r),m.head.insertBefore(x,m.querySelector("head > title"))),Mt(x,r,l),x[ft]=e,Oe(x),r=x;break e;case"link":var T=tm("link","href",m).get(r+(l.href||""));if(T){for(var E=0;E<T.length;E++)if(x=T[E],x.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&x.getAttribute("rel")===(l.rel==null?null:l.rel)&&x.getAttribute("title")===(l.title==null?null:l.title)&&x.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){T.splice(E,1);break t}}x=m.createElement(r),Mt(x,r,l),m.head.appendChild(x);break;case"meta":if(T=tm("meta","content",m).get(r+(l.content||""))){for(E=0;E<T.length;E++)if(x=T[E],x.getAttribute("content")===(l.content==null?null:""+l.content)&&x.getAttribute("name")===(l.name==null?null:l.name)&&x.getAttribute("property")===(l.property==null?null:l.property)&&x.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&x.getAttribute("charset")===(l.charSet==null?null:l.charSet)){T.splice(E,1);break t}}x=m.createElement(r),Mt(x,r,l),m.head.appendChild(x);break;default:throw Error(o(468,r))}x[ft]=e,Oe(x),r=x}e.stateNode=r}else nm(m,e.type,e.stateNode);else e.stateNode=em(m,r,e.memoizedProps);else x!==r?(x===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):x.count--,r===null?nm(m,e.type,e.stateNode):em(m,r,e.memoizedProps)):r===null&&e.stateNode!==null&&oc(e,e.memoizedProps,l.memoizedProps)}break;case 27:Jt(n,e),zt(e),r&512&&(Tt||l===null||An(l,l.return)),l!==null&&r&4&&oc(e,e.memoizedProps,l.memoizedProps);break;case 5:if(Jt(n,e),zt(e),r&512&&(Tt||l===null||An(l,l.return)),e.flags&32){m=e.stateNode;try{ra(m,"")}catch(Ne){tt(e,e.return,Ne)}}r&4&&e.stateNode!=null&&(m=e.memoizedProps,oc(e,m,l!==null?l.memoizedProps:m)),r&1024&&(cc=!0);break;case 6:if(Jt(n,e),zt(e),r&4){if(e.stateNode===null)throw Error(o(162));r=e.memoizedProps,l=e.stateNode;try{l.nodeValue=r}catch(Ne){tt(e,e.return,Ne)}}break;case 3:if(ai=null,m=vn,vn=ni(n.containerInfo),Jt(n,e),vn=m,zt(e),r&4&&l!==null&&l.memoizedState.isDehydrated)try{Pa(n.containerInfo)}catch(Ne){tt(e,e.return,Ne)}cc&&(cc=!1,np(e));break;case 4:r=vn,vn=ni(e.stateNode.containerInfo),Jt(n,e),zt(e),vn=r;break;case 12:Jt(n,e),zt(e);break;case 31:Jt(n,e),zt(e),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,Vo(e,r)));break;case 13:Jt(n,e),zt(e),e.child.flags&8192&&e.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Jo=Gt()),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,Vo(e,r)));break;case 22:m=e.memoizedState!==null;var R=l!==null&&l.memoizedState!==null,$=Bn,ie=Tt;if(Bn=$||m,Tt=ie||R,Jt(n,e),Tt=ie,Bn=$,zt(e),r&8192)e:for(n=e.stateNode,n._visibility=m?n._visibility&-2:n._visibility|1,m&&(l===null||R||Bn||Tt||Ys(e)),l=null,n=e;;){if(n.tag===5||n.tag===26){if(l===null){R=l=n;try{if(x=R.stateNode,m)T=x.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{E=R.stateNode;var pe=R.memoizedProps.style,K=pe!=null&&pe.hasOwnProperty("display")?pe.display:null;E.style.display=K==null||typeof K=="boolean"?"":(""+K).trim()}}catch(Ne){tt(R,R.return,Ne)}}}else if(n.tag===6){if(l===null){R=n;try{R.stateNode.nodeValue=m?"":R.memoizedProps}catch(Ne){tt(R,R.return,Ne)}}}else if(n.tag===18){if(l===null){R=n;try{var te=R.stateNode;m?zp(te,!0):zp(R.stateNode,!1)}catch(Ne){tt(R,R.return,Ne)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===e)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;l===n&&(l=null),n=n.return}l===n&&(l=null),n.sibling.return=n.return,n=n.sibling}r&4&&(r=e.updateQueue,r!==null&&(l=r.retryQueue,l!==null&&(r.retryQueue=null,Vo(e,l))));break;case 19:Jt(n,e),zt(e),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,Vo(e,r)));break;case 30:break;case 21:break;default:Jt(n,e),zt(e)}}function zt(e){var n=e.flags;if(n&2){try{for(var l,r=e.return;r!==null;){if(Yf(r)){l=r;break}r=r.return}if(l==null)throw Error(o(160));switch(l.tag){case 27:var m=l.stateNode,x=ic(e);Bo(e,x,m);break;case 5:var T=l.stateNode;l.flags&32&&(ra(T,""),l.flags&=-33);var E=ic(e);Bo(e,E,T);break;case 3:case 4:var R=l.stateNode.containerInfo,$=ic(e);rc(e,$,R);break;default:throw Error(o(161))}}catch(ie){tt(e,e.return,ie)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function np(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var n=e;np(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),e=e.sibling}}function qn(e,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)Xf(e,n.alternate,n),n=n.sibling}function Ys(e){for(e=e.child;e!==null;){var n=e;switch(n.tag){case 0:case 11:case 14:case 15:ps(4,n,n.return),Ys(n);break;case 1:An(n,n.return);var l=n.stateNode;typeof l.componentWillUnmount=="function"&&zf(n,n.return,l),Ys(n);break;case 27:Ul(n.stateNode);case 26:case 5:An(n,n.return),Ys(n);break;case 22:n.memoizedState===null&&Ys(n);break;case 30:Ys(n);break;default:Ys(n)}e=e.sibling}}function Jn(e,n,l){for(l=l&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var r=n.alternate,m=e,x=n,T=x.flags;switch(x.tag){case 0:case 11:case 15:Jn(m,x,l),Cl(4,x);break;case 1:if(Jn(m,x,l),r=x,m=r.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch($){tt(r,r.return,$)}if(r=x,m=r.updateQueue,m!==null){var E=r.stateNode;try{var R=m.shared.hiddenCallbacks;if(R!==null)for(m.shared.hiddenCallbacks=null,m=0;m<R.length;m++)Dd(R[m],E)}catch($){tt(r,r.return,$)}}l&&T&64&&Jf(x),wl(x,x.return);break;case 27:$f(x);case 26:case 5:Jn(m,x,l),l&&r===null&&T&4&&Ff(x),wl(x,x.return);break;case 12:Jn(m,x,l);break;case 31:Jn(m,x,l),l&&T&4&&Zf(m,x);break;case 13:Jn(m,x,l),l&&T&4&&ep(m,x);break;case 22:x.memoizedState===null&&Jn(m,x,l),wl(x,x.return);break;case 30:break;default:Jn(m,x,l)}n=n.sibling}}function uc(e,n){var l=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(l=e.memoizedState.cachePool.pool),e=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(e=n.memoizedState.cachePool.pool),e!==l&&(e!=null&&e.refCount++,l!=null&&fl(l))}function dc(e,n){e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&fl(e))}function yn(e,n,l,r){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)sp(e,n,l,r),n=n.sibling}function sp(e,n,l,r){var m=n.flags;switch(n.tag){case 0:case 11:case 15:yn(e,n,l,r),m&2048&&Cl(9,n);break;case 1:yn(e,n,l,r);break;case 3:yn(e,n,l,r),m&2048&&(e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&fl(e)));break;case 12:if(m&2048){yn(e,n,l,r),e=n.stateNode;try{var x=n.memoizedProps,T=x.id,E=x.onPostCommit;typeof E=="function"&&E(T,n.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(R){tt(n,n.return,R)}}else yn(e,n,l,r);break;case 31:yn(e,n,l,r);break;case 13:yn(e,n,l,r);break;case 23:break;case 22:x=n.stateNode,T=n.alternate,n.memoizedState!==null?x._visibility&2?yn(e,n,l,r):Al(e,n):x._visibility&2?yn(e,n,l,r):(x._visibility|=2,_a(e,n,l,r,(n.subtreeFlags&10256)!==0||!1)),m&2048&&uc(T,n);break;case 24:yn(e,n,l,r),m&2048&&dc(n.alternate,n);break;default:yn(e,n,l,r)}}function _a(e,n,l,r,m){for(m=m&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var x=e,T=n,E=l,R=r,$=T.flags;switch(T.tag){case 0:case 11:case 15:_a(x,T,E,R,m),Cl(8,T);break;case 23:break;case 22:var ie=T.stateNode;T.memoizedState!==null?ie._visibility&2?_a(x,T,E,R,m):Al(x,T):(ie._visibility|=2,_a(x,T,E,R,m)),m&&$&2048&&uc(T.alternate,T);break;case 24:_a(x,T,E,R,m),m&&$&2048&&dc(T.alternate,T);break;default:_a(x,T,E,R,m)}n=n.sibling}}function Al(e,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var l=e,r=n,m=r.flags;switch(r.tag){case 22:Al(l,r),m&2048&&uc(r.alternate,r);break;case 24:Al(l,r),m&2048&&dc(r.alternate,r);break;default:Al(l,r)}n=n.sibling}}var _l=8192;function Ra(e,n,l){if(e.subtreeFlags&_l)for(e=e.child;e!==null;)ap(e,n,l),e=e.sibling}function ap(e,n,l){switch(e.tag){case 26:Ra(e,n,l),e.flags&_l&&e.memoizedState!==null&&sv(l,vn,e.memoizedState,e.memoizedProps);break;case 5:Ra(e,n,l);break;case 3:case 4:var r=vn;vn=ni(e.stateNode.containerInfo),Ra(e,n,l),vn=r;break;case 22:e.memoizedState===null&&(r=e.alternate,r!==null&&r.memoizedState!==null?(r=_l,_l=16777216,Ra(e,n,l),_l=r):Ra(e,n,l));break;default:Ra(e,n,l)}}function lp(e){var n=e.alternate;if(n!==null&&(e=n.child,e!==null)){n.child=null;do n=e.sibling,e.sibling=null,e=n;while(e!==null)}}function Rl(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var l=0;l<n.length;l++){var r=n[l];Et=r,ip(r,e)}lp(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)op(e),e=e.sibling}function op(e){switch(e.tag){case 0:case 11:case 15:Rl(e),e.flags&2048&&ps(9,e,e.return);break;case 3:Rl(e);break;case 12:Rl(e);break;case 22:var n=e.stateNode;e.memoizedState!==null&&n._visibility&2&&(e.return===null||e.return.tag!==13)?(n._visibility&=-3,qo(e)):Rl(e);break;default:Rl(e)}}function qo(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var l=0;l<n.length;l++){var r=n[l];Et=r,ip(r,e)}lp(e)}for(e=e.child;e!==null;){switch(n=e,n.tag){case 0:case 11:case 15:ps(8,n,n.return),qo(n);break;case 22:l=n.stateNode,l._visibility&2&&(l._visibility&=-3,qo(n));break;default:qo(n)}e=e.sibling}}function ip(e,n){for(;Et!==null;){var l=Et;switch(l.tag){case 0:case 11:case 15:ps(8,l,n);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var r=l.memoizedState.cachePool.pool;r!=null&&r.refCount++}break;case 24:fl(l.memoizedState.cache)}if(r=l.child,r!==null)r.return=l,Et=r;else e:for(l=e;Et!==null;){r=Et;var m=r.sibling,x=r.return;if(Qf(r),r===l){Et=null;break e}if(m!==null){m.return=x,Et=m;break e}Et=x}}}var vx={getCacheForType:function(e){var n=Rt(yt),l=n.data.get(e);return l===void 0&&(l=e(),n.data.set(e,l)),l},cacheSignal:function(){return Rt(yt).controller.signal}},yx=typeof WeakMap=="function"?WeakMap:Map,We=0,ot=null,Ve=null,Je=0,et=0,en=null,ms=!1,Ia=!1,fc=!1,zn=0,ht=0,hs=0,$s=0,pc=0,tn=0,Ma=0,Il=null,Ft=null,mc=!1,Jo=0,rp=0,zo=1/0,Fo=null,gs=null,Nt=0,xs=null,Da=null,Fn=0,hc=0,gc=null,cp=null,Ml=0,xc=null;function nn(){return(We&2)!==0&&Je!==0?Je&-Je:A.T!==null?Nc():to()}function up(){if(tn===0)if((Je&536870912)===0||Ye){var e=ta;ta<<=1,(ta&3932160)===0&&(ta=262144),tn=e}else tn=536870912;return e=Wt.current,e!==null&&(e.flags|=32),tn}function Yt(e,n,l){(e===ot&&(et===2||et===9)||e.cancelPendingCommit!==null)&&(ka(e,0),vs(e,Je,tn,!1)),Ds(e,l),((We&2)===0||e!==ot)&&(e===ot&&((We&2)===0&&($s|=l),ht===4&&vs(e,Je,tn,!1)),_n(e))}function dp(e,n,l){if((We&6)!==0)throw Error(o(327));var r=!l&&(n&127)===0&&(n&e.expiredLanes)===0||Ms(e,n),m=r?Tx(e,n):yc(e,n,!0),x=r;do{if(m===0){Ia&&!r&&vs(e,n,0,!1);break}else{if(l=e.current.alternate,x&&!bx(l)){m=yc(e,n,!1),x=!1;continue}if(m===2){if(x=n,e.errorRecoveryDisabledLanes&x)var T=0;else T=e.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){n=T;e:{var E=e;m=Il;var R=E.current.memoizedState.isDehydrated;if(R&&(ka(E,T).flags|=256),T=yc(E,T,!1),T!==2){if(fc&&!R){E.errorRecoveryDisabledLanes|=x,$s|=x,m=4;break e}x=Ft,Ft=m,x!==null&&(Ft===null?Ft=x:Ft.push.apply(Ft,x))}m=T}if(x=!1,m!==2)continue}}if(m===1){ka(e,0),vs(e,n,0,!0);break}e:{switch(r=e,x=m,x){case 0:case 1:throw Error(o(345));case 4:if((n&4194048)!==n)break;case 6:vs(r,n,tn,!ms);break e;case 2:Ft=null;break;case 3:case 5:break;default:throw Error(o(329))}if((n&62914560)===n&&(m=Jo+300-Gt(),10<m)){if(vs(r,n,tn,!ms),sa(r,0,!0)!==0)break e;Fn=n,r.timeoutHandle=Vp(fp.bind(null,r,l,Ft,Fo,mc,n,tn,$s,Ma,ms,x,"Throttled",-0,0),m);break e}fp(r,l,Ft,Fo,mc,n,tn,$s,Ma,ms,x,null,-0,0)}}break}while(!0);_n(e)}function fp(e,n,l,r,m,x,T,E,R,$,ie,pe,K,te){if(e.timeoutHandle=-1,pe=n.subtreeFlags,pe&8192||(pe&16785408)===16785408){pe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Mn},ap(n,x,pe);var Ne=(x&62914560)===x?Jo-Gt():(x&4194048)===x?rp-Gt():0;if(Ne=av(pe,Ne),Ne!==null){Fn=x,e.cancelPendingCommit=Ne(bp.bind(null,e,n,x,l,r,m,T,E,R,ie,pe,null,K,te)),vs(e,x,T,!$);return}}bp(e,n,x,l,r,m,T,E,R)}function bx(e){for(var n=e;;){var l=n.tag;if((l===0||l===11||l===15)&&n.flags&16384&&(l=n.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var r=0;r<l.length;r++){var m=l[r],x=m.getSnapshot;m=m.value;try{if(!Xt(x(),m))return!1}catch{return!1}}if(l=n.child,n.subtreeFlags&16384&&l!==null)l.return=n,n=l;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function vs(e,n,l,r){n&=~pc,n&=~$s,e.suspendedLanes|=n,e.pingedLanes&=~n,r&&(e.warmLanes|=n),r=e.expirationTimes;for(var m=n;0<m;){var x=31-Dt(m),T=1<<x;r[x]=-1,m&=~T}l!==0&&Wl(e,l,n)}function Yo(){return(We&6)===0?(Dl(0),!1):!0}function vc(){if(Ve!==null){if(et===0)var e=Ve.return;else e=Ve,Un=Ps=null,jr(e),Na=null,ml=0,e=Ve;for(;e!==null;)qf(e.alternate,e),e=e.return;Ve=null}}function ka(e,n){var l=e.timeoutHandle;l!==-1&&(e.timeoutHandle=-1,Hx(l)),l=e.cancelPendingCommit,l!==null&&(e.cancelPendingCommit=null,l()),Fn=0,vc(),ot=e,Ve=l=kn(e.current,null),Je=n,et=0,en=null,ms=!1,Ia=Ms(e,n),fc=!1,Ma=tn=pc=$s=hs=ht=0,Ft=Il=null,mc=!1,(n&8)!==0&&(n|=n&32);var r=e.entangledLanes;if(r!==0)for(e=e.entanglements,r&=n;0<r;){var m=31-Dt(r),x=1<<m;n|=e[m],r&=~x}return zn=n,mo(),l}function pp(e,n){He=null,A.H=Tl,n===Ta||n===To?(n=_d(),et=3):n===Tr?(n=_d(),et=4):et=n===Xr?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,en=n,Ve===null&&(ht=1,Lo(e,rn(n,e.current)))}function mp(){var e=Wt.current;return e===null?!0:(Je&4194048)===Je?fn===null:(Je&62914560)===Je||(Je&536870912)!==0?e===fn:!1}function hp(){var e=A.H;return A.H=Tl,e===null?Tl:e}function gp(){var e=A.A;return A.A=vx,e}function $o(){ht=4,ms||(Je&4194048)!==Je&&Wt.current!==null||(Ia=!0),(hs&134217727)===0&&($s&134217727)===0||ot===null||vs(ot,Je,tn,!1)}function yc(e,n,l){var r=We;We|=2;var m=hp(),x=gp();(ot!==e||Je!==n)&&(Fo=null,ka(e,n)),n=!1;var T=ht;e:do try{if(et!==0&&Ve!==null){var E=Ve,R=en;switch(et){case 8:vc(),T=6;break e;case 3:case 2:case 9:case 6:Wt.current===null&&(n=!0);var $=et;if(et=0,en=null,ja(e,E,R,$),l&&Ia){T=0;break e}break;default:$=et,et=0,en=null,ja(e,E,R,$)}}Sx(),T=ht;break}catch(ie){pp(e,ie)}while(!0);return n&&e.shellSuspendCounter++,Un=Ps=null,We=r,A.H=m,A.A=x,Ve===null&&(ot=null,Je=0,mo()),T}function Sx(){for(;Ve!==null;)xp(Ve)}function Tx(e,n){var l=We;We|=2;var r=hp(),m=gp();ot!==e||Je!==n?(Fo=null,zo=Gt()+500,ka(e,n)):Ia=Ms(e,n);e:do try{if(et!==0&&Ve!==null){n=Ve;var x=en;t:switch(et){case 1:et=0,en=null,ja(e,n,x,1);break;case 2:case 9:if(wd(x)){et=0,en=null,vp(n);break}n=function(){et!==2&&et!==9||ot!==e||(et=7),_n(e)},x.then(n,n);break e;case 3:et=7;break e;case 4:et=5;break e;case 7:wd(x)?(et=0,en=null,vp(n)):(et=0,en=null,ja(e,n,x,7));break;case 5:var T=null;switch(Ve.tag){case 26:T=Ve.memoizedState;case 5:case 27:var E=Ve;if(T?sm(T):E.stateNode.complete){et=0,en=null;var R=E.sibling;if(R!==null)Ve=R;else{var $=E.return;$!==null?(Ve=$,Ko($)):Ve=null}break t}}et=0,en=null,ja(e,n,x,5);break;case 6:et=0,en=null,ja(e,n,x,6);break;case 8:vc(),ht=6;break e;default:throw Error(o(462))}}Nx();break}catch(ie){pp(e,ie)}while(!0);return Un=Ps=null,A.H=r,A.A=m,We=l,Ve!==null?0:(ot=null,Je=0,mo(),ht)}function Nx(){for(;Ve!==null&&!_s();)xp(Ve)}function xp(e){var n=Bf(e.alternate,e,zn);e.memoizedProps=e.pendingProps,n===null?Ko(e):Ve=n}function vp(e){var n=e,l=n.alternate;switch(n.tag){case 15:case 0:n=Uf(l,n,n.pendingProps,n.type,void 0,Je);break;case 11:n=Uf(l,n,n.pendingProps,n.type.render,n.ref,Je);break;case 5:jr(n);default:qf(l,n),n=Ve=hd(n,zn),n=Bf(l,n,zn)}e.memoizedProps=e.pendingProps,n===null?Ko(e):Ve=n}function ja(e,n,l,r){Un=Ps=null,jr(n),Na=null,ml=0;var m=n.return;try{if(dx(e,m,n,l,Je)){ht=1,Lo(e,rn(l,e.current)),Ve=null;return}}catch(x){if(m!==null)throw Ve=m,x;ht=1,Lo(e,rn(l,e.current)),Ve=null;return}n.flags&32768?(Ye||r===1?e=!0:Ia||(Je&536870912)!==0?e=!1:(ms=e=!0,(r===2||r===9||r===3||r===6)&&(r=Wt.current,r!==null&&r.tag===13&&(r.flags|=16384))),yp(n,e)):Ko(n)}function Ko(e){var n=e;do{if((n.flags&32768)!==0){yp(n,ms);return}e=n.return;var l=mx(n.alternate,n,zn);if(l!==null){Ve=l;return}if(n=n.sibling,n!==null){Ve=n;return}Ve=n=e}while(n!==null);ht===0&&(ht=5)}function yp(e,n){do{var l=hx(e.alternate,e);if(l!==null){l.flags&=32767,Ve=l;return}if(l=e.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!n&&(e=e.sibling,e!==null)){Ve=e;return}Ve=e=l}while(e!==null);ht=6,Ve=null}function bp(e,n,l,r,m,x,T,E,R){e.cancelPendingCommit=null;do Xo();while(Nt!==0);if((We&6)!==0)throw Error(o(327));if(n!==null){if(n===e.current)throw Error(o(177));if(x=n.lanes|n.childLanes,x|=ir,Pi(e,l,x,T,E,R),e===ot&&(Ve=ot=null,Je=0),Da=n,xs=e,Fn=l,hc=x,gc=m,cp=r,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Ax(Wn,function(){return Cp(),null})):(e.callbackNode=null,e.callbackPriority=0),r=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||r){r=A.T,A.T=null,m=U.p,U.p=2,T=We,We|=4;try{gx(e,n,l)}finally{We=T,U.p=m,A.T=r}}Nt=1,Sp(),Tp(),Np()}}function Sp(){if(Nt===1){Nt=0;var e=xs,n=Da,l=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||l){l=A.T,A.T=null;var r=U.p;U.p=2;var m=We;We|=4;try{tp(n,e);var x=Mc,T=od(e.containerInfo),E=x.focusedElem,R=x.selectionRange;if(T!==E&&E&&E.ownerDocument&&ld(E.ownerDocument.documentElement,E)){if(R!==null&&nr(E)){var $=R.start,ie=R.end;if(ie===void 0&&(ie=$),"selectionStart"in E)E.selectionStart=$,E.selectionEnd=Math.min(ie,E.value.length);else{var pe=E.ownerDocument||document,K=pe&&pe.defaultView||window;if(K.getSelection){var te=K.getSelection(),Ne=E.textContent.length,Me=Math.min(R.start,Ne),lt=R.end===void 0?Me:Math.min(R.end,Ne);!te.extend&&Me>lt&&(T=lt,lt=Me,Me=T);var B=ad(E,Me),j=ad(E,lt);if(B&&j&&(te.rangeCount!==1||te.anchorNode!==B.node||te.anchorOffset!==B.offset||te.focusNode!==j.node||te.focusOffset!==j.offset)){var Y=pe.createRange();Y.setStart(B.node,B.offset),te.removeAllRanges(),Me>lt?(te.addRange(Y),te.extend(j.node,j.offset)):(Y.setEnd(j.node,j.offset),te.addRange(Y))}}}}for(pe=[],te=E;te=te.parentNode;)te.nodeType===1&&pe.push({element:te,left:te.scrollLeft,top:te.scrollTop});for(typeof E.focus=="function"&&E.focus(),E=0;E<pe.length;E++){var de=pe[E];de.element.scrollLeft=de.left,de.element.scrollTop=de.top}}ri=!!Ic,Mc=Ic=null}finally{We=m,U.p=r,A.T=l}}e.current=n,Nt=2}}function Tp(){if(Nt===2){Nt=0;var e=xs,n=Da,l=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||l){l=A.T,A.T=null;var r=U.p;U.p=2;var m=We;We|=4;try{Xf(e,n.alternate,n)}finally{We=m,U.p=r,A.T=l}}Nt=3}}function Np(){if(Nt===4||Nt===3){Nt=0,Ws();var e=xs,n=Da,l=Fn,r=cp;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?Nt=5:(Nt=0,Da=xs=null,Ep(e,e.pendingLanes));var m=e.pendingLanes;if(m===0&&(gs=null),Wa(l),n=n.stateNode,wt&&typeof wt.onCommitFiberRoot=="function")try{wt.onCommitFiberRoot(Zn,n,void 0,(n.current.flags&128)===128)}catch{}if(r!==null){n=A.T,m=U.p,U.p=2,A.T=null;try{for(var x=e.onRecoverableError,T=0;T<r.length;T++){var E=r[T];x(E.value,{componentStack:E.stack})}}finally{A.T=n,U.p=m}}(Fn&3)!==0&&Xo(),_n(e),m=e.pendingLanes,(l&261930)!==0&&(m&42)!==0?e===xc?Ml++:(Ml=0,xc=e):Ml=0,Dl(0)}}function Ep(e,n){(e.pooledCacheLanes&=n)===0&&(n=e.pooledCache,n!=null&&(e.pooledCache=null,fl(n)))}function Xo(){return Sp(),Tp(),Np(),Cp()}function Cp(){if(Nt!==5)return!1;var e=xs,n=hc;hc=0;var l=Wa(Fn),r=A.T,m=U.p;try{U.p=32>l?32:l,A.T=null,l=gc,gc=null;var x=xs,T=Fn;if(Nt=0,Da=xs=null,Fn=0,(We&6)!==0)throw Error(o(331));var E=We;if(We|=4,op(x.current),sp(x,x.current,T,l),We=E,Dl(0,!1),wt&&typeof wt.onPostCommitFiberRoot=="function")try{wt.onPostCommitFiberRoot(Zn,x)}catch{}return!0}finally{U.p=m,A.T=r,Ep(e,n)}}function wp(e,n,l){n=rn(l,n),n=Kr(e.stateNode,n,2),e=us(e,n,2),e!==null&&(Ds(e,2),_n(e))}function tt(e,n,l){if(e.tag===3)wp(e,e,l);else for(;n!==null;){if(n.tag===3){wp(n,e,l);break}else if(n.tag===1){var r=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(gs===null||!gs.has(r))){e=rn(l,e),l=Af(2),r=us(n,l,2),r!==null&&(_f(l,r,n,e),Ds(r,2),_n(r));break}}n=n.return}}function bc(e,n,l){var r=e.pingCache;if(r===null){r=e.pingCache=new yx;var m=new Set;r.set(n,m)}else m=r.get(n),m===void 0&&(m=new Set,r.set(n,m));m.has(l)||(fc=!0,m.add(l),e=Ex.bind(null,e,n,l),n.then(e,e))}function Ex(e,n,l){var r=e.pingCache;r!==null&&r.delete(n),e.pingedLanes|=e.suspendedLanes&l,e.warmLanes&=~l,ot===e&&(Je&l)===l&&(ht===4||ht===3&&(Je&62914560)===Je&&300>Gt()-Jo?(We&2)===0&&ka(e,0):pc|=l,Ma===Je&&(Ma=0)),_n(e)}function Ap(e,n){n===0&&(n=Ql()),e=Ls(e,n),e!==null&&(Ds(e,n),_n(e))}function Cx(e){var n=e.memoizedState,l=0;n!==null&&(l=n.retryLane),Ap(e,l)}function wx(e,n){var l=0;switch(e.tag){case 31:case 13:var r=e.stateNode,m=e.memoizedState;m!==null&&(l=m.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(o(314))}r!==null&&r.delete(n),Ap(e,l)}function Ax(e,n){return Fe(e,n)}var Qo=null,Ua=null,Sc=!1,Wo=!1,Tc=!1,ys=0;function _n(e){e!==Ua&&e.next===null&&(Ua===null?Qo=Ua=e:Ua=Ua.next=e),Wo=!0,Sc||(Sc=!0,Rx())}function Dl(e,n){if(!Tc&&Wo){Tc=!0;do for(var l=!1,r=Qo;r!==null;){if(e!==0){var m=r.pendingLanes;if(m===0)var x=0;else{var T=r.suspendedLanes,E=r.pingedLanes;x=(1<<31-Dt(42|e)+1)-1,x&=m&~(T&~E),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(l=!0,Mp(r,x))}else x=Je,x=sa(r,r===ot?x:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),(x&3)===0||Ms(r,x)||(l=!0,Mp(r,x));r=r.next}while(l);Tc=!1}}function _x(){_p()}function _p(){Wo=Sc=!1;var e=0;ys!==0&&Px()&&(e=ys);for(var n=Gt(),l=null,r=Qo;r!==null;){var m=r.next,x=Rp(r,n);x===0?(r.next=null,l===null?Qo=m:l.next=m,m===null&&(Ua=l)):(l=r,(e!==0||(x&3)!==0)&&(Wo=!0)),r=m}Nt!==0&&Nt!==5||Dl(e),ys!==0&&(ys=0)}function Rp(e,n){for(var l=e.suspendedLanes,r=e.pingedLanes,m=e.expirationTimes,x=e.pendingLanes&-62914561;0<x;){var T=31-Dt(x),E=1<<T,R=m[T];R===-1?((E&l)===0||(E&r)!==0)&&(m[T]=Oi(E,n)):R<=n&&(e.expiredLanes|=E),x&=~E}if(n=ot,l=Je,l=sa(e,e===n?l:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),r=e.callbackNode,l===0||e===n&&(et===2||et===9)||e.cancelPendingCommit!==null)return r!==null&&r!==null&&Lt(r),e.callbackNode=null,e.callbackPriority=0;if((l&3)===0||Ms(e,l)){if(n=l&-l,n===e.callbackPriority)return n;switch(r!==null&&Lt(r),Wa(l)){case 2:case 8:l=Zs;break;case 32:l=Wn;break;case 268435456:l=Nn;break;default:l=Wn}return r=Ip.bind(null,e),l=Fe(l,r),e.callbackPriority=n,e.callbackNode=l,n}return r!==null&&r!==null&&Lt(r),e.callbackPriority=2,e.callbackNode=null,2}function Ip(e,n){if(Nt!==0&&Nt!==5)return e.callbackNode=null,e.callbackPriority=0,null;var l=e.callbackNode;if(Xo()&&e.callbackNode!==l)return null;var r=Je;return r=sa(e,e===ot?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),r===0?null:(dp(e,r,n),Rp(e,Gt()),e.callbackNode!=null&&e.callbackNode===l?Ip.bind(null,e):null)}function Mp(e,n){if(Xo())return null;dp(e,n,!0)}function Rx(){Bx(function(){(We&6)!==0?Fe($t,_x):_p()})}function Nc(){if(ys===0){var e=ba;e===0&&(e=Is,Is<<=1,(Is&261888)===0&&(Is=256)),ys=e}return ys}function Dp(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:lo(""+e)}function kp(e,n){var l=n.ownerDocument.createElement("input");return l.name=n.name,l.value=n.value,e.id&&l.setAttribute("form",e.id),n.parentNode.insertBefore(l,n),e=new FormData(e),l.parentNode.removeChild(l),e}function Ix(e,n,l,r,m){if(n==="submit"&&l&&l.stateNode===m){var x=Dp((m[At]||null).action),T=r.submitter;T&&(n=(n=T[At]||null)?Dp(n.formAction):T.getAttribute("formAction"),n!==null&&(x=n,T=null));var E=new co("action","action",null,r,m);e.push({event:E,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(ys!==0){var R=T?kp(m,T):new FormData(m);qr(l,{pending:!0,data:R,method:m.method,action:x},null,R)}}else typeof x=="function"&&(E.preventDefault(),R=T?kp(m,T):new FormData(m),qr(l,{pending:!0,data:R,method:m.method,action:x},x,R))},currentTarget:m}]})}}for(var Ec=0;Ec<or.length;Ec++){var Cc=or[Ec],Mx=Cc.toLowerCase(),Dx=Cc[0].toUpperCase()+Cc.slice(1);xn(Mx,"on"+Dx)}xn(cd,"onAnimationEnd"),xn(ud,"onAnimationIteration"),xn(dd,"onAnimationStart"),xn("dblclick","onDoubleClick"),xn("focusin","onFocus"),xn("focusout","onBlur"),xn($0,"onTransitionRun"),xn(K0,"onTransitionStart"),xn(X0,"onTransitionCancel"),xn(fd,"onTransitionEnd"),dt("onMouseEnter",["mouseout","mouseover"]),dt("onMouseLeave",["mouseout","mouseover"]),dt("onPointerEnter",["pointerout","pointerover"]),dt("onPointerLeave",["pointerout","pointerover"]),Qe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Qe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Qe("onBeforeInput",["compositionend","keypress","textInput","paste"]),Qe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Qe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Qe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var kl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kx=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(kl));function jp(e,n){n=(n&4)!==0;for(var l=0;l<e.length;l++){var r=e[l],m=r.event;r=r.listeners;e:{var x=void 0;if(n)for(var T=r.length-1;0<=T;T--){var E=r[T],R=E.instance,$=E.currentTarget;if(E=E.listener,R!==x&&m.isPropagationStopped())break e;x=E,m.currentTarget=$;try{x(m)}catch(ie){po(ie)}m.currentTarget=null,x=R}else for(T=0;T<r.length;T++){if(E=r[T],R=E.instance,$=E.currentTarget,E=E.listener,R!==x&&m.isPropagationStopped())break e;x=E,m.currentTarget=$;try{x(m)}catch(ie){po(ie)}m.currentTarget=null,x=R}}}}function qe(e,n){var l=n[ts];l===void 0&&(l=n[ts]=new Set);var r=e+"__bubble";l.has(r)||(Up(n,e,2,!1),l.add(r))}function wc(e,n,l){var r=0;n&&(r|=4),Up(l,e,r,n)}var Zo="_reactListening"+Math.random().toString(36).slice(2);function Ac(e){if(!e[Zo]){e[Zo]=!0,ns.forEach(function(l){l!=="selectionchange"&&(kx.has(l)||wc(l,!1,e),wc(l,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[Zo]||(n[Zo]=!0,wc("selectionchange",!1,n))}}function Up(e,n,l,r){switch(um(n)){case 2:var m=iv;break;case 8:m=rv;break;default:m=Vc}l=m.bind(null,n,l,e),m=void 0,!Yi||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(m=!0),r?m!==void 0?e.addEventListener(n,l,{capture:!0,passive:m}):e.addEventListener(n,l,!0):m!==void 0?e.addEventListener(n,l,{passive:m}):e.addEventListener(n,l,!1)}function _c(e,n,l,r,m){var x=r;if((n&1)===0&&(n&2)===0&&r!==null)e:for(;;){if(r===null)return;var T=r.tag;if(T===3||T===4){var E=r.stateNode.containerInfo;if(E===m)break;if(T===4)for(T=r.return;T!==null;){var R=T.tag;if((R===3||R===4)&&T.stateNode.containerInfo===m)return;T=T.return}for(;E!==null;){if(T=ye(E),T===null)return;if(R=T.tag,R===5||R===6||R===26||R===27){r=x=T;continue e}E=E.parentNode}}r=r.return}Pu(function(){var $=x,ie=zi(l),pe=[];e:{var K=pd.get(e);if(K!==void 0){var te=co,Ne=e;switch(e){case"keypress":if(io(l)===0)break e;case"keydown":case"keyup":te=w0;break;case"focusin":Ne="focus",te=Qi;break;case"focusout":Ne="blur",te=Qi;break;case"beforeblur":case"afterblur":te=Qi;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":te=Vu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":te=m0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":te=R0;break;case cd:case ud:case dd:te=x0;break;case fd:te=M0;break;case"scroll":case"scrollend":te=f0;break;case"wheel":te=k0;break;case"copy":case"cut":case"paste":te=y0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":te=Ju;break;case"toggle":case"beforetoggle":te=U0}var Me=(n&4)!==0,lt=!Me&&(e==="scroll"||e==="scrollend"),B=Me?K!==null?K+"Capture":null:K;Me=[];for(var j=$,Y;j!==null;){var de=j;if(Y=de.stateNode,de=de.tag,de!==5&&de!==26&&de!==27||Y===null||B===null||(de=tl(j,B),de!=null&&Me.push(jl(j,de,Y))),lt)break;j=j.return}0<Me.length&&(K=new te(K,Ne,null,l,ie),pe.push({event:K,listeners:Me}))}}if((n&7)===0){e:{if(K=e==="mouseover"||e==="pointerover",te=e==="mouseout"||e==="pointerout",K&&l!==Ji&&(Ne=l.relatedTarget||l.fromElement)&&(ye(Ne)||Ne[es]))break e;if((te||K)&&(K=ie.window===ie?ie:(K=ie.ownerDocument)?K.defaultView||K.parentWindow:window,te?(Ne=l.relatedTarget||l.toElement,te=$,Ne=Ne?ye(Ne):null,Ne!==null&&(lt=d(Ne),Me=Ne.tag,Ne!==lt||Me!==5&&Me!==27&&Me!==6)&&(Ne=null)):(te=null,Ne=$),te!==Ne)){if(Me=Vu,de="onMouseLeave",B="onMouseEnter",j="mouse",(e==="pointerout"||e==="pointerover")&&(Me=Ju,de="onPointerLeave",B="onPointerEnter",j="pointer"),lt=te==null?K:Re(te),Y=Ne==null?K:Re(Ne),K=new Me(de,j+"leave",te,l,ie),K.target=lt,K.relatedTarget=Y,de=null,ye(ie)===$&&(Me=new Me(B,j+"enter",Ne,l,ie),Me.target=Y,Me.relatedTarget=lt,de=Me),lt=de,te&&Ne)t:{for(Me=jx,B=te,j=Ne,Y=0,de=B;de;de=Me(de))Y++;de=0;for(var Ae=j;Ae;Ae=Me(Ae))de++;for(;0<Y-de;)B=Me(B),Y--;for(;0<de-Y;)j=Me(j),de--;for(;Y--;){if(B===j||j!==null&&B===j.alternate){Me=B;break t}B=Me(B),j=Me(j)}Me=null}else Me=null;te!==null&&Lp(pe,K,te,Me,!1),Ne!==null&&lt!==null&&Lp(pe,lt,Ne,Me,!0)}}e:{if(K=$?Re($):window,te=K.nodeName&&K.nodeName.toLowerCase(),te==="select"||te==="input"&&K.type==="file")var $e=Wu;else if(Xu(K))if(Zu)$e=z0;else{$e=q0;var Ce=V0}else te=K.nodeName,!te||te.toLowerCase()!=="input"||K.type!=="checkbox"&&K.type!=="radio"?$&&qi($.elementType)&&($e=Wu):$e=J0;if($e&&($e=$e(e,$))){Qu(pe,$e,l,ie);break e}Ce&&Ce(e,K,$),e==="focusout"&&$&&K.type==="number"&&$.memoizedProps.value!=null&&Vi(K,"number",K.value)}switch(Ce=$?Re($):window,e){case"focusin":(Xu(Ce)||Ce.contentEditable==="true")&&(fa=Ce,sr=$,cl=null);break;case"focusout":cl=sr=fa=null;break;case"mousedown":ar=!0;break;case"contextmenu":case"mouseup":case"dragend":ar=!1,id(pe,l,ie);break;case"selectionchange":if(Y0)break;case"keydown":case"keyup":id(pe,l,ie)}var Be;if(Zi)e:{switch(e){case"compositionstart":var ze="onCompositionStart";break e;case"compositionend":ze="onCompositionEnd";break e;case"compositionupdate":ze="onCompositionUpdate";break e}ze=void 0}else da?$u(e,l)&&(ze="onCompositionEnd"):e==="keydown"&&l.keyCode===229&&(ze="onCompositionStart");ze&&(zu&&l.locale!=="ko"&&(da||ze!=="onCompositionStart"?ze==="onCompositionEnd"&&da&&(Be=Hu()):(ss=ie,$i="value"in ss?ss.value:ss.textContent,da=!0)),Ce=ei($,ze),0<Ce.length&&(ze=new qu(ze,e,null,l,ie),pe.push({event:ze,listeners:Ce}),Be?ze.data=Be:(Be=Ku(l),Be!==null&&(ze.data=Be)))),(Be=G0?O0(e,l):P0(e,l))&&(ze=ei($,"onBeforeInput"),0<ze.length&&(Ce=new qu("onBeforeInput","beforeinput",null,l,ie),pe.push({event:Ce,listeners:ze}),Ce.data=Be)),Ix(pe,e,$,l,ie)}jp(pe,n)})}function jl(e,n,l){return{instance:e,listener:n,currentTarget:l}}function ei(e,n){for(var l=n+"Capture",r=[];e!==null;){var m=e,x=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||x===null||(m=tl(e,l),m!=null&&r.unshift(jl(e,m,x)),m=tl(e,n),m!=null&&r.push(jl(e,m,x))),e.tag===3)return r;e=e.return}return[]}function jx(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Lp(e,n,l,r,m){for(var x=n._reactName,T=[];l!==null&&l!==r;){var E=l,R=E.alternate,$=E.stateNode;if(E=E.tag,R!==null&&R===r)break;E!==5&&E!==26&&E!==27||$===null||(R=$,m?($=tl(l,x),$!=null&&T.unshift(jl(l,$,R))):m||($=tl(l,x),$!=null&&T.push(jl(l,$,R)))),l=l.return}T.length!==0&&e.push({event:n,listeners:T})}var Ux=/\r\n?/g,Lx=/\u0000|\uFFFD/g;function Gp(e){return(typeof e=="string"?e:""+e).replace(Ux,`
`).replace(Lx,"")}function Op(e,n){return n=Gp(n),Gp(e)===n}function at(e,n,l,r,m,x){switch(l){case"children":typeof r=="string"?n==="body"||n==="textarea"&&r===""||ra(e,r):(typeof r=="number"||typeof r=="bigint")&&n!=="body"&&ra(e,""+r);break;case"className":so(e,"class",r);break;case"tabIndex":so(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":so(e,l,r);break;case"style":Gu(e,r,x);break;case"data":if(n!=="object"){so(e,"data",r);break}case"src":case"href":if(r===""&&(n!=="a"||l!=="href")){e.removeAttribute(l);break}if(r==null||typeof r=="function"||typeof r=="symbol"||typeof r=="boolean"){e.removeAttribute(l);break}r=lo(""+r),e.setAttribute(l,r);break;case"action":case"formAction":if(typeof r=="function"){e.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(l==="formAction"?(n!=="input"&&at(e,n,"name",m.name,m,null),at(e,n,"formEncType",m.formEncType,m,null),at(e,n,"formMethod",m.formMethod,m,null),at(e,n,"formTarget",m.formTarget,m,null)):(at(e,n,"encType",m.encType,m,null),at(e,n,"method",m.method,m,null),at(e,n,"target",m.target,m,null)));if(r==null||typeof r=="symbol"||typeof r=="boolean"){e.removeAttribute(l);break}r=lo(""+r),e.setAttribute(l,r);break;case"onClick":r!=null&&(e.onclick=Mn);break;case"onScroll":r!=null&&qe("scroll",e);break;case"onScrollEnd":r!=null&&qe("scrollend",e);break;case"dangerouslySetInnerHTML":if(r!=null){if(typeof r!="object"||!("__html"in r))throw Error(o(61));if(l=r.__html,l!=null){if(m.children!=null)throw Error(o(60));e.innerHTML=l}}break;case"multiple":e.multiple=r&&typeof r!="function"&&typeof r!="symbol";break;case"muted":e.muted=r&&typeof r!="function"&&typeof r!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(r==null||typeof r=="function"||typeof r=="boolean"||typeof r=="symbol"){e.removeAttribute("xlink:href");break}l=lo(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":r!=null&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(l,""+r):e.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(l,""):e.removeAttribute(l);break;case"capture":case"download":r===!0?e.setAttribute(l,""):r!==!1&&r!=null&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(l,r):e.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":r!=null&&typeof r!="function"&&typeof r!="symbol"&&!isNaN(r)&&1<=r?e.setAttribute(l,r):e.removeAttribute(l);break;case"rowSpan":case"start":r==null||typeof r=="function"||typeof r=="symbol"||isNaN(r)?e.removeAttribute(l):e.setAttribute(l,r);break;case"popover":qe("beforetoggle",e),qe("toggle",e),oa(e,"popover",r);break;case"xlinkActuate":In(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":In(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":In(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":In(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":In(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":In(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":In(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":In(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":In(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":oa(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=u0.get(l)||l,oa(e,l,r))}}function Rc(e,n,l,r,m,x){switch(l){case"style":Gu(e,r,x);break;case"dangerouslySetInnerHTML":if(r!=null){if(typeof r!="object"||!("__html"in r))throw Error(o(61));if(l=r.__html,l!=null){if(m.children!=null)throw Error(o(60));e.innerHTML=l}}break;case"children":typeof r=="string"?ra(e,r):(typeof r=="number"||typeof r=="bigint")&&ra(e,""+r);break;case"onScroll":r!=null&&qe("scroll",e);break;case"onScrollEnd":r!=null&&qe("scrollend",e);break;case"onClick":r!=null&&(e.onclick=Mn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ot.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(m=l.endsWith("Capture"),n=l.slice(2,m?l.length-7:void 0),x=e[At]||null,x=x!=null?x[l]:null,typeof x=="function"&&e.removeEventListener(n,x,m),typeof r=="function")){typeof x!="function"&&x!==null&&(l in e?e[l]=null:e.hasAttribute(l)&&e.removeAttribute(l)),e.addEventListener(n,r,m);break e}l in e?e[l]=r:r===!0?e.setAttribute(l,""):oa(e,l,r)}}}function Mt(e,n,l){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":qe("error",e),qe("load",e);var r=!1,m=!1,x;for(x in l)if(l.hasOwnProperty(x)){var T=l[x];if(T!=null)switch(x){case"src":r=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,n));default:at(e,n,x,T,l,null)}}m&&at(e,n,"srcSet",l.srcSet,l,null),r&&at(e,n,"src",l.src,l,null);return;case"input":qe("invalid",e);var E=x=T=m=null,R=null,$=null;for(r in l)if(l.hasOwnProperty(r)){var ie=l[r];if(ie!=null)switch(r){case"name":m=ie;break;case"type":T=ie;break;case"checked":R=ie;break;case"defaultChecked":$=ie;break;case"value":x=ie;break;case"defaultValue":E=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(o(137,n));break;default:at(e,n,r,ie,l,null)}}ku(e,x,E,R,$,T,m,!1);return;case"select":qe("invalid",e),r=T=x=null;for(m in l)if(l.hasOwnProperty(m)&&(E=l[m],E!=null))switch(m){case"value":x=E;break;case"defaultValue":T=E;break;case"multiple":r=E;default:at(e,n,m,E,l,null)}n=x,l=T,e.multiple=!!r,n!=null?ia(e,!!r,n,!1):l!=null&&ia(e,!!r,l,!0);return;case"textarea":qe("invalid",e),x=m=r=null;for(T in l)if(l.hasOwnProperty(T)&&(E=l[T],E!=null))switch(T){case"value":r=E;break;case"defaultValue":m=E;break;case"children":x=E;break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(o(91));break;default:at(e,n,T,E,l,null)}Uu(e,r,m,x);return;case"option":for(R in l)if(l.hasOwnProperty(R)&&(r=l[R],r!=null))switch(R){case"selected":e.selected=r&&typeof r!="function"&&typeof r!="symbol";break;default:at(e,n,R,r,l,null)}return;case"dialog":qe("beforetoggle",e),qe("toggle",e),qe("cancel",e),qe("close",e);break;case"iframe":case"object":qe("load",e);break;case"video":case"audio":for(r=0;r<kl.length;r++)qe(kl[r],e);break;case"image":qe("error",e),qe("load",e);break;case"details":qe("toggle",e);break;case"embed":case"source":case"link":qe("error",e),qe("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for($ in l)if(l.hasOwnProperty($)&&(r=l[$],r!=null))switch($){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,n));default:at(e,n,$,r,l,null)}return;default:if(qi(n)){for(ie in l)l.hasOwnProperty(ie)&&(r=l[ie],r!==void 0&&Rc(e,n,ie,r,l,void 0));return}}for(E in l)l.hasOwnProperty(E)&&(r=l[E],r!=null&&at(e,n,E,r,l,null))}function Gx(e,n,l,r){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,x=null,T=null,E=null,R=null,$=null,ie=null;for(te in l){var pe=l[te];if(l.hasOwnProperty(te)&&pe!=null)switch(te){case"checked":break;case"value":break;case"defaultValue":R=pe;default:r.hasOwnProperty(te)||at(e,n,te,null,r,pe)}}for(var K in r){var te=r[K];if(pe=l[K],r.hasOwnProperty(K)&&(te!=null||pe!=null))switch(K){case"type":x=te;break;case"name":m=te;break;case"checked":$=te;break;case"defaultChecked":ie=te;break;case"value":T=te;break;case"defaultValue":E=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(o(137,n));break;default:te!==pe&&at(e,n,K,te,r,pe)}}Bi(e,T,E,R,$,ie,x,m);return;case"select":te=T=E=K=null;for(x in l)if(R=l[x],l.hasOwnProperty(x)&&R!=null)switch(x){case"value":break;case"multiple":te=R;default:r.hasOwnProperty(x)||at(e,n,x,null,r,R)}for(m in r)if(x=r[m],R=l[m],r.hasOwnProperty(m)&&(x!=null||R!=null))switch(m){case"value":K=x;break;case"defaultValue":E=x;break;case"multiple":T=x;default:x!==R&&at(e,n,m,x,r,R)}n=E,l=T,r=te,K!=null?ia(e,!!l,K,!1):!!r!=!!l&&(n!=null?ia(e,!!l,n,!0):ia(e,!!l,l?[]:"",!1));return;case"textarea":te=K=null;for(E in l)if(m=l[E],l.hasOwnProperty(E)&&m!=null&&!r.hasOwnProperty(E))switch(E){case"value":break;case"children":break;default:at(e,n,E,null,r,m)}for(T in r)if(m=r[T],x=l[T],r.hasOwnProperty(T)&&(m!=null||x!=null))switch(T){case"value":K=m;break;case"defaultValue":te=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(o(91));break;default:m!==x&&at(e,n,T,m,r,x)}ju(e,K,te);return;case"option":for(var Ne in l)if(K=l[Ne],l.hasOwnProperty(Ne)&&K!=null&&!r.hasOwnProperty(Ne))switch(Ne){case"selected":e.selected=!1;break;default:at(e,n,Ne,null,r,K)}for(R in r)if(K=r[R],te=l[R],r.hasOwnProperty(R)&&K!==te&&(K!=null||te!=null))switch(R){case"selected":e.selected=K&&typeof K!="function"&&typeof K!="symbol";break;default:at(e,n,R,K,r,te)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Me in l)K=l[Me],l.hasOwnProperty(Me)&&K!=null&&!r.hasOwnProperty(Me)&&at(e,n,Me,null,r,K);for($ in r)if(K=r[$],te=l[$],r.hasOwnProperty($)&&K!==te&&(K!=null||te!=null))switch($){case"children":case"dangerouslySetInnerHTML":if(K!=null)throw Error(o(137,n));break;default:at(e,n,$,K,r,te)}return;default:if(qi(n)){for(var lt in l)K=l[lt],l.hasOwnProperty(lt)&&K!==void 0&&!r.hasOwnProperty(lt)&&Rc(e,n,lt,void 0,r,K);for(ie in r)K=r[ie],te=l[ie],!r.hasOwnProperty(ie)||K===te||K===void 0&&te===void 0||Rc(e,n,ie,K,r,te);return}}for(var B in l)K=l[B],l.hasOwnProperty(B)&&K!=null&&!r.hasOwnProperty(B)&&at(e,n,B,null,r,K);for(pe in r)K=r[pe],te=l[pe],!r.hasOwnProperty(pe)||K===te||K==null&&te==null||at(e,n,pe,K,r,te)}function Pp(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Ox(){if(typeof performance.getEntriesByType=="function"){for(var e=0,n=0,l=performance.getEntriesByType("resource"),r=0;r<l.length;r++){var m=l[r],x=m.transferSize,T=m.initiatorType,E=m.duration;if(x&&E&&Pp(T)){for(T=0,E=m.responseEnd,r+=1;r<l.length;r++){var R=l[r],$=R.startTime;if($>E)break;var ie=R.transferSize,pe=R.initiatorType;ie&&Pp(pe)&&(R=R.responseEnd,T+=ie*(R<E?1:(E-$)/(R-$)))}if(--r,n+=8*(x+T)/(m.duration/1e3),e++,10<e)break}}if(0<e)return n/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Ic=null,Mc=null;function ti(e){return e.nodeType===9?e:e.ownerDocument}function Hp(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Bp(e,n){if(e===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&n==="foreignObject"?0:e}function Dc(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var kc=null;function Px(){var e=window.event;return e&&e.type==="popstate"?e===kc?!1:(kc=e,!0):(kc=null,!1)}var Vp=typeof setTimeout=="function"?setTimeout:void 0,Hx=typeof clearTimeout=="function"?clearTimeout:void 0,qp=typeof Promise=="function"?Promise:void 0,Bx=typeof queueMicrotask=="function"?queueMicrotask:typeof qp<"u"?function(e){return qp.resolve(null).then(e).catch(Vx)}:Vp;function Vx(e){setTimeout(function(){throw e})}function bs(e){return e==="head"}function Jp(e,n){var l=n,r=0;do{var m=l.nextSibling;if(e.removeChild(l),m&&m.nodeType===8)if(l=m.data,l==="/$"||l==="/&"){if(r===0){e.removeChild(m),Pa(n);return}r--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")r++;else if(l==="html")Ul(e.ownerDocument.documentElement);else if(l==="head"){l=e.ownerDocument.head,Ul(l);for(var x=l.firstChild;x;){var T=x.nextSibling,E=x.nodeName;x[Z]||E==="SCRIPT"||E==="STYLE"||E==="LINK"&&x.rel.toLowerCase()==="stylesheet"||l.removeChild(x),x=T}}else l==="body"&&Ul(e.ownerDocument.body);l=m}while(l);Pa(n)}function zp(e,n){var l=e;e=0;do{var r=l.nextSibling;if(l.nodeType===1?n?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(n?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),r&&r.nodeType===8)if(l=r.data,l==="/$"){if(e===0)break;e--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||e++;l=r}while(l)}function jc(e){var n=e.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var l=n;switch(n=n.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":jc(l),ve(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}e.removeChild(l)}}function qx(e,n,l,r){for(;e.nodeType===1;){var m=l;if(e.nodeName.toLowerCase()!==n.toLowerCase()){if(!r&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(r){if(!e[Z])switch(n){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(x=e.getAttribute("rel"),x==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(x!==m.rel||e.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||e.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||e.getAttribute("title")!==(m.title==null?null:m.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(x=e.getAttribute("src"),(x!==(m.src==null?null:m.src)||e.getAttribute("type")!==(m.type==null?null:m.type)||e.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&x&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(n==="input"&&e.type==="hidden"){var x=m.name==null?null:""+m.name;if(m.type==="hidden"&&e.getAttribute("name")===x)return e}else return e;if(e=pn(e.nextSibling),e===null)break}return null}function Jx(e,n,l){if(n==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!l||(e=pn(e.nextSibling),e===null))return null;return e}function Fp(e,n){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=pn(e.nextSibling),e===null))return null;return e}function Uc(e){return e.data==="$?"||e.data==="$~"}function Lc(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function zx(e,n){var l=e.ownerDocument;if(e.data==="$~")e._reactRetry=n;else if(e.data!=="$?"||l.readyState!=="loading")n();else{var r=function(){n(),l.removeEventListener("DOMContentLoaded",r)};l.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}function pn(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return e}var Gc=null;function Yp(e){e=e.nextSibling;for(var n=0;e;){if(e.nodeType===8){var l=e.data;if(l==="/$"||l==="/&"){if(n===0)return pn(e.nextSibling);n--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||n++}e=e.nextSibling}return null}function $p(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var l=e.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(n===0)return e;n--}else l!=="/$"&&l!=="/&"||n++}e=e.previousSibling}return null}function Kp(e,n,l){switch(n=ti(l),e){case"html":if(e=n.documentElement,!e)throw Error(o(452));return e;case"head":if(e=n.head,!e)throw Error(o(453));return e;case"body":if(e=n.body,!e)throw Error(o(454));return e;default:throw Error(o(451))}}function Ul(e){for(var n=e.attributes;n.length;)e.removeAttributeNode(n[0]);ve(e)}var mn=new Map,Xp=new Set;function ni(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Yn=U.d;U.d={f:Fx,r:Yx,D:$x,C:Kx,L:Xx,m:Qx,X:Zx,S:Wx,M:ev};function Fx(){var e=Yn.f(),n=Yo();return e||n}function Yx(e){var n=je(e);n!==null&&n.tag===5&&n.type==="form"?pf(n):Yn.r(e)}var La=typeof document>"u"?null:document;function Qp(e,n,l){var r=La;if(r&&typeof n=="string"&&n){var m=ln(n);m='link[rel="'+e+'"][href="'+m+'"]',typeof l=="string"&&(m+='[crossorigin="'+l+'"]'),Xp.has(m)||(Xp.add(m),e={rel:e,crossOrigin:l,href:n},r.querySelector(m)===null&&(n=r.createElement("link"),Mt(n,"link",e),Oe(n),r.head.appendChild(n)))}}function $x(e){Yn.D(e),Qp("dns-prefetch",e,null)}function Kx(e,n){Yn.C(e,n),Qp("preconnect",e,n)}function Xx(e,n,l){Yn.L(e,n,l);var r=La;if(r&&e&&n){var m='link[rel="preload"][as="'+ln(n)+'"]';n==="image"&&l&&l.imageSrcSet?(m+='[imagesrcset="'+ln(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(m+='[imagesizes="'+ln(l.imageSizes)+'"]')):m+='[href="'+ln(e)+'"]';var x=m;switch(n){case"style":x=Ga(e);break;case"script":x=Oa(e)}mn.has(x)||(e=b({rel:"preload",href:n==="image"&&l&&l.imageSrcSet?void 0:e,as:n},l),mn.set(x,e),r.querySelector(m)!==null||n==="style"&&r.querySelector(Ll(x))||n==="script"&&r.querySelector(Gl(x))||(n=r.createElement("link"),Mt(n,"link",e),Oe(n),r.head.appendChild(n)))}}function Qx(e,n){Yn.m(e,n);var l=La;if(l&&e){var r=n&&typeof n.as=="string"?n.as:"script",m='link[rel="modulepreload"][as="'+ln(r)+'"][href="'+ln(e)+'"]',x=m;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=Oa(e)}if(!mn.has(x)&&(e=b({rel:"modulepreload",href:e},n),mn.set(x,e),l.querySelector(m)===null)){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Gl(x)))return}r=l.createElement("link"),Mt(r,"link",e),Oe(r),l.head.appendChild(r)}}}function Wx(e,n,l){Yn.S(e,n,l);var r=La;if(r&&e){var m=pt(r).hoistableStyles,x=Ga(e);n=n||"default";var T=m.get(x);if(!T){var E={loading:0,preload:null};if(T=r.querySelector(Ll(x)))E.loading=5;else{e=b({rel:"stylesheet",href:e,"data-precedence":n},l),(l=mn.get(x))&&Oc(e,l);var R=T=r.createElement("link");Oe(R),Mt(R,"link",e),R._p=new Promise(function($,ie){R.onload=$,R.onerror=ie}),R.addEventListener("load",function(){E.loading|=1}),R.addEventListener("error",function(){E.loading|=2}),E.loading|=4,si(T,n,r)}T={type:"stylesheet",instance:T,count:1,state:E},m.set(x,T)}}}function Zx(e,n){Yn.X(e,n);var l=La;if(l&&e){var r=pt(l).hoistableScripts,m=Oa(e),x=r.get(m);x||(x=l.querySelector(Gl(m)),x||(e=b({src:e,async:!0},n),(n=mn.get(m))&&Pc(e,n),x=l.createElement("script"),Oe(x),Mt(x,"link",e),l.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},r.set(m,x))}}function ev(e,n){Yn.M(e,n);var l=La;if(l&&e){var r=pt(l).hoistableScripts,m=Oa(e),x=r.get(m);x||(x=l.querySelector(Gl(m)),x||(e=b({src:e,async:!0,type:"module"},n),(n=mn.get(m))&&Pc(e,n),x=l.createElement("script"),Oe(x),Mt(x,"link",e),l.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},r.set(m,x))}}function Wp(e,n,l,r){var m=(m=xe.current)?ni(m):null;if(!m)throw Error(o(446));switch(e){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(n=Ga(l.href),l=pt(m).hoistableStyles,r=l.get(n),r||(r={type:"style",instance:null,count:0,state:null},l.set(n,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){e=Ga(l.href);var x=pt(m).hoistableStyles,T=x.get(e);if(T||(m=m.ownerDocument||m,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(e,T),(x=m.querySelector(Ll(e)))&&!x._p&&(T.instance=x,T.state.loading=5),mn.has(e)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},mn.set(e,l),x||tv(m,e,l,T.state))),n&&r===null)throw Error(o(528,""));return T}if(n&&r!==null)throw Error(o(529,""));return null;case"script":return n=l.async,l=l.src,typeof l=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=Oa(l),l=pt(m).hoistableScripts,r=l.get(n),r||(r={type:"script",instance:null,count:0,state:null},l.set(n,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,e))}}function Ga(e){return'href="'+ln(e)+'"'}function Ll(e){return'link[rel="stylesheet"]['+e+"]"}function Zp(e){return b({},e,{"data-precedence":e.precedence,precedence:null})}function tv(e,n,l,r){e.querySelector('link[rel="preload"][as="style"]['+n+"]")?r.loading=1:(n=e.createElement("link"),r.preload=n,n.addEventListener("load",function(){return r.loading|=1}),n.addEventListener("error",function(){return r.loading|=2}),Mt(n,"link",l),Oe(n),e.head.appendChild(n))}function Oa(e){return'[src="'+ln(e)+'"]'}function Gl(e){return"script[async]"+e}function em(e,n,l){if(n.count++,n.instance===null)switch(n.type){case"style":var r=e.querySelector('style[data-href~="'+ln(l.href)+'"]');if(r)return n.instance=r,Oe(r),r;var m=b({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return r=(e.ownerDocument||e).createElement("style"),Oe(r),Mt(r,"style",m),si(r,l.precedence,e),n.instance=r;case"stylesheet":m=Ga(l.href);var x=e.querySelector(Ll(m));if(x)return n.state.loading|=4,n.instance=x,Oe(x),x;r=Zp(l),(m=mn.get(m))&&Oc(r,m),x=(e.ownerDocument||e).createElement("link"),Oe(x);var T=x;return T._p=new Promise(function(E,R){T.onload=E,T.onerror=R}),Mt(x,"link",r),n.state.loading|=4,si(x,l.precedence,e),n.instance=x;case"script":return x=Oa(l.src),(m=e.querySelector(Gl(x)))?(n.instance=m,Oe(m),m):(r=l,(m=mn.get(x))&&(r=b({},l),Pc(r,m)),e=e.ownerDocument||e,m=e.createElement("script"),Oe(m),Mt(m,"link",r),e.head.appendChild(m),n.instance=m);case"void":return null;default:throw Error(o(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(r=n.instance,n.state.loading|=4,si(r,l.precedence,e));return n.instance}function si(e,n,l){for(var r=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=r.length?r[r.length-1]:null,x=m,T=0;T<r.length;T++){var E=r[T];if(E.dataset.precedence===n)x=E;else if(x!==m)break}x?x.parentNode.insertBefore(e,x.nextSibling):(n=l.nodeType===9?l.head:l,n.insertBefore(e,n.firstChild))}function Oc(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.title==null&&(e.title=n.title)}function Pc(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.integrity==null&&(e.integrity=n.integrity)}var ai=null;function tm(e,n,l){if(ai===null){var r=new Map,m=ai=new Map;m.set(l,r)}else m=ai,r=m.get(l),r||(r=new Map,m.set(l,r));if(r.has(e))return r;for(r.set(e,null),l=l.getElementsByTagName(e),m=0;m<l.length;m++){var x=l[m];if(!(x[Z]||x[ft]||e==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var T=x.getAttribute(n)||"";T=e+T;var E=r.get(T);E?E.push(x):r.set(T,[x])}}return r}function nm(e,n,l){e=e.ownerDocument||e,e.head.insertBefore(l,n==="title"?e.querySelector("head > title"):null)}function nv(e,n,l){if(l===1||n.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;switch(n.rel){case"stylesheet":return e=n.disabled,typeof n.precedence=="string"&&e==null;default:return!0}case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function sm(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function sv(e,n,l,r){if(l.type==="stylesheet"&&(typeof r.media!="string"||matchMedia(r.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var m=Ga(r.href),x=n.querySelector(Ll(m));if(x){n=x._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(e.count++,e=li.bind(e),n.then(e,e)),l.state.loading|=4,l.instance=x,Oe(x);return}x=n.ownerDocument||n,r=Zp(r),(m=mn.get(m))&&Oc(r,m),x=x.createElement("link"),Oe(x);var T=x;T._p=new Promise(function(E,R){T.onload=E,T.onerror=R}),Mt(x,"link",r),l.instance=x}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(l,n),(n=l.state.preload)&&(l.state.loading&3)===0&&(e.count++,l=li.bind(e),n.addEventListener("load",l),n.addEventListener("error",l))}}var Hc=0;function av(e,n){return e.stylesheets&&e.count===0&&ii(e,e.stylesheets),0<e.count||0<e.imgCount?function(l){var r=setTimeout(function(){if(e.stylesheets&&ii(e,e.stylesheets),e.unsuspend){var x=e.unsuspend;e.unsuspend=null,x()}},6e4+n);0<e.imgBytes&&Hc===0&&(Hc=62500*Ox());var m=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&ii(e,e.stylesheets),e.unsuspend)){var x=e.unsuspend;e.unsuspend=null,x()}},(e.imgBytes>Hc?50:800)+n);return e.unsuspend=l,function(){e.unsuspend=null,clearTimeout(r),clearTimeout(m)}}:null}function li(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ii(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var oi=null;function ii(e,n){e.stylesheets=null,e.unsuspend!==null&&(e.count++,oi=new Map,n.forEach(lv,e),oi=null,li.call(e))}function lv(e,n){if(!(n.state.loading&4)){var l=oi.get(e);if(l)var r=l.get(null);else{l=new Map,oi.set(e,l);for(var m=e.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<m.length;x++){var T=m[x];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(l.set(T.dataset.precedence,T),r=T)}r&&l.set(null,r)}m=n.instance,T=m.getAttribute("data-precedence"),x=l.get(T)||r,x===r&&l.set(null,m),l.set(T,m),this.count++,r=li.bind(this),m.addEventListener("load",r),m.addEventListener("error",r),x?x.parentNode.insertBefore(m,x.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(m,e.firstChild)),n.state.loading|=4}}var Ol={$$typeof:ee,Provider:null,Consumer:null,_currentValue:ue,_currentValue2:ue,_threadCount:0};function ov(e,n,l,r,m,x,T,E,R){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Xa(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xa(0),this.hiddenUpdates=Xa(null),this.identifierPrefix=r,this.onUncaughtError=m,this.onCaughtError=x,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=R,this.incompleteTransitions=new Map}function am(e,n,l,r,m,x,T,E,R,$,ie,pe){return e=new ov(e,n,l,T,R,$,ie,pe,E),n=1,x===!0&&(n|=24),x=Qt(3,null,null,n),e.current=x,x.stateNode=e,n=yr(),n.refCount++,e.pooledCache=n,n.refCount++,x.memoizedState={element:r,isDehydrated:l,cache:n},Nr(x),e}function lm(e){return e?(e=ha,e):ha}function om(e,n,l,r,m,x){m=lm(m),r.context===null?r.context=m:r.pendingContext=m,r=cs(n),r.payload={element:l},x=x===void 0?null:x,x!==null&&(r.callback=x),l=us(e,r,n),l!==null&&(Yt(l,e,n),gl(l,e,n))}function im(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var l=e.retryLane;e.retryLane=l!==0&&l<n?l:n}}function Bc(e,n){im(e,n),(e=e.alternate)&&im(e,n)}function rm(e){if(e.tag===13||e.tag===31){var n=Ls(e,67108864);n!==null&&Yt(n,e,67108864),Bc(e,67108864)}}function cm(e){if(e.tag===13||e.tag===31){var n=nn();n=Qa(n);var l=Ls(e,n);l!==null&&Yt(l,e,n),Bc(e,n)}}var ri=!0;function iv(e,n,l,r){var m=A.T;A.T=null;var x=U.p;try{U.p=2,Vc(e,n,l,r)}finally{U.p=x,A.T=m}}function rv(e,n,l,r){var m=A.T;A.T=null;var x=U.p;try{U.p=8,Vc(e,n,l,r)}finally{U.p=x,A.T=m}}function Vc(e,n,l,r){if(ri){var m=qc(r);if(m===null)_c(e,n,r,ci,l),dm(e,r);else if(uv(m,e,n,l,r))r.stopPropagation();else if(dm(e,r),n&4&&-1<cv.indexOf(e)){for(;m!==null;){var x=je(m);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var T=Rn(x.pendingLanes);if(T!==0){var E=x;for(E.pendingLanes|=2,E.entangledLanes|=2;T;){var R=1<<31-Dt(T);E.entanglements[1]|=R,T&=~R}_n(x),(We&6)===0&&(zo=Gt()+500,Dl(0))}}break;case 31:case 13:E=Ls(x,2),E!==null&&Yt(E,x,2),Yo(),Bc(x,2)}if(x=qc(r),x===null&&_c(e,n,r,ci,l),x===m)break;m=x}m!==null&&r.stopPropagation()}else _c(e,n,r,null,l)}}function qc(e){return e=zi(e),Jc(e)}var ci=null;function Jc(e){if(ci=null,e=ye(e),e!==null){var n=d(e);if(n===null)e=null;else{var l=n.tag;if(l===13){if(e=p(n),e!==null)return e;e=null}else if(l===31){if(e=g(n),e!==null)return e;e=null}else if(l===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null)}}return ci=e,null}function um(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch($a()){case $t:return 2;case Zs:return 8;case Wn:case ea:return 32;case Nn:return 268435456;default:return 32}default:return 32}}var zc=!1,Ss=null,Ts=null,Ns=null,Pl=new Map,Hl=new Map,Es=[],cv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function dm(e,n){switch(e){case"focusin":case"focusout":Ss=null;break;case"dragenter":case"dragleave":Ts=null;break;case"mouseover":case"mouseout":Ns=null;break;case"pointerover":case"pointerout":Pl.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hl.delete(n.pointerId)}}function Bl(e,n,l,r,m,x){return e===null||e.nativeEvent!==x?(e={blockedOn:n,domEventName:l,eventSystemFlags:r,nativeEvent:x,targetContainers:[m]},n!==null&&(n=je(n),n!==null&&rm(n)),e):(e.eventSystemFlags|=r,n=e.targetContainers,m!==null&&n.indexOf(m)===-1&&n.push(m),e)}function uv(e,n,l,r,m){switch(n){case"focusin":return Ss=Bl(Ss,e,n,l,r,m),!0;case"dragenter":return Ts=Bl(Ts,e,n,l,r,m),!0;case"mouseover":return Ns=Bl(Ns,e,n,l,r,m),!0;case"pointerover":var x=m.pointerId;return Pl.set(x,Bl(Pl.get(x)||null,e,n,l,r,m)),!0;case"gotpointercapture":return x=m.pointerId,Hl.set(x,Bl(Hl.get(x)||null,e,n,l,r,m)),!0}return!1}function fm(e){var n=ye(e.target);if(n!==null){var l=d(n);if(l!==null){if(n=l.tag,n===13){if(n=p(l),n!==null){e.blockedOn=n,no(e.priority,function(){cm(l)});return}}else if(n===31){if(n=g(l),n!==null){e.blockedOn=n,no(e.priority,function(){cm(l)});return}}else if(n===3&&l.stateNode.current.memoizedState.isDehydrated){e.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ui(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var l=qc(e.nativeEvent);if(l===null){l=e.nativeEvent;var r=new l.constructor(l.type,l);Ji=r,l.target.dispatchEvent(r),Ji=null}else return n=je(l),n!==null&&rm(n),e.blockedOn=l,!1;n.shift()}return!0}function pm(e,n,l){ui(e)&&l.delete(n)}function dv(){zc=!1,Ss!==null&&ui(Ss)&&(Ss=null),Ts!==null&&ui(Ts)&&(Ts=null),Ns!==null&&ui(Ns)&&(Ns=null),Pl.forEach(pm),Hl.forEach(pm)}function di(e,n){e.blockedOn===n&&(e.blockedOn=null,zc||(zc=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,dv)))}var fi=null;function mm(e){fi!==e&&(fi=e,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){fi===e&&(fi=null);for(var n=0;n<e.length;n+=3){var l=e[n],r=e[n+1],m=e[n+2];if(typeof r!="function"){if(Jc(r||l)===null)continue;break}var x=je(l);x!==null&&(e.splice(n,3),n-=3,qr(x,{pending:!0,data:m,method:l.method,action:r},r,m))}}))}function Pa(e){function n(R){return di(R,e)}Ss!==null&&di(Ss,e),Ts!==null&&di(Ts,e),Ns!==null&&di(Ns,e),Pl.forEach(n),Hl.forEach(n);for(var l=0;l<Es.length;l++){var r=Es[l];r.blockedOn===e&&(r.blockedOn=null)}for(;0<Es.length&&(l=Es[0],l.blockedOn===null);)fm(l),l.blockedOn===null&&Es.shift();if(l=(e.ownerDocument||e).$$reactFormReplay,l!=null)for(r=0;r<l.length;r+=3){var m=l[r],x=l[r+1],T=m[At]||null;if(typeof x=="function")T||mm(l);else if(T){var E=null;if(x&&x.hasAttribute("formAction")){if(m=x,T=x[At]||null)E=T.formAction;else if(Jc(m)!==null)continue}else E=T.action;typeof E=="function"?l[r+1]=E:(l.splice(r,3),r-=3),mm(l)}}}function hm(){function e(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(T){return m=T})},focusReset:"manual",scroll:"manual"})}function n(){m!==null&&(m(),m=null),r||setTimeout(l,20)}function l(){if(!r&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var r=!1,m=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(l,100),function(){r=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),m!==null&&(m(),m=null)}}}function Fc(e){this._internalRoot=e}pi.prototype.render=Fc.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(o(409));var l=n.current,r=nn();om(l,r,e,n,null,null)},pi.prototype.unmount=Fc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;om(e.current,2,null,e,null,null),Yo(),n[es]=null}};function pi(e){this._internalRoot=e}pi.prototype.unstable_scheduleHydration=function(e){if(e){var n=to();e={blockedOn:null,target:e,priority:n};for(var l=0;l<Es.length&&n!==0&&n<Es[l].priority;l++);Es.splice(l,0,e),l===0&&fm(e)}};var gm=t.version;if(gm!=="19.2.3")throw Error(o(527,gm,"19.2.3"));U.findDOMNode=function(e){var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(o(188)):(e=Object.keys(e).join(","),Error(o(268,e)));return e=h(n),e=e!==null?y(e):null,e=e===null?null:e.stateNode,e};var fv={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:A,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mi=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mi.isDisabled&&mi.supportsFiber)try{Zn=mi.inject(fv),wt=mi}catch{}}return ql.createRoot=function(e,n){if(!c(e))throw Error(o(299));var l=!1,r="",m=Nf,x=Ef,T=Cf;return n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(r=n.identifierPrefix),n.onUncaughtError!==void 0&&(m=n.onUncaughtError),n.onCaughtError!==void 0&&(x=n.onCaughtError),n.onRecoverableError!==void 0&&(T=n.onRecoverableError)),n=am(e,1,!1,null,null,l,r,null,m,x,T,hm),e[es]=n.current,Ac(e),new Fc(n)},ql.hydrateRoot=function(e,n,l){if(!c(e))throw Error(o(299));var r=!1,m="",x=Nf,T=Ef,E=Cf,R=null;return l!=null&&(l.unstable_strictMode===!0&&(r=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(x=l.onUncaughtError),l.onCaughtError!==void 0&&(T=l.onCaughtError),l.onRecoverableError!==void 0&&(E=l.onRecoverableError),l.formState!==void 0&&(R=l.formState)),n=am(e,1,!0,n,l??null,r,m,R,x,T,E,hm),n.context=lm(null),l=n.current,r=nn(),r=Qa(r),m=cs(r),m.callback=null,us(l,m,r),l=r,n.current.lanes=l,Ds(n,l),_n(n),e[es]=n.current,Ac(e),new pi(n)},ql.version="19.2.3",ql}var wm;function Tv(){if(wm)return Kc.exports;wm=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(t){console.error(t)}}return s(),Kc.exports=Sv(),Kc.exports}var Nv=Tv();const Ev=dg(Nv);var we=(s=>(s.NOT_STARTED="Not Started",s.IN_PROGRESS="In Progress",s.DONE="Done",s.BLOCKED="Blocked",s.PAUSED="Paused",s))(we||{}),Ee=(s=>(s.LOW="Low",s.MEDIUM="Medium",s.HIGH="High",s.CRITICAL="Critical",s))(Ee||{}),De=(s=>(s.GREEN="green",s.AMBER="amber",s.RED="red",s))(De||{});const ws=[{color:"bg-blue-900",icon:""},{color:"bg-teal-600",icon:""},{color:"bg-orange-500",icon:""},{color:"bg-red-600",icon:""},{color:"bg-slate-900",icon:""},{color:"bg-slate-600",icon:""},{color:"bg-purple-600",icon:""}],vu={[De.GREEN]:{color:"bg-emerald-500",text:"text-emerald-500",border:"border-emerald-200",label:"On Track"},[De.AMBER]:{color:"bg-amber-500",text:"text-amber-500",border:"border-amber-200",label:"At Risk"},[De.RED]:{color:"bg-rose-500",text:"text-rose-500",border:"border-rose-200",label:"Blocked"}},yu={labelClass:"text-xs font-medium text-slate-600 block mb-1.5",inputClass:"w-full bg-white border border-slate-300 rounded-lg px-3 py-2.5 focus:ring-2 focus:ring-teal-500/20 focus:border-teal-500 outline-none text-slate-900 text-sm transition-colors",selectClass:"w-full bg-white border border-slate-300 rounded-lg px-3 py-2.5 focus:ring-2 focus:ring-teal-500/20 focus:border-teal-500 outline-none text-slate-900 text-sm transition-colors"},Am=(s,t)=>{const a=t.toLowerCase();return a.includes("eu")&&a.includes("growth")?ws[0]:a.includes("organic")?ws[1]:a.includes("speed")||a.includes("market")?ws[2]:a.includes("trust")?ws[3]:a.includes("revenue")?ws[4]:a.includes("miscellaneous")||a.includes("misc")?ws[5]:ws[s%ws.length]},Cv=[{id:"1",title:"EU Growth",description:"European market expansion",color:"bg-blue-900",icon:""},{id:"2",title:"Organic Growth",description:"Scaling through word-of-mouth and retention",color:"bg-teal-600",icon:""}],wv=[],$l=s=>{const t=s.toLowerCase();return t.includes("tech")||t.includes("product")?"bg-blue-500":t.includes("marketing")?"bg-purple-500":t.includes("operations")?"bg-emerald-500":t.includes("sales")?"bg-orange-500":t.includes("executive")?"bg-slate-800":"bg-slate-400"},Av={[we.NOT_STARTED]:"bg-slate-100 text-slate-600 border-slate-200",[we.IN_PROGRESS]:"bg-blue-50 text-blue-700 border-blue-200",[we.DONE]:"bg-emerald-50 text-emerald-700 border-emerald-200",[we.BLOCKED]:"bg-rose-50 text-rose-700 border-rose-200",[we.PAUSED]:"bg-amber-50 text-amber-700 border-amber-200"},_v=({items:s,onItemClick:t})=>{var se,ae;const[a,o]=I.useState("Quarter"),[c,d]=I.useState(new Date),[p,g]=I.useState(""),[v,h]=I.useState(""),[y,b]=I.useState(null),[S,N]=I.useState(!1),{uniqueOwners:k,uniqueTeams:w}=I.useMemo(()=>{const A=new Set,U=new Set;return s.forEach(ue=>{ue.owner&&A.add(ue.owner),ue.team&&U.add(ue.team)}),{uniqueOwners:Array.from(A).sort(),uniqueTeams:Array.from(U).sort()}},[s]),M=A=>{const U=new Date,ue=new Date(A.endDate),L=U>ue&&A.status!==we.DONE;return A.status===we.BLOCKED||L},J=I.useMemo(()=>s.filter(A=>{const U=!p||A.owner===p,ue=!v||A.team===v,L=!y||A.priority===y,W=!S||M(A);return U&&ue&&L&&W}),[s,p,v,y,S]),ce=I.useMemo(()=>{const A={};return J.forEach(U=>{A[U.department]||(A[U.department]={teams:{},noTeam:[]}),U.team?(A[U.department].teams[U.team]||(A[U.department].teams[U.team]=[]),A[U.department].teams[U.team].push(U)):A[U.department].noTeam.push(U)}),A},[J]),ee=I.useMemo(()=>Object.keys(ce).sort(),[ce]),P=I.useMemo(()=>{const A=[];let U=0,ue=new Date(c);if(a==="Year"){ue=new Date(c.getFullYear(),0,1),U=12;for(let L=0;L<U;L++){const W=new Date(ue.getFullYear(),ue.getMonth()+L,1);A.push({label:W.toLocaleString("default",{month:"short"}),subLabel:W.getFullYear().toString(),date:W,end:new Date(W.getFullYear(),W.getMonth()+1,0)})}}else if(a==="Quarter"){const L=c.getMonth(),W=Math.floor(L/3)*3;ue=new Date(c.getFullYear(),W,1),U=6;for(let C=0;C<U;C++){const _=new Date(ue.getFullYear(),ue.getMonth()+C,1);A.push({label:_.toLocaleString("default",{month:"long"}),subLabel:_.getFullYear().toString(),date:_,end:new Date(_.getFullYear(),_.getMonth()+1,0)})}}else{ue=new Date(c.getFullYear(),c.getMonth(),1);const L=new Date(ue.getFullYear(),ue.getMonth()+1,0).getDate();for(let W=1;W<=L;W++){const C=new Date(ue.getFullYear(),ue.getMonth(),W);A.push({label:`${W}`,subLabel:C.toLocaleString("default",{weekday:"narrow"}),date:C,end:new Date(C.getFullYear(),C.getMonth(),W,23,59,59)})}}return A},[a,c]),Q=((se=P[0])==null?void 0:se.date)||new Date,H=((ae=P[P.length-1])==null?void 0:ae.end)||new Date,V=H.getTime()-Q.getTime(),q=new Date,X=I.useMemo(()=>q<Q||q>H?null:(q.getTime()-Q.getTime())/V*100,[Q,H,V,q]),fe=(A,U)=>{const ue=new Date(A),L=new Date(U),W=ue<Q?Q:ue,C=L>H?H:L;if(L<Q||ue>H)return{visible:!1,left:"0%",width:"0%"};const _=(W.getTime()-Q.getTime())/V*100,O=(C.getTime()-W.getTime())/V*100;return{left:`${_}%`,width:`${Math.max(.5,O)}%`,visible:!0,isCutLeft:ue<Q,isCutRight:L>H}},F=A=>{const U=new Date(c);a==="Year"?U.setFullYear(U.getFullYear()+A):a==="Quarter"?U.setMonth(U.getMonth()+A*3):U.setMonth(U.getMonth()+A),d(U)},re=A=>{const U=[...A].sort((L,W)=>{const C=new Date(L.startDate).getTime()-new Date(W.startDate).getTime();return C!==0?C:new Date(W.endDate).getTime()-new Date(L.endDate).getTime()}),ue=[];return U.map(L=>{const W=new Date(L.startDate).getTime(),C=new Date(L.endDate).getTime();let _=-1;for(let O=0;O<ue.length;O++)if(ue[O]<W){_=O,ue[O]=C;break}return _===-1&&(_=ue.length,ue.push(C)),{...L,laneIndex:_}})},oe=A=>{const U=new Date,ue=new Date(A.endDate),L=U>ue&&A.status!==we.DONE,W=A.status===we.BLOCKED;let C=`${$l(A.department)} text-white`,_="border border-white/20",O="shadow-sm",z="";switch(A.priority){case Ee.CRITICAL:z="";break;case Ee.HIGH:z="3";break;case Ee.MEDIUM:z="2";break;case Ee.LOW:z="1";break;default:z="2"}return(W||L)&&(_="border-2 border-rose-500",O="shadow-[0_2px_8px_rgba(244,63,94,0.4)]",z=""),A.status===we.DONE&&(C+=" opacity-60 grayscale-[0.5]",_="border border-emerald-300",z=""),{classes:C,border:_,shadow:O,icon:z}};return i.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-300 overflow-hidden flex flex-col h-[700px]",children:[i.jsxs("div",{className:"px-6 py-3 border-b border-slate-300 flex flex-col gap-3 bg-slate-100",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-3",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("h3",{className:"font-display text-sm font-bold text-slate-800 uppercase tracking-widest",children:"Roadmap Timeline"}),i.jsx("div",{className:"flex bg-white p-0.5 rounded-lg border border-slate-300 shadow-sm",children:["Month","Quarter","Year"].map(A=>i.jsx("button",{onClick:()=>o(A),className:`px-3 py-1 text-[10px] font-bold uppercase tracking-wider rounded-md transition-all ${a===A?"bg-teal-600 text-white shadow-sm":"text-slate-500 hover:text-slate-700 hover:bg-slate-100"}`,children:A},A))})]}),i.jsxs("div",{className:"hidden lg:flex items-center gap-2 text-[9px] font-bold uppercase tracking-widest",children:[i.jsxs("button",{onClick:()=>b(y===Ee.CRITICAL?null:Ee.CRITICAL),className:`flex items-center gap-1 px-2 py-1 rounded-lg transition-all cursor-pointer ${y===Ee.CRITICAL?"bg-red-100 text-red-700 ring-2 ring-red-300":"text-slate-500 hover:bg-slate-100"}`,children:[i.jsx("span",{className:"text-sm",children:""})," Critical"]}),i.jsxs("button",{onClick:()=>b(y===Ee.HIGH?null:Ee.HIGH),className:`flex items-center gap-1 px-2 py-1 rounded-lg transition-all cursor-pointer ${y===Ee.HIGH?"bg-orange-100 text-orange-700 ring-2 ring-orange-300":"text-slate-500 hover:bg-slate-100"}`,children:[i.jsx("span",{className:"text-sm",children:"3"})," High"]}),i.jsxs("button",{onClick:()=>b(y===Ee.MEDIUM?null:Ee.MEDIUM),className:`flex items-center gap-1 px-2 py-1 rounded-lg transition-all cursor-pointer ${y===Ee.MEDIUM?"bg-blue-100 text-blue-700 ring-2 ring-blue-300":"text-slate-500 hover:bg-slate-100"}`,children:[i.jsx("span",{className:"text-sm",children:"2"})," Normal"]}),i.jsxs("button",{onClick:()=>b(y===Ee.LOW?null:Ee.LOW),className:`flex items-center gap-1 px-2 py-1 rounded-lg transition-all cursor-pointer ${y===Ee.LOW?"bg-slate-200 text-slate-700 ring-2 ring-slate-400":"text-slate-500 hover:bg-slate-100"}`,children:[i.jsx("span",{className:"text-sm",children:"1"})," Low"]}),i.jsx("div",{className:"w-px h-4 bg-slate-200 mx-1"}),i.jsxs("button",{onClick:()=>N(!S),className:`flex items-center gap-1 px-2 py-1 rounded-lg transition-all cursor-pointer ${S?"bg-rose-100 text-rose-700 ring-2 ring-rose-300":"text-slate-500 hover:bg-slate-100"}`,children:[i.jsx("div",{className:"w-3 h-3 border-2 border-rose-500 rounded bg-rose-50 flex items-center justify-center text-[8px]",children:""})," Blocked/Late"]})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("span",{className:"text-xs font-bold text-slate-700 uppercase tracking-wide",children:[a==="Year"&&c.getFullYear(),a==="Quarter"&&`Q${Math.floor(c.getMonth()/3)+1} ${c.getFullYear()}`,a==="Month"&&c.toLocaleString("default",{month:"long",year:"numeric"})]}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:()=>F(-1),className:"p-1.5 hover:bg-slate-100 rounded-lg text-slate-500 hover:text-slate-700 transition-colors",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),i.jsx("button",{onClick:()=>d(new Date),className:"text-[10px] font-bold uppercase text-teal-600 px-2 hover:bg-teal-50 rounded transition-colors",children:"Today"}),i.jsx("button",{onClick:()=>F(1),className:"p-1.5 hover:bg-slate-100 rounded-lg text-slate-500 hover:text-slate-700 transition-colors",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})})]})]})]}),i.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[i.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Quick Filters:"}),i.jsxs("div",{className:"relative",children:[i.jsxs("select",{value:p,onChange:A=>g(A.target.value),className:"appearance-none bg-white border border-slate-300 rounded-lg px-3 py-1.5 pr-8 text-xs font-medium text-slate-700 focus:border-teal-400 focus:ring-1 focus:ring-teal-100 outline-none cursor-pointer",children:[i.jsx("option",{value:"",children:"All Owners"}),k.map(A=>i.jsx("option",{value:A,children:A},A))]}),i.jsx("svg",{className:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),i.jsxs("div",{className:"relative",children:[i.jsxs("select",{value:v,onChange:A=>h(A.target.value),className:"appearance-none bg-white border border-slate-300 rounded-lg px-3 py-1.5 pr-8 text-xs font-medium text-slate-700 focus:border-teal-400 focus:ring-1 focus:ring-teal-100 outline-none cursor-pointer",children:[i.jsx("option",{value:"",children:"All Teams"}),w.map(A=>i.jsx("option",{value:A,children:A},A))]}),i.jsx("svg",{className:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),(p||v||y||S)&&i.jsx("button",{onClick:()=>{g(""),h(""),b(null),N(!1)},className:"text-[10px] font-bold text-slate-500 hover:text-red-600 uppercase tracking-wider px-2 py-1 hover:bg-red-50 rounded transition-colors",children:"Clear All"}),i.jsxs("span",{className:"text-[10px] text-slate-500 ml-auto",children:[J.length!==s.length?i.jsxs("span",{className:"text-teal-600 font-semibold",children:["Filtered: ",J.length]}):`Showing ${J.length}`," of ",s.length," items"]})]})]}),i.jsx("div",{className:"flex-1 overflow-auto relative custom-scrollbar",children:i.jsxs("div",{className:"min-w-[1000px] h-full flex flex-col",children:[i.jsxs("div",{className:"flex border-b border-slate-300 bg-slate-100 sticky top-0 z-20",children:[i.jsx("div",{className:"w-48 shrink-0 p-3 border-r border-slate-300 bg-white font-bold text-[10px] text-slate-500 uppercase tracking-widest sticky left-0 z-30 shadow-sm",children:"Department / Initiative"}),i.jsxs("div",{className:"flex-1 flex relative",children:[P.map((A,U)=>i.jsxs("div",{className:"flex-1 border-r border-slate-100 p-2 text-center min-w-[40px]",children:[i.jsx("div",{className:"text-[10px] font-bold text-slate-700 uppercase",children:A.label}),i.jsx("div",{className:"text-[9px] font-medium text-slate-500",children:A.subLabel})]},U)),X&&i.jsx("div",{className:"absolute top-0 bottom-0 w-px bg-rose-500 z-10",style:{left:`${X}%`},children:i.jsx("div",{className:"absolute -top-1 -left-1 w-2 h-2 rounded-full bg-rose-500"})})]})]}),i.jsxs("div",{className:"flex-1 relative bg-white",children:[X&&i.jsx("div",{className:"absolute inset-0 pl-48 pointer-events-none z-10",children:i.jsx("div",{className:"absolute top-0 bottom-0 w-px bg-rose-500/30 border-l border-dashed border-rose-500",style:{left:`${X}%`}})}),ee.map(A=>{const U=ce[A];if(!U)return null;const ue=Object.keys(U.teams).length>0,L=Object.keys(U.teams).sort(),W=Object.values(U.teams).flat().length+U.noTeam.length,C=(_,O,z=!1)=>{if(_.length===0)return null;const ne=re(_),xe=Math.max(...ne.map(Se=>Se.laneIndex))+1,ge=Math.max(xe*36+24,80);return i.jsxs("div",{className:`flex border-b border-slate-100 group ${z?"bg-slate-25":""}`,children:[i.jsxs("div",{className:`w-48 shrink-0 p-3 border-r border-slate-300 bg-white sticky left-0 z-10 group-hover:bg-slate-100 transition-colors flex flex-col justify-center ${z?"pl-6":""}`,children:[i.jsxs("div",{className:"flex items-center gap-2",children:[!z&&i.jsx("div",{className:`w-2 h-2 rounded-full ${$l(A)}`}),z&&i.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-300"}),i.jsx("span",{className:`text-xs font-semibold truncate ${z?"text-slate-500":"text-slate-700"}`,children:O})]}),i.jsxs("div",{className:`text-[9px] text-slate-500 mt-0.5 ${z?"pl-3.5":"pl-4"}`,children:[_.length," items"]})]}),i.jsxs("div",{className:"flex-1 relative",style:{height:`${ge}px`},children:[i.jsx("div",{className:"absolute inset-0 flex pointer-events-none",children:P.map((Se,_e)=>i.jsx("div",{className:"flex-1 border-r border-slate-50 h-full"},_e))}),ne.map(Se=>{const _e=fe(Se.startDate,Se.endDate);if(!_e.visible)return null;const{classes:nt,border:G,shadow:he,icon:be}=oe(Se),Pe=Se.owner?Se.owner.split(" ")[0]:"";return i.jsx("div",{onClick:()=>t==null?void 0:t(Se),className:`absolute h-7 rounded-md text-[10px] font-bold px-2 flex items-center overflow-hidden cursor-pointer hover:brightness-110 hover:z-20 transition-all ${nt} ${G} ${he}`,style:{left:_e.left,width:_e.width,top:`${12+Se.laneIndex*36}px`,borderRadius:`${_e.isCutLeft?"0":"6px"} ${_e.isCutRight?"0":"6px"} ${_e.isCutRight?"0":"6px"} ${_e.isCutLeft?"0":"6px"}`},title:`${Se.owner}: ${Se.title} (${Se.startDate} - ${Se.endDate})`,children:i.jsxs("div",{className:"flex items-center gap-1.5 truncate sticky left-0 w-full",children:[be&&i.jsx("span",{className:"shrink-0 text-sm filter drop-shadow-sm",children:be}),Pe&&i.jsx("span",{className:"shrink-0 text-[9px] font-bold opacity-80 bg-white/20 px-1 rounded",children:Pe}),i.jsx("span",{className:"truncate",children:Se.title})]})},Se.id)})]})]},O)};return i.jsxs(fg.Fragment,{children:[!ue&&C([...U.noTeam],A),ue&&i.jsxs(i.Fragment,{children:[U.noTeam.length>0&&C(U.noTeam,A),U.noTeam.length===0&&i.jsxs("div",{className:"flex border-b border-slate-100",children:[i.jsxs("div",{className:"w-48 shrink-0 p-2 border-r border-slate-300 bg-slate-100 sticky left-0 z-10 flex items-center gap-2",children:[i.jsx("div",{className:`w-2 h-2 rounded-full ${$l(A)}`}),i.jsx("span",{className:"text-xs font-semibold text-slate-700",children:A}),i.jsxs("span",{className:"text-[9px] text-slate-500 ml-auto",children:[W," items"]})]}),i.jsx("div",{className:"flex-1 bg-slate-100"})]}),L.map(_=>C(U.teams[_],_,!0))]})]},A)})]})]})})]})},Ni=({item:s,employees:t,onClick:a,onEdit:o,onAddUpdate:c,onPushToHiBob:d,isPushing:p})=>{const[g,v]=I.useState(!1),h=t.find(N=>N.id===s.owner||N.name===s.owner),y=N=>{switch(N){case Ee.CRITICAL:return"bg-red-50 text-red-700 border-red-200";case Ee.HIGH:return"bg-orange-50 text-orange-700 border-orange-200";case Ee.MEDIUM:return"bg-blue-50 text-blue-700 border-blue-200";case Ee.LOW:return"bg-slate-100 text-slate-600 border-slate-300";default:return"bg-slate-100 text-slate-600 border-slate-300"}},b=N=>{switch(N){case we.NOT_STARTED:return"bg-slate-100 text-slate-600 border-slate-300";case we.IN_PROGRESS:return"bg-teal-50 text-teal-700 border-teal-200";case we.DONE:return"bg-emerald-50 text-emerald-700 border-emerald-200";case we.BLOCKED:return"bg-red-50 text-red-700 border-red-200";case we.PAUSED:return"bg-amber-50 text-amber-700 border-amber-200";default:return"bg-slate-100 text-slate-600 border-slate-300"}},S=s.priority===Ee.CRITICAL||s.status===we.BLOCKED;return i.jsxs("div",{className:`
        bg-white rounded-xl p-5 group flex flex-col transition-all duration-200 cursor-pointer
        border hover:shadow-card-hover
        ${S?"border-red-200":g?"border-teal-300":"border-slate-300"}
      `,onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),onClick:()=>a==null?void 0:a(s),children:[i.jsxs("div",{className:"absolute top-3 right-3 flex gap-1.5 z-10",children:[d&&i.jsx("button",{onClick:N=>{N.stopPropagation(),p||d(s)},disabled:p,className:`
              p-1.5 rounded-lg transition-all flex items-center gap-1
              ${p?"bg-slate-100 text-slate-500 cursor-wait":"bg-teal-50 text-teal-600 hover:bg-teal-100 border border-teal-200 hover:border-teal-300"}
            `,title:"Push to HiBob",children:p?i.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"3"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):i.jsxs(i.Fragment,{children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),i.jsx("span",{className:"text-[10px] font-medium hidden sm:inline",children:"HiBob"})]})}),s.jiraId&&i.jsx("a",{href:s.jiraUrl,target:"_blank",rel:"noopener noreferrer",onClick:N=>N.stopPropagation(),className:"p-1.5 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors border border-blue-200",title:"Open in Jira",children:i.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M11.5 2L4.5 4C2.5 6 2 11.5 2 11.5L11.5 21L21 11.5C21 11.5 21.5 6 19.5 4C17.5 2 12.5 2 11.5 2Z"})})}),i.jsx("button",{onClick:N=>{N.stopPropagation(),o==null||o(s)},className:`
            p-1.5 rounded-lg transition-all border
            ${g?"bg-slate-100 text-slate-700 border-slate-300":"bg-slate-100 text-slate-500 border-slate-300 hover:bg-slate-100 hover:text-slate-600"}
          `,children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})})]}),i.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[i.jsx("div",{className:`w-1 h-8 rounded-full ${$l(s.department)} shrink-0`}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 mb-2",children:[i.jsx("span",{className:`text-[10px] font-medium px-2 py-0.5 rounded-full border ${y(s.priority)}`,children:s.priority}),i.jsx("span",{className:`text-[10px] font-medium px-2 py-0.5 rounded-full border ${b(s.status)}`,children:s.status}),s.team&&i.jsx("span",{className:"text-[10px] text-slate-500 truncate max-w-[80px]",children:s.team})]}),i.jsx("h3",{className:`
            text-sm font-semibold text-slate-900 leading-snug transition-colors
            ${g?"text-teal-600":""}
          `,children:s.title})]})]}),i.jsx("p",{className:"text-sm text-slate-500 leading-relaxed line-clamp-2 mb-3 flex-1",children:s.description}),s.progress>0&&i.jsxs("div",{className:"mb-3",children:[i.jsxs("div",{className:"flex items-center justify-between mb-1",children:[i.jsx("span",{className:"text-xs text-slate-500",children:"Progress"}),i.jsxs("span",{className:"text-xs font-medium text-teal-600",children:[s.progress,"%"]})]}),i.jsx("div",{className:"h-1.5 bg-slate-100 rounded-full overflow-hidden",children:i.jsx("div",{className:"h-full bg-teal-500 rounded-full transition-all duration-300",style:{width:`${s.progress}%`}})})]}),i.jsxs("div",{className:"pt-3 border-t border-slate-100 flex justify-between items-center",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("img",{src:(h==null?void 0:h.avatarUrl)||`https://ui-avatars.com/api/?name=${encodeURIComponent(s.owner)}&background=f1f5f9&color=475569`,alt:(h==null?void 0:h.name)||"Owner",className:"w-6 h-6 rounded-full border border-slate-300 object-cover",title:(h==null?void 0:h.name)||s.owner}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"text-xs font-medium text-slate-700 leading-none",children:(h==null?void 0:h.name)||s.owner}),i.jsxs("span",{className:"text-[10px] text-slate-500 leading-none mt-0.5 flex items-center gap-1",children:[i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),new Date(s.endDate).toLocaleDateString(void 0,{month:"short",day:"numeric"})]})]})]}),c&&i.jsx("button",{onClick:N=>{N.stopPropagation(),c(s)},className:`
              text-xs font-medium px-2.5 py-1 rounded-lg transition-all
              ${g?"bg-teal-50 text-teal-600 opacity-100":"opacity-0"}
            `,children:"+ Update"})]})]})},Rv=({currentUser:s,goal:t,updates:a,onAddUpdate:o,onEditUpdate:c})=>{const[d,p]=I.useState("all"),g=a.filter(y=>d==="all"||y.status===d).sort((y,b)=>{const S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return y.year!==b.year?b.year-y.year:S.indexOf(b.month)-S.indexOf(y.month)}),v=y=>{switch(y){case De.GREEN:return"bg-emerald-500";case De.AMBER:return"bg-amber-500";case De.RED:return"bg-rose-500";default:return"bg-slate-400"}},h=y=>{switch(y){case De.GREEN:return"On Track";case De.AMBER:return"At Risk";case De.RED:return"Blocked";default:return"Unknown"}};return i.jsxs("div",{className:"bg-slate-100 rounded-b-3xl border-x border-b border-slate-300 p-8 space-y-8 animate-in slide-in-from-top-4 duration-300",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 border-b border-slate-300 pb-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("h3",{className:"text-sm font-black text-slate-900 uppercase tracking-widest",children:"Strategy Log"}),i.jsx("div",{className:"flex gap-1 bg-white p-1 rounded-lg border border-slate-300 shadow-sm",children:[{id:"all",label:"All",color:"bg-slate-400"},{id:De.GREEN,label:"Green",color:"bg-emerald-500"},{id:De.AMBER,label:"Amber",color:"bg-amber-500"},{id:De.RED,label:"Red",color:"bg-rose-500"}].map(y=>i.jsxs("button",{onClick:()=>p(y.id),className:`px-3 py-1 rounded-md text-[9px] font-bold uppercase tracking-wider transition-all flex items-center gap-1.5 ${d===y.id?"bg-teal-600 text-white shadow-md":"text-slate-500 hover:text-slate-700 hover:bg-slate-100"}`,children:[i.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${y.color}`}),y.label]},y.id))})]}),i.jsx("button",{onClick:o,className:"bg-white border border-slate-300 px-6 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest shadow-sm hover:shadow-md hover:border-indigo-200 transition-all text-slate-700",children:"+ Post Update"})]}),i.jsx("div",{className:"space-y-6 max-h-[500px] overflow-y-auto pr-4 no-scrollbar",children:g.length>0?g.map(y=>i.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-slate-100 flex gap-6 relative group hover:border-indigo-100 transition-colors",children:[s&&c&&(s.accessLevel==="Admin"||s.id===y.authorId)&&i.jsx("button",{onClick:()=>c(y),className:"absolute top-4 right-4 p-1.5 bg-slate-100 rounded-lg text-slate-500 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-indigo-50 hover:text-indigo-600",title:"Edit Update",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"text-xs font-black text-slate-900 uppercase leading-none",children:y.month}),i.jsx("div",{className:"text-[10px] font-bold text-slate-500 mt-1",children:y.year}),i.jsx("div",{className:"flex-1 w-px bg-slate-100 my-4"}),i.jsx("div",{className:`w-4 h-4 rounded-full ring-4 ring-white shadow-md ${v(y.status)}`})]}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsx("div",{className:`text-[9px] font-black uppercase tracking-widest px-2 py-0.5 rounded-full text-white ${v(y.status)}`,children:h(y.status)}),i.jsxs("div",{className:"text-[9px] font-bold text-slate-300 uppercase italic",children:["Posted ",new Date(y.createdAt).toLocaleDateString()]})]}),i.jsx("p",{className:"text-sm text-slate-600 font-medium leading-relaxed whitespace-pre-wrap",children:y.content})]})]},y.id)):i.jsxs("div",{className:"text-center py-20 bg-white/50 rounded-2xl border-2 border-dashed border-slate-300 flex flex-col items-center justify-center gap-4",children:[i.jsx("div",{className:"w-16 h-16 bg-white rounded-full flex items-center justify-center text-3xl shadow-sm border border-slate-100",children:""}),i.jsxs("div",{children:[i.jsx("p",{className:"text-slate-500 font-bold uppercase tracking-widest text-xs",children:"No strategic updates logged"}),i.jsx("p",{className:"text-slate-500 text-[10px] mt-2 max-w-sm mx-auto leading-relaxed",children:"The Strategy Feed allows leadership to post high-level monthly summaries, RAG status changes, and executive commentary directly to this Big Rock."})]}),d==="all"&&i.jsx("button",{onClick:o,className:"bg-indigo-600 text-white px-6 py-3 rounded-xl text-[10px] font-black uppercase tracking-widest shadow-lg shadow-indigo-200 hover:bg-indigo-700 transition-all mt-2",children:"Log First Update"})]})})]})},Iv=({selectedPriorities:s,setSelectedPriorities:t,selectedStatuses:a,setSelectedStatuses:o,isFocusMode:c,toggleFocusMode:d})=>{const p=y=>{s.includes(y)?t(s.filter(b=>b!==y)):t([...s,y])},g=y=>{a.includes(y)?o(a.filter(b=>b!==y)):o([...a,y])},v=(y,b)=>{const S="border transition-all";if(!b)return`${S} bg-white border-slate-300 text-slate-500 hover:border-slate-300 hover:text-slate-500`;switch(y){case Ee.CRITICAL:return`${S} bg-red-50 border-red-200 text-red-700`;case Ee.HIGH:return`${S} bg-orange-50 border-orange-200 text-orange-700`;case Ee.MEDIUM:return`${S} bg-blue-50 border-blue-200 text-blue-700`;case Ee.LOW:return`${S} bg-slate-100 border-slate-300 text-slate-600`;default:return""}},h=(y,b)=>{const S="border transition-all";if(!b)return`${S} bg-white border-slate-300 text-slate-500 hover:border-slate-300 hover:text-slate-500`;switch(y){case we.NOT_STARTED:return`${S} bg-slate-100 border-slate-300 text-slate-600`;case we.IN_PROGRESS:return`${S} bg-teal-50 border-teal-200 text-teal-700`;case we.DONE:return`${S} bg-emerald-50 border-emerald-200 text-emerald-700`;case we.BLOCKED:return`${S} bg-red-50 border-red-200 text-red-700`;case we.PAUSED:return`${S} bg-amber-50 border-amber-200 text-amber-700`;default:return""}};return i.jsxs("div",{className:"flex flex-wrap items-center gap-2 p-2 bg-white rounded-lg border border-slate-300 w-fit",children:[i.jsxs("button",{onClick:d,className:`
          flex items-center gap-2 px-3 py-1.5 rounded-md text-xs font-medium transition-colors
          ${c?"bg-teal-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}
        `,children:[i.jsx("span",{className:`w-2 h-2 rounded-full ${c?"bg-white":"bg-slate-400"}`}),"Focus"]}),i.jsx("div",{className:"w-px h-5 bg-slate-200 mx-1 hidden sm:block"}),i.jsx("div",{className:"flex items-center gap-1",children:Object.values(Ee).map(y=>i.jsx("button",{onClick:()=>!c&&p(y),disabled:c,className:`
              px-2.5 py-1 rounded-md text-[10px] font-medium
              ${v(y,s.includes(y))}
              ${c?"opacity-40 cursor-not-allowed":""}
            `,children:y},y))}),i.jsx("div",{className:"w-px h-5 bg-slate-200 mx-1 hidden sm:block"}),i.jsx("div",{className:"flex items-center gap-1",children:Object.values(we).map(y=>i.jsx("button",{onClick:()=>!c&&g(y),disabled:c,className:`
              px-2.5 py-1 rounded-md text-[10px] font-medium
              ${h(y,a.includes(y))}
              ${c?"opacity-40 cursor-not-allowed":""}
            `,children:y},y))})]})},Mv=({currentUser:s,goals:t,items:a,employees:o,updates:c,onEditGoal:d,onAddGoal:p,onEditItem:g,onAddUpdate:v,onEditUpdate:h,onViewHistory:y,onPushToHiBob:b,pushingItems:S})=>{const[N,k]=I.useState({}),[w,M]=I.useState({}),[J,ce]=I.useState(!1),[ee,P]=I.useState(Object.values(Ee)),[Q,H]=I.useState(Object.values(we)),V=()=>{J?(P(Object.values(Ee)),H(Object.values(we)),ce(!1)):(P([Ee.CRITICAL,Ee.HIGH]),H([we.BLOCKED,we.IN_PROGRESS]),ce(!0))},q=ae=>{M(A=>({...A,[ae]:A[ae]!==!0}))},X=I.useMemo(()=>a.filter(ae=>{if(J){const A=ae.priority===Ee.CRITICAL||ae.priority===Ee.HIGH,U=ae.status===we.BLOCKED;return A||U}return!(!ee.includes(ae.priority)||!Q.includes(ae.status))}),[a,J,ee,Q]),fe=I.useMemo(()=>{const ae=new Set;return X.forEach(A=>ae.add(A.department)),Array.from(ae).sort()},[X]),F=(ae,A)=>{k(U=>({...U,[ae]:A}))},re=ae=>{const A=c.filter(U=>U.goalId===ae);return A.length===0?null:A.sort((U,ue)=>new Date(ue.createdAt).getTime()-new Date(U.createdAt).getTime())[0].status},oe=(ae,A)=>{const U=A.toLowerCase();if(U.includes("eu")&&U.includes("growth"))return"bg-blue-900";if(U.includes("organic"))return"bg-teal-600";if(U.includes("speed")||U.includes("market"))return"bg-orange-500";if(U.includes("trust"))return"bg-red-600";if(U.includes("revenue"))return"bg-slate-900";if(U.includes("miscellaneous")||U.includes("misc"))return"bg-slate-600";const ue=["bg-blue-900","bg-teal-600","bg-orange-500","bg-red-600","bg-slate-900","bg-slate-600"];return ue[ae%ue.length]},se=ae=>{const A=ae.toLowerCase();return A.includes("eu")&&A.includes("growth")?"":A.includes("organic")?"":A.includes("speed")||A.includes("market")?"":A.includes("trust")?"":A.includes("revenue")?"":A.includes("miscellaneous")||A.includes("misc")?"":""};return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col-reverse md:flex-row justify-between items-start md:items-center gap-4",children:[i.jsx(Iv,{selectedPriorities:ee,setSelectedPriorities:P,selectedStatuses:Q,setSelectedStatuses:H,isFocusMode:J,toggleFocusMode:V}),p&&i.jsxs("button",{onClick:p,className:"bg-teal-600 hover:bg-teal-700 text-white px-4 py-2.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",children:[i.jsx("span",{className:"text-lg leading-none",children:"+"})," New Big Rock"]})]}),i.jsx("div",{className:"space-y-6",children:t.length>0?t.map((ae,A)=>{const U=X.filter(O=>O.goalId===ae.id),ue=a.filter(O=>O.goalId===ae.id).length,L=c.filter(O=>O.goalId===ae.id),W=N[ae.id]||"initiatives",C=re(ae.id),_=w[ae.id]!==!0;return i.jsxs("div",{className:"bg-white rounded-xl border border-slate-300 overflow-hidden shadow-card",children:[i.jsxs("div",{className:`${oe(A,ae.title)} p-5 cursor-pointer relative overflow-hidden`,onClick:()=>q(ae.id),children:[i.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-[80px] opacity-10 pointer-events-none select-none",children:se(ae.title)}),i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("button",{onClick:O=>{O.stopPropagation(),q(ae.id)},className:"p-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors",children:i.jsx("svg",{className:`w-4 h-4 text-white transition-transform ${_?"-rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("h2",{className:"text-lg font-semibold text-white",children:ae.title}),C&&i.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${vu[C].color} border border-white/50`})]}),!_&&i.jsx("p",{className:"text-white/80 text-sm max-w-2xl",children:ae.description})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[d&&!_&&i.jsx("button",{onClick:O=>{O.stopPropagation(),d(ae)},className:"text-xs font-medium bg-white/20 hover:bg-white/30 px-3 py-1.5 rounded-lg text-white transition-colors",children:"Edit"}),!_&&i.jsxs("div",{className:"flex bg-white/20 p-1 rounded-lg",onClick:O=>O.stopPropagation(),children:[i.jsxs("button",{onClick:()=>F(ae.id,"initiatives"),className:`
                            px-3 py-1.5 rounded-md text-xs font-medium transition-colors flex items-center gap-1.5
                            ${W==="initiatives"?"bg-white text-slate-900":"text-white/80 hover:text-white"}
                          `,children:["Initiatives",i.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] ${W==="initiatives"?"bg-slate-100":"bg-white/20"}`,children:J?U.length:ue})]}),i.jsxs("button",{onClick:()=>F(ae.id,"updates"),className:`
                            px-3 py-1.5 rounded-md text-xs font-medium transition-colors flex items-center gap-1.5
                            ${W==="updates"?"bg-white text-slate-900":"text-white/80 hover:text-white"}
                          `,children:["Updates",i.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] ${W==="updates"?"bg-slate-100":"bg-white/20"}`,children:L.length})]})]}),_&&i.jsxs("span",{className:"text-xs bg-white/20 px-2.5 py-1 rounded-lg text-white",children:[ue," Items"]})]})]})]}),!_&&i.jsx("div",{className:"bg-slate-100 border-t border-slate-300",children:W==="initiatives"?i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 divide-x divide-slate-200",children:fe.length>0?fe.map(O=>{const z=U.filter(ne=>ne.department===O);return z.length===0?null:i.jsxs("div",{className:"p-5 min-h-[180px]",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${$l(O)}`}),i.jsx("h3",{className:"text-xs font-semibold text-slate-600 uppercase tracking-wide",children:O}),i.jsx("span",{className:"ml-auto text-xs text-slate-500",children:z.length})]}),i.jsx("div",{className:"space-y-3",children:z.map(ne=>i.jsx(Ni,{item:ne,employees:o,onEdit:g,onClick:y,onAddUpdate:v?()=>y==null?void 0:y(ne):void 0,onPushToHiBob:b,isPushing:S==null?void 0:S.has(ne.id)},ne.id))})]},O)}):i.jsxs("div",{className:"col-span-full p-12 text-center",children:[i.jsx("div",{className:"w-12 h-12 mx-auto mb-3 bg-slate-100 rounded-xl flex items-center justify-center",children:i.jsx("svg",{className:"w-6 h-6 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),i.jsx("p",{className:"text-slate-500",children:"No initiatives linked yet"})]})}):i.jsx(Rv,{currentUser:s,goal:ae,updates:L,onAddUpdate:()=>v==null?void 0:v(ae),onEditUpdate:h})})]},ae.id)}):i.jsxs("div",{className:"text-center py-16 bg-white rounded-xl border-2 border-dashed border-slate-300",children:[i.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-slate-100 rounded-xl flex items-center justify-center",children:i.jsx("svg",{className:"w-8 h-8 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),i.jsx("p",{className:"text-lg text-slate-700 font-semibold mb-1",children:"No Big Rocks Found"}),i.jsx("p",{className:"text-slate-500 mb-4",children:"Create your first strategic goal to get started"}),p&&i.jsx("button",{onClick:p,className:"bg-teal-600 hover:bg-teal-700 text-white px-6 py-2.5 rounded-lg text-sm font-medium transition-colors",children:"Create First Rock"})]})})]})},Dv=({employee:s,items:t,statFilter:a,onStatFilterChange:o})=>{const[c,d]=I.useState(localStorage.getItem(`omnimap_mission_${s.id}`)||""),[p,g]=I.useState(!1),v=t.filter(S=>S.status===we.IN_PROGRESS).length,h=t.filter(S=>S.status===we.DONE).length,y=t.filter(S=>S.status===we.BLOCKED).length,b=()=>{localStorage.setItem(`omnimap_mission_${s.id}`,c),g(!1)};return i.jsx("div",{className:"bg-white rounded-xl border border-slate-300 p-6 mb-8 shadow-sm",children:i.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 items-start lg:items-center",children:[i.jsxs("div",{className:"flex items-center gap-4 shrink-0",children:[i.jsx("div",{className:"relative",children:s.avatarUrl?i.jsx("img",{src:s.avatarUrl,alt:s.name,className:"w-16 h-16 rounded-xl object-cover border border-slate-300"}):i.jsx("div",{className:"w-16 h-16 rounded-xl bg-slate-100 border border-slate-300 flex items-center justify-center text-lg font-bold text-slate-600",children:s.name.split(" ").map(S=>S[0]).join("").substring(0,2)})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-xl font-semibold text-slate-900 mb-1",children:s.name}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("span",{className:"text-xs px-2.5 py-1 rounded-full bg-slate-100 text-slate-600 font-medium",children:s.role}),i.jsx("span",{className:"text-xs px-2.5 py-1 rounded-full bg-slate-100 text-slate-600 font-medium",children:s.department}),i.jsx("span",{className:`
                text-xs px-2.5 py-1 rounded-full font-medium
                ${s.accessLevel==="Admin"?"bg-purple-50 text-purple-700":s.accessLevel==="Manager"?"bg-blue-50 text-blue-700":"bg-slate-100 text-slate-600"}
              `,children:s.accessLevel})]})]})]}),i.jsx("div",{className:"hidden lg:block w-px h-16 bg-slate-200"}),i.jsxs("div",{className:"flex-1 w-full min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("svg",{className:"w-4 h-4 text-teal-600",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"})}),i.jsx("label",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Current Focus"})]}),p?i.jsx("textarea",{autoFocus:!0,className:"w-full bg-slate-100 border border-slate-300 rounded-lg p-3 text-sm text-slate-900 placeholder-slate-400 outline-none focus:ring-2 focus:ring-teal-500/20 focus:border-teal-500 resize-none",rows:2,placeholder:"What is your primary objective right now?",value:c,onChange:S=>d(S.target.value),onBlur:b,onKeyDown:S=>{S.key==="Enter"&&b()}}):i.jsx("div",{onClick:()=>g(!0),className:"cursor-pointer p-2 -ml-2 rounded-lg hover:bg-slate-100 transition-colors",children:i.jsx("p",{className:`text-base leading-relaxed ${c?"text-slate-700":"text-slate-500 italic"}`,children:c?`"${c}"`:"Click to set your primary focus..."})})]}),i.jsxs("div",{className:"flex gap-2 shrink-0",children:[y>0&&i.jsxs("button",{onClick:()=>o(a==="blocked"?"all":"blocked"),className:`
                flex flex-col items-center justify-center rounded-xl p-4 min-w-[80px] transition-all cursor-pointer
                ${a==="blocked"?"bg-red-500 border-2 border-red-600 shadow-lg scale-105":"bg-red-50 border border-red-100 hover:border-red-300 hover:shadow-md"}
              `,children:[i.jsx("span",{className:`text-2xl font-bold leading-none mb-1 ${a==="blocked"?"text-white":"text-red-600"}`,children:y}),i.jsx("span",{className:`text-[10px] font-medium uppercase ${a==="blocked"?"text-red-100":"text-red-500"}`,children:"Blocked"})]}),i.jsxs("button",{onClick:()=>o(a==="active"?"all":"active"),className:`
              flex flex-col items-center justify-center rounded-xl p-4 min-w-[80px] transition-all cursor-pointer
              ${a==="active"?"bg-teal-500 border-2 border-teal-600 shadow-lg scale-105":"bg-teal-50 border border-teal-100 hover:border-teal-300 hover:shadow-md"}
            `,children:[i.jsx("span",{className:`text-2xl font-bold leading-none mb-1 ${a==="active"?"text-white":"text-teal-600"}`,children:v}),i.jsx("span",{className:`text-[10px] font-medium uppercase ${a==="active"?"text-teal-100":"text-teal-500"}`,children:"Active"})]}),i.jsxs("button",{onClick:()=>o(a==="done"?"all":"done"),className:`
              flex flex-col items-center justify-center rounded-xl p-4 min-w-[80px] transition-all cursor-pointer
              ${a==="done"?"bg-emerald-500 border-2 border-emerald-600 shadow-lg scale-105":"bg-emerald-50 border border-emerald-100 hover:border-emerald-300 hover:shadow-md"}
            `,children:[i.jsx("span",{className:`text-2xl font-bold leading-none mb-1 ${a==="done"?"text-white":"text-emerald-600"}`,children:h}),i.jsx("span",{className:`text-[10px] font-medium uppercase ${a==="done"?"text-emerald-100":"text-emerald-500"}`,children:"Done"})]})]})]})})},bi=({employee:s,items:t,goals:a,employees:o,allItems:c,isExpanded:d,onToggle:p,expandedSet:g,onToggleAny:v,onEditItem:h,onViewHistory:y,onPushToHiBob:b,pushingItems:S,depth:N=0,getEmployeeItems:k})=>{const w=t.filter(V=>V.status===we.BLOCKED).length,M=t.filter(V=>V.status===we.IN_PROGRESS).length,J=t.filter(V=>V.status===we.DONE).length,ce=o.filter(V=>V.reportsTo===s.id||V.reportsTo===s.name||V.reportsTo&&V.reportsTo.toLowerCase()===s.name.toLowerCase()),ee=ce.length>0,P=s.accessLevel==="Manager"||ee,Q=(V,q=new Set)=>{if(q.has(V.id))return{blocked:0,active:0,done:0,total:0};q.add(V.id);const X=k(V),fe={blocked:X.filter(re=>re.status===we.BLOCKED).length,active:X.filter(re=>re.status===we.IN_PROGRESS).length,done:X.filter(re=>re.status===we.DONE).length,total:X.length};return o.filter(re=>re.reportsTo===V.id||re.reportsTo===V.name||re.reportsTo&&re.reportsTo.toLowerCase()===V.name.toLowerCase()).forEach(re=>{const oe=Q(re,q);fe.blocked+=oe.blocked,fe.active+=oe.active,fe.done+=oe.done,fe.total+=oe.total}),fe},H=P?Q(s,new Set):null;return i.jsxs("div",{className:N>0?"ml-6 border-l-2 border-slate-100":"",children:[i.jsxs("div",{onClick:p,className:`
          flex items-center gap-4 p-3 cursor-pointer transition-all
          ${N>0?"pl-4":""}
          ${d?"bg-slate-100":"hover:bg-slate-100"}
          ${P?"border-l-2 border-l-blue-400":""}
        `,children:[i.jsx("button",{className:"p-1 hover:bg-slate-200 rounded transition-colors",onClick:V=>{V.stopPropagation(),p()},children:i.jsx("svg",{className:`w-4 h-4 text-slate-500 transition-transform ${d?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})}),s.avatarUrl?i.jsx("img",{src:s.avatarUrl,className:"w-9 h-9 rounded-full object-cover border border-slate-300",alt:""}):i.jsx("div",{className:"w-9 h-9 rounded-full bg-slate-100 border border-slate-300 flex items-center justify-center text-xs font-bold text-slate-600",children:s.name.split(" ").map(V=>V[0]).join("").substring(0,2)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-medium text-slate-900 truncate",children:s.name}),P&&i.jsx("span",{className:"text-[10px] font-medium text-blue-600 bg-blue-50 px-1.5 py-0.5 rounded",children:"MGR"}),ee&&i.jsxs("span",{className:"text-[10px] text-slate-500",children:["(",ce.length," direct",ce.length>1?"s":"",")"]})]}),i.jsx("span",{className:"text-xs text-slate-500",children:s.role})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[w>0&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500"}),i.jsx("span",{className:"text-xs font-medium text-red-600",children:w})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 rounded-full bg-teal-500"}),i.jsx("span",{className:"text-xs font-medium text-teal-600",children:M})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500"}),i.jsx("span",{className:"text-xs font-medium text-emerald-600",children:J})]}),P&&H&&H.total>t.length&&i.jsxs("div",{className:"ml-2 pl-2 border-l border-slate-300 flex items-center gap-2",children:[i.jsx("span",{className:"text-[10px] text-slate-500 uppercase",children:"Team:"}),H.blocked>0&&i.jsxs("span",{className:"text-xs font-medium text-red-600",children:[H.blocked,"!"]}),i.jsxs("span",{className:"text-xs text-slate-500",children:[H.total," goals"]})]})]})]}),d&&i.jsxs("div",{className:`${N>0?"pl-4":""} pb-2`,children:[t.length>0&&i.jsx("div",{className:"pl-10 pr-4 py-3",children:i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:a&&a.map(V=>{if(!V)return null;const q=t.filter(X=>X.goalId===V.id);return q.length===0?null:i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-slate-100",children:[V.icon&&i.jsx("span",{className:"text-sm opacity-60",children:V.icon}),i.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide truncate",children:V.title||"Untitled"}),i.jsx("span",{className:"text-xs text-slate-500 ml-auto",children:q.length})]}),i.jsx("div",{className:"space-y-2",children:q.map(X=>i.jsx(Ni,{item:X,employees:o,onEdit:h,onClick:y,onPushToHiBob:b,isPushing:S==null?void 0:S.has(X.id)},X.id))})]},V.id)})})}),ee&&i.jsx("div",{className:"mt-2",children:ce.map(V=>i.jsx(bi,{employee:V,items:k(V),goals:a,employees:o,allItems:c,isExpanded:g.has(V.id),onToggle:()=>v(V.id),expandedSet:g,onToggleAny:v,onEditItem:h,onViewHistory:y,onPushToHiBob:b,pushingItems:S,depth:N+1,getEmployeeItems:k},V.id))})]})]})},kv=({currentUser:s,items:t,goals:a,employees:o,onEditItem:c,onAddItem:d,onViewHistory:p,onPushToHiBob:g,pushingItems:v})=>{const[h,y]=I.useState("ALL"),[b,S]=I.useState(""),[N,k]=I.useState("all"),[w,M]=I.useState(new Set([s.id])),[J,ce]=I.useState(new Set),ee=(se,ae)=>{const A=se.toLowerCase().trim(),U=ae.toLowerCase().trim();return A===U||A.includes(U)||U.includes(A)},P=se=>t.filter(ae=>ae.owner===se.id||ee(ae.owner,se.name)),Q=I.useMemo(()=>{let se=t.filter(ae=>ae.owner===s.id||ee(ae.owner,s.name));return N==="blocked"&&(se=se.filter(ae=>ae.status===we.BLOCKED)),N==="active"&&(se=se.filter(ae=>ae.status===we.IN_PROGRESS)),N==="done"&&(se=se.filter(ae=>ae.status===we.DONE)),se},[t,s,N]),H=I.useMemo(()=>t.filter(se=>se.owner===s.id||ee(se.owner,s.name)),[t,s]),V=I.useMemo(()=>Array.from(new Set(o.map(se=>se.department))).sort(),[o]),q=se=>{const ae=new Set(w);ae.has(se)?ae.delete(se):ae.add(se),M(ae)},X=se=>{const ae=new Set(J);ae.has(se)?ae.delete(se):ae.add(se),ce(ae)},{myTeamMembers:fe,myTeamManagers:F,othersByDept:re}=I.useMemo(()=>{if(s.accessLevel==="IC")return{myTeamMembers:[],myTeamManagers:[],othersByDept:{}};const se=o.filter(C=>C.id!==s.id&&(C.reportsTo===s.id||C.reportsTo===s.name||C.reportsTo&&C.reportsTo.toLowerCase()===s.name.toLowerCase())),ae=C=>{const _=o.filter(z=>z.id!==C.id&&(z.reportsTo===C.id||z.reportsTo===C.name||z.reportsTo&&z.reportsTo.toLowerCase()===C.name.toLowerCase()));let O=[..._];return _.forEach(z=>{O=[...O,...ae(z)]}),O};if(se.length>0){const C=new Set;se.forEach(ge=>{C.add(ge.id),ae(ge).forEach(Se=>C.add(Se.id))});let _=o.filter(ge=>ge.id!==s.id&&!C.has(ge.id));if(h!=="ALL"&&(_=_.filter(ge=>ge.department===h)),b){const ge=b.toLowerCase();_=_.filter(Se=>Se.name.toLowerCase().includes(ge)||Se.role.toLowerCase().includes(ge))}const O={};_.forEach(ge=>{O[ge.department]||(O[ge.department]=[]),O[ge.department].push(ge)});let z=se;if(b){const ge=b.toLowerCase();z=se.filter(Se=>Se.name.toLowerCase().includes(ge)||Se.role.toLowerCase().includes(ge))}const ne=z.filter(ge=>ge.accessLevel==="Manager"||ae(ge).length>0);return{myTeamMembers:z.filter(ge=>ge.accessLevel!=="Manager"&&ae(ge).length===0),myTeamManagers:ne,othersByDept:O}}let A=o.filter(C=>C.id!==s.id&&C.department===s.department);if(b){const C=b.toLowerCase();A=A.filter(_=>_.name.toLowerCase().includes(C)||_.role.toLowerCase().includes(C))}const U=A.filter(C=>C.accessLevel==="Manager"),ue=A.filter(C=>C.accessLevel!=="Manager");let L=o.filter(C=>C.id!==s.id&&C.department!==s.department);if(h!=="ALL"&&(L=L.filter(C=>C.department===h)),b){const C=b.toLowerCase();L=L.filter(_=>_.name.toLowerCase().includes(C)||_.role.toLowerCase().includes(C))}const W={};return L.forEach(C=>{W[C.department]||(W[C.department]=[]),W[C.department].push(C)}),{myTeamMembers:ue,myTeamManagers:U,othersByDept:W}},[o,s,h,b]),oe=I.useMemo(()=>{const se=[...F,...fe],ae=L=>{let W=[];return L.forEach(C=>{W.push(C);const _=o.filter(O=>O.reportsTo===C.id||O.reportsTo===C.name||O.reportsTo&&O.reportsTo.toLowerCase()===C.name.toLowerCase());W=[...W,...ae(_)]}),W},A=ae(se),U=Array.from(new Map(A.map(L=>[L.id,L])).values()),ue=U.flatMap(L=>P(L));return{people:U.length,total:ue.length,blocked:ue.filter(L=>L.status===we.BLOCKED).length,active:ue.filter(L=>L.status===we.IN_PROGRESS).length,done:ue.filter(L=>L.status===we.DONE).length}},[F,fe,o,t]);return i.jsxs("div",{className:"pb-12",children:[i.jsx(Dv,{employee:s,items:H,statFilter:N,onStatFilterChange:k}),H.length>0&&i.jsxs("div",{className:"mb-8 bg-white rounded-xl border border-slate-300 overflow-hidden shadow-sm",children:[i.jsxs("div",{className:"px-5 py-4 bg-gradient-to-r from-teal-50 to-cyan-50 border-b border-slate-300 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-teal-100 rounded-lg",children:i.jsx("svg",{className:"w-5 h-5 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-base font-semibold text-slate-900",children:"My Goals"}),i.jsxs("p",{className:"text-xs text-slate-500",children:[H.length," goal",H.length!==1?"s":""," assigned to you"]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[N!=="all"&&i.jsxs("button",{onClick:()=>k("all"),className:"text-xs text-slate-500 hover:text-slate-700 flex items-center gap-1 mr-2",children:[i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),"Clear"]}),i.jsx("span",{className:"text-[10px] text-slate-500 uppercase tracking-wide mr-1",children:"Show:"}),i.jsx("button",{onClick:()=>k("all"),className:`text-xs px-2.5 py-1 rounded-full font-medium transition-all ${N==="all"?"bg-slate-800 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"All"}),i.jsx("button",{onClick:()=>k(N==="active"?"all":"active"),className:`text-xs px-2.5 py-1 rounded-full font-medium transition-all ${N==="active"?"bg-teal-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Active"}),i.jsx("button",{onClick:()=>k(N==="blocked"?"all":"blocked"),className:`text-xs px-2.5 py-1 rounded-full font-medium transition-all ${N==="blocked"?"bg-red-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Blocked"}),i.jsx("button",{onClick:()=>k(N==="done"?"all":"done"),className:`text-xs px-2.5 py-1 rounded-full font-medium transition-all ${N==="done"?"bg-emerald-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Done"})]})]}),i.jsx("div",{className:"p-5",children:Q.length>0?i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Q.map(se=>{const ae=a.find(A=>A.id===se.goalId);return i.jsxs("div",{className:"relative group",children:[ae&&i.jsxs("div",{className:"flex items-center gap-1.5 mb-2 px-1",children:[ae.icon&&i.jsx("span",{className:"text-sm opacity-60",children:ae.icon}),i.jsx("span",{className:"text-[10px] font-medium text-slate-500 uppercase tracking-wide truncate",children:ae.title})]}),i.jsx(Ni,{item:se,employees:o,onEdit:c,onClick:p,onPushToHiBob:g,isPushing:v==null?void 0:v.has(se.id)})]},se.id)})}):i.jsx("div",{className:"text-center py-8",children:i.jsxs("p",{className:"text-sm text-slate-500",children:["No ",N==="blocked"?"blocked":N==="active"?"active":N==="done"?"completed":""," goals"]})})})]}),s.accessLevel!=="IC"&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 pb-4 border-b border-slate-300",children:[i.jsxs("div",{children:[i.jsxs("h2",{className:"text-xl font-semibold text-slate-900 flex items-center gap-3",children:["Team Overview",oe.blocked>0&&i.jsxs("span",{className:"text-xs font-medium text-red-600 bg-red-50 px-2 py-1 rounded-full",children:[oe.blocked," blocked"]})]}),i.jsxs("p",{className:"text-sm text-slate-500 mt-1",children:[oe.people," people in your org  ",oe.total," goals"]})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[i.jsxs("div",{className:"relative",children:[i.jsx("svg",{className:"w-4 h-4 text-slate-500 absolute left-3 top-1/2 -translate-y-1/2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),i.jsx("input",{type:"text",placeholder:"Search people...",value:b,onChange:se=>S(se.target.value),className:"pl-9 pr-4 py-2 bg-white border border-slate-300 rounded-lg text-sm w-48 outline-none focus:border-teal-500 focus:ring-2 focus:ring-teal-500/20"})]}),d&&i.jsxs("button",{onClick:d,className:"bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",children:[i.jsx("span",{className:"text-base leading-none",children:"+"})," New Goal"]})]})]}),i.jsxs("div",{className:"flex gap-4 mb-4",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[i.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),i.jsxs("span",{children:[oe.blocked," Blocked"]})]}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[i.jsx("div",{className:"w-3 h-3 rounded-full bg-teal-500"}),i.jsxs("span",{children:[oe.active," In Progress"]})]}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[i.jsx("div",{className:"w-3 h-3 rounded-full bg-emerald-500"}),i.jsxs("span",{children:[oe.done," Done"]})]})]}),F.length>0&&i.jsxs("div",{className:"bg-white rounded-xl border border-blue-200 overflow-hidden shadow-sm mb-4",children:[i.jsxs("div",{className:"px-4 py-3 bg-blue-50 border-b border-blue-100 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),i.jsx("h3",{className:"text-sm font-semibold text-blue-900",children:"My Team  Managers"}),i.jsxs("span",{className:"text-xs text-blue-600 bg-blue-100 px-2 py-0.5 rounded-full",children:[F.length," managers"]})]}),i.jsx("button",{onClick:()=>{const se=F.map(U=>U.id),ae=se.every(U=>w.has(U)),A=new Set(w);se.forEach(U=>{ae?A.delete(U):A.add(U)}),M(A)},className:"text-xs text-blue-600 hover:text-blue-700 hover:underline",children:F.every(se=>w.has(se.id))?"Collapse all":"Expand all"})]}),i.jsx("div",{className:"divide-y divide-slate-100",children:F.map(se=>i.jsx(bi,{employee:se,items:P(se),goals:a,employees:o,allItems:t,isExpanded:w.has(se.id),onToggle:()=>q(se.id),expandedSet:w,onToggleAny:q,onEditItem:c,onViewHistory:p,onPushToHiBob:g,pushingItems:v,getEmployeeItems:P},se.id))})]}),fe.length>0&&i.jsxs("div",{className:"bg-white rounded-xl border border-teal-200 overflow-hidden shadow-sm",children:[i.jsxs("div",{className:"px-4 py-3 bg-teal-50 border-b border-teal-100 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 rounded-full bg-teal-500"}),i.jsxs("h3",{className:"text-sm font-semibold text-teal-900",children:["My Team  ",s.department]}),i.jsxs("span",{className:"text-xs text-teal-600 bg-teal-100 px-2 py-0.5 rounded-full",children:[fe.length," people"]})]}),i.jsx("button",{onClick:()=>{const se=fe.map(U=>U.id),ae=se.every(U=>w.has(U)),A=new Set(w);se.forEach(U=>{ae?A.delete(U):A.add(U)}),M(A)},className:"text-xs text-teal-600 hover:text-teal-700 hover:underline",children:fe.every(se=>w.has(se.id))?"Collapse all":"Expand all"})]}),i.jsx("div",{className:"divide-y divide-slate-100",children:fe.map(se=>i.jsx(bi,{employee:se,items:P(se),goals:a,employees:o,allItems:t,isExpanded:w.has(se.id),onToggle:()=>q(se.id),expandedSet:w,onToggleAny:q,onEditItem:c,onViewHistory:p,onPushToHiBob:g,pushingItems:v,getEmployeeItems:P},se.id))})]}),Object.keys(re).length>0&&i.jsxs("div",{className:"space-y-3 mt-6",children:[i.jsxs("h3",{className:"text-sm font-medium text-slate-500 uppercase tracking-wide flex items-center gap-2",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),"Other Departments",i.jsxs("select",{value:h,onChange:se=>y(se.target.value),className:"ml-auto bg-white border border-slate-300 text-slate-700 text-xs font-medium rounded-lg px-3 py-1.5 outline-none focus:border-teal-500",children:[i.jsx("option",{value:"ALL",children:"All Departments"}),V.map(se=>i.jsx("option",{value:se,children:se},se))]})]}),Object.entries(re).sort((se,ae)=>se[0].localeCompare(ae[0])).map(([se,ae])=>{const A=J.has(se),U=ae.flatMap(L=>P(L)),ue=U.filter(L=>L.status===we.BLOCKED).length;return i.jsxs("div",{className:"bg-white rounded-xl border border-slate-300 overflow-hidden shadow-sm",children:[i.jsxs("div",{onClick:()=>X(se),className:"px-4 py-3 bg-slate-100 border-b border-slate-100 flex items-center justify-between cursor-pointer hover:bg-slate-100 transition-colors",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("svg",{className:`w-4 h-4 text-slate-500 transition-transform ${A?"":"rotate-90"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})}),i.jsx("h4",{className:"text-sm font-medium text-slate-700",children:se}),i.jsxs("span",{className:"text-xs text-slate-500 bg-slate-100 px-2 py-0.5 rounded-full",children:[ae.length," people"]}),ue>0&&i.jsxs("span",{className:"text-xs text-red-600 bg-red-50 px-2 py-0.5 rounded-full",children:[ue," blocked"]})]}),i.jsxs("span",{className:"text-xs text-slate-500",children:[U.length," goals"]})]}),!A&&i.jsx("div",{className:"divide-y divide-slate-100",children:ae.map(L=>i.jsx(bi,{employee:L,items:P(L),goals:a,employees:o,allItems:t,isExpanded:w.has(L.id),onToggle:()=>q(L.id),expandedSet:w,onToggleAny:q,onEditItem:c,onViewHistory:p,onPushToHiBob:g,pushingItems:v,getEmployeeItems:P},L.id))})]},se)})]}),F.length===0&&fe.length===0&&Object.keys(re).length===0&&i.jsx("div",{className:"bg-white rounded-xl border border-slate-300 p-8 text-center text-slate-500 shadow-sm",children:i.jsx("p",{children:"No team members found matching your filters."})})]}),s.accessLevel==="IC"&&N==="all"&&i.jsxs("div",{className:"bg-white rounded-xl border border-slate-300 p-5 shadow-sm",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Your Goals"}),d&&i.jsxs("button",{onClick:d,className:"bg-teal-600 hover:bg-teal-700 text-white px-3 py-1.5 rounded-lg text-xs font-medium transition-colors flex items-center gap-1",children:[i.jsx("span",{children:"+"})," Add Goal"]})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a&&a.map(se=>{if(!se)return null;const ae=H.filter(A=>A.goalId===se.id);return ae.length===0?null:i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-slate-100",children:[se.icon&&i.jsx("span",{className:"text-sm opacity-60",children:se.icon}),i.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide truncate",children:se.title||"Untitled"})]}),i.jsx("div",{className:"space-y-2",children:ae.map(A=>i.jsx(Ni,{item:A,employees:o,onEdit:c,onClick:p,onPushToHiBob:g,isPushing:v==null?void 0:v.has(A.id)},A.id))})]},se.id)})})]})]})},jv=()=>{const s=new Date;return{month:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][s.getMonth()],year:s.getFullYear()}},Uv=({items:s,updates:t,employees:a,goals:o,currentUser:c,onAddUpdate:d,onViewHistory:p,initialMonth:g,initialYear:v})=>{const h=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],y=jv(),[b,S]=I.useState(g||y.month),[N,k]=I.useState(v||y.year),[w,M]=I.useState(new Set),[J,ce]=I.useState("updates"),[ee,P]=I.useState("all"),[Q,H]=I.useState(!1),q=((L,W)=>{const C=h.indexOf(L);return C===0?{month:"Dec",year:W-1}:{month:h[C-1],year:W}})(b,N),X=L=>{M(W=>{const C=new Set(W);return C.has(L)?C.delete(L):C.add(L),C})},fe=(L,W,C)=>t.find(_=>_.itemId===L&&_.month===b&&_.year===N),F=L=>t.find(W=>W.itemId===L&&W.month===q.month&&W.year===q.year),re=I.useMemo(()=>{let L=0,W=0,C=0,_=0,O=0,z=0;return s.forEach(ne=>{L++;const xe=fe(ne.id);xe?(W++,xe.health===De.GREEN?C++:xe.health===De.AMBER?_++:xe.health===De.RED&&O++):z++}),{total:L,withUpdate:W,green:C,amber:_,red:O,missing:z}},[s,t,b,N]),oe=I.useMemo(()=>{if(!c)return[];const L=c.name.toLowerCase();return s.filter(W=>{const C=(W.owner||"").toLowerCase();return C===L||C.includes(L)||L.includes(C)})},[s,c]),se=I.useMemo(()=>{let L=0,W=0,C=0,_=0,O=0;return oe.forEach(z=>{const ne=fe(z.id);ne?(L++,ne.health===De.GREEN?C++:ne.health===De.AMBER?_++:ne.health===De.RED&&O++):W++}),{total:oe.length,withUpdate:L,missing:W,green:C,amber:_,red:O}},[oe,t,b,N]),ae=I.useMemo(()=>{const L={};return s.forEach(W=>{const C=W.owner||"Unassigned";L[C]||(L[C]=[]),L[C].push(W)}),L},[s]),A=I.useMemo(()=>t.filter(L=>L.month===b&&L.year===N).filter(L=>ee==="all"||L.health===ee).sort((L,W)=>new Date(W.updatedAt).getTime()-new Date(L.updatedAt).getTime()),[t,b,N,ee]),U=L=>{if(!L)return{color:"bg-slate-100",text:"text-slate-500",border:"border-slate-300",label:"Pending"};const W=vu[L];return W?{...W,color:W.color}:{color:"bg-slate-100",text:"text-slate-500",border:"border-slate-300",label:"Unknown"}},ue=({item:L})=>{const W=fe(L.id),C=U(W==null?void 0:W.health),_=o.find(O=>O.id===L.goalId);return i.jsxs("div",{onClick:()=>p==null?void 0:p(L),className:`
          p-4 rounded-xl border cursor-pointer transition-all group
          ${W?"bg-white border-slate-300 hover:border-teal-300 hover:shadow-md":"bg-amber-50/50 border-amber-200 border-dashed hover:border-amber-300"}
        `,children:[i.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[_&&i.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[_.icon&&i.jsx("span",{className:"text-xs opacity-60",children:_.icon}),i.jsx("span",{className:"text-[10px] font-medium text-slate-500 uppercase tracking-wide truncate",children:_.title})]}),i.jsx("h4",{className:"text-sm font-semibold text-slate-800 leading-snug line-clamp-2 group-hover:text-teal-700 transition-colors",children:L.title})]}),i.jsx("div",{className:`
            shrink-0 px-2 py-1 rounded-lg text-[10px] font-bold uppercase tracking-wide
            ${W?`${C.color} text-white`:"bg-amber-100 text-amber-600"}
          `,children:W?C.label:"Missing"})]}),W?i.jsx("p",{className:"text-xs text-slate-600 line-clamp-2 mt-2",children:W.content}):i.jsxs("button",{onClick:O=>{O.stopPropagation(),d(L)},className:"mt-2 text-xs font-medium text-amber-600 hover:text-amber-700 flex items-center gap-1",children:[i.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add update for ",b]})]})};return i.jsxs("div",{className:"space-y-6 pb-12",children:[i.jsx("div",{className:"bg-white rounded-xl border border-slate-300 px-4 py-3",children:i.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("h2",{className:"font-bold text-slate-900",children:"Updates"}),i.jsxs("div",{className:"flex items-center bg-slate-100 rounded-lg",children:[i.jsx("button",{onClick:()=>{const L=h.indexOf(b);L===0?(S("Dec"),k(N-1)):S(h[L-1])},className:"p-1.5 hover:bg-slate-200 rounded-l-lg transition-colors",children:i.jsx("svg",{className:"w-4 h-4 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),i.jsx("select",{value:b,onChange:L=>S(L.target.value),className:"bg-transparent text-sm font-medium text-slate-700 outline-none cursor-pointer px-1",children:h.map(L=>i.jsx("option",{value:L,children:L},L))}),i.jsx("select",{value:N,onChange:L=>k(Number(L.target.value)),className:"bg-transparent text-sm font-medium text-slate-700 outline-none cursor-pointer pr-1",children:[2024,2025,2026,2027].map(L=>i.jsx("option",{value:L,children:L},L))}),i.jsx("button",{onClick:()=>{const L=h.indexOf(b);L===11?(S("Jan"),k(N+1)):S(h[L+1])},className:"p-1.5 hover:bg-slate-200 rounded-r-lg transition-colors",children:i.jsx("svg",{className:"w-4 h-4 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]}),i.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[i.jsxs("span",{className:"text-slate-500",children:[i.jsx("strong",{className:"text-slate-700",children:re.total})," goals"]}),i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500"}),i.jsx("strong",{className:"text-emerald-600",children:re.green})]}),i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-amber-500"}),i.jsx("strong",{className:"text-amber-600",children:re.amber})]}),i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-red-500"}),i.jsx("strong",{className:"text-red-600",children:re.red})]}),re.missing>0&&i.jsxs("span",{className:"text-slate-500",children:[i.jsx("strong",{className:"text-slate-500",children:re.missing})," pending"]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:()=>H(!Q),className:`
                px-3 py-1.5 rounded-lg text-xs font-medium transition-all flex items-center gap-1.5 border
                ${Q?"bg-teal-50 border-teal-300 text-teal-700":"bg-white border-slate-300 text-slate-600 hover:border-slate-300"}
              `,children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Compare"]}),i.jsxs("div",{className:"flex bg-slate-100 p-0.5 rounded-lg",children:[i.jsx("button",{onClick:()=>ce("updates"),className:`px-2.5 py-1 rounded-md text-xs font-medium transition-all ${J==="updates"?"bg-white shadow-sm text-slate-800":"text-slate-500 hover:text-slate-700"}`,children:"Feed"}),i.jsx("button",{onClick:()=>ce("people"),className:`px-2.5 py-1 rounded-md text-xs font-medium transition-all ${J==="people"?"bg-white shadow-sm text-slate-800":"text-slate-500 hover:text-slate-700"}`,children:"People"})]})]})]})}),J==="updates"?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",children:[[{id:"all",label:"All",color:"bg-slate-400"},{id:De.GREEN,label:"On Track",color:"bg-emerald-500"},{id:De.AMBER,label:"At Risk",color:"bg-amber-500"},{id:De.RED,label:"Blocked",color:"bg-red-500"}].map(L=>i.jsxs("button",{onClick:()=>P(L.id),className:`
                  px-3 py-1.5 rounded-lg text-xs font-medium transition-all flex items-center gap-1.5
                  ${ee===L.id?"bg-slate-800 text-white":"bg-white text-slate-600 hover:bg-slate-100 border border-slate-300"}
                `,children:[i.jsx("div",{className:`w-2 h-2 rounded-full ${L.color}`}),L.label]},L.id)),Q&&i.jsxs("span",{className:"ml-auto text-xs text-slate-500 flex items-center gap-1.5 bg-slate-100 px-3 py-1.5 rounded-lg",children:[i.jsx("svg",{className:"w-4 h-4 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),"Comparing ",i.jsxs("strong",{className:"text-teal-700",children:[q.month," ",q.year]}),"  ",i.jsxs("strong",{className:"text-teal-700",children:[b," ",N]})]})]}),Q?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-[1fr_1fr] gap-4",children:[i.jsxs("div",{className:"bg-slate-100 rounded-lg px-4 py-2 text-center",children:[i.jsxs("span",{className:"text-sm font-semibold text-slate-600",children:[q.month," ",q.year]}),i.jsx("span",{className:"text-xs text-slate-500 ml-2",children:"(Previous)"})]}),i.jsxs("div",{className:"bg-teal-50 rounded-lg px-4 py-2 text-center border border-teal-200",children:[i.jsxs("span",{className:"text-sm font-semibold text-teal-700",children:[b," ",N]}),i.jsx("span",{className:"text-xs text-teal-500 ml-2",children:"(Current)"})]})]}),(()=>{const L=new Set;s.forEach(C=>{C.owner&&L.add(C.owner)});const W=Array.from(L).sort();return W.length===0?i.jsxs("div",{className:"bg-white rounded-xl border border-slate-300 p-12 text-center",children:[i.jsx("h3",{className:"font-semibold text-slate-800 mb-1",children:"No goals to compare"}),i.jsx("p",{className:"text-sm text-slate-500",children:"Add goals to see comparison"})]}):W.map(C=>{const _=s.filter(ne=>ne.owner===C),O=a.find(ne=>ne.name===C),z=_.filter(ne=>{if(ee==="all")return!0;const xe=fe(ne.id),ge=F(ne.id);return(xe==null?void 0:xe.health)===ee||(ge==null?void 0:ge.health)===ee});return z.length===0?null:i.jsxs("div",{className:"bg-white rounded-xl border border-slate-300 overflow-hidden",children:[i.jsxs("div",{className:"px-4 py-3 bg-slate-100 border-b border-slate-100 flex items-center gap-3",children:[i.jsx("img",{src:(O==null?void 0:O.avatar)||`https://ui-avatars.com/api/?name=${encodeURIComponent(C)}&background=0d9488&color=fff&size=32`,className:"w-7 h-7 rounded-lg object-cover",alt:""}),i.jsx("span",{className:"font-semibold text-slate-800",children:C}),i.jsxs("span",{className:"text-xs text-slate-500",children:[z.length," goal",z.length!==1?"s":""]})]}),i.jsx("div",{className:"divide-y divide-slate-100",children:z.map(ne=>{const xe=F(ne.id),ge=fe(ne.id),Se=o.find(ke=>ke.id===ne.goalId),_e=U(xe==null?void 0:xe.health),nt=U(ge==null?void 0:ge.health),G={[De.GREEN]:3,[De.AMBER]:2,[De.RED]:1},he=xe!=null&&xe.health?G[xe.health]:0,Pe=(ge!=null&&ge.health?G[ge.health]:0)-he;return i.jsxs("div",{onClick:()=>p==null?void 0:p(ne),className:"hover:bg-slate-100 cursor-pointer transition-colors",children:[i.jsxs("div",{className:"px-4 py-2 bg-slate-100/50 flex items-center gap-2 border-b border-slate-50",children:[(Se==null?void 0:Se.icon)&&i.jsx("span",{className:"text-sm",children:Se.icon}),i.jsx("span",{className:"text-xs font-medium text-slate-500 truncate flex-1",children:ne.title}),xe&&ge&&Pe!==0&&i.jsx("span",{className:`text-xs font-semibold px-2 py-0.5 rounded-full ${Pe>0?"bg-emerald-100 text-emerald-700":"bg-red-100 text-red-700"}`,children:Pe>0?" Improved":" Declined"}),!xe&&ge&&i.jsx("span",{className:"text-xs font-semibold px-2 py-0.5 rounded-full bg-blue-100 text-blue-700",children:"New"})]}),i.jsxs("div",{className:"grid grid-cols-[1fr_1fr] divide-x divide-slate-100",children:[i.jsx("div",{className:"p-4",children:xe?i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${_e.color}`}),i.jsx("span",{className:`text-xs font-semibold ${_e.text}`,children:_e.label})]}),i.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:xe.content})]}):i.jsx("div",{className:"text-sm text-slate-500 italic",children:"No update"})}),i.jsx("div",{className:"p-4 bg-teal-50/30",children:ge?i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${nt.color}`}),i.jsx("span",{className:`text-xs font-semibold ${nt.text}`,children:nt.label})]}),i.jsx("p",{className:"text-sm text-slate-700 leading-relaxed",children:ge.content})]}):i.jsxs("button",{onClick:ke=>{ke.stopPropagation(),d(ne)},className:"text-sm text-amber-600 hover:text-amber-700 flex items-center gap-1",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add update"]})})]})]},ne.id)})})]},C)})})()]}):(()=>{const L={};A.forEach(C=>{const _=s.find(z=>z.id===C.itemId);if(!_)return;const O=_.owner||"Unknown";L[O]||(L[O]={employee:a.find(z=>z.name===O),updates:[]}),L[O].updates.push({update:C,item:_,goal:o.find(z=>z.id===_.goalId)})});const W=Object.entries(L).sort(([C],[_])=>C.localeCompare(_));return W.length===0?i.jsxs("div",{className:"bg-white rounded-xl border border-slate-300 p-12 text-center",children:[i.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx("svg",{className:"w-6 h-6 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),i.jsxs("h3",{className:"font-semibold text-slate-800 mb-1",children:["No updates for ",b," ",N]}),i.jsx("p",{className:"text-sm text-slate-500",children:"Updates will appear here once submitted"})]}):i.jsx("div",{className:"space-y-4",children:W.map(([C,{employee:_,updates:O}])=>i.jsxs("div",{className:"bg-white rounded-xl border border-slate-300 overflow-hidden",children:[i.jsxs("div",{className:"px-4 py-3 bg-slate-100 border-b border-slate-100 flex items-center gap-3",children:[i.jsx("img",{src:(_==null?void 0:_.avatar)||`https://ui-avatars.com/api/?name=${encodeURIComponent(C)}&background=0d9488&color=fff&size=32`,className:"w-7 h-7 rounded-lg object-cover",alt:""}),i.jsx("span",{className:"font-semibold text-slate-800",children:C}),i.jsxs("span",{className:"text-xs text-slate-500 bg-slate-200/50 px-2 py-0.5 rounded-full",children:[O.length," update",O.length!==1?"s":""]})]}),i.jsxs("div",{className:"divide-y divide-slate-100",children:[i.jsxs("div",{className:"grid grid-cols-[minmax(200px,1fr)_minmax(300px,2fr)_80px] gap-4 px-4 py-2 bg-slate-100/50 text-[10px] font-semibold text-slate-500 uppercase tracking-wider",children:[i.jsx("div",{children:"Goal"}),i.jsx("div",{children:"Update"}),i.jsx("div",{className:"text-right",children:"Date"})]}),O.map(({update:z,item:ne,goal:xe})=>{const ge=U(z.health);return i.jsxs("div",{onClick:()=>p==null?void 0:p(ne),className:"grid grid-cols-[minmax(200px,1fr)_minmax(300px,2fr)_80px] gap-4 px-4 py-3 hover:bg-slate-100 cursor-pointer transition-colors items-start",children:[i.jsxs("div",{className:"flex items-start gap-2 min-w-0",children:[(xe==null?void 0:xe.icon)&&i.jsx("span",{className:"text-base shrink-0",children:xe.icon}),i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[10px] font-medium text-slate-500 uppercase tracking-wide truncate",children:(xe==null?void 0:xe.title)||"Unassigned"}),i.jsx("div",{className:"text-sm font-medium text-slate-700 line-clamp-2 leading-snug",children:ne.title})]})]}),i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:`w-2.5 h-2.5 rounded-full mt-1 shrink-0 ${ge.color}`}),i.jsx("p",{className:"text-sm text-slate-700 leading-relaxed",children:z.content})]}),i.jsx("div",{className:"text-xs text-slate-500 text-right whitespace-nowrap",children:new Date(z.updatedAt).toLocaleDateString("en-GB",{day:"numeric",month:"short"})})]},z.id)})]})]},C))})})()]}):i.jsxs(i.Fragment,{children:[c&&oe.length>0&&i.jsxs("div",{className:"bg-teal-50/50 rounded-2xl border border-teal-200 overflow-hidden",children:[i.jsx("div",{className:"p-6 border-b border-teal-200 bg-teal-50",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("img",{src:c.avatar||`https://ui-avatars.com/api/?name=${encodeURIComponent(c.name)}&background=random&color=fff`,className:"w-12 h-12 rounded-xl object-cover border-2 border-white shadow-sm",alt:c.name}),i.jsxs("div",{children:[i.jsxs("h3",{className:"font-bold text-slate-900",children:["My Updates for ",b," ",N]}),i.jsxs("p",{className:"text-sm text-slate-600",children:[se.withUpdate," of ",se.total," goals updated"]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[se.missing>0&&i.jsxs("span",{className:"px-3 py-1.5 bg-amber-100 rounded-lg text-xs font-semibold text-amber-700",children:[se.missing," pending"]}),se.withUpdate===se.total&&se.total>0&&i.jsxs("span",{className:"px-3 py-1.5 bg-emerald-100 rounded-lg text-xs font-semibold text-emerald-700 flex items-center gap-1",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"All updated"]})]})]})}),i.jsx("div",{className:"p-6",children:i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:oe.map(L=>i.jsx(ue,{item:L},L.id))})})]}),i.jsx("div",{className:"space-y-4",children:Object.entries(ae).filter(([L])=>{if(!c)return!0;const W=c.name.toLowerCase(),C=L.toLowerCase();return!(C===W||C.includes(W)||W.includes(C))}).sort(([L],[W])=>L.localeCompare(W)).map(([L,W])=>{var ge;if(W.length===0)return null;const C=W.map(Se=>fe(Se.id)).filter(Boolean),_=W.length-C.length,O=C.filter(Se=>(Se==null?void 0:Se.health)===De.RED).length,z=C.filter(Se=>(Se==null?void 0:Se.health)===De.AMBER).length,ne=a.find(Se=>Se.name===L),xe=((ge=W[0])==null?void 0:ge.department)||"Unassigned";return i.jsxs("div",{className:"bg-white rounded-2xl border border-slate-300 overflow-hidden",children:[i.jsxs("div",{className:"p-4 flex items-center gap-4 cursor-pointer hover:bg-slate-100 transition-colors",onClick:()=>X(L),children:[i.jsx("button",{className:"p-1 hover:bg-slate-200 rounded transition-colors",children:i.jsx("svg",{className:`w-4 h-4 text-slate-500 transition-transform ${w.has(L)?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),i.jsx("img",{src:(ne==null?void 0:ne.avatar)||`https://ui-avatars.com/api/?name=${encodeURIComponent(L)}&background=random&color=fff`,className:"w-10 h-10 rounded-lg object-cover border border-slate-300",alt:L}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"font-semibold text-slate-800",children:L}),i.jsxs("div",{className:"text-xs text-slate-500",children:[xe,"  ",W.length," goals"]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[O>0&&i.jsxs("span",{className:"flex items-center gap-1 px-2 py-1 bg-red-50 rounded-lg",children:[i.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500"}),i.jsx("span",{className:"text-xs font-medium text-red-600",children:O})]}),z>0&&i.jsxs("span",{className:"flex items-center gap-1 px-2 py-1 bg-amber-50 rounded-lg",children:[i.jsx("div",{className:"w-2 h-2 rounded-full bg-amber-500"}),i.jsx("span",{className:"text-xs font-medium text-amber-600",children:z})]}),_>0&&i.jsx("span",{className:"flex items-center gap-1 px-2 py-1 bg-slate-100 rounded-lg",children:i.jsxs("span",{className:"text-xs font-medium text-slate-500",children:[_," missing"]})}),C.length===W.length&&W.length>0&&i.jsx("span",{className:"flex items-center gap-1 px-2 py-1 bg-emerald-50 rounded-lg",children:i.jsx("svg",{className:"w-4 h-4 text-emerald-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]})]}),w.has(L)&&i.jsx("div",{className:"px-4 pb-4 pl-16 border-t border-slate-100",children:i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 pt-4",children:W.map(Se=>i.jsx(ue,{item:Se},Se.id))})})]},L)})})]})]})},Lv=({insights:s,loading:t,onRefresh:a})=>{const[o,c]=I.useState(!1);return i.jsxs("div",{className:"bg-white rounded-xl border border-slate-300 overflow-hidden shadow-card",children:[i.jsxs("div",{className:"p-5 flex justify-between items-center cursor-pointer hover:bg-slate-100 transition-colors",onClick:()=>c(!o),children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"p-3 bg-teal-50 text-teal-600 rounded-lg",children:i.jsx("svg",{className:`w-5 h-5 ${t?"animate-pulse":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),i.jsxs("div",{children:[i.jsxs("h3",{className:"text-base font-semibold text-slate-900 flex items-center gap-2",children:["AI Intelligence",t&&i.jsx("span",{className:"text-xs bg-teal-50 text-teal-600 px-2 py-0.5 rounded-full animate-pulse",children:"Processing"})]}),i.jsx("p",{className:"text-sm text-slate-500",children:t?"Analyzing roadmap data...":"AI-powered analysis & risk detection"})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[!o&&s.length>0&&!t&&i.jsx("div",{className:"flex items-center gap-2",children:s.filter(d=>d.impactLevel==="high").length>0&&i.jsxs("div",{className:"flex items-center gap-1.5 bg-red-50 border border-red-100 px-2.5 py-1 rounded-full",children:[i.jsx("span",{className:"w-2 h-2 rounded-full bg-red-500"}),i.jsxs("span",{className:"text-xs font-medium text-red-600",children:[s.filter(d=>d.impactLevel==="high").length," Alert",s.filter(d=>d.impactLevel==="high").length>1?"s":""]})]})}),i.jsx("button",{onClick:d=>{d.stopPropagation(),o?a():c(!0)},disabled:t,className:`
              px-4 py-2 rounded-lg text-sm font-medium transition-colors disabled:opacity-50
              ${o?"bg-slate-100 text-slate-700 hover:bg-slate-200":"bg-teal-600 text-white hover:bg-teal-700"}
            `,children:t?"Analyzing...":o?"Refresh":"View Insights"}),i.jsx("svg",{className:`w-5 h-5 text-slate-500 transition-transform ${o?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]})]}),o&&i.jsxs("div",{className:"px-5 pb-5 border-t border-slate-100",children:[i.jsx("div",{className:"grid gap-4 lg:grid-cols-3 mt-5",children:t?[1,2,3].map(d=>i.jsx("div",{className:"h-32 bg-slate-100 animate-pulse rounded-xl"},d)):s.length>0?s.map((d,p)=>i.jsxs("div",{className:`
                    bg-slate-100 p-5 rounded-xl border transition-all hover:shadow-card-hover
                    ${d.impactLevel==="high"?"border-red-200":d.impactLevel==="medium"?"border-amber-200":"border-slate-300"}
                  `,children:[i.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.jsx("span",{className:`
                      text-xs font-medium px-2 py-0.5 rounded-full
                      ${d.impactLevel==="high"?"bg-red-100 text-red-700":d.impactLevel==="medium"?"bg-amber-100 text-amber-700":"bg-teal-100 text-teal-700"}
                    `,children:d.impactLevel}),i.jsx("span",{className:"text-xs text-slate-500 capitalize",children:d.type.replace("_"," ")})]}),i.jsx("p",{className:"text-sm text-slate-700 leading-relaxed",children:d.message})]},p)):i.jsxs("div",{className:"col-span-full text-center py-8",children:[i.jsx("div",{className:"w-12 h-12 mx-auto mb-3 bg-emerald-50 rounded-xl flex items-center justify-center",children:i.jsx("svg",{className:"w-6 h-6 text-emerald-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),i.jsx("p",{className:"text-slate-600 font-medium",children:"No critical insights detected"}),i.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Your roadmap is looking healthy!"})]})}),i.jsx("div",{className:"mt-4 flex justify-end",children:i.jsxs("span",{className:"text-xs text-slate-500 flex items-center gap-1",children:[i.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Powered by Gemini AI"]})})]})]})},_m="https://script.google.com/macros/s/AKfycbxT_Mn0L9spyKDwIp8d3Vk_dGsb9V6JWdhb1t9GcBHWqJMeEi9Lq26knezQjfIZ_ZTEHA/exec";class Gv{constructor(){this.scriptUrl=localStorage.getItem("omnimap_script_url")||_m}setScriptUrl(t){const a=t.trim();this.scriptUrl=a,localStorage.setItem("omnimap_script_url",a)}getScriptUrl(){return this.scriptUrl||_m}async fetchData(){const t=this.getScriptUrl();if(!t)return null;try{const a=t.includes("?")?"&":"?",o=`${t}${a}t=${Date.now()}`,c=await fetch(o,{method:"GET",mode:"cors",credentials:"omit"});if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);return await c.json()}catch(a){throw console.error("Sheets Fetch Error:",a),a}}async dispatch(t){const a=this.getScriptUrl();if(!a)return console.error("[Sheets Dispatch] No script URL configured"),!1;console.log("[Sheets Dispatch] Sending:",t.action);try{return await fetch(a,{method:"POST",mode:"no-cors",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}),console.log("[Sheets Dispatch] Request sent (no-cors mode, response status unknown)"),!0}catch(o){return console.error("[Sheets Dispatch] Error:",o),!1}}async upsertItem(t){return this.dispatch({action:"UPSERT_ITEM",item:t})}async upsertItems(t){try{const a=t.map(o=>this.upsertItem(o));return await Promise.all(a),!0}catch(a){return console.error("Batch Upsert Error:",a),!1}}async deleteItem(t){return this.dispatch({action:"DELETE_ITEM",id:t})}async upsertGoal(t){return this.dispatch({action:"UPSERT_GOAL",goal:t})}async deleteGoal(t){return this.dispatch({action:"DELETE_GOAL",id:t})}async upsertUpdate(t){return this.dispatch({action:"UPSERT_UPDATE",update:t})}async deleteUpdate(t){return this.dispatch({action:"DELETE_UPDATE",id:t})}async upsertItemUpdate(t){return this.dispatch({action:"UPSERT_ITEM_UPDATE",itemUpdate:t})}async listFollowUps(t={}){const a=this.getScriptUrl();if(!a)return[];const o=new URLSearchParams;o.set("action","list_follow_ups"),t.cadenceDays!=null&&o.set("cadenceDays",String(t.cadenceDays)),t.goalId&&o.set("goalId",t.goalId),t.token&&o.set("token",t.token);const c=a.includes("?")?"&":"?";try{const d=await fetch(`${a}${c}${o.toString()}`,{method:"GET",mode:"cors",credentials:"omit"});if(!d.ok)return[];const p=await d.json();return Array.isArray(p.items)?p.items:[]}catch(d){return console.error("[listFollowUps]",d),[]}}async recordUpdateFromExternal(t){const a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],o=new Date,c={itemId:t.itemId,content:t.content,health:t.health,source:t.source||"n8n",month:t.month??a[o.getMonth()],year:t.year??o.getFullYear(),updatedAt:new Date().toISOString()};return this.dispatch({action:"RECORD_UPDATE_FROM_EXTERNAL",itemUpdate:c})}async upsertProject(t){return this.dispatch({action:"UPSERT_PROJECT",project:t})}async upsertProjectTasks(t){try{for(const a of t)await this.dispatch({action:"UPSERT_PROJECT_TASK",projectTask:a});return!0}catch(a){return console.error("Batch project tasks upsert error",a),!1}}async deleteProject(t){return this.dispatch({action:"DELETE_PROJECT",id:t})}async deleteProjectTask(t){return this.dispatch({action:"DELETE_PROJECT_TASK",id:t})}async upsertProjectMilestone(t){return this.dispatch({action:"UPSERT_PROJECT_MILESTONE",projectMilestone:t})}async deleteProjectMilestone(t){return this.dispatch({action:"DELETE_PROJECT_MILESTONE",id:t})}async upsertTaskMilestone(t){return this.dispatch({action:"UPSERT_TASK_MILESTONE",taskMilestone:t})}async deleteTaskMilestone(t){return this.dispatch({action:"DELETE_TASK_MILESTONE",id:t})}async upsertSalesAction(t){return this.dispatch({action:"UPSERT_SALES_ACTION",salesAction:t})}async toggleSalesAction(t,a){return this.dispatch({action:"TOGGLE_SALES_ACTION",salesAction:{id:t,isCompleted:a}})}async syncHiBobPeople(t){return this.dispatch({action:"SYNC_HIBOB_PEOPLE",hibobConfig:t})}async syncHiBobGoals(t){return this.dispatch({action:"SYNC_HIBOB_GOALS",hibobConfig:t})}async testHiBob(t,a,o,c,d){const p=this.getScriptUrl();if(!p)return{error:"No Script URL Configured"};try{const g=p.includes("?")?"&":"?";let v=`${p}${g}action=TEST_HIBOB&serviceId=${encodeURIComponent(t.serviceId)}&token=${encodeURIComponent(t.token)}&email=${encodeURIComponent(a)}&subAction=${o}`;c&&(v+=`&goalId=${encodeURIComponent(c)}`),d&&(v+=`&testHealthStatus=${encodeURIComponent(d)}`);const y=await(await fetch(v,{method:"GET"})).text();try{return JSON.parse(y)}catch{return{success:!1,error:"Received invalid JSON from backend. Check Script URL.",rawResponse:y.substring(0,500)}}}catch(g){return{success:!1,error:"Network/Fetch Error: "+g.message,hint:"Is the script deployed as 'Anyone'?"}}}async pushGoalsToHiBob(t,a){return this.dispatch({action:"PUSH_GOALS_HIBOB",hibobConfig:t,targetEmail:a})}async pushSingleGoalToHiBob(t,a,o){const c=this.getScriptUrl();if(!c)return{success:!1,message:"Script URL missing"};if(!a.serviceId||!a.token)return{success:!1,message:"HiBob credentials missing (Service ID or Token)"};try{const d=c.includes("?")?"&":"?",p=new URLSearchParams({action:"PUSH_SINGLE_GOAL",serviceId:a.serviceId,token:a.token,itemId:t.id,manualGoalType:a.manualGoalType||"",p_title:t.title||"",p_desc:t.description||"",p_owner:t.owner||"",p_start:t.startDate||new Date().toISOString().split("T")[0],p_end:t.endDate||new Date(new Date().getTime()+365*24*60*60*1e3).toISOString().split("T")[0],p_goal_type:t.goalType||"PERSONAL",p_goal_category:t.goalCategory||"PERFORMANCE",p_status:t.status||"Not Started",p_progress:String(t.progress||0),p_hibob_goal_id:t.hibobGoalId||""});o&&o.includes("@")&&p.append("p_owner_email",o);const g=`${c}${d}${p.toString()}`;console.log("[HiBob Push] Sending request for:",t.title,"Owner:",t.owner),console.log("[HiBob Push] URL (sanitized):",g.replace(/token=[^&]+/,"token=***").replace(/serviceId=[^&]+/,"serviceId=***"));const v=await fetch(g,{method:"GET",headers:{Accept:"application/json"}}),h=await v.text();if(console.log("[HiBob Push] Response status:",v.status,"Content-Type:",v.headers.get("content-type")),console.log("[HiBob Push] Response text (first 500 chars):",h.substring(0,500)),!v.ok){console.error("[HiBob Push] HTTP Error:",v.status,h.substring(0,200));let b;try{if(b=JSON.parse(h),b.message)return{success:!1,message:b.message}}catch{}throw new Error(`HTTP Error ${v.status}: ${h.substring(0,100)}`)}if(h.trim().startsWith("<")||h.includes("<!DOCTYPE"))return console.error("[HiBob Push] Received HTML instead of JSON. This might be an error page."),{success:!1,message:`Backend returned HTML instead of JSON. This usually means the script URL is incorrect or the script has an error. Response preview: ${h.substring(0,200)}`};let y;try{y=JSON.parse(h)}catch(b){return console.error("[HiBob Push] JSON Parse Error:",b),console.error("[HiBob Push] Full response:",h),{success:!1,message:`Invalid JSON response from backend. The script might have an error. Response preview: ${h.substring(0,300)}`}}return console.log("[HiBob Push] Parsed response:",y),y.statusUpdateInfo&&(y.statusUpdateInfo.success?console.log(`[HiBob Push]  Status updated successfully to: ${y.statusUpdateInfo.targetStatus}`):(console.error("[HiBob Push]  Status update failed:",y.statusUpdateInfo.error),console.error(`[HiBob Push] Target status was: ${y.statusUpdateInfo.targetStatus}`))),typeof y.success>"u"?(console.warn("[HiBob Push] Response missing success field:",y),{success:!1,message:`Unexpected response format: ${JSON.stringify(y).substring(0,200)}`}):y}catch(d){return console.error("[HiBob Push] Exception:",d),{success:!1,message:d.message||"Unknown network error"}}}async pushGoalUpdateToHiBob(t,a,o,c,d){const p=this.getScriptUrl();if(!p)return{success:!1,message:"Script URL missing"};if(!a.serviceId||!a.token)return{success:!1,message:"HiBob credentials missing (Service ID or Token)"};try{const g=p.includes("?")?"&":"?",v=new URLSearchParams({action:"PUSH_GOAL_UPDATE",serviceId:a.serviceId,token:a.token,goalId:t,updateDate:o,content:c,healthStatus:d}),h=`${p}${g}${v.toString()}`;console.log("[HiBob Goal Update] Pushing update for goal:",t);const y=await fetch(h,{method:"GET",headers:{Accept:"application/json"}}),b=await y.text();if(console.log("[HiBob Goal Update] Response status:",y.status),!y.ok){let N=`HTTP Error ${y.status}`;try{const k=JSON.parse(b);N+=`: ${k.message||k.error||b}`}catch{N+=`: ${b.substring(0,500)}`}throw new Error(N)}const S=JSON.parse(b);return console.log("[HiBob Goal Update] Parsed response:",S),S}catch(g){return console.error("[HiBob Goal Update] Fetch Exception:",g),{success:!1,message:g.message||"Unknown network error"}}}async pushCheckInToHiBob(t,a,o,c,d,p=!1){var v,h;const g=this.getScriptUrl();if(!g)return{success:!1,message:"Script URL missing"};if(!a.serviceId||!a.token)return{success:!1,message:"HiBob credentials missing (Service ID or Token)"};if(p){console.log("[HiBob] Using goal update method (appears in description)");const y=await this.pushGoalUpdateToHiBob(t,a,o,c,d);if(y.success)return{...y,methodUsed:"goal_update"};console.warn("[HiBob] Goal update failed, trying check-ins...")}try{const y=g.includes("?")?"&":"?",b=new URLSearchParams({action:"PUSH_CHECK_IN",serviceId:a.serviceId,token:a.token,goalId:t,checkInDate:o,content:c,healthStatus:d}),S=`${g}${y}${b.toString()}`;console.log("[HiBob Check-in] Pushing check-in for goal:",t);const N=await fetch(S,{method:"GET",headers:{Accept:"application/json"}}),k=await N.text();if(console.log("[HiBob Check-in] Response status:",N.status),console.log("[HiBob Check-in] Response text (first 500 chars):",k.substring(0,500)),!N.ok){let M=`HTTP Error ${N.status}`;if((v=N.headers.get("Content-Type"))!=null&&v.includes("text/html"))M+=". Received HTML, likely script error or wrong URL.";else try{const J=JSON.parse(k);M+=`: ${J.message||J.error||k}`,J.debug&&console.error("[HiBob Check-in] Debug info:",J.debug),J.lastError&&console.error("[HiBob Check-in] Last error:",J.lastError)}catch{M+=`: ${k.substring(0,500)}`}throw new Error(M)}if(!((h=N.headers.get("Content-Type"))!=null&&h.includes("application/json")))return{success:!1,message:`Received non-JSON response. Content-Type: ${N.headers.get("Content-Type")}. Raw: ${k.substring(0,500)}`};const w=JSON.parse(k);if(console.log("[HiBob Check-in] Parsed response:",w),w.debug&&(console.group("[HiBob Check-in] Debug Info:"),w.debug.forEach(M=>console.log(M)),console.groupEnd()),w.lastError&&console.error("[HiBob Check-in] Last Error:",w.lastError),w.fallbackUsed)return console.warn('[HiBob Check-in]  Check-in failed, but fallback goal update succeeded (will appear as "OmniMap Updated" activity)'),{...w,methodUsed:"goal_update_fallback"};if(!w.success&&!p){console.warn("[HiBob Check-in]  Check-in failed:",w.message),console.log("[HiBob Check-in] Trying goal update fallback...");const M=await this.pushGoalUpdateToHiBob(t,a,o,c,d);return M.success?(console.log('[HiBob Check-in]  Fallback goal update succeeded (will appear as "OmniMap Updated" activity)'),{...M,fallbackUsed:!0,methodUsed:"goal_update_fallback"}):(console.error("[HiBob Check-in]  Both check-in and fallback failed"),w)}return w.success?(console.log("[HiBob Check-in]  Check-in created successfully"),{...w,methodUsed:"check_in"}):w}catch(y){return console.error("[HiBob Check-in] Fetch Exception:",y),{success:!1,message:y.message||"Unknown network error"}}}async syncWorkableJobs(t){return this.dispatch({action:"SYNC_WORKABLE_JOBS",workableConfig:t})}async syncSalesforce(t){return this.dispatch({action:"SYNC_SALESFORCE",salesforceConfig:t})}async syncJiraIssues(t){var o;const a=this.getScriptUrl();if(!a)return{success:!1,message:"No Script URL Configured"};try{const c=a.includes("?")?"&":"?",d=new URLSearchParams({action:"SYNC_JIRA",domain:t.domain,email:t.email,token:t.apiToken,projectKeys:t.projectKeys||""}),p=`${a}${c}${d.toString()}`;console.log("[Jira Sync] Fetching from:",t.domain);const v=await(await fetch(p,{method:"GET"})).text();try{const h=JSON.parse(v);return console.log("[Jira Sync] Response:",h.success?`Found ${((o=h.issues)==null?void 0:o.length)||0} issues`:h.message),h}catch(h){return console.error("[Jira Sync] Parse error:",h),{success:!1,message:"Invalid JSON response from backend",error:v.substring(0,500)}}}catch(c){return console.error("[Jira Sync] Fetch error:",c),{success:!1,message:c.message||"Network error"}}}}const Ie=new Gv,gt=({isOpen:s,onClose:t,title:a,children:o,maxWidth:c="max-w-2xl"})=>{const[d,p]=I.useState(!1),[g,v]=I.useState(!1);return I.useEffect(()=>{if(s)requestAnimationFrame(()=>{p(!0),requestAnimationFrame(()=>{v(!0)})});else{requestAnimationFrame(()=>v(!1));const h=setTimeout(()=>p(!1),200);return()=>clearTimeout(h)}},[s]),d?i.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[i.jsx("div",{className:`
          absolute inset-0 bg-slate-900/40 backdrop-blur-sm transition-opacity duration-200
          ${g?"opacity-100":"opacity-0"}
        `,onClick:t}),i.jsx("div",{className:`
          relative w-full ${c} transition-all duration-300 ease-out
          ${g?"opacity-100 translate-y-0 scale-100":"opacity-0 translate-y-4 scale-98"}
        `,children:i.jsxs("div",{className:"bg-white rounded-xl shadow-elevated border border-slate-300 overflow-hidden",children:[i.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 flex justify-between items-center",children:[i.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:a}),i.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-100 rounded-lg text-slate-500 hover:text-slate-600 transition-colors",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"p-6 max-h-[80vh] overflow-y-auto",children:o})]})})]}):null},Rm=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Im=({onSync:s,onJiraSync:t,isSyncing:a,lastSync:o,globalPeriod:c,onPeriodChange:d})=>{const[p,g]=I.useState(""),[v,h]=I.useState(!1),[y,b]=I.useState(!1),[S,N]=I.useState(!1),[k,w]=I.useState("general"),[M,J]=I.useState(!1),[ce,ee]=I.useState(null),[P,Q]=I.useState(!1),[H,V]=I.useState({serviceId:"",token:""}),[q,X]=I.useState(null),[fe,F]=I.useState(""),[re,oe]=I.useState(""),[se,ae]=I.useState(null),[A,U]=I.useState(!1),[ue,L]=I.useState(""),[W,C]=I.useState({subdomain:"",token:""}),[_,O]=I.useState(null),[z,ne]=I.useState({instanceUrl:"",clientId:"",clientSecret:"",refreshToken:""}),[xe,ge]=I.useState(null);I.useEffect(()=>{if(v){const me=Ie.getScriptUrl();me&&g(me)}},[v]),I.useEffect(()=>{const me=localStorage.getItem("omnimap_hibob_config");if(me){const Ut=JSON.parse(me);V(Ut),Ut.manualGoalType&&L(Ut.manualGoalType)}const Ze=localStorage.getItem("omnimap_workable_config");Ze&&C(JSON.parse(Ze));const ut=localStorage.getItem("omnimap_salesforce_config");ut&&ne(JSON.parse(ut))},[]);const Se=()=>{Ie.setScriptUrl(p),h(!1),s()},_e=async()=>{Q(!0);try{const me=await Ie.fetchData();ee(me)}catch(me){console.error(me)}finally{Q(!1)}},nt=me=>{L(me);const Ze={...H,manualGoalType:me};localStorage.setItem("omnimap_hibob_config",JSON.stringify(Ze))},G=async me=>{const Ze={...H,manualGoalType:ue};localStorage.setItem("omnimap_hibob_config",JSON.stringify(Ze));const ut=me==="PUSH"&&fe?fe:void 0,Ut=me==="PUSH"?ut?`Pushing Goals for ${ut}...`:"Pushing ALL Goals to HiBob...":"Connecting to HiBob via Backend...";X(Ut);try{let Fe=!1;me==="PULL"?Fe=await Ie.syncHiBobPeople(Ze):Fe=await Ie.pushGoalsToHiBob(Ze,ut),Fe?(X("Success! Request sent. Allow 30s for processing then refresh."),me==="PULL"&&setTimeout(s,2e3)):X("Failed to send request. Check console.")}catch(Fe){X(`Error: ${Fe.message}`)}},he=async(me,Ze,ut)=>{if(me!=="TEST_GET_TAGS"&&me!=="TEST_CHECK_IN"&&!fe){ae({error:"Please enter an email address."});return}if(me==="TEST_CHECK_IN"&&!Ze&&!re){ae({error:"Please enter a Goal ID or use 'Get Single Goal' first."});return}U(!0),ae(null);const Ut={...H,manualGoalType:ue};localStorage.setItem("omnimap_hibob_config",JSON.stringify(Ut));try{const Fe=await Ie.testHiBob({...H,serviceId:H.serviceId+(ue?`&manualGoalType=${ue}`:"")},fe||"",me,Ze||re||void 0,ut);ae(Fe)}catch(Fe){ae({error:Fe.message})}finally{U(!1)}},be=async()=>{localStorage.setItem("omnimap_workable_config",JSON.stringify(W)),O("Connecting to Workable via Backend...");try{await Ie.syncWorkableJobs(W)?(O("Success! Jobs are syncing to Roadmap Items."),setTimeout(s,2e3)):O("Failed. Check API token and Subdomain.")}catch(me){O(`Error: ${me.message}`)}},Pe=async()=>{localStorage.setItem("omnimap_salesforce_config",JSON.stringify(z)),ge("Authenticating & Pulling Data (this takes ~10s)...");try{await Ie.syncSalesforce(z)?(ge("Success! Actuals updated in Google Sheets."),setTimeout(s,3e3)):ge("Failed. Check configuration or logs.")}catch(me){ge(`Error: ${me.message}`)}},ke=`/**
 * OmniMap Backend Script v7.65 (DEBUG LOGGING)
 * FIXED: Removed all ?. optional chaining for older Google Apps Script compatibility
 * FEATURE: PUSH_SINGLE_GOAL now accepts direct item parameters (p_title, p_owner etc)
 * FIXED: Improved duplicate detection using hibobGoalId and better title matching
 * FIXED: Category field now included in updates (tags field)
 * NEW: Smart tag resolution - automatically detects HiBob tag format (string/object/id) and uses correct format
 * NEW: Push existing check-ins when goal is pushed
 * NEW: Update existing goals with status, progress, and all fields
 * NEW: PUSH_CHECK_IN action uses PATCH /goals/goals/{goalId}/key-results/progress endpoint
 * NEW: Status updates use PATCH /goals/goals/{goalId}/status endpoint
 * NEW: Automatic mapping of PERSONAL/DEPARTMENT/COMPANY to HiBob Goal Type IDs
 * NEW: Support for Goal Type (PERSONAL/DEPARTMENT/COMPANY) and Category (PERFORMANCE/DEVELOPMENT)
 * IMPROVED: Enhanced owner finder with better email extraction and multiple HiBob search strategies
 * IMPROVED: Tag format detection by examining existing goals before pushing
 * This allows the frontend to push items immediately without waiting for sheet sync.
 */

// Helper function to safely get nested properties (replaces optional chaining ?.)
function safeGet(obj, path, defaultVal) {
  if (defaultVal === undefined) defaultVal = null;
  if (!obj) return defaultVal;
  var parts = path.split('.');
  var current = obj;
  for (var i = 0; i < parts.length; i++) {
    if (current === null || current === undefined) return defaultVal;
    current = current[parts[i]];
  }
  return (current !== undefined && current !== null) ? current : defaultVal;
}

function doGet(e) {
  var params = e.parameter;
  
  // --- SINGLE GOAL PUSH (GET METHOD) ---
  if (params.action === 'PUSH_SINGLE_GOAL') {
      var serviceId = params.serviceId;
      var token = params.token;
      var itemId = params.itemId;
      var manualGoalType = params.manualGoalType || "";
      
      var authHeader = 'Basic ' + Utilities.base64Encode(serviceId + ':' + token);
      var headers = { 'Authorization': authHeader, 'Accept': 'application/json' };
      
      var ss = SpreadsheetApp.getActiveSpreadsheet();
      var employeesSheet = ss.getSheetByName('Employees') || ss.getSheetByName('Team');
      if (!employeesSheet) return jsonResp({ success: false, message: "Employee Sheet not found" });
      var employees = employeesSheet.getDataRange().getValues().slice(1);

      var ownerName = "";
      var title = "";
      var desc = "";
      var start = "";
      var end = "";
      var goalType = params.p_goal_type || "PERSONAL";
      var goalCategory = params.p_goal_category || "PERFORMANCE";
      var status = params.p_status || "Not Started";
      var progress = parseFloat(params.p_progress || "0");
      var existingHibobGoalId = params.p_hibob_goal_id || null;

      // 1. Try to get data from direct params (Preferred for immediate push)
      if (params.p_title && params.p_owner) {
          title = params.p_title;
          ownerName = params.p_owner;
          desc = params.p_desc || "";
          start = params.p_start || new Date().toISOString().split('T')[0];
          end = params.p_end || new Date(new Date().getTime() + (365*24*60*60*1000)).toISOString().split('T')[0];
          goalType = params.p_goal_type || "PERSONAL";
          goalCategory = params.p_goal_category || "PERFORMANCE";
          status = params.p_status || "Not Started";
          progress = parseFloat(params.p_progress || "0");
          existingHibobGoalId = params.p_hibob_goal_id || null;
      } 
      // 2. Fallback to sheet lookup
      else {
          var itemsSheet = ss.getSheetByName('AllGoals') || ss.getSheetByName('RoadmapItems');
          if (!itemsSheet) return jsonResp({ success: false, message: "Goal Sheet not found" });
          var items = itemsSheet.getDataRange().getValues().slice(1);
          var itemRow = items.find(function(row) { return String(row[0]) === itemId; });
          if (!itemRow) return jsonResp({ success: false, message: "Item ID not found in sheet: " + itemId });
          
          ownerName = itemRow[2];
          title = itemRow[3];
          desc = itemRow[4];
          // Default dates if missing
          start = new Date().toISOString().split('T')[0];
          end = new Date(new Date().getTime() + (365*24*60*60*1000)).toISOString().split('T')[0];
      }
      
      // --- IMPROVED OWNER FINDER WITH EMAIL SUPPORT ---
      var hibobOwnerId = null;
      var debugSteps = [];
      
      // Step 1: Try direct email parameter (if provided)
      var ownerEmail = params.p_owner_email;
      if (ownerEmail && String(ownerEmail).includes('@')) {
          debugSteps.push("Trying email search: " + ownerEmail);
          try {
               var searchUrl = 'https://api.hibob.com/v1/people/search';
               var searchPayload = {
                  "fields": ["root.email", "id"],
                  "filters": [{ "fieldPath": "root.email", "operator": "equals", "values": [String(ownerEmail).trim()] }]
               };
               var searchRes = UrlFetchApp.fetch(searchUrl, {
                  method: 'post', headers: headers, contentType: 'application/json',
                  payload: JSON.stringify(searchPayload), muteHttpExceptions: true
               });
               if (searchRes.getResponseCode() === 200) {
                   var searchJson = JSON.parse(searchRes.getContentText());
                   if (searchJson.employees && searchJson.employees.length > 0) {
                       hibobOwnerId = searchJson.employees[0].id;
                       debugSteps.push("Found via email: " + hibobOwnerId);
                   } else {
                       debugSteps.push("Email search returned no results");
                   }
               } else {
                   debugSteps.push("Email search failed with status: " + searchRes.getResponseCode());
               }
          } catch(e) {
              debugSteps.push("Email search exception: " + e.toString());
          }
      }
      
      // Step 2: Try direct match in employees sheet (by ID or name)
      if (!hibobOwnerId) {
          var directMatch = employees.find(function(e) { return e[1] === ownerName || e[0] === ownerName; });
          if (directMatch && String(directMatch[0]).length > 10) {
              hibobOwnerId = directMatch[0];
              debugSteps.push("Found via direct sheet match (ID): " + hibobOwnerId);
          }
      }
      
      // Step 3: Try fuzzy name match in employees sheet, then email lookup
      if (!hibobOwnerId) {
          debugSteps.push("Trying fuzzy name match for: " + ownerName);
          var empRow = employees.find(function(e) {
              var sheetName = String(e[1] || "").toLowerCase().trim();
              var target = String(ownerName).toLowerCase().trim();
              return sheetName === target || String(e[0] || "").toLowerCase() === target || 
                     sheetName.includes(target) || target.includes(sheetName);
          });
          
          if (empRow) {
              debugSteps.push("Found employee row in sheet (columns: " + empRow.length + ")");
              // Try to find email in any column - check all columns more thoroughly
              var email = null;
              for (var i = 0; i < empRow.length; i++) {
                  var cell = String(empRow[i] || "").trim();
                  // Check if it looks like an email
                  if (cell.includes('@') && cell.includes('.') && cell.length > 5) {
                      // Basic email validation
                      var emailPattern = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;
                      if (emailPattern.test(cell)) {
                          email = cell;
                          debugSteps.push("Found email in column " + i + ": " + email);
                          break;
                      }
                  }
              }
              
              if (email) {
                  try {
                       var searchUrl = 'https://api.hibob.com/v1/people/search';
                       var searchPayload = {
                          "fields": ["root.email", "id"],
                          "filters": [{ "fieldPath": "root.email", "operator": "equals", "values": [String(email).trim()] }]
                       };
                       var searchRes = UrlFetchApp.fetch(searchUrl, {
                          method: 'post', headers: headers, contentType: 'application/json',
                          payload: JSON.stringify(searchPayload), muteHttpExceptions: true
                       });
                       if (searchRes.getResponseCode() === 200) {
                           var searchJson = JSON.parse(searchRes.getContentText());
                           if (searchJson.employees && searchJson.employees.length > 0) {
                               hibobOwnerId = searchJson.employees[0].id;
                               debugSteps.push("Found via sheet email lookup: " + hibobOwnerId);
                           } else {
                               debugSteps.push("Sheet email lookup returned no results for: " + email);
                           }
                       } else {
                           var errorText = searchRes.getContentText();
                           debugSteps.push("Sheet email lookup failed: " + searchRes.getResponseCode() + " - " + errorText.substring(0, 200));
                       }
                  } catch(e) {
                      debugSteps.push("Sheet email lookup exception: " + e.toString());
                  }
              } else {
                  debugSteps.push("No email found in employee row. Row data: " + JSON.stringify(empRow).substring(0, 200));
              }
          } else {
              debugSteps.push("Employee row not found in sheet for: " + ownerName);
          }
      }
      
      // Step 4: Try searching HiBob directly by name as last resort
      if (!hibobOwnerId) {
          debugSteps.push("Trying direct HiBob name search for: " + ownerName);
          try {
              var searchUrl = 'https://api.hibob.com/v1/people/search';
              
              // Try multiple search strategies
              var nameParts = ownerName.split(' ').filter(function(p) { return p.length > 0; });
              var firstName = nameParts[0] || "";
              var lastName = nameParts.slice(1).join(' ') || "";
              
              // Strategy 1: Search by first name and last name separately
              var searchPayload = null;
              if (firstName && lastName) {
                  debugSteps.push("Trying firstName + lastName search");
                  searchPayload = {
                      "fields": ["root.firstName", "root.lastName", "root.displayName", "id", "root.email"],
                      "filters": [{ 
                          "fieldPath": "root.firstName", 
                          "operator": "equals", 
                          "values": [firstName] 
                      }, {
                          "fieldPath": "root.lastName",
                          "operator": "equals",
                          "values": [lastName]
                      }]
                  };
              } else {
                  // Strategy 2: Search without filters and match in results
                  debugSteps.push("Trying broad search without filters");
                  searchPayload = {
                      "fields": ["root.firstName", "root.lastName", "root.displayName", "id", "root.email"],
                      "filters": []
                  };
              }
              
              var searchRes = UrlFetchApp.fetch(searchUrl, {
                  method: 'post', headers: headers, contentType: 'application/json',
                  payload: JSON.stringify(searchPayload), muteHttpExceptions: true
              });
              
              if (searchRes.getResponseCode() === 200) {
                  var searchJson = JSON.parse(searchRes.getContentText());
                  if (searchJson.employees && searchJson.employees.length > 0) {
                      // If we searched without filters, try to match by name
                      if (!firstName || !lastName) {
                          var targetLower = ownerName.toLowerCase();
                          var match = searchJson.employees.find(function(emp) {
                              var displayName = (safeGet(emp, 'fields.displayName.value') || emp.displayName || "").toLowerCase();
                              var fullName = ((safeGet(emp, 'fields.firstName.value') || emp.firstName || "") + " " + (safeGet(emp, 'fields.lastName.value') || emp.lastName || "")).toLowerCase().trim();
                              return displayName === targetLower || fullName === targetLower || 
                                     displayName.includes(targetLower) || fullName.includes(targetLower);
                          });
                          if (match) {
                              hibobOwnerId = match.id;
                              debugSteps.push("Found via HiBob name search (matched in results): " + hibobOwnerId);
                          } else {
                              debugSteps.push("HiBob name search returned results but no name match");
                          }
                      } else {
                          hibobOwnerId = searchJson.employees[0].id;
                          debugSteps.push("Found via HiBob name search (firstName+lastName): " + hibobOwnerId);
                      }
                  } else {
                      debugSteps.push("HiBob name search returned no results");
                  }
              } else {
                  var errorText = searchRes.getContentText();
                  debugSteps.push("HiBob name search failed: " + searchRes.getResponseCode() + " - " + errorText.substring(0, 300));
              }
          } catch(e) {
              debugSteps.push("HiBob name search exception: " + e.toString());
          }
      }
      
      if (!hibobOwnerId) {
          return jsonResp({ 
              success: false, 
              message: "Owner '" + ownerName + "' not found in HiBob. Debug: " + debugSteps.join(" | ") 
          });
      }
      
      // --- GOAL TYPE RESOLUTION ---
      // Map app goal types to HiBob goal type IDs
      // PERSONAL  Individual, DEPARTMENT  Department, COMPANY  Company
      var typeId = null;
      var goalTypeDebug = [];
      
      // First, try to fetch goal types from HiBob to map correctly
      try {
          var typeSearchUrl = 'https://api.hibob.com/v1/goals/goal-types/search';
          var typeRes = UrlFetchApp.fetch(typeSearchUrl, {
              method: 'post', headers: headers, contentType: 'application/json',
              payload: JSON.stringify({ "fields": ["id", "name"] }), 
              muteHttpExceptions: true
          });
          
          if (typeRes.getResponseCode() === 200) {
              var typeJson = JSON.parse(typeRes.getContentText());
              goalTypeDebug.push("Goal types API returned: " + typeRes.getResponseCode());
              
              // Try different response formats
              var goalTypes = [];
              if (typeJson.items && typeJson.items.length > 0) {
                  goalTypes = typeJson.items;
              } else if (typeJson.goalTypes && typeJson.goalTypes.items && typeJson.goalTypes.items.length > 0) {
                  goalTypes = typeJson.goalTypes.items;
              } else if (Array.isArray(typeJson)) {
                  goalTypes = typeJson;
              }
              
              if (goalTypes.length > 0) {
                  // Map goalType (PERSONAL/DEPARTMENT/COMPANY) to HiBob goal type ID
                  var goalTypeUpper = String(goalType).toUpperCase();
                  goalTypeDebug.push("Mapping goalType: " + goalTypeUpper);
                  
                  // Find matching goal type by name
                  var matchedType = null;
                  if (goalTypeUpper === 'PERSONAL') {
                      matchedType = goalTypes.find(function(gt) {
                          var name = (gt.name || safeGet(gt, 'fields.name.value') || safeGet(gt, 'fields.name') || "").toLowerCase();
                          return name.includes('individual') || name.includes('personal');
                      });
                  } else if (goalTypeUpper === 'DEPARTMENT') {
                      matchedType = goalTypes.find(function(gt) {
                          var name = (gt.name || safeGet(gt, 'fields.name.value') || safeGet(gt, 'fields.name') || "").toLowerCase();
                          return name.includes('department');
                      });
                  } else if (goalTypeUpper === 'COMPANY') {
                      matchedType = goalTypes.find(function(gt) {
                          var name = (gt.name || safeGet(gt, 'fields.name.value') || safeGet(gt, 'fields.name') || "").toLowerCase();
                          return name.includes('company');
                      });
                  }
                  
                  if (matchedType) {
                      typeId = matchedType.id || safeGet(matchedType, 'fields.id.value') || safeGet(matchedType, 'fields.id') || null;
                      var typeName = matchedType.name || safeGet(matchedType, 'fields.name.value') || safeGet(matchedType, 'fields.name') || "unnamed";
                      goalTypeDebug.push("Mapped to HiBob goal type: " + typeId + " (" + typeName + ")");
                  } else {
                      goalTypeDebug.push("Could not find matching goal type for: " + goalTypeUpper);
                      // Fallback: use first available type
                      var firstType = goalTypes[0];
                      typeId = firstType.id || safeGet(firstType, 'fields.id.value') || safeGet(firstType, 'fields.id') || null;
                      var typeName = firstType.name || safeGet(firstType, 'fields.name.value') || safeGet(firstType, 'fields.name') || "unnamed";
                      goalTypeDebug.push("Using fallback (first available): " + typeId + " (" + typeName + ")");
                  }
              } else {
                  goalTypeDebug.push("Goal types API returned empty. Full response: " + JSON.stringify(typeJson).substring(0, 300));
              }
          } else {
              var errorText = typeRes.getContentText();
              goalTypeDebug.push("Goal types API failed: " + typeRes.getResponseCode() + " - " + errorText.substring(0, 300));
          }
      } catch(e) {
          goalTypeDebug.push("Goal types API exception: " + e.toString());
      }
      
      // If mapping failed, try manual Goal Type ID as fallback
      if (!typeId && manualGoalType) {
          typeId = manualGoalType;
          goalTypeDebug.push("Using manual Goal Type ID fallback: " + typeId);
      }
      
      if (!typeId) {
          return jsonResp({ 
              success: false, 
              message: "Could not resolve Goal Type ID. Please enter manually in Bulk Creator settings. Debug: " + goalTypeDebug.join(" | ") 
          });
      }

      // --- PUSH TO HIBOB ---
      var baseEndpoint = 'https://api.hibob.com/v1/goals/goals';
      
      // --- TAG RESOLUTION ---
      // Try to determine the correct tag format by fetching an existing goal or available tags
      var tagFormat = null; // Will store the format: "string", "object", or "id"
      var resolvedTagValue = null; // Will store the actual tag value to use
      var tagDebug = [];
      
      // Strategy 1: Try to fetch an existing goal to see tag format
      try {
          var sampleSearchUrl = baseEndpoint + '/search';
          var sampleSearchPayload = {
                 "fields": ["id", "tags"],
                 "filters": [{ "fieldPath": "owner.id", "operator": "equals", "values": [hibobOwnerId] }]
          };
          var sampleSearchRes = UrlFetchApp.fetch(sampleSearchUrl, {
              method: 'post', headers: headers, contentType: 'application/json',
              payload: JSON.stringify(sampleSearchPayload), muteHttpExceptions: true
          });
          if (sampleSearchRes.getResponseCode() === 200) {
              var sampleJson = JSON.parse(sampleSearchRes.getContentText());
              if (sampleJson.items && sampleJson.items.length > 0) {
                  var sampleGoal = sampleJson.items[0];
                  var sampleTags = safeGet(sampleGoal, 'fields.tags.value') || sampleGoal.tags;
                  if (sampleTags && Array.isArray(sampleTags) && sampleTags.length > 0) {
                      var firstTag = sampleTags[0];
                      if (typeof firstTag === 'string') {
                          tagFormat = "string";
                          tagDebug.push("Detected tag format: string array");
                      } else if (typeof firstTag === 'object' && firstTag.id) {
                          tagFormat = "id";
                          tagDebug.push("Detected tag format: object with id");
                      } else if (typeof firstTag === 'object' && firstTag.name) {
                          tagFormat = "object";
                          tagDebug.push("Detected tag format: object with name");
                      }
                      tagDebug.push("Sample tag structure: " + JSON.stringify(firstTag).substring(0, 200));
                  }
              }
          }
      } catch(e) {
          tagDebug.push("Tag format detection failed: " + e.toString());
      }
      
      // Strategy 2: Map goalCategory to tag value
      var goalCategoryUpper = String(goalCategory).toUpperCase();
      var tagName = null;
      if (goalCategoryUpper === "PERFORMANCE") {
          tagName = "Performance";
      } else if (goalCategoryUpper === "DEVELOPMENT") {
          tagName = "Development";
      } else {
          tagName = goalCategory;
      }
      
      // If we detected a format, use it; otherwise default to string
      if (tagFormat === "id") {
          // Try to find tag ID by searching for tags
          try {
              var tagSearchUrl = baseEndpoint + '/search';
              var tagSearchPayload = {
                     "fields": ["tags"],
                     "filters": []
              };
              var tagSearchRes = UrlFetchApp.fetch(tagSearchUrl, {
                  method: 'post', headers: headers, contentType: 'application/json',
                  payload: JSON.stringify(tagSearchPayload), muteHttpExceptions: true
              });
              if (tagSearchRes.getResponseCode() === 200) {
                  var tagSearchJson = JSON.parse(tagSearchRes.getContentText());
                  // Look through goals to find a tag matching our tagName
                  var goalsArr = tagSearchJson.items || [];
                  for (var gi = 0; gi < goalsArr.length; gi++) {
                      var goal = goalsArr[gi];
                      var tags = safeGet(goal, 'fields.tags.value') || goal.tags || [];
                      for (var ti = 0; ti < tags.length; ti++) {
                          var tag = tags[ti];
                          if (typeof tag === 'object' && tag.id && (tag.name === tagName || (tag.name && tag.name.toLowerCase() === tagName.toLowerCase()))) {
                              resolvedTagValue = [{ "id": tag.id }];
                              tagDebug.push("Found tag ID: " + tag.id + " for name: " + tagName);
                              break;
                          }
                      }
                      if (resolvedTagValue) break;
                  }
              }
          } catch(e) {
              tagDebug.push("Tag ID search failed: " + e.toString());
          }
          // Fallback: use tag name if ID not found
          if (!resolvedTagValue) {
              resolvedTagValue = [tagName];
              tagDebug.push("Using tag name as fallback: " + tagName);
          }
      } else if (tagFormat === "object") {
          resolvedTagValue = [{ "name": tagName }];
          tagDebug.push("Using tag object format with name: " + tagName);
      } else {
          // Default: string format
          resolvedTagValue = [tagName];
          tagDebug.push("Using tag string format: " + tagName);
      }
      
      // Final fallback: if resolvedTagValue is still null, use string format
      if (!resolvedTagValue) {
          resolvedTagValue = [tagName || goalCategory];
          tagDebug.push("Final fallback: using tag name as string");
      }
      
      // First, check if we have an existing HiBob goal ID from params
      var existingId = existingHibobGoalId;
      
      // If no ID provided, search for existing goal by title
      if (!existingId) {
          try {
              var searchUrl = baseEndpoint + '/search';
              var searchPayload = {
                     "fields": ["id", "title", "name"],
                     "filters": [{ "fieldPath": "owner.id", "operator": "equals", "values": [hibobOwnerId] }]
              };
              var searchRes = UrlFetchApp.fetch(searchUrl, {
                  method: 'post', headers: headers, contentType: 'application/json',
                  payload: JSON.stringify(searchPayload), muteHttpExceptions: true
              });
              if (searchRes.getResponseCode() === 200) {
                  var json = JSON.parse(searchRes.getContentText());
                  // Try multiple field names and do case-insensitive comparison
                  var titleLower = String(title).toLowerCase().trim();
                  var match = (json.items || []).find(function(g) {
                      var goalTitle = (safeGet(g, 'fields.title.value') || safeGet(g, 'fields.name.value') || g.title || g.name || "").toLowerCase().trim();
                      return goalTitle === titleLower || goalTitle.includes(titleLower) || titleLower.includes(goalTitle);
                  });
                  if (match) {
                      existingId = match.id || safeGet(match, 'fields.id.value') || safeGet(match, 'fields.id');
                  }
              }
          } catch (e) {
              // Log error but continue - we'll create new if search fails
          }
      }

      try {
          var apiRes;
          var statusUpdateInfo = null;
          
          if (existingId) {
                // Map status to HiBob status values (using correct enum: onTrack, offTrack, completed, incomplete, other)
                var hibobStatus = "onTrack"; // Default
                var statusLower = String(status).toLowerCase();
                if (statusLower.includes('done') || statusLower.includes('complete')) {
                    hibobStatus = "completed";
                } else if (statusLower.includes('progress') || statusLower.includes('on track') || statusLower.includes('on_track')) {
                    hibobStatus = "onTrack"; // In progress or On Track = on track
                } else if (statusLower.includes('blocked')) {
                    hibobStatus = "offTrack"; // Blocked = off track
                } else if (statusLower.includes('paused') || statusLower.includes('on hold')) {
                    hibobStatus = "other"; // Paused = other (not off track, just on hold)
                } else if (statusLower.includes('not started') || statusLower.includes('not_started')) {
                    hibobStatus = "incomplete";
                } else {
                    hibobStatus = "onTrack"; // Default to onTrack
                }
                
                // Update other fields first (title, description, dates, progress, tags)
                var updatePayload = {
                    "items": [{
                            "objectType": "goal",
                            "fields": {
                                "title": { "value": title },
                                "description": { "value": desc },
                                "startDate": { "value": start },
                                "dueDate": { "value": end },
                                "progress": { "value": Math.min(100, Math.max(0, progress)) },
                                "tags": { "value": resolvedTagValue }
                            }
                    }]
                };
                apiRes = UrlFetchApp.fetch(baseEndpoint + '/' + existingId, {
                    method: 'patch', headers: headers, contentType: 'application/json',
                    payload: JSON.stringify(updatePayload), muteHttpExceptions: true
                });
                
                // ALWAYS update status separately using dedicated status endpoint (PATCH /goals/goals/{goalId}/status)
                // This happens regardless of whether other updates succeeded
                var statusUpdateSuccess = false;
                var statusUpdateError = null;
                var statusUpdateDebug = [];
                
                statusUpdateDebug.push("Attempting status update for goal ID: " + existingId);
                statusUpdateDebug.push("Mapped status from '" + status + "' to '" + hibobStatus + "'");
                
                try {
                    var statusUpdatePayload = {
                        "status": hibobStatus
                    };
                    var statusUpdateUrl = baseEndpoint + '/' + existingId + '/status';
                    statusUpdateDebug.push("Status update URL: " + statusUpdateUrl);
                    statusUpdateDebug.push("Status update payload: " + JSON.stringify(statusUpdatePayload));
                    
                    var statusUpdateRes = UrlFetchApp.fetch(statusUpdateUrl, {
                        method: 'patch', headers: headers, contentType: 'application/json',
                        payload: JSON.stringify(statusUpdatePayload), muteHttpExceptions: true
                    });
                    var statusUpdateCode = statusUpdateRes.getResponseCode();
                    var statusUpdateResponseText = statusUpdateRes.getContentText();
                    
                    statusUpdateDebug.push("Status update HTTP code: " + statusUpdateCode);
                    statusUpdateDebug.push("Status update response: " + statusUpdateResponseText.substring(0, 300));
                    
                    if (statusUpdateCode >= 200 && statusUpdateCode < 300) {
                        statusUpdateSuccess = true;
                        statusUpdateDebug.push("Status update SUCCESS");
                    } else {
                        statusUpdateError = "Status update failed: HTTP " + statusUpdateCode + " - " + statusUpdateResponseText.substring(0, 200);
                        statusUpdateDebug.push("Status update FAILED: " + statusUpdateError);
                    }
                } catch(statusErr) {
                    statusUpdateError = "Status update exception: " + statusErr.toString();
                    statusUpdateDebug.push("Status update EXCEPTION: " + statusUpdateError);
                }
                
                // Store status update info for response
                statusUpdateInfo = {
                    attempted: true,
                    success: statusUpdateSuccess,
                    targetStatus: hibobStatus,
                    originalStatus: status,
                    error: statusUpdateError,
                    debug: statusUpdateDebug
                };
          } else {
                var payloadWrapper = {
                    "items": [{
                            "objectType": "goal",
                            "fields": {
                                "title": { "value": title },
                                "description": { "value": desc },
                                "owner": { "value": hibobOwnerId },
                                "startDate": { "value": start },
                                "dueDate": { "value": end },
                                "isPrivate": { "value": false },
                                "typeId": { "value": typeId },
                                "tags": { "value": resolvedTagValue }
                            }
                    }]
                };
                apiRes = UrlFetchApp.fetch(baseEndpoint, {
                    method: 'post', headers: headers, contentType: 'application/json',
                    payload: JSON.stringify(payloadWrapper), muteHttpExceptions: true
                });
          }
          
          if (apiRes.getResponseCode() >= 200 && apiRes.getResponseCode() < 300) {
              var hibobGoalId = existingId;
              if (!hibobGoalId) {
                  // Extract goal ID from creation response
                  try {
                      var responseJson = JSON.parse(apiRes.getContentText());
                      hibobGoalId = (responseJson.items && responseJson.items[0] && responseJson.items[0].id) || responseJson.id || null;
                  } catch(e) {
                      // If we can't parse, try to find the goal by searching again
                      try {
                          var searchUrl = baseEndpoint + '/search';
                          var searchPayload = {
                                 "fields": ["id", "title"],
                                 "filters": [{ "fieldPath": "owner.id", "operator": "equals", "values": [hibobOwnerId] }]
                          };
                          var searchRes = UrlFetchApp.fetch(searchUrl, {
                              method: 'post', headers: headers, contentType: 'application/json',
                              payload: JSON.stringify(searchPayload), muteHttpExceptions: true
                          });
                          if (searchRes.getResponseCode() === 200) {
                              var json = JSON.parse(searchRes.getContentText());
                              var match = (json.items || []).find(function(g) { return (safeGet(g, 'fields.title.value') || g.title || g.name) === title; });
                              if (match) hibobGoalId = match.id || safeGet(match, 'fields.id.value');
                          }
                      } catch(e2) {}
                  }
              }
              var responseMessage = existingId ? "Goal Updated in HiBob" : "Goal Created in HiBob";
              if (statusUpdateInfo) {
                  if (statusUpdateInfo.success) {
                      responseMessage += ". Status updated to: " + statusUpdateInfo.targetStatus;
                  } else {
                      responseMessage += ". Status update failed: " + (statusUpdateInfo.error || "Unknown error");
                  }
              }
              
              var responseObj = { 
                  success: true, 
                  message: responseMessage,
                  hibobGoalId: hibobGoalId,
                  scriptVersion: "7.65" // Version check - if you don't see this, you need to redeploy!
              };
              
              if (tagDebug.length > 0) {
                  responseObj.tagDebug = tagDebug;
              }
              
              // Always include statusUpdateInfo (even if null) for debugging
              responseObj.statusUpdateInfo = statusUpdateInfo;
              
              return jsonResp(responseObj);
          } else {
              var errorText = apiRes.getContentText();
              var errorMsg = "HiBob API Error: " + errorText;
              return jsonResp({ 
                  success: false, 
                  message: errorMsg,
                  tagDebug: tagDebug.length > 0 ? tagDebug : undefined,
                  tagValueUsed: resolvedTagValue
              });
          }
      } catch(e) {
          return jsonResp({ success: false, message: "Fetch Exception: " + e.toString() });
      }
  }
  
  // --- PUSH GOAL UPDATE (Monthly Update as Goal Note/Description Update) ---
  if (params.action === 'PUSH_GOAL_UPDATE') {
      var serviceId = params.serviceId;
      var token = params.token;
      var goalId = params.goalId;
      var updateContent = params.content || "";
      var updateDate = params.updateDate || new Date().toISOString().split('T')[0];
      var healthStatus = params.healthStatus || "GREEN";
      
      var authHeader = 'Basic ' + Utilities.base64Encode(serviceId + ':' + token);
      var headers = { 'Authorization': authHeader, 'Accept': 'application/json' };
      
      if (!goalId) {
          return jsonResp({ success: false, message: "Goal ID is required for goal update" });
      }
      
      try {
          // First, fetch current goal to get description
          var baseEndpoint = 'https://api.hibob.com/v1/goals/goals';
          var searchUrl = baseEndpoint + '/search';
          var searchPayload = {
                 "fields": ["id", "title", "description"],
                 "filters": [{ "fieldPath": "id", "operator": "equals", "values": [goalId] }]
          };
          var searchRes = UrlFetchApp.fetch(searchUrl, {
              method: 'post', headers: headers, contentType: 'application/json',
              payload: JSON.stringify(searchPayload), muteHttpExceptions: true
          });
          
          var currentDescription = "";
          if (searchRes.getResponseCode() === 200) {
              var searchJson = JSON.parse(searchRes.getContentText());
              if (searchJson.items && searchJson.items.length > 0) {
                  currentDescription = safeGet(searchJson.items[0], 'fields.description.value') || searchJson.items[0].description || "";
              }
          }
          
          // Format update content with date and health status
          var healthEmoji = healthStatus === "RED" ? "[RED]" : healthStatus === "AMBER" ? "[AMBER]" : "[GREEN]";
          var updateNote = "\\n\\n--- Monthly Update (" + updateDate + ") " + healthEmoji + " ---\\n" + updateContent;
          var newDescription = currentDescription + updateNote;
          
          // Update goal description to create activity entry
          var updatePayload = {
              "items": [{
                      "objectType": "goal",
                      "fields": {
                          "description": { "value": newDescription }
                      }
              }]
          };
          
          var apiRes = UrlFetchApp.fetch(baseEndpoint + '/' + goalId, {
              method: 'patch', headers: headers, contentType: 'application/json',
              payload: JSON.stringify(updatePayload), muteHttpExceptions: true
          });
          
          if (apiRes.getResponseCode() >= 200 && apiRes.getResponseCode() < 300) {
              return jsonResp({ success: true, message: "Goal updated with monthly update (appears as OmniMap activity)" });
          } else {
              return jsonResp({ success: false, message: "HiBob API Error: " + apiRes.getContentText() });
          }
      } catch(e) {
          return jsonResp({ success: false, message: "Goal Update Exception: " + e.toString() });
      }
  }
  
  // --- PUSH CHECK-IN (Monthly Update) ---
  // Uses PATCH /goals/goals/{goalId}/key-results/progress endpoint
  if (params.action === 'PUSH_CHECK_IN') {
      var serviceId = params.serviceId;
      var token = params.token;
      var goalId = params.goalId; // HiBob goal ID
      var checkInDate = params.checkInDate || new Date().toISOString().split('T')[0];
      var content = params.content || "";
      var healthStatus = params.healthStatus || "GREEN"; // GREEN, AMBER, RED
      
      var authHeader = 'Basic ' + Utilities.base64Encode(serviceId + ':' + token);
      var headers = { 'Authorization': authHeader, 'Accept': 'application/json' };
      
      var debugInfo = [];
      debugInfo.push("Check-in request received");
      debugInfo.push("Goal ID: " + goalId);
      debugInfo.push("Date: " + checkInDate);
      debugInfo.push("Status: " + healthStatus);
      debugInfo.push("Content length: " + content.length);
      
      if (!goalId) {
          return jsonResp({ success: false, message: "Goal ID is required for check-in", debug: debugInfo });
      }
      
      try {
          var baseEndpoint = 'https://api.hibob.com/v1/goals/goals';
          
          // First, try to fetch key results for this goal
          var keyResults = [];
          try {
              var searchUrl = baseEndpoint + '/search';
              var searchPayload = {
                     "fields": ["id", "keyResults"],
                     "filters": [{ "fieldPath": "id", "operator": "equals", "values": [goalId] }]
              };
              var searchRes = UrlFetchApp.fetch(searchUrl, {
                  method: 'post', headers: headers, contentType: 'application/json',
                  payload: JSON.stringify(searchPayload), muteHttpExceptions: true
              });
              
              if (searchRes.getResponseCode() === 200) {
                  var searchJson = JSON.parse(searchRes.getContentText());
                  if (searchJson.items && searchJson.items.length > 0) {
                      var goal = searchJson.items[0];
                      var krData = safeGet(goal, 'fields.keyResults.value') || goal.keyResults || [];
                      if (Array.isArray(krData) && krData.length > 0) {
                          // Extract key result IDs
                          keyResults = krData.map(function(kr) { return {
                              keyResultId: kr.id || safeGet(kr, 'fields.id.value') || safeGet(kr, 'fields.id'),
                              currentValue: kr.currentValue || safeGet(kr, 'fields.currentValue.value') || 0,
                              notes: "" // Can be filled with update content if needed
                          }; }).filter(function(kr) { return kr.keyResultId; });
                          debugInfo.push("Found " + keyResults.length + " key results");
                      }
                  }
              }
          } catch(krErr) {
              debugInfo.push("Key results fetch failed: " + krErr.toString());
          }
          
          // Format comment with date
          var monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
          var dateObj = new Date(checkInDate);
          var monthName = monthNames[dateObj.getMonth()] || 'Unknown';
          var year = dateObj.getFullYear();
          var checkInComment = "Monthly check-in  " + monthName + " " + year + (content ? ": " + content : "");
          
          // Map health status to goal status
          var statusValue = "onTrack";
          if (healthStatus === "RED") {
              statusValue = "offTrack";
          } else if (healthStatus === "AMBER") {
              statusValue = "onTrack"; // AMBER = still on track but at risk
          }
          
          // If goal has no key results, use status update with comment
          // This creates a check-in as an activity entry, NOT a description update
          if (keyResults.length === 0) {
              debugInfo.push("Goal has no key results, using status update endpoint with comment");
              try {
                  // First, just try adding a comment/activity via the status endpoint
                  var statusUpdatePayload = {
                      "status": statusValue,
                      "comment": checkInComment
                  };
                  
                  var statusRes = UrlFetchApp.fetch(baseEndpoint + '/' + goalId + '/status', {
                      method: 'patch', headers: headers, contentType: 'application/json',
                      payload: JSON.stringify(statusUpdatePayload), muteHttpExceptions: true
                  });
                  
                  var statusCode = statusRes.getResponseCode();
                  var responseText = statusRes.getContentText();
                  debugInfo.push("Status update response: " + statusCode);
                  debugInfo.push("Status update response text: " + responseText.substring(0, 300));
                  
                  if (statusCode >= 200 && statusCode < 300) {
                      return jsonResp({ 
                          success: true, 
                          message: "Check-in recorded via status update (goal has no key results)",
                          debug: debugInfo,
                          methodUsed: "status_update"
                      });
                  } else {
                      // Status update failed - report failure, do NOT update description
                      debugInfo.push("Status update failed with code: " + statusCode);
                      return jsonResp({ 
                          success: false, 
                          message: "Check-in failed. Goal has no key results and status update returned " + statusCode + ". Add key results in HiBob for better check-in support.",
                          debug: debugInfo,
                          lastError: responseText.substring(0, 300)
                      });
                  }
              } catch(statusErr) {
                  debugInfo.push("Status update exception: " + statusErr.toString());
                  return jsonResp({ 
                      success: false, 
                      message: "Check-in failed: " + statusErr.toString() + ". Goal has no key results - add key results in HiBob for better check-in support.",
                      debug: debugInfo
                  });
              }
          } else {
              // Goal has key results - use the key-results/progress endpoint
              var checkInUrl = baseEndpoint + '/' + goalId + '/key-results/progress';
              debugInfo.push("Check-in URL: " + checkInUrl);
              
              // Build payload according to API spec
              var checkInPayload = {
                  "comment": checkInComment,
                  "keyResults": keyResults.map(function(kr) { return {
                      "keyResultId": kr.keyResultId,
                      "currentValue": kr.currentValue,
                      "notes": kr.notes || (content ? content.substring(0, 200) : "") // Use content as notes if available
                  }; })
              };
              
              debugInfo.push("Payload: " + JSON.stringify(checkInPayload).substring(0, 400));
              
              // Try the key-results/progress endpoint
              var apiRes = UrlFetchApp.fetch(checkInUrl, {
                  method: 'patch', 
                  headers: headers, 
                  contentType: 'application/json',
                  payload: JSON.stringify(checkInPayload), 
                  muteHttpExceptions: true
              });
              
              var statusCode = apiRes.getResponseCode();
              var responseText = apiRes.getContentText();
              debugInfo.push("Response status: " + statusCode);
              debugInfo.push("Response: " + responseText.substring(0, 300));
              
              if (statusCode >= 200 && statusCode < 300) {
              // If health status indicates status change, also update goal status
              if (healthStatus === "RED" || healthStatus === "AMBER") {
                  try {
                      var statusValue = "onTrack";
                      if (healthStatus === "RED") {
                          statusValue = "offTrack";
                      } else if (healthStatus === "AMBER") {
                          statusValue = "onTrack"; // AMBER = still on track but at risk
                      }
                      
                      var statusUpdatePayload = {
                          "status": statusValue,
                          "comment": checkInComment
                      };
                      
                      var statusRes = UrlFetchApp.fetch(baseEndpoint + '/' + goalId + '/status', {
                          method: 'patch', headers: headers, contentType: 'application/json',
                          payload: JSON.stringify(statusUpdatePayload), muteHttpExceptions: true
                      });
                      debugInfo.push("Status update response: " + statusRes.getResponseCode());
                  } catch(statusErr) {
                      debugInfo.push("Status update exception: " + statusErr.toString());
                  }
              }
              
              try {
                  var responseJson = JSON.parse(responseText);
                  return jsonResp({ 
                      success: true, 
                      message: "Check-in created in HiBob using key-results/progress endpoint",
                      debug: debugInfo,
                      response: responseJson
                  });
              } catch(parseErr) {
                  return jsonResp({ 
                      success: true, 
                      message: "Check-in created in HiBob",
                      debug: debugInfo,
                      rawResponse: responseText.substring(0, 500)
                  });
              }
          } else {
              // If key-results endpoint fails, try status update with comment as fallback
              debugInfo.push("Key-results/progress endpoint failed, trying status update fallback...");
              try {
                  var statusValue = "onTrack";
                  if (healthStatus === "RED") {
                      statusValue = "offTrack";
                  } else if (healthStatus === "AMBER") {
                      statusValue = "onTrack";
                  }
                  
                  var statusUpdatePayload = {
                      "status": statusValue,
                      "comment": checkInComment
                  };
                  
                  var statusRes = UrlFetchApp.fetch(baseEndpoint + '/' + goalId + '/status', {
                      method: 'patch', headers: headers, contentType: 'application/json',
                      payload: JSON.stringify(statusUpdatePayload), muteHttpExceptions: true
                  });
                  
                  if (statusRes.getResponseCode() >= 200 && statusRes.getResponseCode() < 300) {
                      debugInfo.push("Status update fallback succeeded");
                      return jsonResp({ 
                          success: true, 
                          message: "Check-in via key-results failed, but status update with comment succeeded",
                          fallbackUsed: true,
                          debug: debugInfo
                      });
                  }
              } catch(statusErr) {
                  debugInfo.push("Status update fallback exception: " + statusErr.toString());
              }
              
              // Both key-results and status update failed - report error, do NOT pollute description
              debugInfo.push("All check-in methods failed - NOT updating description");
              
              return jsonResp({ 
                  success: false, 
                  message: "Check-in failed. Key-results and status update both failed. Status: " + statusCode,
                  debug: debugInfo,
                  lastError: {
                      status: statusCode,
                      response: responseText.substring(0, 500)
                  }
              });
          }
          }
      } catch(e) {
          debugInfo.push("Exception: " + e.toString());
          return jsonResp({ success: false, message: "Check-in Exception: " + e.toString(), debug: debugInfo });
      }
  }
  
  // --- ISOLATED HIBOB TEST ---
  if (params.action === 'TEST_HIBOB') {
      var debugLog = [];
      var serviceId = params.serviceId;
      var manualGoalType = params.manualGoalType || "";
      if (serviceId.includes('&manualGoalType=')) {
          var parts = serviceId.split('&manualGoalType=');
          serviceId = parts[0];
          manualGoalType = parts[1];
      }
      var token = params.token;
      var email = params.email;
      var subAction = params.subAction; 
      var authHeader = 'Basic ' + Utilities.base64Encode(serviceId + ':' + token);
      var headers = { 'Authorization': authHeader, 'Accept': 'application/json' };
      
      // --- SUB ACTION: GET ALL TAGS (doesn't need employee lookup) ---
      if (subAction === 'TEST_GET_TAGS') {
          try {
              var attempts = [];
              
              // Strategy 1: Try GET requests to various tag endpoints
              var tagEndpoints = [
                  { url: 'https://api.hibob.com/v1/company/named-lists/tags', method: 'get' },
                  { url: 'https://api.hibob.com/v1/goals/tags', method: 'get' },
                  { url: 'https://api.hibob.com/v1/named-lists/tags', method: 'get' },
                  { url: 'https://api.hibob.com/v1/company/named-lists', method: 'get' }
              ];
              
              for (var tei = 0; tei < tagEndpoints.length; tei++) {
                  var endpoint = tagEndpoints[tei];
                  try {
                      var tagsRes = UrlFetchApp.fetch(endpoint.url, {
                          method: endpoint.method, headers: headers, muteHttpExceptions: true
                      });
                      var status = tagsRes.getResponseCode();
                      var responseText = tagsRes.getContentText();
                      attempts.push({ url: endpoint.url, method: endpoint.method, status: status, response: responseText.substring(0, 500) });
                      
                      if (status === 200) {
                          try {
                              var tagsJson = JSON.parse(responseText);
                              return jsonResp({ 
                                  success: true, 
                                  message: "Tags Fetched from: " + endpoint.url, 
                                  tags: tagsJson, 
                                  endpoint: endpoint.url,
                                  allAttempts: attempts
                              });
                          } catch(parseErr) {
                              attempts.push({ url: endpoint.url, parseError: parseErr.toString() });
                          }
                      }
                  } catch(e) {
                      attempts.push({ url: endpoint.url, exception: e.toString() });
                  }
              }
              
              // Strategy 2: Try POST search requests for tags
              var searchEndpoints = [
                  { url: 'https://api.hibob.com/v1/company/named-lists/search', payload: { "fields": ["id", "name"], "filters": [{ "fieldPath": "name", "operator": "contains", "values": ["tag"] }] } },
                  { url: 'https://api.hibob.com/v1/goals/goals/search', payload: { "fields": ["tags"], "filters": [] } }
              ];
              
              for (var sei = 0; sei < searchEndpoints.length; sei++) {
                  var endpoint = searchEndpoints[sei];
                  try {
                      var searchRes = UrlFetchApp.fetch(endpoint.url, {
                          method: 'post', headers: headers, contentType: 'application/json',
                          payload: JSON.stringify(endpoint.payload), muteHttpExceptions: true
                      });
                      var status = searchRes.getResponseCode();
                      var responseText = searchRes.getContentText();
                      attempts.push({ url: endpoint.url, method: 'post', status: status, response: responseText.substring(0, 500) });
                      
                      if (status === 200) {
                          try {
                              var searchJson = JSON.parse(responseText);
                              return jsonResp({ 
                                  success: true, 
                                  message: "Tags found via search: " + endpoint.url, 
                                  tags: searchJson, 
                                  endpoint: endpoint.url,
                                  allAttempts: attempts
                              });
                          } catch(parseErr) {
                              attempts.push({ url: endpoint.url, parseError: parseErr.toString() });
                          }
                      }
                  } catch(e) {
                      attempts.push({ url: endpoint.url, exception: e.toString() });
                  }
              }
              
              // If all endpoints failed, return error with all attempts
              return jsonResp({ 
                  success: false, 
                  message: "All tag endpoints failed. See attempts for details.", 
                  attemptedEndpoints: attempts,
                  hint: "Tags might be fetched from an existing goal. Try 'Get Single Goal' first."
              });
          } catch(e) {
              return jsonResp({ success: false, message: "Tags fetch exception: " + e.toString() });
          }
      }
      
      try {
        var searchUrl = 'https://api.hibob.com/v1/people/search';
        var searchPayload = { "fields": ["root.email"], "filters": [{ "fieldPath": "root.email", "operator": "equals", "values": [email] }] };
        var searchRes = UrlFetchApp.fetch(searchUrl, { method: 'post', headers: headers, contentType: 'application/json', payload: JSON.stringify(searchPayload), muteHttpExceptions: true });
        var searchJson = JSON.parse(searchRes.getContentText());
        if (!searchJson.employees || searchJson.employees.length === 0) return jsonResp({ success: false, error: "Employee not found." });
        
        var employeeId = searchJson.employees[0].id;
        debugLog.push("Employee ID: " + employeeId);

        // --- SUB ACTION 1: TEST PUSH ---
        if (subAction === 'TEST_PUSH') {
             var goalsUrl = 'https://api.hibob.com/v1/goals/goals';
             var now = new Date().toISOString().split('T')[0];
             var end = '2025-12-31';
             
             var validTypeId = manualGoalType;
             if (!validTypeId) {
                 try {
                     var typeRes = UrlFetchApp.fetch('https://api.hibob.com/v1/goals/goal-types/search', {
                        method: 'post', headers: headers, contentType: 'application/json',
                        payload: JSON.stringify({ "fields": ["id", "name"] }), muteHttpExceptions: true
                     });
                     var typeJson = JSON.parse(typeRes.getContentText());
                     if (typeJson.items && typeJson.items.length > 0) validTypeId = typeJson.items[0].id;
                 } catch(e) { debugLog.push("Auto-detect type failed: " + e.toString()); }
             }

             if (!validTypeId) return jsonResp({ success: false, message: "Missing Goal Type ID. Please find one via 'Read Goals API' and enter manually." });

             var payloadWrapped = {
                 "items": [{
                        "objectType": "goal",
                        "fields": {
                            "title": { "value": "OmniMap Test v7.46" },
                            "description": { "value": "Test goal created at " + new Date().toISOString() },
                            "startDate": { "value": now },
                            "dueDate": { "value": end },
                            "owner": { "value": employeeId },
                            "typeId": { "value": validTypeId }, 
                            "isPrivate": { "value": false } 
                        }
                 }]
             };

             var res = UrlFetchApp.fetch(goalsUrl, {
                method: 'post', headers: headers, contentType: 'application/json',
                payload: JSON.stringify(payloadWrapped), muteHttpExceptions: true
             });
             
             return jsonResp({ success: res.getResponseCode() < 300, message: "Push Attempted. Status: " + res.getResponseCode(), debugTrace: debugLog, response: JSON.parse(res.getContentText()) });
        }

        // --- SUB ACTION 2: READ GOALS ---
        if (subAction === 'TEST_GOALS_MODULE') {
             var typesRes = UrlFetchApp.fetch('https://api.hibob.com/v1/goals/goal-types/search', {
                method: 'post', headers: headers, contentType: 'application/json',
                payload: JSON.stringify({ "fields": ["id", "name"] }), muteHttpExceptions: true
             });
             var goalsRes = UrlFetchApp.fetch('https://api.hibob.com/v1/goals/goals/search', {
                method: 'post', headers: headers, contentType: 'application/json',
                payload: JSON.stringify({
                    "fields": ["id", "title", "typeId", "type", "tags", "owner.id"],
                    "filters": [{ "fieldPath": "owner.id", "operator": "equals", "values": [employeeId] }]
                }), muteHttpExceptions: true
             });
             
             return jsonResp({ success: true, message: "Data Fetched", goalTypes: JSON.parse(typesRes.getContentText()), userGoals: JSON.parse(goalsRes.getContentText()) });
        }
        
        // --- SUB ACTION 3: GET SINGLE GOAL BY ID (to see all fields including tags) ---
        if (subAction === 'TEST_GET_GOAL') {
            var goalId = params.goalId;
            var targetGoalId = goalId;
            var debugInfo = [];
            
            // If no goalId provided, get first goal ID from search
            if (!targetGoalId) {
                debugInfo.push("No goalId provided, searching for first goal");
                try {
                    var searchRes = UrlFetchApp.fetch('https://api.hibob.com/v1/goals/goals/search', {
                        method: 'post', headers: headers, contentType: 'application/json',
                        payload: JSON.stringify({
                            "fields": ["id", "title"],
                            "filters": [{ "fieldPath": "owner.id", "operator": "equals", "values": [employeeId] }]
                        }), muteHttpExceptions: true
                    });
                    var status = searchRes.getResponseCode();
                    var responseText = searchRes.getContentText();
                    debugInfo.push("Search status: " + status);
                    
                    if (status === 200) {
                        try {
                            var searchJson = JSON.parse(responseText);
                            debugInfo.push("Found " + ((searchJson.items && searchJson.items.length) || 0) + " goals");
                            if (searchJson.items && searchJson.items.length > 0) {
                                targetGoalId = searchJson.items[0].id || safeGet(searchJson.items[0], 'fields.id.value') || safeGet(searchJson.items[0], 'fields.id');
                                debugInfo.push("Using goal ID: " + targetGoalId);
                            }
                        } catch(parseErr) {
                            debugInfo.push("Parse error: " + parseErr.toString());
                            debugInfo.push("Response: " + responseText.substring(0, 500));
                        }
                    } else {
                        debugInfo.push("Search failed: " + responseText.substring(0, 500));
                    }
                } catch(e) {
                    return jsonResp({ success: false, message: "Exception searching for goals: " + e.toString(), debug: debugInfo });
                }
                if (!targetGoalId) {
                    return jsonResp({ success: false, message: "No goal ID provided and no goals found for employee", debug: debugInfo });
                }
            } else {
                debugInfo.push("Using provided goalId: " + targetGoalId);
            }
            
            // Try multiple strategies to fetch the goal
            var strategies = [];
            
            // Strategy 1: Search endpoint with ID filter
            try {
                debugInfo.push("Trying search endpoint with ID filter");
                var searchRes = UrlFetchApp.fetch('https://api.hibob.com/v1/goals/goals/search', {
                    method: 'post', headers: headers, contentType: 'application/json',
                    payload: JSON.stringify({
                        "fields": ["id", "title", "description", "startDate", "dueDate", "status", "progress", "tags", "typeId", "owner.id", "name"],
                        "filters": [{ "fieldPath": "id", "operator": "equals", "values": [String(targetGoalId)] }]
                    }), muteHttpExceptions: true
                });
                var status = searchRes.getResponseCode();
                var responseText = searchRes.getContentText();
                strategies.push({ method: "search_with_id_filter", status: status, response: responseText.substring(0, 1000) });
                
                if (status === 200) {
                    try {
                        var searchJson = JSON.parse(responseText);
                        if (searchJson.items && searchJson.items.length > 0) {
                            var goal = searchJson.items[0];
                            debugInfo.push("Goal found via search endpoint");
                            return jsonResp({ 
                                success: true, 
                                message: "Single Goal Fetched", 
                                goal: goal, 
                                allItems: searchJson.items,
                                debug: debugInfo,
                                strategies: strategies,
                                tagsInfo: {
                                    tagsField: goal.tags,
                                    tagsFieldsValue: safeGet(goal, 'fields.tags.value'),
                                    tagsRaw: JSON.stringify(goal.tags),
                                    allFields: Object.keys(goal.fields || {})
                                }
                            });
                        } else {
                            debugInfo.push("Search returned no items");
                        }
                    } catch(parseErr) {
                        debugInfo.push("Parse error: " + parseErr.toString());
                    }
                }
            } catch(e) {
                strategies.push({ method: "search_with_id_filter", exception: e.toString() });
            }
            
            // Strategy 2: Try direct GET (might work for some HiBob versions)
            try {
                debugInfo.push("Trying direct GET endpoint");
                var getRes = UrlFetchApp.fetch('https://api.hibob.com/v1/goals/goals/' + targetGoalId, {
                    method: 'get', headers: headers, muteHttpExceptions: true
                });
                var status = getRes.getResponseCode();
                var responseText = getRes.getContentText();
                strategies.push({ method: "direct_get", status: status, response: responseText.substring(0, 1000) });
                
                if (status === 200) {
                    try {
                        var goalJson = JSON.parse(responseText);
                        debugInfo.push("Goal found via direct GET");
                        return jsonResp({ 
                            success: true, 
                            message: "Single Goal Fetched (Direct GET)", 
                            goal: (goalJson.items && goalJson.items[0]) || goalJson,
                            debug: debugInfo,
                            strategies: strategies,
                            tagsInfo: {
                                tagsField: (goalJson.items && goalJson.items[0] && goalJson.items[0].tags) || goalJson.tags,
                                tagsFieldsValue: safeGet(goalJson.items && goalJson.items[0], 'fields.tags.value') || safeGet(goalJson, 'fields.tags.value'),
                                tagsRaw: JSON.stringify((goalJson.items && goalJson.items[0] && goalJson.items[0].tags) || goalJson.tags)
                            }
                        });
                    } catch(parseErr) {
                        debugInfo.push("Parse error: " + parseErr.toString());
                    }
                }
            } catch(e) {
                strategies.push({ method: "direct_get", exception: e.toString() });
            }
            
            return jsonResp({ 
                success: false, 
                message: "Could not fetch goal with ID: " + targetGoalId, 
                debug: debugInfo,
                strategies: strategies,
                hint: "Check if the goal ID is correct and belongs to the employee"
            });
        }
        
        // --- SUB ACTION 4: TEST CHECK-IN ---
        if (subAction === 'TEST_CHECK_IN') {
            var goalId = params.goalId;
            if (!goalId) {
                return jsonResp({ success: false, message: "Goal ID is required for check-in test. Use 'Get Single Goal' first to get a goal ID." });
            }
            
            var debugInfo = [];
            debugInfo.push("Testing check-in for goal ID: " + goalId);
            
            try {
                // Map health status to HiBob check-in status
                var hibobStatus = "on_track";
                var testHealthStatus = params.testHealthStatus || "GREEN";
                var healthUpper = String(testHealthStatus).toUpperCase();
                if (healthUpper === "AMBER" || healthUpper === "YELLOW") {
                    hibobStatus = "at_risk";
                } else if (healthUpper === "RED") {
                    hibobStatus = "off_track";
                }
                debugInfo.push("Mapped status: " + hibobStatus + " from: " + testHealthStatus);
                
                var checkInUrl = 'https://api.hibob.com/v1/goals/goals/' + goalId + '/check-ins';
                var testDate = new Date().toISOString().split('T')[0];
                var testContent = "Test check-in created at " + new Date().toISOString();
                
                var checkInPayload = {
                    "items": [{
                        "objectType": "checkIn",
                        "fields": {
                            "date": { "value": testDate },
                            "status": { "value": hibobStatus },
                            "comment": { "value": testContent }
                        }
                    }]
                };
                
                debugInfo.push("Check-in URL: " + checkInUrl);
                debugInfo.push("Payload: " + JSON.stringify(checkInPayload).substring(0, 300));
                
                var apiRes = UrlFetchApp.fetch(checkInUrl, {
                    method: 'post', 
                    headers: headers, 
                    contentType: 'application/json',
                    payload: JSON.stringify(checkInPayload), 
                    muteHttpExceptions: true
                });
                
                var statusCode = apiRes.getResponseCode();
                var responseText = apiRes.getContentText();
                debugInfo.push("Response status: " + statusCode);
                
                if (statusCode >= 200 && statusCode < 300) {
                    try {
                        var responseJson = JSON.parse(responseText);
                        return jsonResp({ 
                            success: true, 
                            message: "Test check-in created successfully",
                            checkInId: (responseJson.items && responseJson.items[0] && responseJson.items[0].id) || responseJson.id || null,
                            debug: debugInfo,
                            response: responseJson
                        });
                    } catch(parseErr) {
                        return jsonResp({ 
                            success: true, 
                            message: "Test check-in created (could not parse response)",
                            debug: debugInfo,
                            rawResponse: responseText.substring(0, 500)
                        });
                    }
                } else {
                    return jsonResp({ 
                        success: false, 
                        message: "Check-in test failed. Status: " + statusCode,
                        debug: debugInfo,
                        errorResponse: responseText.substring(0, 1000)
                    });
                }
            } catch(e) {
                debugInfo.push("Exception: " + e.toString());
                return jsonResp({ success: false, message: "Check-in test exception: " + e.toString(), debug: debugInfo });
            }
        }
        
        return jsonResp({ success: true, message: "Connection OK. Employee Found." });
      } catch (err) {
         return jsonResp({ success: false, error: err.toString() });
      }
  }

  // --- JIRA SYNC ---
  if (params.action === 'SYNC_JIRA') {
      var jiraDomain = params.domain;
      var jiraEmail = params.email;
      var jiraToken = params.token;
      var projectKeys = params.projectKeys || '';
      
      if (!jiraDomain || !jiraEmail || !jiraToken) {
          return jsonResp({ success: false, message: 'Missing Jira credentials (domain, email, token)' });
      }
      
      var jiraAuth = 'Basic ' + Utilities.base64Encode(jiraEmail + ':' + jiraToken);
      var jiraHeaders = { 
          'Authorization': jiraAuth, 
          'Accept': 'application/json',
          'Content-Type': 'application/json'
      };
      
      try {
          // Build JQL query
          var jql = 'status != Done';
          if (projectKeys) {
              var keys = projectKeys.split(',').map(function(k) { return k.trim(); }).filter(function(k) { return k.length > 0; });
              if (keys.length > 0) {
                  jql = 'project IN (' + keys.join(',') + ') AND ' + jql;
              }
          }
          jql += ' ORDER BY updated DESC';
          
          var searchUrl = 'https://' + jiraDomain + '/rest/api/3/search?jql=' + encodeURIComponent(jql) + '&maxResults=100&fields=summary,description,status,priority,assignee,issuetype,project,created,updated,labels,duedate';
          
          var response = UrlFetchApp.fetch(searchUrl, {
              method: 'get',
              headers: jiraHeaders,
              muteHttpExceptions: true
          });
          
          var statusCode = response.getResponseCode();
          var responseText = response.getContentText();
          
          if (statusCode >= 200 && statusCode < 300) {
              var jiraData = JSON.parse(responseText);
              var issues = jiraData.issues || [];
              
              // Map to a simpler format for the frontend
              var mappedIssues = issues.map(function(issue) {
                  var fields = issue.fields || {};
                  var desc = '';
                  
                  // Extract description text (Jira uses Atlassian Document Format)
                  if (fields.description && fields.description.content) {
                      try {
                          desc = fields.description.content.map(function(block) {
                              if (block.content) {
                                  return block.content.map(function(c) { return c.text || ''; }).join('');
                              }
                              return '';
                          }).join('\\n');
                      } catch(e) {
                          desc = '';
                      }
                  } else if (typeof fields.description === 'string') {
                      desc = fields.description;
                  }
                  
                  return {
                      key: issue.key,
                      id: issue.id,
                      summary: fields.summary || '',
                      description: desc,
                      status: fields.status ? fields.status.name : 'Unknown',
                      statusCategory: fields.status && fields.status.statusCategory ? fields.status.statusCategory.name : 'Unknown',
                      priority: fields.priority ? fields.priority.name : 'Medium',
                      assignee: fields.assignee ? fields.assignee.displayName : 'Unassigned',
                      assigneeEmail: fields.assignee ? fields.assignee.emailAddress : '',
                      issueType: fields.issuetype ? fields.issuetype.name : 'Task',
                      project: fields.project ? fields.project.name : '',
                      projectKey: fields.project ? fields.project.key : '',
                      created: fields.created,
                      updated: fields.updated,
                      dueDate: fields.duedate || '',
                      labels: fields.labels || [],
                      url: 'https://' + jiraDomain + '/browse/' + issue.key
                  };
              });
              
              return jsonResp({ 
                  success: true, 
                  message: 'Found ' + mappedIssues.length + ' issues from Jira',
                  total: jiraData.total || mappedIssues.length,
                  issues: mappedIssues
              });
          } else {
              var errorBody = '';
              try { errorBody = JSON.parse(responseText); } catch(e) { errorBody = responseText; }
              return jsonResp({ 
                  success: false, 
                  message: 'Jira API error: ' + statusCode, 
                  error: errorBody 
              });
          }
      } catch (err) {
          return jsonResp({ success: false, message: 'Jira sync failed: ' + err.toString() });
      }
  }

  // --- STANDARD DATA FETCH ---
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  function getSheetData(possibleNames) {
    for (var i = 0; i < possibleNames.length; i++) {
      var name = possibleNames[i];
      var sheet = ss.getSheetByName(name);
      if (sheet) return sheet.getDataRange().getValues();
    }
    return [];
  }
  function safeDate(val) {
    if (!val) return "";
    var str = String(val).trim();
    if (/^\\d{1,2}\\/\\d{1,2}\\/\\d{4}$/.test(str)) {
       var parts = str.split('/'); 
       return parts[2] + '-' + parts[1].padStart(2, '0') + '-' + parts[0].padStart(2, '0');
    }
    if (val instanceof Date) return Utilities.formatDate(val, ss.getSpreadsheetTimeZone(), "yyyy-MM-dd");
    return val.toString();
  };

  try {
      var rocksRaw = getSheetData(['BigRocks', 'Big Rocks']);
      var itemsRaw = getSheetData(['AllGoals', 'RoadmapItems', 'Roadmap Items']);
      var employeesRaw = getSheetData(['Employees', 'Team']);
      var updatesRaw = getSheetData(['BigRocksMonthlyUpdates', 'MonthlyUpdates', 'Updates']);
      var itemUpdatesRaw = getSheetData(['MonthlyGoalUpdates', 'ItemUpdates', 'Item Updates']);
      var salesActionsRaw = getSheetData(['SalesActions', 'Sales Actions']);
      var targetsRaw = getSheetData(['SalesTargets', 'Sales Targets', 'SalesData']); 
      var actualsRaw = getSheetData(['SalesActuals', 'Sales Actuals']);
      var projectsRaw = getSheetData(['Projects']);
      var projectTasksRaw = getSheetData(['ProjectTasks']);
      var projectMilestonesRaw = getSheetData(['ProjectMilestones', 'Project Milestones']);
      var taskMilestonesRaw = getSheetData(['TaskMilestones', 'Task Milestones']);
      
      // Debug: Log the header row to understand column structure
      Logger.log('SalesTargets Headers: ' + JSON.stringify(targetsRaw[0]));
      Logger.log('SalesActuals Headers: ' + JSON.stringify(actualsRaw[0]));
      if (targetsRaw.length > 1) Logger.log('SalesTargets First Data Row: ' + JSON.stringify(targetsRaw[1]));
      
      // Include debug info in the response
      var salesDebugInfo = {
        targetsHeaders: targetsRaw.length > 0 ? targetsRaw[0] : [],
        actualsHeaders: actualsRaw.length > 0 ? actualsRaw[0] : [],
        targetsRowCount: targetsRaw.length - 1,
        actualsRowCount: actualsRaw.length - 1,
        sampleTargetRow: targetsRaw.length > 1 ? targetsRaw[1] : [],
        sampleActualRow: actualsRaw.length > 1 ? actualsRaw[1] : []
      };

      var actualsMap = {};
      if (actualsRaw.length > 1) {
        actualsRaw.slice(1).forEach(function(row) {
           var dateStr = safeDate(row[3]); 
           var empId = row[4] ? row[4].toString().trim() : "";
           if(dateStr && empId) actualsMap[empId + '_' + dateStr] = row;
        });
      }
      
      var data = {
        rocks: rocksRaw.length > 1 ? rocksRaw.slice(1).map(function(r) { return { id: r[0].toString(), title: r[1], description: r[2] }; }) : [],
        employees: employeesRaw.length > 1 ? employeesRaw.slice(1).map(function(e) {
           var hasEmailCol = e[4] && String(e[4]).includes('@');
           var offset = hasEmailCol ? 1 : 0;
           
           // Extract email - it's in column 4 if hasEmailCol is true, otherwise try to find it
           var email = null;
           if (hasEmailCol) {
             email = String(e[4] || "").trim();
             // Validate it's actually an email
             if (!email.includes('@') || email.length < 5) email = null;
           } else {
             // Try to find email in any column
             for (var i = 0; i < e.length; i++) {
               var cell = String(e[i] || "").trim();
               if (cell.includes('@') && cell.includes('.') && cell.length > 5) {
                 // Basic email validation
                 var emailPattern = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;
                 if (emailPattern.test(cell)) {
                   email = cell;
                   break;
                 }
               }
             }
           }
           
           var hodVal = e[7 + offset];
           var accessVal = e[8 + offset];
           var salesAccessVal = e[10 + offset];
           
           var isHoD = (hodVal === true || String(hodVal).trim().toUpperCase() === 'TRUE');
           
           var accessLevel = "IC";
           if (accessVal) {
               var norm = String(accessVal).trim();
               if (['Admin', 'Manager', 'IC'].includes(norm)) accessLevel = norm;
           }
           if (isHoD && accessLevel === 'IC') accessLevel = 'Manager';

           var fName = String(e[1] || "").trim();
           var lName = String(e[2] || "").trim();
           if (lName && !lName.includes('@') && lName.length > 1) {
              fName = fName + " " + lName;
           }
           if (!fName) fName = String(e[3] || "Unknown");

           return { 
            id: (e[0] || e[3]).toString().trim(), 
            name: fName,
            email: email || undefined, // Include email field for SSO matching
            department: e[4 + offset], 
            team: e[5 + offset], 
            role: e[6 + offset] || "",
            responsibilities: e[11 + offset] ? String(e[11 + offset]).trim() : undefined,
            reportsTo: e[9 + offset] ? String(e[9 + offset]).trim() : "",
            salesPerformanceAccess: salesAccessVal ? String(salesAccessVal).split(',').map(function(s) { return s.trim(); }) : [],
            avatarUrl: "https://ui-avatars.com/api/?name=" + encodeURIComponent(fName) + "&background=random&color=fff",
            accessLevel: accessLevel,
            isHoD: isHoD
          };
        }) : [],
        items: itemsRaw.length > 1 ? itemsRaw.slice(1).map(function(i) { return {
          id: i[0].toString(), goalId: i[1].toString(), owner: i[2], title: i[3], description: i[4], 
          department: i[5], status: i[6], priority: i[7], startDate: safeDate(i[8]), endDate: safeDate(i[9]), 
          tags: i[10] ? i[10].toString().split(',') : [], progress: i[11] || 0, contribution: i[12] || "",
          goalType: (i[13] && i[13].toString().trim()) ? i[13].toString().trim() : 'PERSONAL',
          goalCategory: (i[14] && i[14].toString().trim()) ? i[14].toString().trim() : 'PERFORMANCE',
          hibobGoalId: (i[15] && i[15].toString().trim()) ? i[15].toString().trim() : ''
        }; }) : [],
        updates: updatesRaw.length > 1 ? updatesRaw.slice(1).map(function(u) { return {
          id: u[0], goalId: u[1], month: u[2], year: u[3], status: u[4], content: u[5], authorId: u[6], createdAt: u[7]
        }; }) : [],
        itemUpdates: itemUpdatesRaw.length > 1 ? itemUpdatesRaw.slice(1).map(function(u) { return {
          id: u[0], itemId: u[1], month: u[2], year: u[3], health: u[4], content: u[5], updatedAt: u[6]
        }; }) : [],
        salesData: targetsRaw.length > 1 ? targetsRaw.slice(1).flatMap(function(row, idx) {
          var dateStr = safeDate(row[3]); 
          if (!dateStr) return [];
          var parts = dateStr.split('-');
          var yearNum = parseInt(parts[0], 10) || 2025;
          var monthNum = parseInt(parts[1], 10) || 1;
          var monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
          var monthStr = monthNames[monthNum - 1] || 'Jan';
          
          var empId = row[4] ? row[4].toString().trim() : ""; 
          if (!empId) return [];
          
          var actualRow = actualsMap[empId + '_' + dateStr];
          var metrics = [];
          
          function parseVal(val, isPercentMetric) {
             if (val === undefined || val === null || val === '') return 0;
             var s = String(val).trim().replace(/,/g, '').replace(/[^0-9.%-]/g, '');
             if (!s || s === '-') return 0;
             var num = parseFloat(s.replace('%', '')) || 0;
             // For percentage metrics (Sales Rate, Conversion):
             // If value has % sign OR is > 1, assume it's already a percentage (27.75 = 27.75%)
             // Convert to decimal for internal storage (27.75 -> 0.2775)
             if (isPercentMetric) {
                if (s.indexOf('%') >= 0 || num > 1) {
                   return num / 100;
                }
                return num; // Already decimal (0.2775)
             }
             return num;
          }
          
          function addM(type, colIdx, isPercentMetric) { 
            var targetVal = parseVal(row[colIdx], isPercentMetric);
            var actualVal = actualRow ? parseVal(actualRow[colIdx], isPercentMetric) : 0;
            // Only add metric if we have at least a target value
            if (targetVal > 0 || actualVal > 0) {
              metrics.push({ 
                id: 'sd-' + idx + '-' + type + '-' + monthStr + yearNum, 
                employeeId: empId, 
                month: monthStr, 
                year: yearNum, 
                metricType: type, 
                target: targetVal, 
                actual: actualVal 
              }); 
            }
          }
          
          // Add all 5 metric types based on actual sheet structure:
          // ID(0), EmpID(1), TargetName(2), TargetDate(3), OwnerID(4), CompanyCode(5), Currency(6), LotType(7), RecordType(8),
          // RevenueActuals(9), IncompleteEnq(10), AwaitingPhotos(11), OutboundCalls(12), ListingsValue(13), 
          // ListingsActuals(14), SalesActuals(15), SellRate(16), DealsNoActivity(17), DealsOverdue(18),
          // Reruns(19), NewSellers(20), ConversionRate(21)
          addM('Revenue', 9, false);
          addM('Calls', 12, false);       // OUTBOUND CALLS
          addM('Listings', 14, false);    // LISTINGS ACTUALS
          addM('Sales Rate', 16, true);   // SELL RATE (percentage)
          addM('Conversion', 21, true);   // SUITABLE INQUIERIES CONVERSION RATE (percentage)
          
          return metrics;
        }) : [],
        salesActions: salesActionsRaw.length > 1 ? salesActionsRaw.slice(1).map(function(s) { return {
          id: s[0], employeeId: s[1], metricType: s[2], description: s[3], assignedBy: s[4], dueDate: safeDate(s[5]), isCompleted: s[6] === true, createdAt: s[7]
        }; }) : [],
        projects: projectsRaw.length > 1 ? projectsRaw.slice(1).map(function(p) { return {
          id: p[0].toString(), title: p[1], description: p[2] || '', owner: p[3] || '', status: p[4] || 'Not Started', priority: p[5] || 'Medium',
          startDate: safeDate(p[6]), endDate: safeDate(p[7]), createdAt: p[8] ? String(p[8]) : undefined, department: p[9], team: p[10]
        }; }) : [],
        projectTasks: projectTasksRaw.length > 1 ? projectTasksRaw.slice(1).map(function(t) { return {
          id: t[0].toString(), projectId: t[1].toString(), title: t[2], description: t[3] || '', owner: t[4] || '', status: t[5] || 'Not Started', priority: t[6] || 'Medium',
          startDate: safeDate(t[7]), endDate: safeDate(t[8]), order: t[9] != null ? Number(t[9]) : undefined, createdAt: t[10] ? String(t[10]) : undefined, department: t[11], team: t[12]
        }; }) : [],
        projectMilestones: projectMilestonesRaw.length > 1 ? projectMilestonesRaw.slice(1).map(function(m) { return {
          id: m[0].toString(), projectId: m[1].toString(), title: m[2], dueDate: safeDate(m[3]), completed: m[4] === true, completedAt: m[5] ? String(m[5]) : undefined
        }; }) : [],
        taskMilestones: taskMilestonesRaw.length > 1 ? taskMilestonesRaw.slice(1).map(function(m) { return {
          id: m[0].toString(), taskId: m[1].toString(), title: m[2], dueDate: safeDate(m[3]), completed: m[4] === true, completedAt: m[5] ? String(m[5]) : undefined
        }; }) : [],
        _salesDebug: salesDebugInfo
      };
      return ContentService.createTextOutput(JSON.stringify(data)).setMimeType(ContentService.MimeType.JSON);
  } catch (err) {
      return ContentService.createTextOutput(JSON.stringify({ error: err.toString() })).setMimeType(ContentService.MimeType.JSON);
  }
}

function jsonResp(data) {
    return ContentService.createTextOutput(JSON.stringify(data)).setMimeType(ContentService.MimeType.JSON);
}

function doPost(e) {
  try {
    var payload = JSON.parse(e.postData.contents);
    var ss = SpreadsheetApp.getActiveSpreadsheet();
    var action = payload.action;
    
    function getSheet(names, headers) {
      for (var i = 0; i < names.length; i++) { var s = ss.getSheetByName(names[i]); if (s) return s; }
      var newSheet = ss.insertSheet(names[0]);
      if (headers) newSheet.appendRow(headers);
      return newSheet;
    };

    if (action === 'UPSERT_ITEM') {
        Logger.log('UPSERT_ITEM received: ' + JSON.stringify(payload.item));
        Logger.log('hibobGoalId value: ' + (payload.item.hibobGoalId || 'NOT SET'));
        var sheet = getSheet(['AllGoals', 'RoadmapItems'], ['ID','GoalID','Owner','Title','Desc','Dept','Status','Priority','Start','End','Tags','Prog','Contrib','GoalType','GoalCategory','HiBobGoalId']);
        var values = [
            payload.item.id, payload.item.goalId, payload.item.owner, payload.item.title, payload.item.description, 
            payload.item.department, payload.item.status, payload.item.priority, payload.item.startDate, 
            payload.item.endDate, (payload.item.tags || []).join(','), payload.item.progress, payload.item.contribution,
            payload.item.goalType || 'PERSONAL', payload.item.goalCategory || 'PERFORMANCE',
            payload.item.hibobGoalId || ''
        ];
        Logger.log('Values to save (16 cols): ' + JSON.stringify(values));
        upsertRow(sheet, payload.item, values);
        Logger.log('UPSERT_ITEM completed for ID: ' + payload.item.id);
    }

    if (action === 'UPSERT_ITEM_UPDATE') {
        var sheet = getSheet(['MonthlyGoalUpdates', 'ItemUpdates'], ['ID','ItemID','Month','Year','Health','Content','UpdatedAt']);
        var update = payload.itemUpdate;
        upsertRow(sheet, update, [
            update.id, update.itemId, update.month, update.year, update.health, update.content, update.updatedAt || new Date().toISOString()
        ]);
    }

    if (action === 'UPSERT_GOAL') {
        var sheet = getSheet(['BigRocks', 'Goals'], ['ID','Title','Description']);
        var goal = payload.goal;
        upsertRow(sheet, goal, [goal.id, goal.title, goal.description]);
    }

    if (action === 'UPSERT_UPDATE') {
        var sheet = getSheet(['BigRocksMonthlyUpdates', 'MonthlyUpdates'], ['ID','GoalID','Month','Year','Status','Content','AuthorID','CreatedAt']);
        var upd = payload.update;
        upsertRow(sheet, upd, [upd.id, upd.goalId, upd.month, upd.year, upd.status, upd.content, upd.authorId, upd.createdAt || new Date().toISOString()]);
    }

    if (action === 'PUSH_GOALS_HIBOB') {
        return ContentService.createTextOutput("Bulk Push Executed").setMimeType(ContentService.MimeType.TEXT);
    }

    if (action === 'UPSERT_PROJECT') {
        var sheet = getSheet(['Projects'], ['ID','Title','Description','Owner','Status','Priority','StartDate','EndDate','CreatedAt','Department','Team']);
        var p = payload.project;
        upsertRow(sheet, p, [p.id, p.title, p.description || '', p.owner || '', p.status || 'Not Started', p.priority || 'Medium', p.startDate || '', p.endDate || '', p.createdAt || '', p.department || '', p.team || '']);
    }

    if (action === 'UPSERT_PROJECT_TASK') {
        var sheet = getSheet(['ProjectTasks'], ['ID','ProjectID','Title','Description','Owner','Status','Priority','StartDate','EndDate','Order','CreatedAt','Department','Team']);
        var t = payload.projectTask;
        upsertRow(sheet, t, [t.id, t.projectId, t.title, t.description || '', t.owner || '', t.status || 'Not Started', t.priority || 'Medium', t.startDate || '', t.endDate || '', t.order != null ? t.order : '', t.createdAt || '', t.department || '', t.team || '']);
    }

    if (action === 'DELETE_PROJECT') {
        var sheet = ss.getSheetByName('Projects');
        if (sheet) deleteRowById(sheet, payload.id);
    }

    if (action === 'DELETE_PROJECT_TASK') {
        var sheet = ss.getSheetByName('ProjectTasks');
        if (sheet) deleteRowById(sheet, payload.id);
    }

    if (action === 'UPSERT_PROJECT_MILESTONE') {
        var m = payload.projectMilestone;
        if (!m || !m.id || !m.projectId) {
          Logger.log('UPSERT_PROJECT_MILESTONE missing payload.projectMilestone or id/projectId: ' + JSON.stringify(payload));
          return ContentService.createTextOutput(JSON.stringify({ error: 'UPSERT_PROJECT_MILESTONE requires payload.projectMilestone with id and projectId' })).setMimeType(ContentService.MimeType.TEXT);
        }
        var sheet = getSheet(['ProjectMilestones', 'Project Milestones'], ['ID','ProjectID','Title','DueDate','Completed','CompletedAt']);
        var row = [m.id, m.projectId, m.title || '', m.dueDate || '', m.completed === true, m.completedAt || ''];
        upsertRow(sheet, m, row);
        Logger.log('UPSERT_PROJECT_MILESTONE ok: ' + m.id);
    }

    if (action === 'DELETE_PROJECT_MILESTONE') {
        var sheet = ss.getSheetByName('ProjectMilestones') || ss.getSheetByName('Project Milestones');
        if (sheet) deleteRowById(sheet, payload.id);
    }

    if (action === 'UPSERT_TASK_MILESTONE') {
        var m = payload.taskMilestone;
        if (!m || !m.id || !m.taskId) {
          Logger.log('UPSERT_TASK_MILESTONE missing payload.taskMilestone or id/taskId: ' + JSON.stringify(payload));
          return ContentService.createTextOutput(JSON.stringify({ error: 'UPSERT_TASK_MILESTONE requires payload.taskMilestone with id and taskId' })).setMimeType(ContentService.MimeType.TEXT);
        }
        var sheet = getSheet(['TaskMilestones', 'Task Milestones'], ['ID','TaskID','Title','DueDate','Completed','CompletedAt']);
        var row = [m.id, m.taskId, m.title || '', m.dueDate || '', m.completed === true, m.completedAt || ''];
        upsertRow(sheet, m, row);
        Logger.log('UPSERT_TASK_MILESTONE ok: ' + m.id);
    }

    if (action === 'DELETE_TASK_MILESTONE') {
        var sheet = ss.getSheetByName('TaskMilestones') || ss.getSheetByName('Task Milestones');
        if (sheet) deleteRowById(sheet, payload.id);
    }

    return ContentService.createTextOutput("Success").setMimeType(ContentService.MimeType.TEXT);
  } catch(err) {
    return ContentService.createTextOutput("Error: " + err.toString()).setMimeType(ContentService.MimeType.TEXT);
  }
}

function upsertRow(sheet, dataObj, values) {
  var rows = sheet.getDataRange().getValues();
  var rowIndex = -1;
  var id = values[0]; 
  
  for (var i = 1; i < rows.length; i++) { if (rows[i][0] == id) { rowIndex = i + 1; break; } }
  
  if (rowIndex > -1) sheet.getRange(rowIndex, 1, 1, values.length).setValues([values]);
  else sheet.appendRow(values);
}

function deleteRowById(sheet, id) {
  var rows = sheet.getDataRange().getValues();
  for (var i = 1; i < rows.length; i++) {
    if (rows[i][0] == id) {
      sheet.deleteRow(i + 1);
      return;
    }
  }
}

function _authorize() {
  UrlFetchApp.fetch("https://www.google.com");
  SpreadsheetApp.getActiveSpreadsheet();
}
`;return i.jsxs("div",{className:"relative z-50","data-sync-handlers":[G,be,Pe],children:[i.jsxs("div",{className:"flex items-center gap-2 bg-white border border-slate-300 pl-3 pr-1.5 py-1 rounded-xl shadow-sm hover:shadow-md transition-all hover:border-slate-300",children:[i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${Ie.getScriptUrl()?"bg-emerald-500":"bg-slate-400"}`}),i.jsx("span",{className:`text-[9px] font-semibold uppercase tracking-wide ${Ie.getScriptUrl()?"text-emerald-600":"text-slate-500"}`,children:Ie.getScriptUrl()?"Synced":"Offline"})]}),i.jsx("div",{className:"h-3 w-px bg-slate-200"}),i.jsx("button",{onClick:()=>h(!v),className:`p-1.5 rounded-lg transition-colors ${v?"bg-slate-100 text-slate-700":"text-slate-500 hover:text-slate-600 hover:bg-slate-100"}`,children:i.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),i.jsx(gt,{isOpen:v,onClose:()=>h(!1),title:"Settings",maxWidth:"max-w-lg",children:i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex border-b border-slate-300",children:[{id:"general",label:"General",icon:""},{id:"integrations",label:"Integrations",icon:""},{id:"data",label:"Data",icon:""}].map(me=>i.jsxs("button",{onClick:()=>w(me.id),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors ${k===me.id?"border-teal-500 text-teal-600":"border-transparent text-slate-500 hover:text-slate-700"}`,children:[i.jsx("span",{children:me.icon}),me.label]},me.id))}),k==="general"&&i.jsxs("div",{className:"space-y-6",children:[c&&d&&i.jsxs("div",{className:"bg-teal-50 rounded-xl p-4 border border-teal-200",children:[i.jsxs("h4",{className:"text-sm font-bold text-slate-800 mb-1 flex items-center gap-2",children:[i.jsx("svg",{className:"w-4 h-4 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Active Period"]}),i.jsx("p",{className:"text-xs text-slate-600 mb-3",children:"This sets the default month/year across the app"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("select",{value:c.month,onChange:me=>d({...c,month:me.target.value}),className:"flex-1 bg-white border border-teal-300 rounded-lg px-3 py-2 text-sm font-semibold text-slate-800 focus:ring-2 focus:ring-teal-100 focus:border-teal-400 outline-none cursor-pointer",children:Rm.map(me=>i.jsx("option",{value:me,children:me},me))}),i.jsx("select",{value:c.year,onChange:me=>d({...c,year:Number(me.target.value)}),className:"w-24 bg-white border border-teal-300 rounded-lg px-3 py-2 text-sm font-semibold text-slate-800 focus:ring-2 focus:ring-teal-100 focus:border-teal-400 outline-none cursor-pointer",children:[2024,2025,2026,2027].map(me=>i.jsx("option",{value:me,children:me},me))}),i.jsx("button",{onClick:()=>{const me=new Date;d({month:Rm[me.getMonth()],year:me.getFullYear()})},className:"px-3 py-2 bg-teal-600 text-white rounded-lg text-xs font-bold hover:bg-teal-700 transition-colors",children:"Today"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest block mb-1.5",children:"Backend Script URL"}),i.jsx("input",{type:"text",value:p,onChange:me=>g(me.target.value),placeholder:"https://script.google.com/...",className:"w-full bg-slate-100 border border-slate-300 rounded-lg px-3 py-2.5 text-sm text-slate-800 placeholder:text-slate-500 focus:ring-2 focus:ring-teal-100 focus:border-teal-300 outline-none"}),i.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Your Google Apps Script deployment URL"})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:Se,className:"flex-1 bg-teal-600 text-white py-2.5 rounded-lg text-sm font-bold hover:bg-teal-700 transition-all flex items-center justify-center gap-2",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Save & Sync"]}),i.jsx("button",{onClick:()=>b(!0),className:"px-4 py-2.5 bg-slate-100 text-slate-600 rounded-lg text-sm font-medium hover:bg-slate-200 transition-colors border border-slate-300",children:"Setup Guide"})]})]}),k==="integrations"&&i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{onClick:()=>{J(!0),h(!1)},className:"p-4 bg-white rounded-xl border border-slate-300 hover:border-rose-300 hover:shadow-md transition-all cursor-pointer group",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-rose-100 rounded-lg flex items-center justify-center",children:i.jsx("span",{className:"text-lg",children:""})}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-slate-800 group-hover:text-rose-600 transition-colors",children:"HiBob"}),i.jsx("p",{className:"text-xs text-slate-500",children:"HR & Goals Integration"})]})]}),i.jsx("div",{className:`px-2 py-1 rounded-full text-[10px] font-bold ${H.serviceId&&H.token?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-500"}`,children:H.serviceId&&H.token?"Connected":"Not configured"})]})}),i.jsx("div",{className:"p-4 bg-slate-100 rounded-xl border border-slate-300 opacity-60",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:i.jsx("span",{className:"text-lg",children:""})}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-slate-600",children:"Workable"}),i.jsx("p",{className:"text-xs text-slate-500",children:"Recruiting Integration"})]})]}),i.jsx("span",{className:"px-2 py-1 bg-slate-200 rounded-full text-[10px] font-bold text-slate-500",children:"Coming soon"})]})}),i.jsx("div",{onClick:()=>{h(!1)},className:"p-4 bg-white rounded-xl border border-slate-300 hover:border-blue-400 hover:shadow-md transition-all cursor-pointer group",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:i.jsx("svg",{className:"w-6 h-6 text-blue-600",viewBox:"0 0 24 24",fill:"currentColor",children:i.jsx("path",{d:"M11.53 2c0 2.4 1.97 4.35 4.35 4.35h1.78v1.7c0 2.4 1.94 4.34 4.34 4.35V2.84a.84.84 0 0 0-.84-.84H11.53zM6.77 6.8a4.362 4.362 0 0 0 4.34 4.38h1.8v1.7c0 2.4 1.93 4.34 4.33 4.35V7.65a.85.85 0 0 0-.85-.85H6.77zM2 11.6c0 2.4 1.95 4.34 4.35 4.38h1.78v1.7c.01 2.39 1.95 4.33 4.35 4.33v-9.57a.84.84 0 0 0-.85-.84H2z"})})}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-slate-800 group-hover:text-blue-600 transition-colors",children:"Jira"}),i.jsx("p",{className:"text-xs text-slate-500",children:"Project Management"})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"px-2 py-1 bg-emerald-100 text-emerald-700 rounded-full text-[10px] font-bold",children:"Ready"}),i.jsx("svg",{className:"w-4 h-4 text-slate-400 group-hover:text-blue-500 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})})]}),k==="data"&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"bg-slate-100 rounded-xl p-4 border border-slate-300",children:[i.jsx("h4",{className:"text-sm font-bold text-slate-800 mb-2",children:"Data Source"}),i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx("div",{className:`w-2 h-2 rounded-full ${Ie.getScriptUrl()?"bg-emerald-500":"bg-slate-400"}`}),i.jsx("span",{className:Ie.getScriptUrl()?"text-emerald-700":"text-slate-500",children:Ie.getScriptUrl()?"Google Sheets Connected":"Not Connected"})]}),o&&i.jsxs("p",{className:"text-xs text-slate-500 mt-2",children:["Last synced: ",o.toLocaleString()]})]}),Ie.getScriptUrl()&&i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:()=>{_e(),N(!0),h(!1)},className:"flex-1 bg-slate-100 text-slate-700 py-2.5 rounded-lg text-sm font-medium hover:bg-slate-200 transition-colors border border-slate-300 flex items-center justify-center gap-2",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 21h4a2 2 0 002-2v-3.616a1 1 0 01.3-.7l2.122-2.122a6 6 0 00-4.242-10.242A6 6 0 008 10v.01"})}),"Inspect Raw Data"]}),i.jsx("button",{onClick:()=>{s(),h(!1)},disabled:a,className:"flex-1 bg-teal-600 text-white py-2.5 rounded-lg text-sm font-medium hover:bg-teal-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:a?i.jsxs(i.Fragment,{children:[i.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Syncing..."]}):i.jsxs(i.Fragment,{children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Force Sync"]})})]})]})]})}),i.jsx(gt,{isOpen:M,onClose:()=>J(!1),title:"HiBob HR Integration",maxWidth:"max-w-2xl",children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"bg-rose-50 p-4 rounded-xl border border-rose-200",children:[i.jsx("h4",{className:"text-rose-700 font-bold text-sm mb-1",children:"Integration Status"}),i.jsx("p",{className:"text-xs text-rose-600",children:q||"Ready to connect. Requires Service ID & Token."})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest block mb-1",children:"Service ID"}),i.jsx("input",{type:"text",className:"w-full bg-slate-100 border border-slate-300 rounded-lg px-3 py-2 text-sm font-semibold text-slate-800 placeholder:text-slate-500 focus:ring-2 focus:ring-rose-100 focus:border-rose-300 outline-none transition-all",value:H.serviceId,onChange:me=>V({...H,serviceId:me.target.value})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest block mb-1",children:"Service Token"}),i.jsx("input",{type:"password",className:"w-full bg-slate-100 border border-slate-300 rounded-lg px-3 py-2 text-sm font-semibold text-slate-800 placeholder:text-slate-500 focus:ring-2 focus:ring-rose-100 focus:border-rose-300 outline-none transition-all",value:H.token,onChange:me=>V({...H,token:me.target.value})})]})]}),i.jsxs("div",{className:"bg-slate-100 rounded-xl p-4 border border-slate-300 mt-4",children:[i.jsxs("h5",{className:"text-[10px] font-bold text-teal-600 uppercase tracking-widest mb-3 flex items-center gap-2",children:[i.jsx("span",{className:"w-2 h-2 rounded-full bg-teal-500 animate-pulse"}),"Test Bench (Debug Mode)"]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-semibold text-slate-500 uppercase block mb-1",children:"Target Employee Email"}),i.jsx("input",{type:"email",className:"w-full bg-white border border-slate-300 text-slate-800 rounded-lg px-3 py-2 text-xs font-mono",placeholder:"user@company.com",value:fe,onChange:me=>F(me.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-semibold text-slate-500 uppercase block mb-1",children:"Goal Type ID (Optional Override)"}),i.jsx("div",{className:"flex gap-2",children:i.jsx("input",{type:"text",className:"w-full bg-white border border-slate-300 text-slate-800 rounded-lg px-3 py-2 text-xs font-mono",placeholder:"Use 'Read Goals API' to find ID",value:ue,onChange:me=>nt(me.target.value)})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("button",{onClick:()=>he("READ"),disabled:A,className:"bg-white text-slate-700 border border-slate-300 hover:bg-teal-50 hover:border-teal-300 hover:text-teal-700 py-2 rounded-lg text-[9px] font-bold uppercase tracking-widest transition-colors disabled:opacity-50",children:A?"...":"Read Profile"}),i.jsx("button",{onClick:()=>he("TEST_GOALS_MODULE"),disabled:A,className:"bg-white text-emerald-600 border border-slate-300 hover:bg-emerald-50 hover:border-emerald-300 py-2 rounded-lg text-[9px] font-bold uppercase tracking-widest transition-colors disabled:opacity-50",children:A?"...":"Read Goals API"}),i.jsx("button",{onClick:()=>he("TEST_PUSH"),disabled:A,className:"bg-white text-rose-600 border border-slate-300 hover:bg-rose-50 hover:border-rose-300 py-2 rounded-lg text-[9px] font-bold uppercase tracking-widest transition-colors disabled:opacity-50",children:A?"...":"Test Push Goal"}),i.jsx("button",{onClick:()=>he("SCAN_METADATA"),disabled:A,className:"bg-white text-cyan-600 border border-slate-300 hover:bg-cyan-50 hover:border-cyan-300 py-2 rounded-lg text-[9px] font-bold uppercase tracking-widest transition-colors disabled:opacity-50",children:A?"...":"Deep Profile Scan"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-semibold text-slate-500 uppercase block mb-1",children:"Goal ID (Optional - leave empty to fetch first goal)"}),i.jsx("input",{type:"text",className:"w-full bg-white border border-slate-300 text-slate-800 rounded-lg px-3 py-2 text-xs font-mono mb-2",placeholder:"e.g., 8095174",value:re,onChange:me=>oe(me.target.value)}),i.jsx("button",{onClick:()=>he("TEST_GET_GOAL",re||void 0),disabled:A,className:"w-full bg-white text-amber-600 border border-slate-300 hover:bg-amber-50 hover:border-amber-300 py-2 rounded-lg text-[9px] font-bold uppercase tracking-widest transition-colors disabled:opacity-50 mb-2",children:A?"...":"Get Single Goal"}),i.jsx("button",{onClick:()=>he("TEST_CHECK_IN",re||void 0,"GREEN"),disabled:A||!re,className:"w-full bg-white text-orange-600 border border-slate-300 hover:bg-orange-50 hover:border-orange-300 py-2 rounded-lg text-[9px] font-bold uppercase tracking-widest transition-colors disabled:opacity-50",title:re?"Test creating a check-in for this goal":"Enter a Goal ID first",children:A?"...":"Test Check-In"})]}),i.jsx("button",{onClick:()=>he("TEST_GET_TAGS"),disabled:A,className:"w-full bg-white text-purple-600 border border-slate-300 hover:bg-purple-50 hover:border-purple-300 py-2 rounded-lg text-[9px] font-bold uppercase tracking-widest transition-colors disabled:opacity-50",children:A?"...":"Get Tags"})]}),se&&i.jsx("div",{className:"mt-2 bg-slate-100 p-3 rounded-lg border border-slate-300 max-h-64 overflow-y-auto",children:i.jsx("pre",{className:"text-[10px] font-mono text-slate-700 whitespace-pre-wrap",children:JSON.stringify(se,null,2)})})]})]})]})}),i.jsx(gt,{isOpen:y,onClose:()=>b(!1),title:"Backend Setup Guide",children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"bg-slate-100 p-4 rounded-xl border border-slate-300 max-h-[60vh] overflow-y-auto",children:[i.jsx("h5",{className:"text-[10px] font-bold text-slate-800 uppercase mb-4",children:"1. Script Installation"}),i.jsxs("ol",{className:"text-[10px] font-medium text-slate-600 space-y-2 list-decimal list-inside mb-6",children:[i.jsx("li",{children:"Open your Google Sheet."}),i.jsxs("li",{children:["Go to ",i.jsx("strong",{className:"text-slate-800",children:"Extensions > Apps Script"}),"."]}),i.jsx("li",{children:"Paste the script below (replacing everything)."}),i.jsxs("li",{children:[i.jsx("span",{className:"text-teal-600 font-bold",children:"IMPORTANT:"})," Select ",i.jsx("code",{className:"bg-slate-200 px-1 py-0.5 rounded text-slate-700",children:"_authorize"})," from the dropdown menu up top and click ",i.jsx("strong",{className:"text-slate-800",children:"Run"}),". Review and grant permissions (especially 'External Service')."]}),i.jsxs("li",{children:["Click ",i.jsx("strong",{className:"text-slate-800",children:"Deploy > New Deployment"}),"."]}),i.jsx("li",{children:'Select type "Web app".'}),i.jsx("li",{children:'Set "Who has access" to "Anyone".'}),i.jsxs("li",{children:['Click "Deploy" and copy the ',i.jsx("strong",{className:"text-slate-800",children:"Web App URL"}),"."]})]}),i.jsx("div",{className:"bg-amber-50 p-3 rounded-lg border border-amber-200 mb-4",children:i.jsx("p",{className:"text-[10px] font-semibold text-amber-700",children:'Important: You must re-deploy as "New Version" every time you update this script code!'})})]}),i.jsxs("div",{className:"bg-slate-100 p-4 rounded-xl relative border border-slate-300",children:[i.jsx("button",{onClick:()=>navigator.clipboard.writeText(ke),className:"absolute top-2 right-2 bg-teal-600 text-white text-[9px] font-bold px-2 py-1 rounded-lg hover:bg-teal-700 transition-all",children:"Copy Script"}),i.jsx("pre",{className:"text-[10px] text-slate-700 font-mono overflow-x-auto h-40",children:ke})]})]})}),i.jsx(gt,{isOpen:S,onClose:()=>N(!1),title:"Data Inspector",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("p",{className:"text-xs text-slate-600",children:"Verify data arriving from Google Sheets."}),i.jsx("button",{onClick:_e,className:"text-[10px] bg-slate-100 px-3 py-1 rounded-lg font-bold uppercase hover:bg-slate-200 text-slate-700 border border-slate-300 transition-colors",children:"Refresh Data"})]}),P?i.jsx("div",{className:"h-40 bg-slate-100 animate-pulse rounded-xl"}):ce?i.jsx("pre",{className:"bg-slate-100 text-slate-700 p-4 rounded-xl text-[10px] font-mono overflow-auto h-40 border border-slate-300",children:JSON.stringify(ce,null,2)}):i.jsx("div",{className:"text-center py-10 text-slate-500 font-semibold",children:"No data fetched yet."})]})})]})},Ov=({goal:s,onSave:t,onDelete:a,onCancel:o})=>{const[c,d]=I.useState({title:"",description:"",...s}),p=g=>{g.preventDefault(),t(c)};return i.jsxs("form",{onSubmit:p,className:"space-y-5",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs font-medium text-slate-600 block mb-1.5",children:"Strategic Title"}),i.jsx("input",{required:!0,type:"text",className:"w-full bg-white border border-slate-300 rounded-lg px-3 py-2.5 focus:ring-2 focus:ring-teal-500/20 focus:border-teal-500 outline-none text-slate-900 placeholder:text-slate-500 text-sm transition-colors",value:c.title,onChange:g=>d({...c,title:g.target.value}),placeholder:"e.g., Global Market Expansion"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs font-medium text-slate-600 block mb-1.5",children:"Success Definition / Goal Description"}),i.jsx("textarea",{required:!0,className:"w-full bg-white border border-slate-300 rounded-lg px-3 py-2.5 focus:ring-2 focus:ring-teal-500/20 focus:border-teal-500 outline-none text-slate-900 placeholder:text-slate-500 min-h-[100px] text-sm transition-colors",value:c.description,onChange:g=>d({...c,description:g.target.value}),placeholder:"Define what success looks like for this rock..."})]})]}),i.jsxs("div",{className:"flex gap-3 pt-4",children:[i.jsx("button",{type:"submit",className:"flex-1 bg-teal-600 hover:bg-teal-700 text-white py-3 rounded-lg font-medium transition-colors",children:s!=null&&s.id?"Update Goal":"Establish Goal"}),(s==null?void 0:s.id)&&a&&i.jsx("button",{type:"button",onClick:()=>a(s.id),className:"px-5 py-3 bg-red-50 text-red-600 rounded-lg font-medium hover:bg-red-100 transition-colors",children:"Delete"}),i.jsx("button",{type:"button",onClick:o,className:"px-5 py-3 bg-slate-100 text-slate-600 rounded-lg font-medium hover:bg-slate-200 transition-colors",children:"Cancel"})]})]})},Pv=({item:s,goals:t,employees:a,departments:o,onSave:c,onCancel:d})=>{var k;const[p,g]=I.useState({title:"",description:"",goalId:((k=t[0])==null?void 0:k.id)||"",owner:"",department:o[0]||"Product",team:"",status:we.NOT_STARTED,priority:Ee.MEDIUM,progress:0,startDate:new Date().toISOString().split("T")[0],endDate:"2026-12-31",tags:[],goalType:"PERSONAL",goalCategory:"PERFORMANCE",...s}),v=I.useMemo(()=>{const w=new Set;return a.filter(M=>{var J;return M.department.toLowerCase()===((J=p.department)==null?void 0:J.toLowerCase())&&M.team}).forEach(M=>w.add(M.team)),Array.from(w).sort()},[a,p.department]),h=I.useMemo(()=>a.filter(w=>{var M;return w.department.toLowerCase()===((M=p.department)==null?void 0:M.toLowerCase())}).sort((w,M)=>w.isHoD&&!M.isHoD?-1:!w.isHoD&&M.isHoD?1:w.name.localeCompare(M.name)),[a,p.department]);I.useEffect(()=>{if(h.length>0){if(!h.some(M=>M.name===p.owner||M.id===p.owner)){const M=h.find(ce=>ce.isHoD)||h[0],J=(M==null?void 0:M.name)??"";queueMicrotask(()=>g(ce=>({...ce,owner:J})))}}else queueMicrotask(()=>g(w=>({...w,owner:""})))},[p.department,h]);const y=w=>{w.preventDefault(),c(p)},{labelClass:b,inputClass:S,selectClass:N}=yu;return i.jsxs("form",{onSubmit:y,className:"space-y-5",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:b,children:"Goal Title"}),i.jsx("input",{required:!0,type:"text",placeholder:"What is the high-level objective?",className:S,value:p.title,onChange:w=>g({...p,title:w.target.value})})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:b,children:"Details & Context"}),i.jsx("textarea",{required:!0,placeholder:"Describe the scope and impact...",className:`${S} min-h-[80px]`,value:p.description,onChange:w=>g({...p,description:w.target.value})})]}),i.jsxs("div",{children:[i.jsx("label",{className:b,children:"Lead Department"}),i.jsx("select",{className:N,value:p.department,onChange:w=>g({...p,department:w.target.value,team:""}),children:o.map(w=>i.jsx("option",{value:w,children:w},w))})]}),i.jsxs("div",{children:[i.jsx("label",{className:b,children:"Sub-Team (Optional)"}),i.jsxs("select",{className:N,value:p.team,onChange:w=>g({...p,team:w.target.value}),children:[i.jsx("option",{value:"",children:"No specific team"}),v.map(w=>i.jsx("option",{value:w,children:w},w))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:b,children:"Responsible Owner"}),i.jsx("select",{className:N,value:p.owner,onChange:w=>g({...p,owner:w.target.value}),children:h.length>0?h.map(w=>i.jsxs("option",{value:w.name,children:[w.isHoD?" ":"",w.name]},w.id)):i.jsx("option",{value:"",children:"No employees in this department"})})]}),i.jsxs("div",{children:[i.jsx("label",{className:b,children:"Big Rock Alignment"}),i.jsx("select",{className:N,value:p.goalId,onChange:w=>g({...p,goalId:w.target.value}),children:t.map(w=>i.jsx("option",{value:w.id,children:w.title},w.id))})]}),i.jsxs("div",{children:[i.jsx("label",{className:b,children:"Status"}),i.jsx("select",{className:N,value:p.status,onChange:w=>g({...p,status:w.target.value}),children:Object.values(we).map(w=>i.jsx("option",{value:w,children:w},w))})]}),i.jsxs("div",{children:[i.jsx("label",{className:b,children:"Priority"}),i.jsx("select",{className:N,value:p.priority,onChange:w=>g({...p,priority:w.target.value}),children:Object.values(Ee).map(w=>i.jsx("option",{value:w,children:w},w))})]}),i.jsxs("div",{children:[i.jsx("label",{className:b,children:"Start Date"}),i.jsx("input",{type:"date",className:S,value:p.startDate,onChange:w=>g({...p,startDate:w.target.value})})]}),i.jsxs("div",{children:[i.jsx("label",{className:b,children:"End Date"}),i.jsx("input",{type:"date",className:S,value:p.endDate,onChange:w=>g({...p,endDate:w.target.value})})]}),i.jsxs("div",{children:[i.jsxs("label",{className:b,children:["Type ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{className:N,value:p.goalType||"PERSONAL",onChange:w=>g({...p,goalType:w.target.value}),children:[i.jsx("option",{value:"PERSONAL",children:"Personal"}),i.jsx("option",{value:"DEPARTMENT",children:"Department"}),i.jsx("option",{value:"COMPANY",children:"Company"})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:b,children:["Category ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{className:N,value:p.goalCategory||"PERFORMANCE",onChange:w=>g({...p,goalCategory:w.target.value}),children:[i.jsx("option",{value:"PERFORMANCE",children:"Performance"}),i.jsx("option",{value:"DEVELOPMENT",children:"Development"})]})]})]}),i.jsxs("div",{className:"flex gap-3 pt-4",children:[i.jsx("button",{type:"submit",className:"flex-1 bg-teal-600 hover:bg-teal-700 text-white py-3 rounded-lg font-medium transition-colors",children:s!=null&&s.id?"Update Goal":"Confirm Goal"}),i.jsx("button",{type:"button",onClick:d,className:"px-5 py-3 bg-slate-100 text-slate-600 rounded-lg font-medium hover:bg-slate-200 transition-colors",children:"Cancel"})]})]})},Hv=({goal:s,existingUpdate:t,onSave:a,onCancel:o})=>{const c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],d=c[new Date().getMonth()],p=new Date().getFullYear(),[g,v]=I.useState({goalId:s.id,month:d,year:p,status:De.GREEN,content:"",...t}),h=y=>{y.preventDefault(),a(g)};return i.jsxs("form",{onSubmit:h,className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest block mb-2",children:"Month"}),i.jsx("select",{className:"w-full bg-slate-100 border border-slate-300 rounded-xl px-4 py-3 outline-none focus:ring-2 focus:ring-indigo-500/20 font-bold text-slate-700",value:g.month,onChange:y=>v({...g,month:y.target.value}),children:c.map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest block mb-2",children:"Year"}),i.jsx("input",{type:"number",className:"w-full bg-slate-100 border border-slate-300 rounded-xl px-4 py-3 outline-none focus:ring-2 focus:ring-indigo-500/20 font-bold text-slate-700",value:g.year,onChange:y=>v({...g,year:parseInt(y.target.value)})})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest block mb-2",children:"Current Health"}),i.jsx("div",{className:"flex gap-4",children:[{id:De.GREEN,color:"bg-emerald-500",label:"On Track"},{id:De.AMBER,color:"bg-amber-500",label:"At Risk"},{id:De.RED,color:"bg-rose-500",label:"Blocked"}].map(y=>i.jsxs("button",{type:"button",onClick:()=>v({...g,status:y.id}),className:`flex-1 flex items-center justify-center gap-2 py-3 rounded-xl border-2 transition-all ${g.status===y.id?`border-slate-900 ${y.color} text-white`:"border-slate-100 bg-white text-slate-500 hover:border-slate-300"}`,children:[i.jsx("div",{className:`w-3 h-3 rounded-full ${g.status===y.id?"bg-white":y.color}`}),i.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:y.label})]},y.id))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest block mb-2",children:"Progress Update"}),i.jsx("textarea",{required:!0,placeholder:"What's happened this month? Key wins, blockers, and next steps...",className:"w-full bg-slate-100 border border-slate-300 rounded-xl px-4 py-3 outline-none focus:ring-2 focus:ring-indigo-500/20 text-slate-700 min-h-[150px]",value:g.content,onChange:y=>v({...g,content:y.target.value})})]}),i.jsxs("div",{className:"flex gap-4 pt-4",children:[i.jsx("button",{type:"submit",className:"flex-1 bg-teal-600 text-white py-4 rounded-2xl font-bold uppercase tracking-widest hover:bg-teal-700 transition-all shadow-lg shadow-teal-100",children:t?"Save Changes":"Publish Update"}),i.jsx("button",{type:"button",onClick:o,className:"px-6 py-4 bg-slate-100 text-slate-500 rounded-2xl font-black uppercase tracking-widest hover:bg-slate-100 transition-all",children:"Cancel"})]})]})},Bv=({item:s,existingUpdate:t,onSave:a,onCancel:o})=>{const c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],d=c[new Date().getMonth()],[p,g]=I.useState({itemId:s.id,month:d,year:new Date().getFullYear(),health:De.GREEN,content:"",...t}),v=h=>{h.preventDefault(),a(p)};return i.jsxs("form",{onSubmit:v,className:"space-y-5",children:[i.jsxs("div",{className:"bg-slate-100 p-4 rounded-xl border border-slate-300 mb-5",children:[i.jsx("h4",{className:"text-xs font-medium text-slate-500 mb-1",children:"Updating Goal"}),i.jsx("p",{className:"text-sm font-semibold text-slate-900",children:s.title})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs font-medium text-slate-600 block mb-1.5",children:"Month"}),i.jsx("select",{className:"w-full bg-white border border-slate-300 rounded-lg px-3 py-2.5 outline-none focus:ring-2 focus:ring-teal-500/20 focus:border-teal-500 text-slate-900 text-sm transition-colors",value:p.month,onChange:h=>g({...p,month:h.target.value}),children:c.map(h=>i.jsx("option",{value:h,children:h},h))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs font-medium text-slate-600 block mb-1.5",children:"Year"}),i.jsx("input",{type:"number",className:"w-full bg-white border border-slate-300 rounded-lg px-3 py-2.5 outline-none focus:ring-2 focus:ring-teal-500/20 focus:border-teal-500 text-slate-900 text-sm transition-colors",value:p.year,onChange:h=>g({...p,year:parseInt(h.target.value)})})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs font-medium text-slate-600 block mb-2",children:"Execution Health"}),i.jsx("div",{className:"flex gap-2",children:[{id:De.GREEN,color:"bg-emerald-500",borderColor:"border-emerald-500",bgColor:"bg-emerald-50",label:"On Track"},{id:De.AMBER,color:"bg-amber-500",borderColor:"border-amber-500",bgColor:"bg-amber-50",label:"At Risk"},{id:De.RED,color:"bg-red-500",borderColor:"border-red-500",bgColor:"bg-red-50",label:"Blocked"}].map(h=>i.jsxs("button",{type:"button",onClick:()=>g({...p,health:h.id}),className:`flex-1 py-3 rounded-lg border-2 transition-all flex flex-col items-center gap-1 ${p.health===h.id?`${h.borderColor} ${h.bgColor}`:"border-slate-300 bg-white hover:bg-slate-100"}`,children:[i.jsx("div",{className:`w-3 h-3 rounded-full ${h.color}`}),i.jsx("span",{className:`text-[10px] font-medium ${p.health===h.id?"text-slate-900":"text-slate-500"}`,children:h.label})]},h.id))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs font-medium text-slate-600 block mb-1.5",children:"Update Details"}),i.jsx("textarea",{required:!0,placeholder:"Briefly describe progress, issues, or key achievements for this period...",className:"w-full bg-white border border-slate-300 rounded-lg px-3 py-2.5 outline-none focus:ring-2 focus:ring-teal-500/20 focus:border-teal-500 text-slate-900 placeholder:text-slate-500 min-h-[120px] text-sm transition-colors",value:p.content,onChange:h=>g({...p,content:h.target.value})})]}),i.jsxs("div",{className:"flex gap-3 pt-3",children:[i.jsx("button",{type:"submit",className:"flex-1 bg-teal-600 hover:bg-teal-700 text-white py-3 rounded-lg font-medium transition-colors",children:"Save Update"}),i.jsx("button",{type:"button",onClick:o,className:"px-5 py-3 bg-slate-100 text-slate-600 rounded-lg font-medium hover:bg-slate-200 transition-colors",children:"Cancel"})]})]})},Vv=({item:s,updates:t,isOpen:a,onClose:o,onAddUpdate:c,onEdit:d,onEditUpdate:p})=>{const g=[...t].sort((h,y)=>{const b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return h.year!==y.year?y.year-h.year:b.indexOf(y.month)-b.indexOf(h.month)}),v=h=>{switch(h){case"GREEN":return"bg-emerald-500";case"AMBER":return"bg-amber-500";case"RED":return"bg-red-500";default:return"bg-teal-500"}};return i.jsx(gt,{isOpen:a,onClose:o,title:"Goal Update History",children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"bg-slate-100 p-5 rounded-xl border border-slate-300 relative",children:[d&&i.jsx("button",{onClick:()=>d(s),className:"absolute top-4 right-4 bg-white border border-slate-300 hover:border-teal-300 text-slate-500 hover:text-teal-600 p-2 rounded-lg transition-colors",title:"Edit Goal Details",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:s.department}),s.team&&i.jsx("span",{className:"text-slate-500",children:""}),s.team&&i.jsx("span",{className:"text-xs text-slate-500",children:s.team})]}),i.jsx("h3",{className:"text-lg font-semibold text-slate-900 pr-10",children:s.title}),i.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[i.jsxs("div",{className:"text-xs font-medium bg-white border border-slate-300 text-slate-600 px-2.5 py-1 rounded-lg flex items-center gap-1.5",children:[i.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),s.owner]}),i.jsxs("div",{className:"text-xs font-medium bg-white border border-slate-300 text-slate-600 px-2.5 py-1 rounded-lg flex items-center gap-1.5",children:[i.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Due ",s.endDate]})]})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h4",{className:"text-sm font-semibold text-slate-900",children:"Timeline"}),c&&i.jsxs("button",{onClick:()=>c(s),className:"bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",children:[i.jsx("span",{className:"text-base leading-none",children:"+"})," Add Update"]})]}),i.jsxs("div",{className:"relative ml-3 space-y-5 pl-6 py-2",children:[i.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-px bg-slate-200"}),g.length>0?g.map(h=>{var y;return i.jsxs("div",{className:"relative group",children:[i.jsx("div",{className:`absolute -left-[25px] top-1 w-4 h-4 rounded-full ${v(h.health)} border-2 border-white shadow`}),i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("span",{className:"text-sm font-semibold text-slate-900",children:[h.month," ",h.year]}),i.jsx("span",{className:`
                      text-[10px] font-medium px-2 py-0.5 rounded-full
                      ${h.health===De.GREEN?"bg-emerald-50 text-emerald-700":h.health===De.AMBER?"bg-amber-50 text-amber-700":"bg-red-50 text-red-700"}
                    `,children:((y=vu[h.health])==null?void 0:y.label)||"Unknown"})]}),i.jsx("span",{className:"text-xs text-slate-500 sm:ml-auto",children:new Date(h.updatedAt).toLocaleDateString()})]}),i.jsxs("div",{className:"bg-white p-4 rounded-lg border border-slate-300 group-hover:border-teal-200 transition-colors relative",children:[p&&i.jsx("button",{onClick:()=>p(h),className:"absolute top-2 right-2 p-1.5 bg-slate-100 text-slate-500 hover:text-teal-600 rounded opacity-0 group-hover:opacity-100 transition-opacity",title:"Edit this update",children:i.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),i.jsx("p",{className:"text-sm text-slate-700 leading-relaxed whitespace-pre-wrap pr-6",children:h.content})]})]},h.id)}):i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"w-12 h-12 mx-auto mb-3 bg-slate-100 rounded-xl flex items-center justify-center",children:i.jsx("svg",{className:"w-6 h-6 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),i.jsx("p",{className:"text-slate-600 font-medium",children:"No updates yet"}),i.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Add your first monthly update to track progress"})]})]})]})]})})},Mm=({onSync:s,isSyncing:t,onCancel:a})=>{const[o,c]=I.useState({domain:"",email:"",apiToken:"",projectKeys:""}),[d,p]=I.useState(!1),[g,v]=I.useState(null);I.useEffect(()=>{const b=localStorage.getItem("omnimap_jira_config");b&&c(JSON.parse(b))},[]);const h=async b=>{b.preventDefault(),localStorage.setItem("omnimap_jira_config",JSON.stringify(o)),p(!0),v(null);try{const S=await Ie.syncJiraIssues({domain:o.domain,email:o.email,apiToken:o.apiToken,projectKeys:o.projectKeys});v(S),S.success&&S.issues&&s({...o,_issues:S.issues})}catch(S){v({success:!1,message:S.message||"Unknown error"})}finally{p(!1)}},y=async()=>{var b;p(!0),v(null);try{const S=await Ie.syncJiraIssues({domain:o.domain,email:o.email,apiToken:o.apiToken,projectKeys:o.projectKeys});v({success:S.success,message:S.success?` Connection successful! Found ${((b=S.issues)==null?void 0:b.length)||0} issues.`:` ${S.message}`})}catch(S){v({success:!1,message:` ${S.message}`})}finally{p(!1)}};return i.jsxs("form",{onSubmit:h,className:"space-y-5",children:[i.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl border border-blue-200 flex items-center gap-3 mb-2",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center text-white shrink-0",children:i.jsx("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"currentColor",children:i.jsx("path",{d:"M11.53 2c0 2.4 1.97 4.35 4.35 4.35h1.78v1.7c0 2.4 1.94 4.34 4.34 4.35V2.84a.84.84 0 0 0-.84-.84H11.53zM6.77 6.8a4.362 4.362 0 0 0 4.34 4.38h1.8v1.7c0 2.4 1.93 4.34 4.33 4.35V7.65a.85.85 0 0 0-.85-.85H6.77zM2 11.6c0 2.4 1.95 4.34 4.35 4.38h1.78v1.7c.01 2.39 1.95 4.33 4.35 4.33v-9.57a.84.84 0 0 0-.85-.84H2z"})})}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-bold text-blue-900",children:"Jira Cloud Integration"}),i.jsx("p",{className:"text-xs text-blue-600",children:"Sync tickets to your roadmap (via backend proxy - no CORS issues!)"})]})]}),g&&i.jsxs("div",{className:`p-4 rounded-xl border ${g.success?"bg-emerald-50 border-emerald-200":"bg-red-50 border-red-200"}`,children:[i.jsx("p",{className:`text-sm font-medium ${g.success?"text-emerald-700":"text-red-700"}`,children:g.message}),g.success&&g.issues&&g.issues.length>0&&i.jsxs("div",{className:"mt-3 max-h-40 overflow-y-auto",children:[i.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Sample issues:"}),g.issues.slice(0,5).map(b=>{var S,N;return i.jsxs("div",{className:"text-xs bg-white p-2 rounded mb-1 border border-slate-100",children:[i.jsx("span",{className:"font-bold text-blue-600",children:b.key}),i.jsx("span",{className:"mx-2 text-slate-400",children:"|"}),i.jsxs("span",{className:"text-slate-700",children:[(S=b.summary)==null?void 0:S.substring(0,50),((N=b.summary)==null?void 0:N.length)>50?"...":""]})]},b.key)}),g.issues.length>5&&i.jsxs("p",{className:"text-xs text-slate-400 mt-1",children:["...and ",g.issues.length-5," more"]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest block mb-1.5",children:"Jira Domain"}),i.jsx("input",{type:"text",placeholder:"your-company.atlassian.net",className:"w-full bg-slate-100 border border-slate-300 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-blue-200 focus:border-blue-400 outline-none font-medium",value:o.domain,onChange:b=>c({...o,domain:b.target.value}),required:!0}),i.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Just the domain, without https://"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest block mb-1.5",children:"Email"}),i.jsx("input",{type:"email",placeholder:"you@company.com",className:"w-full bg-slate-100 border border-slate-300 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-blue-200 focus:border-blue-400 outline-none font-medium",value:o.email,onChange:b=>c({...o,email:b.target.value}),required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest block mb-1.5",children:"API Token"}),i.jsx("input",{type:"password",placeholder:"Your Jira API token",className:"w-full bg-slate-100 border border-slate-300 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-blue-200 focus:border-blue-400 outline-none font-medium",value:o.apiToken,onChange:b=>c({...o,apiToken:b.target.value}),required:!0})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest block mb-1.5",children:"Project Keys (Optional)"}),i.jsx("input",{type:"text",placeholder:"PROD, TECH, ENG (leave empty for all)",className:"w-full bg-slate-100 border border-slate-300 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-blue-200 focus:border-blue-400 outline-none font-medium",value:o.projectKeys,onChange:b=>c({...o,projectKeys:b.target.value})}),i.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Comma-separated project keys to filter issues"})]})]}),i.jsxs("div",{className:"flex gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:y,disabled:d||!o.domain||!o.email||!o.apiToken,className:"px-6 py-3 bg-slate-100 text-slate-700 rounded-xl font-semibold hover:bg-slate-200 transition-all disabled:opacity-50 disabled:cursor-not-allowed border border-slate-300",children:d?"Testing...":"Test Connection"}),i.jsx("button",{type:"submit",disabled:d||t||!o.domain||!o.email||!o.apiToken,className:"flex-1 bg-blue-600 text-white py-3 rounded-xl font-semibold hover:bg-blue-700 transition-all shadow-lg shadow-blue-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:d||t?i.jsxs(i.Fragment,{children:[i.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Syncing..."]}):i.jsxs(i.Fragment,{children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Fetch & Import Issues"]})})]}),i.jsx("button",{type:"button",onClick:a,className:"w-full text-center text-sm text-slate-500 hover:text-slate-700 py-2",children:"Cancel"}),i.jsx("div",{className:"border-t border-slate-200 pt-4 mt-4",children:i.jsxs("p",{className:"text-xs text-slate-500",children:[i.jsx("strong",{children:"How to get an API token:"})," Go to"," ",i.jsx("a",{href:"https://id.atlassian.com/manage-profile/security/api-tokens",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Atlassian Account Settings"})," "," Security  Create API token"]})})]})},qv="198355667766-om28scvbccnq6nbave8nqj3u6nb4asd7.apps.googleusercontent.com",Jl="collecting.com",Zc="omnimap_auth_session",eu="omnimap_google_user";class Jv{constructor(){this.initialized=!1}initialize(){var t;if(!this.initialized){if(!((t=window.google)!=null&&t.accounts)){console.error("Google Identity Services not loaded. Make sure the script is included in index.html");return}try{const a={client_id:qv,callback:this.handleCredentialResponse.bind(this),auto_select:!1,cancel_on_tap_outside:!0};Jl&&(a.hd=Jl),window.google.accounts.id.initialize(a),this.initialized=!0}catch(a){console.error("Failed to initialize Google Identity Services:",a)}}}async handleCredentialResponse(t){try{const a=this.decodeJWT(t.credential);if(!a)throw new Error("Failed to decode Google token");const o={email:a.email||"",name:a.name||"",picture:a.picture,hd:a.hd};if(Jl&&o.hd!==Jl)throw new Error(`Access restricted to ${Jl} accounts only`);this.saveSession(o,t.credential),window.dispatchEvent(new CustomEvent("google-signin-success",{detail:{googleUser:o}}))}catch(a){console.error("Authentication error:",a),window.dispatchEvent(new CustomEvent("google-signin-error",{detail:{error:a.message||"Authentication failed"}}))}}decodeJWT(t){try{const o=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),c=decodeURIComponent(atob(o).split("").map(d=>"%"+("00"+d.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(c)}catch(a){return console.error("Failed to decode JWT:",a),null}}saveSession(t,a){try{sessionStorage.setItem(eu,JSON.stringify(t)),sessionStorage.setItem(Zc,JSON.stringify({email:t.email,timestamp:Date.now()}))}catch(o){console.error("Failed to save session:",o)}}getStoredUser(){try{const t=sessionStorage.getItem(eu);return t?JSON.parse(t):null}catch(t){return console.error("Failed to get stored user:",t),null}}hasActiveSession(){try{const t=sessionStorage.getItem(Zc);if(!t)return!1;const a=JSON.parse(t),o=1440*60*1e3;return Date.now()-a.timestamp<o}catch{return!1}}signOut(){var t;try{sessionStorage.removeItem(Zc),sessionStorage.removeItem(eu),(t=window.google)!=null&&t.accounts&&window.google.accounts.id.disableAutoSelect(),window.dispatchEvent(new CustomEvent("google-signout"))}catch(a){console.error("Failed to sign out:",a)}}matchEmployeeByEmail(t,a){if(!t.email)return console.log("[AuthService] No email provided for matching"),null;console.log("[AuthService] Matching user:",t.email,"against",a.length,"employees");let o=a.find(c=>{var d;return((d=c.email)==null?void 0:d.toLowerCase())===t.email.toLowerCase()});if(o)console.log("[AuthService] Found employee by email:",o.id,o.name,o.email);else{console.log("[AuthService] No email match found, trying name matching...");const c=t.name.toLowerCase().split(" ");o=a.find(d=>{const p=d.name.toLowerCase();return c.some(g=>p.includes(g))||p.split(" ").some(g=>c.includes(g))}),o?(console.log("[AuthService] Found employee by name:",o.id,o.name,o.email),o.email||(o={...o,email:t.email},console.log("[AuthService] Added email to employee record:",o.email))):console.log("[AuthService] No employee match found for:",t.email,t.name)}return o||null}renderButton(t,a){var c,d;if(console.log("[AuthService] renderButton called for:",t),console.log("[AuthService] Client ID present:",!0),console.log("[AuthService] Google accounts available:",!!((c=window.google)!=null&&c.accounts)),!this.initialized&&(console.log("[AuthService] Initializing before rendering button..."),this.initialize(),!this.initialized)){console.error("[AuthService] Initialization failed, cannot render button");return}const o=document.getElementById(t);if(!o){console.error(`[AuthService] Element with id "${t}" not found`);return}if(!((d=window.google)!=null&&d.accounts)){console.error("[AuthService] Google Identity Services not loaded");return}try{console.log("[AuthService] Rendering button with config:",a),window.google.accounts.id.renderButton(o,{type:(a==null?void 0:a.theme)||"standard",size:(a==null?void 0:a.size)||"large",text:"signin_with",shape:"rectangular",logo_alignment:"left"}),console.log("[AuthService] Button rendered successfully")}catch(p){console.error("[AuthService] Failed to render Google Sign-In button:",p)}}prompt(){var t;if(this.initialized||this.initialize(),(t=window.google)!=null&&t.accounts)try{window.google.accounts.id.prompt()}catch(a){console.error("Failed to prompt Google Sign-In:",a)}}}const $n=new Jv,zv=({employees:s,onLogin:t,onAuthError:a})=>{const[o,c]=I.useState(!1),[d,p]=I.useState(!1),[g,v]=I.useState(null),h=I.useRef(null),y=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1",[b,S]=I.useState(""),[N,k]=I.useState(!1),[w,M]=I.useState(!1),[J,ce]=I.useState("");I.useEffect(()=>{const H=setTimeout(()=>c(!0),100);return()=>clearTimeout(H)},[]),I.useEffect(()=>{const H=()=>{var q,X;if(console.log("[LoginScreen] Initializing Google Sign-In..."),console.log("[LoginScreen] Google script loaded:",!!((q=window.google)!=null&&q.accounts)),console.log("[LoginScreen] Button ref available:",!!h.current),(X=window.google)!=null&&X.accounts)console.log("[LoginScreen] Google accounts available, initializing..."),$n.initialize(),h.current?setTimeout(()=>{console.log("[LoginScreen] Rendering button..."),$n.renderButton("google-signin-button",{theme:"outline",size:"large"})},100):console.error("[LoginScreen] Button ref not available");else{console.log("[LoginScreen] Waiting for Google script to load...");let fe=0;const F=50,re=setInterval(()=>{var oe;fe++,(oe=window.google)!=null&&oe.accounts?(console.log("[LoginScreen] Google script loaded after",fe*100,"ms"),clearInterval(re),$n.initialize(),h.current&&setTimeout(()=>{$n.renderButton("google-signin-button",{theme:"outline",size:"large"})},100)):fe>=F&&(console.error("[LoginScreen] Google script failed to load after",F*100,"ms"),clearInterval(re),v("Failed to load Google Sign-In. Please refresh the page."))},100);return()=>clearInterval(re)}},V=setTimeout(()=>{H()},200);return()=>clearTimeout(V)},[]),I.useEffect(()=>{const H=q=>{p(!0),v(null);const{googleUser:X}=q.detail,fe=$n.matchEmployeeByEmail(X,s);if(fe)p(!1),t(fe);else{p(!1);const F=`No employee record found for ${X.email}. Please contact your administrator.`;v(F),a&&a(F)}},V=q=>{p(!1);const{error:X}=q.detail;v(X),a&&a(X)};return window.addEventListener("google-signin-success",H),window.addEventListener("google-signin-error",V),()=>{window.removeEventListener("google-signin-success",H),window.removeEventListener("google-signin-error",V)}},[s,t,a]);const ee=()=>{b==="123"?(M(!0),v(null)):v("Invalid dev code")},P=H=>{console.log("[Dev Login] Impersonating:",H.id,H.name,H.email),t(H)},Q=s.filter(H=>{var V,q,X;return H.name.toLowerCase().includes(J.toLowerCase())||((V=H.email)==null?void 0:V.toLowerCase().includes(J.toLowerCase()))||((q=H.department)==null?void 0:q.toLowerCase().includes(J.toLowerCase()))||((X=H.role)==null?void 0:X.toLowerCase().includes(J.toLowerCase()))});return i.jsx("div",{className:"min-h-screen bg-slate-100 flex items-center justify-center p-4",children:i.jsxs("div",{className:`
          w-full max-w-xl bg-white rounded-2xl shadow-elevated border border-slate-300 overflow-hidden
          transition-all duration-500 ease-out
          ${o?"opacity-100 translate-y-0":"opacity-0 translate-y-4"}
        `,children:[i.jsxs("div",{className:"p-8 border-b border-slate-100",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"p-2.5 bg-teal-600 rounded-xl",children:i.jsxs("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"})]})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"OmniMap"}),i.jsx("p",{className:"text-sm text-slate-500",children:"Strategic Roadmap Platform"})]})]}),i.jsx("p",{className:"mt-4 text-slate-600",children:"Sign in with your company Google account to access your dashboard."})]}),i.jsxs("div",{className:"p-8",children:[g&&i.jsx("div",{className:"mb-6 p-4 bg-rose-50 border border-rose-200 rounded-xl",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("svg",{className:"w-5 h-5 text-rose-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"text-sm font-medium text-rose-900",children:"Authentication Error"}),i.jsx("p",{className:"text-sm text-rose-700 mt-1",children:g})]})]})}),d?i.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[i.jsx("div",{className:"w-12 h-12 border-4 border-teal-600 border-t-transparent rounded-full animate-spin mb-4"}),i.jsx("p",{className:"text-slate-600 font-medium",children:"Authenticating..."}),i.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Please wait"})]}):i.jsxs("div",{className:"flex flex-col items-center space-y-6",children:[i.jsx("div",{id:"google-signin-button",ref:h,className:"w-full flex justify-center"}),i.jsx("p",{className:"text-xs text-slate-500 text-center",children:"Only company Google Workspace accounts are authorized to access this application."}),y&&i.jsxs("div",{className:"w-full pt-6 border-t border-slate-200",children:[i.jsxs("button",{onClick:()=>{k(!N),N&&(M(!1),S(""),ce(""))},className:"text-xs text-slate-400 hover:text-slate-600 transition-colors",children:[N?"Hide":"Show"," Dev Login"]}),N&&!w&&i.jsxs("div",{className:"mt-4 p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[i.jsx("p",{className:"text-xs font-medium text-amber-900 mb-3",children:"Development Mode Only"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"password",value:b,onChange:H=>S(H.target.value),onKeyPress:H=>H.key==="Enter"&&ee(),placeholder:"Enter dev code",className:"flex-1 px-3 py-2 text-sm border border-amber-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-amber-500"}),i.jsx("button",{onClick:ee,className:"px-4 py-2 bg-amber-600 text-white text-sm font-medium rounded-lg hover:bg-amber-700 transition-colors",children:"Unlock"})]})]}),N&&w&&i.jsxs("div",{className:"mt-4 p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[i.jsx("p",{className:"text-xs font-medium text-amber-900 mb-3",children:"Select a user to impersonate"}),i.jsxs("div",{className:"relative mb-3",children:[i.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),i.jsx("input",{type:"text",value:J,onChange:H=>ce(H.target.value),placeholder:"Search by name, email, department...",className:"w-full pl-9 pr-3 py-2 text-sm border border-amber-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-amber-500",autoFocus:!0})]}),i.jsx("div",{className:"max-h-64 overflow-y-auto space-y-1 rounded-lg border border-amber-200 bg-white",children:Q.length===0?i.jsx("p",{className:"p-3 text-xs text-slate-500 text-center",children:"No employees found"}):Q.map(H=>i.jsxs("button",{onClick:()=>P(H),className:"w-full flex items-center gap-3 p-2 text-left hover:bg-amber-100 transition-colors border-b border-amber-100 last:border-b-0",children:[i.jsx("img",{src:H.avatarUrl||`https://ui-avatars.com/api/?name=${encodeURIComponent(H.name)}&background=random&color=fff`,alt:H.name,className:"w-8 h-8 rounded-full object-cover"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-sm font-medium text-slate-900 truncate",children:H.name}),i.jsxs("p",{className:"text-xs text-slate-500 truncate",children:[H.department," ",H.role?` ${H.role}`:""]})]}),i.jsx("span",{className:`
                                text-[10px] font-medium px-2 py-0.5 rounded-full
                                ${H.accessLevel==="Admin"?"bg-teal-100 text-teal-700":H.accessLevel==="Manager"?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-600"}
                              `,children:H.accessLevel})]},H.id))}),i.jsxs("p",{className:"text-xs text-amber-700 mt-3",children:[Q.length," of ",s.length," employees"]})]})]})]})]}),i.jsxs("div",{className:"px-6 py-4 bg-slate-100 border-t border-slate-100 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2 text-slate-500",children:[i.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500"}),i.jsx("span",{className:"text-xs",children:"Connected to Google Sheets"})]}),i.jsx("span",{className:"text-xs text-slate-500",children:"v3.0"})]})]})})},Dm=["Revenue","Calls","Listings","Sales Rate","Conversion"],Xs=(s,t,a=!1)=>t.includes("Rate")||t==="Conversion"?`${(s*100).toFixed(1)}%`:t==="Revenue"?a?`${(s/1e3).toFixed(0)}k`:`${s.toLocaleString("en-US",{maximumFractionDigits:0})}`:s.toLocaleString("en-US",{maximumFractionDigits:0}),Fv=({data:s,metricType:t,employeeName:a})=>{const o=I.useMemo(()=>{if(!s||s.length===0)return[];const P=new Map;s.forEach(H=>{const V=`${H.year}-${H.month}`;P.set(V,H)});const Q=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return Array.from(P.values()).sort((H,V)=>H.year!==V.year?H.year-V.year:Q.indexOf(H.month)-Q.indexOf(V.month))},[s]);if(o.length===0)return i.jsx("div",{className:"p-10 text-center text-slate-500",children:"No historical data available."});const c=300,d=650,p={top:40,right:30,bottom:40,left:60},g=d-p.left-p.right,v=c-p.top-p.bottom,h=o.flatMap(P=>[P.actual,P.target]),y=Math.max(...h),b=Math.min(...h),S=y*1.1,N=b>0?b*.9:0,k=S-N||1,w=P=>o.length<=1?p.left+g/2:p.left+P/(o.length-1)*g,M=P=>p.top+v-(P-N)/k*v,J=[0,.25,.5,.75,1].map(P=>{const Q=N+k*P;return{val:Q,y:M(Q)}}),ce=o.length>1?"M"+o.map((P,Q)=>`${w(Q)},${M(P.actual)}`).join(" L"):"",ee=o.length>1?"M"+o.map((P,Q)=>`${w(Q)},${M(P.target)}`).join(" L"):"";return i.jsxs("div",{className:"w-full",children:[i.jsxs("div",{className:"bg-slate-100 rounded-xl p-4 border border-slate-100 mb-6 flex justify-between items-end",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:a}),i.jsxs("div",{className:"text-xl font-black text-slate-900",children:[t," History"]})]}),i.jsxs("div",{className:"flex gap-4 text-[10px] font-bold uppercase tracking-widest bg-white px-3 py-2 rounded-lg border border-slate-300 shadow-sm",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-3 h-3 rounded-full border-2 border-indigo-500 bg-white"}),"Actual"]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-3 h-3 rounded-full border-2 border-slate-300 bg-slate-100"}),"Target"]})]})]}),i.jsx("div",{className:"relative w-full aspect-[2/1] bg-white border border-slate-100 rounded-xl shadow-sm overflow-hidden",children:i.jsxs("svg",{viewBox:`0 0 ${d} ${c}`,className:"w-full h-full overflow-visible",children:[J.map((P,Q)=>i.jsxs("g",{children:[i.jsx("line",{x1:p.left,y1:P.y,x2:d-p.right,y2:P.y,stroke:"#f1f5f9",strokeWidth:"1"}),i.jsx("text",{x:p.left-10,y:P.y+4,textAnchor:"end",className:"text-[10px] font-bold fill-slate-400",style:{fontSize:"10px"},children:Xs(P.val,t,!0)})]},Q)),o.map((P,Q)=>i.jsx("text",{x:w(Q),y:c-p.bottom+15,textAnchor:"middle",className:"text-[10px] font-bold fill-slate-400 uppercase",style:{fontSize:"10px"},children:P.month},Q)),o.length>1&&i.jsx("path",{d:ee,fill:"none",stroke:"#cbd5e1",strokeWidth:"2",strokeDasharray:"5 5",strokeLinecap:"round"}),o.length>1&&i.jsx("path",{d:ce,fill:"none",stroke:"#6366f1",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),o.length>1&&i.jsx("path",{d:`${ce} L ${w(o.length-1)},${c-p.bottom} L ${w(0)},${c-p.bottom} Z`,fill:"url(#grad)",opacity:"0.1"}),i.jsx("defs",{children:i.jsxs("linearGradient",{id:"grad",x1:"0",y1:"0",x2:"0",y2:"1",children:[i.jsx("stop",{offset:"0%",stopColor:"#6366f1"}),i.jsx("stop",{offset:"100%",stopColor:"#ffffff",stopOpacity:"0"})]})}),o.map((P,Q)=>i.jsxs("g",{className:"group/point cursor-crosshair",children:[i.jsx("line",{x1:w(Q),y1:p.top,x2:w(Q),y2:c-p.bottom,stroke:"#e2e8f0",strokeWidth:"1",strokeDasharray:"2 2",className:"opacity-0 group-hover/point:opacity-100 transition-opacity"}),i.jsx("circle",{cx:w(Q),cy:M(P.target),r:"4",fill:"#f1f5f9",stroke:"#94a3b8",strokeWidth:"2"}),i.jsx("circle",{cx:w(Q),cy:M(P.actual),r:"5",className:"fill-white stroke-indigo-600 stroke-[3px] transition-all group-hover/point:r-7 group-hover/point:fill-indigo-50 z-10 relative"}),i.jsx("text",{x:w(Q),y:M(P.actual)-12,textAnchor:"middle",className:"text-[9px] font-bold fill-indigo-600 opacity-0 md:opacity-100",style:{fontSize:"9px"},children:Xs(P.actual,t)}),i.jsxs("g",{className:"opacity-0 group-hover/point:opacity-100 transition-opacity pointer-events-none z-50",children:[i.jsx("rect",{x:w(Q)-45,y:p.top,width:"90",height:"45",rx:"6",fill:"#1e293b",stroke:"#ffffff",strokeWidth:"2",className:"shadow-xl"}),i.jsxs("text",{x:w(Q),y:p.top+18,textAnchor:"middle",fill:"#94a3b8",fontSize:"9",fontWeight:"bold",children:[P.month," ",P.year]}),i.jsx("text",{x:w(Q),y:p.top+32,textAnchor:"middle",fill:"white",fontSize:"12",fontWeight:"black",children:Xs(P.actual,t)})]})]},Q))]})}),i.jsxs("div",{className:"mt-6 border-t border-slate-100 pt-6",children:[i.jsx("h4",{className:"text-xs font-black text-slate-900 uppercase tracking-widest mb-4",children:"Detailed Breakdown"}),i.jsx("div",{className:"grid grid-cols-3 md:grid-cols-6 lg:grid-cols-8 gap-3",children:o.map((P,Q)=>i.jsxs("div",{className:`text-center p-2 rounded-lg border ${P.actual>=P.target?"bg-emerald-50 border-emerald-100":"bg-rose-50 border-rose-100"}`,children:[i.jsx("div",{className:"text-[9px] font-black text-slate-500 uppercase",children:P.month}),i.jsx("div",{className:`text-xs font-bold my-0.5 ${P.actual>=P.target?"text-emerald-700":"text-rose-700"}`,children:Xs(P.actual,t)}),i.jsxs("div",{className:"text-[8px] text-slate-500",children:["Target: ",Xs(P.target,t)]})]},Q))})]})]})},Yv=({employees:s,salesData:t,salesActions:a,currentUser:o,onAddAction:c,onToggleAction:d})=>{const[p,g]=I.useState(null),[v,h]=I.useState("All"),[y,b]=I.useState(null),S=I.useMemo(()=>{if(o.accessLevel==="Admin")return!0;const q=o.department.toLowerCase(),X=(o.team||"").toLowerCase();return!!(o.accessLevel==="Manager"&&q.includes("sales")||q.includes("sales ops")||q.includes("sales operations")||X.includes("sales ops")||X.includes("sales operations"))},[o]),N=I.useMemo(()=>{const q=new Set(t.map(X=>X.employeeId));return s.filter(X=>q.has(X.id)||X.department.toLowerCase().includes("sales"))},[s,t]),k=I.useMemo(()=>{const q=new Set;return N.forEach(X=>{X.team&&q.add(X.team)}),Array.from(q).sort()},[N]),w=I.useMemo(()=>v==="All"?N:N.filter(q=>q.team===v),[N,v]),M=I.useMemo(()=>{if(t.length===0)return new Date;const q=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],fe=[...t].sort((re,oe)=>re.year!==oe.year?oe.year-re.year:q.indexOf(oe.month)-q.indexOf(re.month))[0],F=q.indexOf(fe.month);return new Date(fe.year,F,1)},[t]),J=(q,X)=>{const fe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],F=M.getMonth(),re=M.getFullYear();let oe=0;for(let se=0;se<3;se++){let ae=F-se,A=0;ae<0&&(ae+=12,A=1);const U=fe[ae],ue=re-A,L=t.find(W=>W.employeeId===q&&W.metricType===X&&W.month===U&&W.year===ue);if(L)if(L.actual<L.target)oe++;else break}return oe>=3?De.RED:oe===2?De.AMBER:De.GREEN},ce=(q,X)=>t.filter(F=>F.employeeId===q&&F.metricType===X).sort((F,re)=>re.year-F.year||["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(re.month)-["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(F.month))[0],ee=(q,X)=>t.filter(fe=>fe.employeeId===q&&fe.metricType===X),[P,Q]=I.useState({description:"",dueDate:"",metricType:"General"}),[H,V]=I.useState(null);return i.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-black text-slate-900 uppercase tracking-tighter",children:"Sales Performance Monitor"}),i.jsxs("p",{className:"text-sm text-slate-500 font-medium",children:["Tracking compliance against core KPIs.",i.jsxs("span",{className:"ml-2 text-indigo-500 bg-indigo-50 px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-widest",children:["Latest Data: ",M.toLocaleString("default",{month:"short",year:"numeric"})]})]})]}),i.jsxs("div",{className:"flex gap-4",children:[i.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold uppercase tracking-widest text-slate-500",children:[i.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-500"})," On Track"]}),i.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold uppercase tracking-widest text-slate-500",children:[i.jsx("span",{className:"w-2 h-2 rounded-full bg-amber-500"})," 2 Mo. Miss"]}),i.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold uppercase tracking-widest text-slate-500",children:[i.jsx("span",{className:"w-2 h-2 rounded-full bg-rose-500"})," 3+ Mo. Miss"]})]})]}),k.length>0&&i.jsxs("div",{className:"flex items-center gap-3 bg-white p-2 rounded-xl border border-slate-300 shadow-sm w-fit animate-in slide-in-from-left-2",children:[i.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest pl-2",children:"Filter View:"}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:()=>h("All"),className:`px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider transition-all ${v==="All"?"bg-slate-800 text-white shadow-sm":"hover:bg-slate-100 text-slate-500"}`,children:"All"}),k.map(q=>i.jsx("button",{onClick:()=>h(q),className:`px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider transition-all ${v===q?"bg-indigo-600 text-white shadow-sm":"hover:bg-indigo-50 text-slate-500 hover:text-indigo-600"}`,children:q},q))]})]}),i.jsx("div",{className:"grid gap-6",children:w.length>0?w.map(q=>{const X=Dm.map(oe=>({name:oe,health:J(q.id,oe),data:ce(q.id,oe)}));if(!X.some(oe=>oe.data!==void 0)&&!q.department.toLowerCase().includes("sales"))return null;const F=X.some(oe=>oe.health===De.RED||oe.health===De.AMBER),re=a.filter(oe=>oe.employeeId===q.id&&!oe.isCompleted);return i.jsxs("div",{className:`bg-white rounded-2xl border transition-all overflow-hidden ${F?"border-amber-200 shadow-amber-100":"border-slate-300 shadow-sm"}`,children:[i.jsx("div",{className:"p-6 cursor-pointer hover:bg-slate-100 transition-colors",onClick:()=>g(p===q.id?null:q.id),children:i.jsxs("div",{className:"flex flex-col lg:flex-row items-start lg:items-center gap-6",children:[i.jsxs("div",{className:"flex items-center gap-4 w-72 shrink-0",children:[i.jsx("img",{src:q.avatarUrl,className:"w-12 h-12 rounded-full border-2 border-white shadow-sm",alt:q.name}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"font-black text-slate-800 text-sm md:text-base leading-tight",children:q.name}),S&&i.jsx("button",{onClick:oe=>{oe.stopPropagation(),Q({description:"",dueDate:"",metricType:"General"}),V({empId:q.id})},className:"ml-2 text-[10px] font-bold bg-indigo-50 text-indigo-600 px-2 py-1 rounded hover:bg-indigo-100 transition-colors shrink-0",title:"Add Action Plan",children:"+ Action"})]}),i.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:q.role}),q.team&&i.jsx("p",{className:"text-[9px] font-black text-indigo-400 uppercase tracking-wider mt-0.5",children:q.team})]})]}),i.jsx("div",{className:"flex-1 grid grid-cols-2 md:grid-cols-5 gap-4 w-full",children:X.map(oe=>i.jsxs("div",{className:"relative group/metric",children:[i.jsx("div",{className:"text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-1",children:oe.name}),i.jsxs("div",{className:"flex items-end gap-2 p-1 -ml-1 rounded hover:bg-slate-100 transition-colors cursor-pointer",onClick:se=>{se.stopPropagation(),b({isOpen:!0,employeeId:q.id,employeeName:q.name,metricType:oe.name})},title:"Click to view trends",children:[i.jsx("span",{className:"text-lg font-black text-slate-700 underline decoration-dotted decoration-slate-300 underline-offset-4 group-hover/metric:decoration-indigo-400 group-hover/metric:text-indigo-600",children:oe.data?Xs(oe.data.actual,oe.name):"-"}),oe.data&&i.jsxs("span",{className:`text-[9px] font-bold mb-1 ${oe.data.actual>=oe.data.target?"text-emerald-500":"text-rose-500"}`,children:["/ ",Xs(oe.data.target,oe.name)]}),i.jsx("svg",{className:"w-3 h-3 text-slate-300 opacity-0 group-hover/metric:opacity-100 transition-opacity ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"})})]}),i.jsx("div",{className:`h-1 w-full rounded-full mt-2 ${oe.health===De.RED?"bg-rose-500":oe.health===De.AMBER?"bg-amber-500":"bg-emerald-500"}`})]},oe.name))}),i.jsxs("div",{className:"w-32 shrink-0 text-right",children:[re.length>0?i.jsxs("span",{className:"inline-block px-3 py-1 rounded-full bg-rose-50 text-rose-600 text-[10px] font-black uppercase tracking-widest",children:[re.length," Actions Req."]}):i.jsx("span",{className:"inline-block px-3 py-1 rounded-full bg-emerald-50 text-emerald-600 text-[10px] font-black uppercase tracking-widest",children:"All Clear"}),i.jsxs("div",{className:"mt-2 text-indigo-500 text-[10px] font-bold uppercase tracking-widest flex items-center justify-end gap-1",children:[p===q.id?"Collapse":"Manage",i.jsx("svg",{className:`w-3 h-3 transform transition-transform ${p===q.id?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]})]})]})}),p===q.id&&i.jsxs("div",{className:"bg-slate-100 border-t border-slate-300 p-6 animate-in slide-in-from-top-2",children:[i.jsx("h4",{className:"text-xs font-black text-slate-900 uppercase tracking-widest mb-4",children:"Performance Action Plan"}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[i.jsx("div",{className:"space-y-4",children:X.filter(oe=>oe.health!==De.GREEN).length>0?X.filter(oe=>oe.health!==De.GREEN).map(oe=>i.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-300 shadow-sm flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("div",{className:`w-2 h-2 rounded-full ${oe.health===De.RED?"bg-rose-500":"bg-amber-500"}`}),i.jsxs("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:[oe.name," Alert"]})]}),i.jsxs("p",{className:"text-xs text-slate-700 font-medium",children:["Below target for ",oe.health===De.RED?"3+":"2"," consecutive months."]})]}),S&&i.jsx("button",{onClick:()=>{Q({description:"",dueDate:"",metricType:oe.name}),V({empId:q.id,prefillMetric:oe.name})},className:"bg-teal-600 text-white px-3 py-1.5 rounded-lg text-[10px] font-bold uppercase tracking-widest hover:bg-teal-700 transition-colors",children:"Add Action"})]},oe.name)):i.jsx("div",{className:"text-center p-8 border-2 border-dashed border-slate-300 rounded-xl",children:i.jsx("p",{className:"text-slate-500 text-xs font-bold uppercase tracking-widest",children:"No critical performance alerts."})})}),i.jsxs("div",{className:"bg-white rounded-xl border border-slate-300 overflow-hidden",children:[i.jsx("div",{className:"bg-slate-100 px-4 py-2 border-b border-slate-300 text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Assigned Actions"}),i.jsx("div",{className:"divide-y divide-slate-100 max-h-[250px] overflow-y-auto",children:a.filter(oe=>oe.employeeId===q.id).length>0?a.filter(oe=>oe.employeeId===q.id).map(oe=>i.jsxs("div",{className:"p-4 flex gap-3 hover:bg-slate-100 transition-colors",children:[i.jsx("button",{onClick:()=>d(oe.id,!oe.isCompleted),className:`mt-0.5 w-4 h-4 rounded border flex items-center justify-center transition-all ${oe.isCompleted?"bg-emerald-500 border-emerald-500 text-white":"border-slate-300 hover:border-indigo-400"}`,children:oe.isCompleted&&i.jsx("svg",{className:"w-2.5 h-2.5",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"})})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:`text-xs font-medium ${oe.isCompleted?"text-slate-500 line-through":"text-slate-700"}`,children:oe.description}),i.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[i.jsx("span",{className:"text-[9px] bg-slate-100 text-slate-500 px-1.5 py-0.5 rounded font-bold uppercase",children:oe.metricType}),i.jsxs("span",{className:"text-[9px] text-slate-500",children:["Due: ",oe.dueDate]}),i.jsxs("span",{className:"text-[9px] text-slate-300 ml-auto",children:["By ",oe.assignedBy]})]})]})]},oe.id)):i.jsx("div",{className:"p-8 text-center text-slate-500 text-[10px] italic",children:"No actions logged."})})]})]})]})]},q.id)}):i.jsx("div",{className:"py-20 text-center bg-white border border-dashed border-slate-300 rounded-3xl",children:i.jsx("p",{className:"text-slate-500 text-sm font-bold uppercase tracking-widest",children:"No sales members found in this view."})})}),H&&i.jsxs("div",{className:"fixed inset-0 z-[150] flex items-center justify-center p-4",children:[i.jsx("div",{className:"absolute inset-0 bg-slate-900/40 backdrop-blur-sm",onClick:()=>V(null)}),i.jsxs("div",{className:"relative bg-white w-full max-w-md rounded-2xl shadow-2xl p-6 animate-in zoom-in-95",children:[i.jsx("h3",{className:"text-lg font-black text-slate-900 uppercase tracking-tight mb-4",children:"Remedial Action Plan"}),i.jsxs("div",{className:"space-y-4",children:[H.prefillMetric?i.jsx("div",{className:"bg-rose-50 p-3 rounded-lg border border-rose-100",children:i.jsxs("p",{className:"text-xs text-rose-700 font-bold",children:["Targeting Alert: ",H.prefillMetric]})}):i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest block mb-2",children:"Category"}),i.jsxs("select",{className:"w-full bg-slate-100 border border-slate-300 rounded-xl px-4 py-3 outline-none focus:ring-2 focus:ring-indigo-500/20 text-slate-700 text-sm font-medium",value:P.metricType,onChange:q=>Q({...P,metricType:q.target.value}),children:[i.jsx("option",{value:"General",children:"General Performance"}),Dm.map(q=>i.jsx("option",{value:q,children:q},q))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest block mb-2",children:"Required Action"}),i.jsx("textarea",{className:"w-full bg-slate-100 border border-slate-300 rounded-xl px-4 py-3 outline-none focus:ring-2 focus:ring-indigo-500/20 text-slate-700 text-sm font-medium h-24",placeholder:"e.g., Make 50 outbound calls per day until...",value:P.description,onChange:q=>Q({...P,description:q.target.value})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest block mb-2",children:"Target Date"}),i.jsx("input",{type:"date",className:"w-full bg-slate-100 border border-slate-300 rounded-xl px-4 py-3 outline-none focus:ring-2 focus:ring-indigo-500/20 text-slate-700 text-sm font-medium",value:P.dueDate,onChange:q=>Q({...P,dueDate:q.target.value})})]}),i.jsxs("div",{className:"flex gap-3 pt-2",children:[i.jsx("button",{onClick:()=>{c({employeeId:H.empId,metricType:H.prefillMetric||P.metricType,description:P.description,dueDate:P.dueDate,assignedBy:o.name,isCompleted:!1,createdAt:new Date().toISOString()}),V(null),Q({description:"",dueDate:"",metricType:"General"})},className:"flex-1 bg-teal-600 text-white py-3 rounded-xl font-bold uppercase tracking-widest hover:bg-teal-700 transition-colors",children:"Assign Action"}),i.jsx("button",{onClick:()=>V(null),className:"px-6 py-3 bg-slate-100 text-slate-500 rounded-xl font-black uppercase tracking-widest hover:bg-slate-200 transition-colors",children:"Cancel"})]})]})]})]}),y&&i.jsx(gt,{isOpen:y.isOpen,onClose:()=>b(null),title:"",maxWidth:"max-w-3xl",children:i.jsx(Fv,{data:ee(y.employeeId,y.metricType),metricType:y.metricType,employeeName:y.employeeName})})]})},$v=({isOpen:s,onClose:t,currentUser:a,items:o,goals:c,onSaveItem:d,onEditItem:p,onSignOut:g})=>{var k;const v=o.filter(w=>w.owner===a.id||w.owner===a.name),[h,y]=I.useState(!1),[b,S]=I.useState({title:"",status:we.NOT_STARTED,priority:Ee.MEDIUM,goalId:((k=c[0])==null?void 0:k.id)||""}),N=()=>{var w;b.title&&(d({...b,owner:a.name,department:a.department,team:a.team,startDate:new Date().toISOString().split("T")[0],endDate:"2026-12-31",description:"Quickly added via profile."}),S({title:"",status:we.NOT_STARTED,priority:Ee.MEDIUM,goalId:((w=c[0])==null?void 0:w.id)||""}),y(!1))};return i.jsx(gt,{isOpen:s,onClose:t,title:"My Workspace",children:i.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[i.jsxs("div",{className:"md:w-1/3 flex flex-col items-center text-center border-b md:border-b-0 md:border-r border-slate-100 pb-6 md:pb-0 md:pr-6",children:[i.jsxs("div",{className:"relative mb-4",children:[i.jsx("img",{src:a.avatarUrl,alt:a.name,className:"w-24 h-24 rounded-full border-4 border-slate-50 shadow-sm"}),i.jsx("div",{className:"absolute bottom-0 right-0 bg-white p-1 rounded-full shadow-sm border border-slate-100",children:i.jsx("span",{className:"text-xl",children:""})})]}),i.jsx("h3",{className:"text-xl font-black text-slate-900",children:a.name}),i.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-1",children:a.role}),i.jsxs("span",{className:"bg-indigo-50 text-indigo-600 px-2 py-0.5 rounded text-[10px] font-black uppercase tracking-wider mb-6",children:[a.department," ",a.team?` ${a.team}`:""]}),i.jsxs("div",{className:"w-full bg-slate-100 rounded-xl p-4 mb-auto",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase",children:"My Load"}),i.jsxs("span",{className:"text-[10px] font-bold text-slate-800",children:[v.length," Active Items"]})]}),i.jsx("div",{className:"w-full bg-slate-200 h-1.5 rounded-full overflow-hidden",children:i.jsx("div",{className:"bg-indigo-500 h-full rounded-full",style:{width:`${Math.min(100,v.length/10*100)}%`}})})]}),i.jsx("button",{onClick:g,className:"w-full mt-6 border border-rose-100 text-rose-500 hover:bg-rose-50 px-4 py-2 rounded-xl text-xs font-black uppercase tracking-widest transition-colors",children:"Sign Out"})]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h4",{className:"text-sm font-black text-slate-900 uppercase tracking-tight",children:"My Active Goals"}),i.jsx("button",{onClick:()=>y(!h),className:"bg-teal-600 text-white px-3 py-1.5 rounded-lg text-[10px] font-bold uppercase tracking-widest hover:bg-teal-700 transition-colors",children:h?"Cancel":"+ Quick Add"})]}),h&&i.jsx("div",{className:"bg-indigo-50/50 border border-indigo-100 p-4 rounded-xl mb-4 animate-in slide-in-from-top-2",children:i.jsxs("div",{className:"flex flex-col gap-3",children:[i.jsx("input",{type:"text",placeholder:"Goal Title...",autoFocus:!0,className:"w-full bg-white border border-slate-300 rounded-lg px-3 py-2 text-sm font-bold outline-none focus:ring-2 focus:ring-indigo-500/20",value:b.title,onChange:w=>S({...b,title:w.target.value})}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("select",{className:"bg-white border border-slate-300 rounded-lg px-2 py-2 text-xs font-medium outline-none",value:b.goalId,onChange:w=>S({...b,goalId:w.target.value}),children:c.map(w=>i.jsx("option",{value:w.id,children:w.title},w.id))}),i.jsx("select",{className:"bg-white border border-slate-300 rounded-lg px-2 py-2 text-xs font-medium outline-none",value:b.priority,onChange:w=>S({...b,priority:w.target.value}),children:Object.values(Ee).map(w=>i.jsx("option",{value:w,children:w},w))}),i.jsx("button",{onClick:N,className:"bg-indigo-600 text-white px-4 rounded-lg text-xs font-black uppercase tracking-widest ml-auto shadow-sm",children:"Add"})]})]})}),i.jsx("div",{className:"space-y-3 max-h-[50vh] overflow-y-auto pr-2 custom-scrollbar",children:v.length>0?v.map(w=>{var M;return i.jsxs("div",{className:"group bg-white border border-slate-100 rounded-xl p-3 shadow-sm hover:border-indigo-200 transition-all flex items-center justify-between gap-3",children:[i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${w.priority===Ee.CRITICAL?"bg-rose-500":w.priority===Ee.HIGH?"bg-orange-500":"bg-blue-400"}`}),i.jsx("span",{className:"text-[9px] text-slate-500 font-bold uppercase tracking-wider truncate",children:((M=c.find(J=>J.id===w.goalId))==null?void 0:M.title)||"General"})]}),i.jsx("h5",{className:"text-sm font-bold text-slate-800 truncate",children:w.title})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:`px-2 py-1 rounded text-[9px] font-black uppercase tracking-widest ${Av[w.status]}`,children:w.status}),i.jsx("button",{onClick:()=>{t(),p(w)},className:"p-1.5 text-slate-300 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})})]})]},w.id)}):i.jsx("div",{className:"text-center py-10 text-slate-500 text-xs font-medium italic bg-slate-100 rounded-xl border border-dashed border-slate-300",children:"No goals assigned yet. Use Quick Add above!"})})]})]})})},Kv=({isOpen:s,onClose:t,employees:a,goals:o,items:c,onSave:d,onBulkPush:p})=>{var _e,nt;const[g,v]=I.useState("distribute"),[h,y]=I.useState(null),[b,S]=I.useState(!1),[N,k]=I.useState(()=>{try{const G=localStorage.getItem("omnimap_hibob_config");if(G)return JSON.parse(G)}catch{}return{serviceId:"",token:""}}),[w,M]=I.useState(()=>{try{return!localStorage.getItem("omnimap_hibob_config")}catch{return!0}}),J=(G,he)=>{const be={...N,[G]:he};k(be),localStorage.setItem("omnimap_hibob_config",JSON.stringify(be))},ce=b&&g!=="sync_existing"||g==="sync_existing",ee=!!(N.serviceId&&N.token),[P,Q]=I.useState({title:"",description:"",goalId:((_e=o[0])==null?void 0:_e.id)||"",priority:Ee.MEDIUM,endDate:"2026-12-31",goalType:"PERSONAL",goalCategory:"PERFORMANCE"}),[H,V]=I.useState(new Set),[q,X]=I.useState([{title:"",description:"",owner:"",goalId:((nt=o[0])==null?void 0:nt.id)||"",priority:Ee.MEDIUM,endDate:"",goalType:"PERSONAL",goalCategory:"PERFORMANCE"}]),[fe,F]=I.useState(new Set),[re,oe]=I.useState(""),se=G=>{const he=new Set(H);he.has(G)?he.delete(G):he.add(G),V(he)},ae=G=>{const he=a.filter(ke=>ke.team===G).map(ke=>ke.id),be=new Set(H);he.length>0&&he.every(ke=>be.has(ke))?he.forEach(ke=>be.delete(ke)):he.forEach(ke=>be.add(ke)),V(be)},A=G=>{const he=a.filter(be=>be.team===G);return he.length===0?!1:he.every(be=>H.has(be.id))},U=()=>ce&&(!N.serviceId||!N.token)?(y("Please enter your HiBob Service ID and Token below to proceed with Sync."),M(!0),!1):!0,ue=()=>{if(y(null),!U())return;if(!P.title||H.size===0){y("Please provide a title and select at least one employee.");return}const G=[];H.forEach(he=>{const be=a.find(Pe=>Pe.id===he);be&&G.push({id:`bulk-${Math.random().toString(36).substr(2,6)}`,...P,owner:be.name,department:be.department,team:be.team,status:we.NOT_STARTED,startDate:new Date().toISOString().split("T")[0],tags:["bulk-distribute"],progress:0,goalType:P.goalType||"PERSONAL",goalCategory:P.goalCategory||"PERFORMANCE"})}),Q({...P,title:"",description:""}),V(new Set),d(G,b)},L=()=>{var Pe;if(y(null),!U())return;const G=q.filter(ke=>(ke.title||ke.owner)&&(!ke.title||!ke.owner));if(G.length>0){y(`Cannot save: ${G.length} row(s) are missing either a Title or an Owner.`);return}const he=q.filter(ke=>ke.title&&ke.owner);if(he.length===0){y("Please enter at least one valid item with both Title and Owner.");return}const be=he.map(ke=>{const me=a.find(Ze=>Ze.name===ke.owner||Ze.id===ke.owner);return{id:`rapid-${Math.random().toString(36).substr(2,6)}`,title:ke.title,description:ke.description||"Rapid entry",goalId:ke.goalId||o[0].id,owner:ke.owner,priority:ke.priority||Ee.MEDIUM,endDate:ke.endDate||"2026-12-31",department:(me==null?void 0:me.department)||"Unassigned",team:me==null?void 0:me.team,status:we.NOT_STARTED,startDate:new Date().toISOString().split("T")[0],tags:["rapid-entry"],progress:0,goalType:ke.goalType||"PERSONAL",goalCategory:ke.goalCategory||"PERFORMANCE"}});X([{title:"",owner:"",goalId:((Pe=o[0])==null?void 0:Pe.id)||"",priority:Ee.MEDIUM,endDate:"",goalType:"PERSONAL",goalCategory:"PERFORMANCE"}]),d(be,b)},W=()=>{if(y(null),!U())return;if(fe.size===0){y("Select at least one item to push.");return}const G=c.filter(he=>fe.has(he.id));p(G)},C=(G,he,be)=>{const Pe=[...q];Pe[G]={...Pe[G],[he]:be},X(Pe),h&&y(null)},_=()=>{var G;return X([...q,{title:"",description:"",owner:"",goalId:((G=o[0])==null?void 0:G.id)||"",priority:Ee.MEDIUM,endDate:"",goalType:"PERSONAL",goalCategory:"PERFORMANCE"}])},O=G=>{var he;q.length===1?X([{title:"",description:"",owner:"",goalId:((he=o[0])==null?void 0:he.id)||"",priority:Ee.MEDIUM,endDate:"",goalType:"PERSONAL",goalCategory:"PERFORMANCE"}]):X(q.filter((be,Pe)=>Pe!==G))},z=()=>{var G;window.confirm("Clear list?")&&X([{title:"",description:"",owner:"",goalId:((G=o[0])==null?void 0:G.id)||"",priority:Ee.MEDIUM,endDate:"",goalType:"PERSONAL",goalCategory:"PERFORMANCE"}])},ne=I.useMemo(()=>{if(!re)return c;const G=re.toLowerCase();return c.filter(he=>he.title.toLowerCase().includes(G)||he.owner.toLowerCase().includes(G))},[c,re]),xe=G=>{const he=new Set(fe);he.has(G)?he.delete(G):he.add(G),F(he)},ge=()=>{fe.size===ne.length?F(new Set):F(new Set(ne.map(G=>G.id)))},Se=Array.from(new Set(a.map(G=>G.team).filter(Boolean))).sort();return i.jsx(gt,{isOpen:s,onClose:t,title:"Admin Bulk Creator",maxWidth:"max-w-6xl",children:i.jsxs("div",{className:"flex flex-col h-[75vh]",children:[i.jsxs("div",{className:"flex gap-1 mb-6 bg-slate-100 p-1 rounded-xl border border-slate-300 w-fit",children:[i.jsx("button",{onClick:()=>{v("distribute"),y(null)},className:`px-4 py-2 text-[10px] font-black uppercase tracking-widest rounded-lg transition-all ${g==="distribute"?"bg-teal-600 text-white shadow-lg shadow-teal-200":"text-slate-500 hover:text-slate-700 hover:bg-slate-100"}`,children:"Distribute Goal"}),i.jsx("button",{onClick:()=>{v("rapid"),y(null)},className:`px-4 py-2 text-[10px] font-black uppercase tracking-widest rounded-lg transition-all ${g==="rapid"?"bg-teal-600 text-white shadow-lg shadow-teal-200":"text-slate-500 hover:text-slate-700 hover:bg-slate-100"}`,children:"Rapid List Entry"}),i.jsx("button",{onClick:()=>{v("sync_existing"),y(null)},className:`px-4 py-2 text-[10px] font-black uppercase tracking-widest rounded-lg transition-all ${g==="sync_existing"?"bg-teal-600 text-white shadow-lg shadow-teal-200":"text-slate-500 hover:text-slate-700 hover:bg-slate-100"}`,children:"Sync Existing"})]}),h&&i.jsxs("div",{className:"mb-4 bg-rose-50 border border-rose-200 text-rose-700 px-4 py-3 rounded-xl text-xs font-bold flex items-center gap-2 animate-pulse",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),h]}),g!=="sync_existing"&&i.jsx("div",{className:"absolute top-6 right-16",children:i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer bg-slate-100 hover:bg-slate-100 px-3 py-1.5 rounded-lg transition-colors border border-slate-300",children:[i.jsxs("div",{className:"relative inline-flex items-center",children:[i.jsx("input",{type:"checkbox",className:"sr-only peer",checked:b,onChange:()=>S(!b)}),i.jsx("div",{className:"w-9 h-5 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-rose-500"})]}),i.jsx("span",{className:`text-[10px] font-bold uppercase tracking-widest ${b?"text-rose-600":"text-slate-500"}`,children:b?"Sync to HiBob":"Local Only"})]})}),ce&&i.jsxs("div",{className:"bg-slate-100 border border-slate-300 p-4 rounded-xl mb-4 transition-all animate-in slide-in-from-top-1",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("h4",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest flex items-center gap-2",children:[i.jsx("span",{className:`w-2 h-2 rounded-full ${ee?"bg-emerald-500":"bg-rose-500"}`}),"HiBob Credentials"]}),ee&&!w&&i.jsx("button",{onClick:()=>M(!0),className:"text-[9px] font-bold text-teal-600 hover:text-teal-700 underline",children:"Edit Credentials"})]}),!ee||w?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[9px] font-bold text-slate-500 uppercase block mb-1",children:"Service ID"}),i.jsx("input",{type:"text",className:"w-full bg-white border border-slate-300 rounded-lg px-2 py-1.5 text-xs focus:ring-2 focus:ring-teal-100 focus:border-teal-400 outline-none font-medium text-slate-800 placeholder:text-slate-500",value:N.serviceId,onChange:G=>J("serviceId",G.target.value),placeholder:"Enter Service ID"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[9px] font-bold text-slate-500 uppercase block mb-1",children:"Service Token"}),i.jsx("input",{type:"password",className:"w-full bg-white border border-slate-300 rounded-lg px-2 py-1.5 text-xs focus:ring-2 focus:ring-teal-100 focus:border-teal-400 outline-none font-medium text-slate-800 placeholder:text-slate-500",value:N.token,onChange:G=>J("token",G.target.value),placeholder:"Enter Token"})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"text-[9px] font-bold text-slate-500 uppercase block mb-1",children:["Goal Type ID",i.jsx("span",{className:"text-rose-500 ml-1",children:"*"}),i.jsx("span",{className:"text-[8px] text-slate-500 font-normal normal-case ml-1",children:'(Use HiBob Test  "Read Goals API" to find)'})]}),i.jsx("input",{type:"text",className:"w-full bg-white border border-slate-300 rounded-lg px-2 py-1.5 text-xs focus:ring-2 focus:ring-teal-100 focus:border-teal-400 outline-none font-medium text-slate-800 placeholder:text-slate-500",value:N.manualGoalType||"",onChange:G=>J("manualGoalType",G.target.value),placeholder:"Enter Goal Type ID (optional - auto-mapped from Type selection)"})]})]}):i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between bg-white p-2 rounded-lg border border-slate-300",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("span",{className:"text-xs text-slate-700 font-mono",children:["ID: ",N.serviceId.slice(-4)]}),i.jsx("span",{className:"text-[9px] font-bold text-slate-500 uppercase",children:"|"}),i.jsx("span",{className:"text-xs text-slate-700 font-mono",children:"Token: "})]}),i.jsx("span",{className:"text-[10px] text-emerald-600 font-black uppercase tracking-wider bg-emerald-50 border border-emerald-200 px-2 py-0.5 rounded",children:"Ready to Push"})]}),N.manualGoalType?i.jsxs("div",{className:"bg-emerald-50 border border-emerald-200 p-2 rounded-lg",children:[i.jsx("span",{className:"text-[9px] font-bold text-emerald-600 uppercase",children:"Goal Type ID: "}),i.jsx("span",{className:"text-xs font-mono text-emerald-700",children:N.manualGoalType})]}):i.jsxs("div",{className:"bg-white border border-slate-300 p-2 rounded-lg",children:[i.jsx("span",{className:"text-[9px] font-bold text-slate-500 uppercase",children:" Auto-Mapping Enabled"}),i.jsx("span",{className:"text-[8px] text-slate-500 block mt-1",children:"Goal Type ID will be automatically mapped from your Type selection (PERSONAL/DEPARTMENT/COMPANY)"})]})]})]}),g==="distribute"&&i.jsxs("div",{className:"flex-1 flex flex-col md:flex-row gap-8 min-h-0",children:[i.jsx("div",{className:"md:w-1/3 overflow-y-auto pr-2 custom-scrollbar",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest block mb-1",children:"Goal Title"}),i.jsx("input",{type:"text",className:"w-full bg-slate-100 border border-slate-300 rounded-lg px-3 py-2 text-sm font-bold outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-400 text-slate-800 placeholder:text-slate-500",value:P.title,onChange:G=>Q({...P,title:G.target.value}),placeholder:"e.g. Q1 Sales Training"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest block mb-1",children:"Details"}),i.jsx("textarea",{className:"w-full bg-slate-100 border border-slate-300 rounded-lg px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-400 min-h-[100px] text-slate-700 placeholder:text-slate-500",value:P.description,onChange:G=>Q({...P,description:G.target.value}),placeholder:"Description..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest block mb-1",children:"Big Rock"}),i.jsx("select",{className:"w-full bg-slate-100 border border-slate-300 rounded-lg px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-400 text-slate-700",value:P.goalId,onChange:G=>Q({...P,goalId:G.target.value}),children:o.map(G=>i.jsx("option",{value:G.id,className:"bg-white",children:G.title},G.id))})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest block mb-1",children:"Priority"}),i.jsx("select",{className:"w-full bg-slate-100 border border-slate-300 rounded-lg px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-400 text-slate-700",value:P.priority,onChange:G=>Q({...P,priority:G.target.value}),children:Object.values(Ee).map(G=>i.jsx("option",{value:G,className:"bg-white",children:G},G))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest block mb-1",children:"Due Date"}),i.jsx("input",{type:"date",className:"w-full bg-slate-100 border border-slate-300 rounded-lg px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-400 text-slate-700",value:P.endDate,onChange:G=>Q({...P,endDate:G.target.value})})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest block mb-1",children:["Type ",i.jsx("span",{className:"text-rose-500",children:"*"})]}),i.jsxs("select",{className:"w-full bg-slate-100 border border-slate-300 rounded-lg px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-400 text-slate-700",value:P.goalType,onChange:G=>Q({...P,goalType:G.target.value}),children:[i.jsx("option",{value:"PERSONAL",className:"bg-white",children:"Personal"}),i.jsx("option",{value:"DEPARTMENT",className:"bg-white",children:"Department"}),i.jsx("option",{value:"COMPANY",className:"bg-white",children:"Company"})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest block mb-1",children:["Category ",i.jsx("span",{className:"text-rose-500",children:"*"})]}),i.jsxs("select",{className:"w-full bg-slate-100 border border-slate-300 rounded-lg px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-400 text-slate-700",value:P.goalCategory,onChange:G=>Q({...P,goalCategory:G.target.value}),children:[i.jsx("option",{value:"PERFORMANCE",className:"bg-white",children:"Performance"}),i.jsx("option",{value:"DEVELOPMENT",className:"bg-white",children:"Development"})]})]})]})]})}),i.jsxs("div",{className:"flex-1 border-t md:border-t-0 md:border-l border-slate-300 md:pl-8 pt-4 md:pt-0 flex flex-col min-h-0",children:[i.jsxs("div",{className:"mb-2 flex flex-wrap gap-2",children:[i.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest pt-1 mr-2",children:"Quick Select:"}),Se.map(G=>{const he=A(G);return i.jsx("button",{onClick:()=>ae(G),className:`px-2 py-0.5 rounded text-[9px] font-bold uppercase transition-colors ${he?"bg-teal-600 text-white":"bg-slate-100 text-slate-500 hover:bg-slate-200"}`,children:G},G)}),i.jsx("button",{onClick:()=>V(new Set),className:"px-2 py-0.5 bg-rose-50 text-rose-500 rounded text-[9px] font-bold uppercase ml-auto hover:bg-rose-100 transition-colors border border-rose-200",children:"Clear"})]}),i.jsx("div",{className:"flex-1 overflow-y-auto bg-slate-100 rounded-xl p-4 grid grid-cols-2 lg:grid-cols-3 gap-2 border border-slate-300 custom-scrollbar",children:a.map(G=>i.jsxs("label",{className:`flex items-center gap-2 p-2 rounded-lg border cursor-pointer transition-all ${H.has(G.id)?"bg-teal-50 border-teal-300":"bg-white border-slate-300 hover:border-slate-300"}`,children:[i.jsx("input",{type:"checkbox",checked:H.has(G.id),onChange:()=>se(G.id),className:"w-4 h-4 rounded text-teal-600 focus:ring-teal-500 bg-white border-slate-300"}),i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-xs font-bold text-slate-800 truncate",children:G.name}),i.jsx("div",{className:"text-[9px] text-slate-500 truncate",children:G.team||G.department})]})]},G.id))}),i.jsx("div",{className:"pt-4",children:i.jsx("button",{onClick:ue,className:`w-full text-white py-3 rounded-xl font-black uppercase tracking-widest transition-all shadow-lg ${b?"bg-gradient-to-r from-rose-600 to-pink-600 hover:from-rose-700 hover:to-pink-700 shadow-rose-200":"bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700 shadow-teal-200"}`,children:b?`Create & Push ${H.size} Goals`:`Create ${H.size} Goals`})})]})]}),g==="rapid"&&i.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[i.jsx("div",{className:"flex-1 overflow-y-auto border border-slate-300 rounded-xl custom-scrollbar relative bg-white",children:i.jsxs("table",{className:"w-full text-left border-collapse",children:[i.jsx("thead",{className:"bg-slate-100 sticky top-0 z-10 shadow-sm",children:i.jsxs("tr",{children:[i.jsxs("th",{className:"p-3 text-[10px] font-black text-slate-500 uppercase tracking-widest",children:["Goal Title ",i.jsx("span",{className:"text-rose-500",children:"*"})]}),i.jsx("th",{className:"p-3 text-[10px] font-black text-slate-500 uppercase tracking-widest w-52",children:"Description"}),i.jsxs("th",{className:"p-3 text-[10px] font-black text-slate-500 uppercase tracking-widest w-40",children:["Owner ",i.jsx("span",{className:"text-rose-500",children:"*"})]}),i.jsx("th",{className:"p-3 text-[10px] font-black text-slate-500 uppercase tracking-widest w-36",children:"Big Rock"}),i.jsx("th",{className:"p-3 text-[10px] font-black text-slate-500 uppercase tracking-widest w-28",children:"Priority"}),i.jsx("th",{className:"p-3 text-[10px] font-black text-slate-500 uppercase tracking-widest w-28",children:"Due Date"}),i.jsx("th",{className:"p-3 text-[10px] font-black text-slate-500 uppercase tracking-widest w-24",children:"Type"}),i.jsx("th",{className:"p-3 text-[10px] font-black text-slate-500 uppercase tracking-widest w-28",children:"Category"}),i.jsx("th",{className:"p-3 w-10"})]})}),i.jsx("tbody",{className:"divide-y divide-slate-100",children:q.map((G,he)=>i.jsxs("tr",{className:`group ${!G.title&&!G.owner?"opacity-50 hover:opacity-100":""}`,children:[i.jsx("td",{className:"p-2 align-top",children:i.jsx("input",{type:"text",className:"w-full bg-slate-100 border border-slate-300 rounded px-2 py-1.5 text-sm font-medium outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-400 text-slate-800 placeholder:text-slate-500",placeholder:"Goal Title...",value:G.title,onChange:be=>C(he,"title",be.target.value)})}),i.jsx("td",{className:"p-2 align-top",children:i.jsx("input",{type:"text",className:"w-full bg-slate-100 border border-slate-300 rounded px-2 py-1.5 text-xs outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-400 text-slate-700 placeholder:text-slate-500",placeholder:"Description...",value:G.description||"",onChange:be=>C(he,"description",be.target.value)})}),i.jsx("td",{className:"p-2 align-top",children:i.jsxs("select",{className:"w-full bg-slate-100 border border-slate-300 rounded px-2 py-1.5 text-xs font-medium outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-400 text-slate-700",value:G.owner,onChange:be=>C(he,"owner",be.target.value),children:[i.jsx("option",{value:"",className:"bg-white",children:"Select..."}),a.map(be=>i.jsx("option",{value:be.name,className:"bg-white",children:be.name},be.id))]})}),i.jsx("td",{className:"p-2 align-top",children:i.jsx("select",{className:"w-full bg-slate-100 border border-slate-300 rounded px-2 py-1.5 text-xs outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-400 text-slate-700",value:G.goalId,onChange:be=>C(he,"goalId",be.target.value),children:o.map(be=>i.jsx("option",{value:be.id,className:"bg-white",children:be.title},be.id))})}),i.jsx("td",{className:"p-2 align-top",children:i.jsx("select",{className:"w-full bg-slate-100 border border-slate-300 rounded px-2 py-1.5 text-xs outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-400 text-slate-700",value:G.priority,onChange:be=>C(he,"priority",be.target.value),children:Object.values(Ee).map(be=>i.jsx("option",{value:be,className:"bg-white",children:be},be))})}),i.jsx("td",{className:"p-2 align-top",children:i.jsx("input",{type:"date",className:"w-full bg-slate-100 border border-slate-300 rounded px-2 py-1.5 text-xs outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-400 text-slate-700",value:G.endDate||"",onChange:be=>C(he,"endDate",be.target.value)})}),i.jsx("td",{className:"p-2 align-top",children:i.jsxs("select",{className:"w-full bg-slate-100 border border-slate-300 rounded px-2 py-1.5 text-xs outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-400 text-slate-700",value:G.goalType||"PERSONAL",onChange:be=>C(he,"goalType",be.target.value),children:[i.jsx("option",{value:"PERSONAL",className:"bg-white",children:"Personal"}),i.jsx("option",{value:"DEPARTMENT",className:"bg-white",children:"Dept"}),i.jsx("option",{value:"COMPANY",className:"bg-white",children:"Company"})]})}),i.jsx("td",{className:"p-2 align-top",children:i.jsxs("select",{className:"w-full bg-slate-100 border border-slate-300 rounded px-2 py-1.5 text-xs outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-400 text-slate-700",value:G.goalCategory||"PERFORMANCE",onChange:be=>C(he,"goalCategory",be.target.value),children:[i.jsx("option",{value:"PERFORMANCE",className:"bg-white",children:"Perf"}),i.jsx("option",{value:"DEVELOPMENT",className:"bg-white",children:"Dev"})]})}),i.jsx("td",{className:"p-2 text-center align-top pt-3",children:i.jsx("button",{onClick:()=>O(he),className:"text-slate-500 hover:text-rose-500 transition-colors",title:"Delete Row",children:""})})]},he))})]})}),i.jsxs("div",{className:"pt-4 flex justify-between items-center border-t border-slate-300 mt-auto",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:_,className:"flex items-center gap-2 text-teal-600 text-xs font-black uppercase tracking-widest hover:text-teal-700 hover:bg-teal-50 px-4 py-2 rounded-lg transition-colors",children:[i.jsx("span",{children:"+"})," Add Row"]}),i.jsx("button",{onClick:z,className:"flex items-center gap-2 text-rose-500 text-xs font-black uppercase tracking-widest hover:text-rose-600 hover:bg-rose-50 px-4 py-2 rounded-lg transition-colors",children:"Clear List"})]}),i.jsxs("div",{className:"flex gap-4 items-center",children:[i.jsxs("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:[q.filter(G=>G.title&&G.owner).length," Valid Item(s)"]}),i.jsx("button",{onClick:L,className:`text-white px-8 py-3 rounded-xl font-black uppercase tracking-widest transition-colors shadow-lg ${b?"bg-gradient-to-r from-rose-600 to-pink-600 hover:from-rose-700 hover:to-pink-700 shadow-rose-200":"bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700 shadow-teal-200"}`,children:b?"Create & Push":"Create Items"})]})]})]}),g==="sync_existing"&&i.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[i.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[i.jsx("input",{type:"text",placeholder:"Filter by Goal or Owner...",className:"bg-slate-100 border border-slate-300 rounded-lg px-3 py-2 text-sm w-64 outline-none focus:ring-2 focus:ring-teal-100 focus:border-teal-400 text-slate-800 placeholder:text-slate-500",value:re,onChange:G=>oe(G.target.value)}),i.jsxs("div",{className:"text-[10px] font-bold text-slate-500 uppercase",children:[fe.size," Selected"]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto border border-slate-300 rounded-xl custom-scrollbar bg-white",children:i.jsxs("table",{className:"w-full text-left border-collapse",children:[i.jsx("thead",{className:"bg-slate-100 sticky top-0 z-10 shadow-sm",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-3 w-10",children:i.jsx("input",{type:"checkbox",checked:ne.length>0&&fe.size===ne.length,onChange:ge,className:"w-4 h-4 rounded text-teal-600 focus:ring-teal-500 cursor-pointer bg-white border-slate-300"})}),i.jsx("th",{className:"p-3 text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Goal Title"}),i.jsx("th",{className:"p-3 text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Owner"}),i.jsx("th",{className:"p-3 text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Dept"}),i.jsx("th",{className:"p-3 text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Status"})]})}),i.jsx("tbody",{className:"divide-y divide-slate-100",children:ne.map(G=>i.jsxs("tr",{className:`hover:bg-slate-100 transition-colors cursor-pointer ${fe.has(G.id)?"bg-teal-50":""}`,onClick:()=>xe(G.id),children:[i.jsx("td",{className:"p-3",children:i.jsx("input",{type:"checkbox",checked:fe.has(G.id),onChange:()=>xe(G.id),className:"w-4 h-4 rounded text-teal-600 focus:ring-teal-500 cursor-pointer bg-white border-slate-300"})}),i.jsx("td",{className:"p-3 text-sm font-bold text-slate-800",children:G.title}),i.jsx("td",{className:"p-3 text-xs text-slate-500",children:G.owner}),i.jsx("td",{className:"p-3 text-[10px] uppercase font-bold text-slate-500",children:G.department}),i.jsx("td",{className:"p-3",children:i.jsx("span",{className:"text-[9px] font-bold bg-slate-100 text-slate-600 px-2 py-1 rounded border border-slate-300",children:G.status})})]},G.id))})]})}),i.jsx("div",{className:"pt-4 flex justify-end border-t border-slate-300 mt-auto",children:i.jsxs("button",{onClick:W,disabled:fe.size===0,className:"bg-gradient-to-r from-rose-600 to-pink-600 hover:from-rose-700 hover:to-pink-700 text-white px-8 py-3 rounded-xl font-black uppercase tracking-widest transition-colors shadow-lg shadow-rose-200 disabled:opacity-50 disabled:cursor-not-allowed",children:["Push ",fe.size," Selected to HiBob"]})})]})]})})};var Xv={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Qv,Wv;function Zv(){return{geminiUrl:Qv,vertexUrl:Wv}}function ey(s,t,a,o){var c,d;if(!(s!=null&&s.baseUrl)){const p=Zv();return t?(c=p.vertexUrl)!==null&&c!==void 0?c:a:(d=p.geminiUrl)!==null&&d!==void 0?d:o}return s.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Xn{}function Te(s,t){const a=/\{([^}]+)\}/g;return s.replace(a,(o,c)=>{if(Object.prototype.hasOwnProperty.call(t,c)){const d=t[c];return d!=null?String(d):""}else throw new Error(`Key '${c}' not found in valueMap.`)})}function f(s,t,a){for(let d=0;d<t.length-1;d++){const p=t[d];if(p.endsWith("[]")){const g=p.slice(0,-2);if(!(g in s))if(Array.isArray(a))s[g]=Array.from({length:a.length},()=>({}));else throw new Error(`Value must be a list given an array path ${p}`);if(Array.isArray(s[g])){const v=s[g];if(Array.isArray(a))for(let h=0;h<v.length;h++){const y=v[h];f(y,t.slice(d+1),a[h])}else for(const h of v)f(h,t.slice(d+1),a)}return}else if(p.endsWith("[0]")){const g=p.slice(0,-3);g in s||(s[g]=[{}]);const v=s[g];f(v[0],t.slice(d+1),a);return}(!s[p]||typeof s[p]!="object")&&(s[p]={}),s=s[p]}const o=t[t.length-1],c=s[o];if(c!==void 0){if(!a||typeof a=="object"&&Object.keys(a).length===0||a===c)return;if(typeof c=="object"&&typeof a=="object"&&c!==null&&a!==null)Object.assign(c,a);else throw new Error(`Cannot set value for an existing key. Key: ${o}`)}else o==="_self"&&typeof a=="object"&&a!==null&&!Array.isArray(a)?Object.assign(s,a):s[o]=a}function u(s,t,a=void 0){try{if(t.length===1&&t[0]==="_self")return s;for(let o=0;o<t.length;o++){if(typeof s!="object"||s===null)return a;const c=t[o];if(c.endsWith("[]")){const d=c.slice(0,-2);if(d in s){const p=s[d];return Array.isArray(p)?p.map(g=>u(g,t.slice(o+1),a)):a}else return a}else s=s[c]}return s}catch(o){if(o instanceof TypeError)return a;throw o}}function ty(s,t){for(const[a,o]of Object.entries(t)){const c=a.split("."),d=o.split("."),p=new Set;let g=-1;for(let v=0;v<c.length;v++)if(c[v]==="*"){g=v;break}if(g!==-1&&d.length>g)for(let v=g;v<d.length;v++){const h=d[v];h!=="*"&&!h.endsWith("[]")&&!h.endsWith("[0]")&&p.add(h)}su(s,c,d,0,p)}}function su(s,t,a,o,c){if(o>=t.length||typeof s!="object"||s===null)return;const d=t[o];if(d.endsWith("[]")){const p=d.slice(0,-2),g=s;if(p in g&&Array.isArray(g[p]))for(const v of g[p])su(v,t,a,o+1,c)}else if(d==="*"){if(typeof s=="object"&&s!==null&&!Array.isArray(s)){const p=s,g=Object.keys(p).filter(h=>!h.startsWith("_")&&!c.has(h)),v={};for(const h of g)v[h]=p[h];for(const[h,y]of Object.entries(v)){const b=[];for(const S of a.slice(o))S==="*"?b.push(h):b.push(S);f(p,b,y)}for(const h of g)delete p[h]}}else{const p=s;d in p&&su(p[d],t,a,o+1,c)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bu(s){if(typeof s!="string")throw new Error("fromImageBytes must be a string");return s}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ny(s){const t={},a=u(s,["operationName"]);a!=null&&f(t,["operationName"],a);const o=u(s,["resourceName"]);return o!=null&&f(t,["_url","resourceName"],o),t}function sy(s){const t={},a=u(s,["name"]);a!=null&&f(t,["name"],a);const o=u(s,["metadata"]);o!=null&&f(t,["metadata"],o);const c=u(s,["done"]);c!=null&&f(t,["done"],c);const d=u(s,["error"]);d!=null&&f(t,["error"],d);const p=u(s,["response","generateVideoResponse"]);return p!=null&&f(t,["response"],ly(p)),t}function ay(s){const t={},a=u(s,["name"]);a!=null&&f(t,["name"],a);const o=u(s,["metadata"]);o!=null&&f(t,["metadata"],o);const c=u(s,["done"]);c!=null&&f(t,["done"],c);const d=u(s,["error"]);d!=null&&f(t,["error"],d);const p=u(s,["response"]);return p!=null&&f(t,["response"],oy(p)),t}function ly(s){const t={},a=u(s,["generatedSamples"]);if(a!=null){let d=a;Array.isArray(d)&&(d=d.map(p=>iy(p))),f(t,["generatedVideos"],d)}const o=u(s,["raiMediaFilteredCount"]);o!=null&&f(t,["raiMediaFilteredCount"],o);const c=u(s,["raiMediaFilteredReasons"]);return c!=null&&f(t,["raiMediaFilteredReasons"],c),t}function oy(s){const t={},a=u(s,["videos"]);if(a!=null){let d=a;Array.isArray(d)&&(d=d.map(p=>ry(p))),f(t,["generatedVideos"],d)}const o=u(s,["raiMediaFilteredCount"]);o!=null&&f(t,["raiMediaFilteredCount"],o);const c=u(s,["raiMediaFilteredReasons"]);return c!=null&&f(t,["raiMediaFilteredReasons"],c),t}function iy(s){const t={},a=u(s,["video"]);return a!=null&&f(t,["video"],my(a)),t}function ry(s){const t={},a=u(s,["_self"]);return a!=null&&f(t,["video"],hy(a)),t}function cy(s){const t={},a=u(s,["operationName"]);return a!=null&&f(t,["_url","operationName"],a),t}function uy(s){const t={},a=u(s,["operationName"]);return a!=null&&f(t,["_url","operationName"],a),t}function dy(s){const t={},a=u(s,["name"]);a!=null&&f(t,["name"],a);const o=u(s,["metadata"]);o!=null&&f(t,["metadata"],o);const c=u(s,["done"]);c!=null&&f(t,["done"],c);const d=u(s,["error"]);d!=null&&f(t,["error"],d);const p=u(s,["response"]);return p!=null&&f(t,["response"],fy(p)),t}function fy(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["parent"]);o!=null&&f(t,["parent"],o);const c=u(s,["documentName"]);return c!=null&&f(t,["documentName"],c),t}function pg(s){const t={},a=u(s,["name"]);a!=null&&f(t,["name"],a);const o=u(s,["metadata"]);o!=null&&f(t,["metadata"],o);const c=u(s,["done"]);c!=null&&f(t,["done"],c);const d=u(s,["error"]);d!=null&&f(t,["error"],d);const p=u(s,["response"]);return p!=null&&f(t,["response"],py(p)),t}function py(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["parent"]);o!=null&&f(t,["parent"],o);const c=u(s,["documentName"]);return c!=null&&f(t,["documentName"],c),t}function my(s){const t={},a=u(s,["uri"]);a!=null&&f(t,["uri"],a);const o=u(s,["encodedVideo"]);o!=null&&f(t,["videoBytes"],bu(o));const c=u(s,["encoding"]);return c!=null&&f(t,["mimeType"],c),t}function hy(s){const t={},a=u(s,["gcsUri"]);a!=null&&f(t,["uri"],a);const o=u(s,["bytesBase64Encoded"]);o!=null&&f(t,["videoBytes"],bu(o));const c=u(s,["mimeType"]);return c!=null&&f(t,["mimeType"],c),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var km;(function(s){s.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",s.OUTCOME_OK="OUTCOME_OK",s.OUTCOME_FAILED="OUTCOME_FAILED",s.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(km||(km={}));var jm;(function(s){s.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",s.PYTHON="PYTHON"})(jm||(jm={}));var Um;(function(s){s.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",s.SILENT="SILENT",s.WHEN_IDLE="WHEN_IDLE",s.INTERRUPT="INTERRUPT"})(Um||(Um={}));var Ge;(function(s){s.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",s.STRING="STRING",s.NUMBER="NUMBER",s.INTEGER="INTEGER",s.BOOLEAN="BOOLEAN",s.ARRAY="ARRAY",s.OBJECT="OBJECT",s.NULL="NULL"})(Ge||(Ge={}));var Lm;(function(s){s.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",s.SIMPLE_SEARCH="SIMPLE_SEARCH",s.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Lm||(Lm={}));var Gm;(function(s){s.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",s.NO_AUTH="NO_AUTH",s.API_KEY_AUTH="API_KEY_AUTH",s.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",s.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",s.OAUTH="OAUTH",s.OIDC_AUTH="OIDC_AUTH"})(Gm||(Gm={}));var Om;(function(s){s.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",s.HTTP_IN_QUERY="HTTP_IN_QUERY",s.HTTP_IN_HEADER="HTTP_IN_HEADER",s.HTTP_IN_PATH="HTTP_IN_PATH",s.HTTP_IN_BODY="HTTP_IN_BODY",s.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Om||(Om={}));var Pm;(function(s){s.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",s.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",s.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",s.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",s.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",s.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",s.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Pm||(Pm={}));var Hm;(function(s){s.UNSPECIFIED="UNSPECIFIED",s.BLOCKING="BLOCKING",s.NON_BLOCKING="NON_BLOCKING"})(Hm||(Hm={}));var Bm;(function(s){s.MODE_UNSPECIFIED="MODE_UNSPECIFIED",s.MODE_DYNAMIC="MODE_DYNAMIC"})(Bm||(Bm={}));var Vm;(function(s){s.MODE_UNSPECIFIED="MODE_UNSPECIFIED",s.AUTO="AUTO",s.ANY="ANY",s.NONE="NONE",s.VALIDATED="VALIDATED"})(Vm||(Vm={}));var qm;(function(s){s.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",s.LOW="LOW",s.MEDIUM="MEDIUM",s.HIGH="HIGH",s.MINIMAL="MINIMAL"})(qm||(qm={}));var Jm;(function(s){s.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",s.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",s.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",s.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",s.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",s.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",s.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",s.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",s.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",s.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",s.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(Jm||(Jm={}));var zm;(function(s){s.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",s.SEVERITY="SEVERITY",s.PROBABILITY="PROBABILITY"})(zm||(zm={}));var Fm;(function(s){s.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",s.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",s.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",s.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",s.BLOCK_NONE="BLOCK_NONE",s.OFF="OFF"})(Fm||(Fm={}));var Ym;(function(s){s.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",s.STOP="STOP",s.MAX_TOKENS="MAX_TOKENS",s.SAFETY="SAFETY",s.RECITATION="RECITATION",s.LANGUAGE="LANGUAGE",s.OTHER="OTHER",s.BLOCKLIST="BLOCKLIST",s.PROHIBITED_CONTENT="PROHIBITED_CONTENT",s.SPII="SPII",s.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",s.IMAGE_SAFETY="IMAGE_SAFETY",s.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",s.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",s.NO_IMAGE="NO_IMAGE",s.IMAGE_RECITATION="IMAGE_RECITATION",s.IMAGE_OTHER="IMAGE_OTHER"})(Ym||(Ym={}));var $m;(function(s){s.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",s.NEGLIGIBLE="NEGLIGIBLE",s.LOW="LOW",s.MEDIUM="MEDIUM",s.HIGH="HIGH"})($m||($m={}));var Km;(function(s){s.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",s.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",s.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",s.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",s.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Km||(Km={}));var Xm;(function(s){s.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",s.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",s.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",s.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",s.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Xm||(Xm={}));var Qm;(function(s){s.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",s.SAFETY="SAFETY",s.OTHER="OTHER",s.BLOCKLIST="BLOCKLIST",s.PROHIBITED_CONTENT="PROHIBITED_CONTENT",s.IMAGE_SAFETY="IMAGE_SAFETY",s.MODEL_ARMOR="MODEL_ARMOR",s.JAILBREAK="JAILBREAK"})(Qm||(Qm={}));var Wm;(function(s){s.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",s.ON_DEMAND="ON_DEMAND",s.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Wm||(Wm={}));var Ei;(function(s){s.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",s.TEXT="TEXT",s.IMAGE="IMAGE",s.AUDIO="AUDIO"})(Ei||(Ei={}));var Zm;(function(s){s.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",s.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",s.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",s.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Zm||(Zm={}));var eh;(function(s){s.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",s.TUNING_MODE_FULL="TUNING_MODE_FULL",s.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(eh||(eh={}));var th;(function(s){s.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",s.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",s.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",s.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",s.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",s.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",s.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(th||(th={}));var au;(function(s){s.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",s.JOB_STATE_QUEUED="JOB_STATE_QUEUED",s.JOB_STATE_PENDING="JOB_STATE_PENDING",s.JOB_STATE_RUNNING="JOB_STATE_RUNNING",s.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",s.JOB_STATE_FAILED="JOB_STATE_FAILED",s.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",s.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",s.JOB_STATE_PAUSED="JOB_STATE_PAUSED",s.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",s.JOB_STATE_UPDATING="JOB_STATE_UPDATING",s.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(au||(au={}));var nh;(function(s){s.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",s.TUNING_TASK_I2V="TUNING_TASK_I2V",s.TUNING_TASK_T2V="TUNING_TASK_T2V",s.TUNING_TASK_R2V="TUNING_TASK_R2V"})(nh||(nh={}));var sh;(function(s){s.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",s.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",s.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",s.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",s.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(sh||(sh={}));var ah;(function(s){s.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",s.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",s.BALANCED="BALANCED",s.PRIORITIZE_COST="PRIORITIZE_COST"})(ah||(ah={}));var lh;(function(s){s.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",s.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(lh||(lh={}));var oh;(function(s){s.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",s.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",s.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",s.BLOCK_NONE="BLOCK_NONE"})(oh||(oh={}));var ih;(function(s){s.DONT_ALLOW="DONT_ALLOW",s.ALLOW_ADULT="ALLOW_ADULT",s.ALLOW_ALL="ALLOW_ALL"})(ih||(ih={}));var rh;(function(s){s.auto="auto",s.en="en",s.ja="ja",s.ko="ko",s.hi="hi",s.zh="zh",s.pt="pt",s.es="es"})(rh||(rh={}));var ch;(function(s){s.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",s.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",s.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",s.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",s.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(ch||(ch={}));var uh;(function(s){s.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",s.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",s.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",s.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(uh||(uh={}));var dh;(function(s){s.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",s.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",s.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",s.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(dh||(dh={}));var fh;(function(s){s.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",s.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",s.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",s.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",s.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",s.EDIT_MODE_STYLE="EDIT_MODE_STYLE",s.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",s.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(fh||(fh={}));var ph;(function(s){s.FOREGROUND="FOREGROUND",s.BACKGROUND="BACKGROUND",s.PROMPT="PROMPT",s.SEMANTIC="SEMANTIC",s.INTERACTIVE="INTERACTIVE"})(ph||(ph={}));var mh;(function(s){s.ASSET="ASSET",s.STYLE="STYLE"})(mh||(mh={}));var hh;(function(s){s.INSERT="INSERT",s.REMOVE="REMOVE",s.REMOVE_STATIC="REMOVE_STATIC",s.OUTPAINT="OUTPAINT"})(hh||(hh={}));var gh;(function(s){s.OPTIMIZED="OPTIMIZED",s.LOSSLESS="LOSSLESS"})(gh||(gh={}));var xh;(function(s){s.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",s.PREFERENCE_TUNING="PREFERENCE_TUNING"})(xh||(xh={}));var vh;(function(s){s.STATE_UNSPECIFIED="STATE_UNSPECIFIED",s.STATE_PENDING="STATE_PENDING",s.STATE_ACTIVE="STATE_ACTIVE",s.STATE_FAILED="STATE_FAILED"})(vh||(vh={}));var yh;(function(s){s.STATE_UNSPECIFIED="STATE_UNSPECIFIED",s.PROCESSING="PROCESSING",s.ACTIVE="ACTIVE",s.FAILED="FAILED"})(yh||(yh={}));var bh;(function(s){s.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",s.UPLOADED="UPLOADED",s.GENERATED="GENERATED",s.REGISTERED="REGISTERED"})(bh||(bh={}));var Sh;(function(s){s.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",s.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",s.RESPONSE_REJECTED="RESPONSE_REJECTED",s.NEED_MORE_INPUT="NEED_MORE_INPUT"})(Sh||(Sh={}));var Th;(function(s){s.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",s.TEXT="TEXT",s.IMAGE="IMAGE",s.VIDEO="VIDEO",s.AUDIO="AUDIO",s.DOCUMENT="DOCUMENT"})(Th||(Th={}));var Nh;(function(s){s.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",s.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",s.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(Nh||(Nh={}));var Eh;(function(s){s.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",s.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",s.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Eh||(Eh={}));var Ch;(function(s){s.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",s.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",s.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Ch||(Ch={}));var wh;(function(s){s.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",s.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",s.NO_INTERRUPTION="NO_INTERRUPTION"})(wh||(wh={}));var Ah;(function(s){s.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",s.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",s.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Ah||(Ah={}));var _h;(function(s){s.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",s.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",s.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",s.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",s.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",s.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",s.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",s.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",s.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",s.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",s.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",s.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",s.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(_h||(_h={}));var Rh;(function(s){s.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",s.QUALITY="QUALITY",s.DIVERSITY="DIVERSITY",s.VOCALIZATION="VOCALIZATION"})(Rh||(Rh={}));var Ba;(function(s){s.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",s.PLAY="PLAY",s.PAUSE="PAUSE",s.STOP="STOP",s.RESET_CONTEXT="RESET_CONTEXT"})(Ba||(Ba={}));class lu{constructor(t){const a={};for(const o of t.headers.entries())a[o[0]]=o[1];this.headers=a,this.responseInternal=t}json(){return this.responseInternal.json()}}class zl{get text(){var t,a,o,c,d,p,g,v;if(((c=(o=(a=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)===null||c===void 0?void 0:c.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let h="",y=!1;const b=[];for(const S of(v=(g=(p=(d=this.candidates)===null||d===void 0?void 0:d[0])===null||p===void 0?void 0:p.content)===null||g===void 0?void 0:g.parts)!==null&&v!==void 0?v:[]){for(const[N,k]of Object.entries(S))N!=="text"&&N!=="thought"&&N!=="thoughtSignature"&&(k!==null||k!==void 0)&&b.push(N);if(typeof S.text=="string"){if(typeof S.thought=="boolean"&&S.thought)continue;y=!0,h+=S.text}}return b.length>0&&console.warn(`there are non-text parts ${b} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),y?h:void 0}get data(){var t,a,o,c,d,p,g,v;if(((c=(o=(a=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)===null||c===void 0?void 0:c.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let h="";const y=[];for(const b of(v=(g=(p=(d=this.candidates)===null||d===void 0?void 0:d[0])===null||p===void 0?void 0:p.content)===null||g===void 0?void 0:g.parts)!==null&&v!==void 0?v:[]){for(const[S,N]of Object.entries(b))S!=="inlineData"&&(N!==null||N!==void 0)&&y.push(S);b.inlineData&&typeof b.inlineData.data=="string"&&(h+=atob(b.inlineData.data))}return y.length>0&&console.warn(`there are non-data parts ${y} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),h.length>0?btoa(h):void 0}get functionCalls(){var t,a,o,c,d,p,g,v;if(((c=(o=(a=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)===null||c===void 0?void 0:c.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const h=(v=(g=(p=(d=this.candidates)===null||d===void 0?void 0:d[0])===null||p===void 0?void 0:p.content)===null||g===void 0?void 0:g.parts)===null||v===void 0?void 0:v.filter(y=>y.functionCall).map(y=>y.functionCall).filter(y=>y!==void 0);if((h==null?void 0:h.length)!==0)return h}get executableCode(){var t,a,o,c,d,p,g,v,h;if(((c=(o=(a=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)===null||c===void 0?void 0:c.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const y=(v=(g=(p=(d=this.candidates)===null||d===void 0?void 0:d[0])===null||p===void 0?void 0:p.content)===null||g===void 0?void 0:g.parts)===null||v===void 0?void 0:v.filter(b=>b.executableCode).map(b=>b.executableCode).filter(b=>b!==void 0);if((y==null?void 0:y.length)!==0)return(h=y==null?void 0:y[0])===null||h===void 0?void 0:h.code}get codeExecutionResult(){var t,a,o,c,d,p,g,v,h;if(((c=(o=(a=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)===null||c===void 0?void 0:c.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const y=(v=(g=(p=(d=this.candidates)===null||d===void 0?void 0:d[0])===null||p===void 0?void 0:p.content)===null||g===void 0?void 0:g.parts)===null||v===void 0?void 0:v.filter(b=>b.codeExecutionResult).map(b=>b.codeExecutionResult).filter(b=>b!==void 0);if((y==null?void 0:y.length)!==0)return(h=y==null?void 0:y[0])===null||h===void 0?void 0:h.output}}class Ih{}class Mh{}class gy{}class xy{}class vy{}class yy{}class Dh{}class kh{}class jh{}class by{}class Ci{_fromAPIResponse({apiResponse:t,_isVertexAI:a}){const o=new Ci;let c;const d=t;return a?c=ay(d):c=sy(d),Object.assign(o,c),o}}class Uh{}class Lh{}class Gh{}class Oh{}class Sy{}class Ty{}class Ny{}class Su{_fromAPIResponse({apiResponse:t,_isVertexAI:a}){const o=new Su,d=dy(t);return Object.assign(o,d),o}}class Ey{}class Cy{}class wy{}class Ph{}class Ay{get text(){var t,a,o;let c="",d=!1;const p=[];for(const g of(o=(a=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||a===void 0?void 0:a.parts)!==null&&o!==void 0?o:[]){for(const[v,h]of Object.entries(g))v!=="text"&&v!=="thought"&&h!==null&&p.push(v);if(typeof g.text=="string"){if(typeof g.thought=="boolean"&&g.thought)continue;d=!0,c+=g.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),d?c:void 0}get data(){var t,a,o;let c="";const d=[];for(const p of(o=(a=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||a===void 0?void 0:a.parts)!==null&&o!==void 0?o:[]){for(const[g,v]of Object.entries(p))g!=="inlineData"&&v!==null&&d.push(g);p.inlineData&&typeof p.inlineData.data=="string"&&(c+=atob(p.inlineData.data))}return d.length>0&&console.warn(`there are non-data parts ${d} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),c.length>0?btoa(c):void 0}}class _y{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Tu{_fromAPIResponse({apiResponse:t,_isVertexAI:a}){const o=new Tu,d=pg(t);return Object.assign(o,d),o}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Xe(s,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw new Error("invalid model parameter");if(s.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const a=t.split("/",2);return`publishers/${a[0]}/models/${a[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function mg(s,t){const a=Xe(s,t);return a?a.startsWith("publishers/")&&s.isVertexAI()?`projects/${s.getProject()}/locations/${s.getLocation()}/${a}`:a.startsWith("models/")&&s.isVertexAI()?`projects/${s.getProject()}/locations/${s.getLocation()}/publishers/google/${a}`:a:""}function hg(s){return Array.isArray(s)?s.map(t=>wi(t)):[wi(s)]}function wi(s){if(typeof s=="object"&&s!==null)return s;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof s}`)}function gg(s){const t=wi(s);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function xg(s){const t=wi(s);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Hh(s){if(s==null)throw new Error("PartUnion is required");if(typeof s=="object")return s;if(typeof s=="string")return{text:s};throw new Error(`Unsupported part type: ${typeof s}`)}function vg(s){if(s==null||Array.isArray(s)&&s.length===0)throw new Error("PartListUnion is required");return Array.isArray(s)?s.map(t=>Hh(t)):[Hh(s)]}function ou(s){return s!=null&&typeof s=="object"&&"parts"in s&&Array.isArray(s.parts)}function Bh(s){return s!=null&&typeof s=="object"&&"functionCall"in s}function Vh(s){return s!=null&&typeof s=="object"&&"functionResponse"in s}function jt(s){if(s==null)throw new Error("ContentUnion is required");return ou(s)?s:{role:"user",parts:vg(s)}}function Nu(s,t){if(!t)return[];if(s.isVertexAI()&&Array.isArray(t))return t.flatMap(a=>{const o=jt(a);return o.parts&&o.parts.length>0&&o.parts[0].text!==void 0?[o.parts[0].text]:[]});if(s.isVertexAI()){const a=jt(t);return a.parts&&a.parts.length>0&&a.parts[0].text!==void 0?[a.parts[0].text]:[]}return Array.isArray(t)?t.map(a=>jt(a)):[jt(t)]}function hn(s){if(s==null||Array.isArray(s)&&s.length===0)throw new Error("contents are required");if(!Array.isArray(s)){if(Bh(s)||Vh(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[jt(s)]}const t=[],a=[],o=ou(s[0]);for(const c of s){const d=ou(c);if(d!=o)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(d)t.push(c);else{if(Bh(c)||Vh(c))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");a.push(c)}}return o||t.push({role:"user",parts:vg(a)}),t}function Ry(s,t){s.includes("null")&&(t.nullable=!0);const a=s.filter(o=>o!=="null");if(a.length===1)t.type=Object.values(Ge).includes(a[0].toUpperCase())?a[0].toUpperCase():Ge.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const o of a)t.anyOf.push({type:Object.values(Ge).includes(o.toUpperCase())?o.toUpperCase():Ge.TYPE_UNSPECIFIED})}}function qa(s){const t={},a=["items"],o=["anyOf"],c=["properties"];if(s.type&&s.anyOf)throw new Error("type and anyOf cannot be both populated.");const d=s.anyOf;d!=null&&d.length==2&&(d[0].type==="null"?(t.nullable=!0,s=d[1]):d[1].type==="null"&&(t.nullable=!0,s=d[0])),s.type instanceof Array&&Ry(s.type,t);for(const[p,g]of Object.entries(s))if(g!=null)if(p=="type"){if(g==="null")throw new Error("type: null can not be the only possible type for the field.");if(g instanceof Array)continue;t.type=Object.values(Ge).includes(g.toUpperCase())?g.toUpperCase():Ge.TYPE_UNSPECIFIED}else if(a.includes(p))t[p]=qa(g);else if(o.includes(p)){const v=[];for(const h of g){if(h.type=="null"){t.nullable=!0;continue}v.push(qa(h))}t[p]=v}else if(c.includes(p)){const v={};for(const[h,y]of Object.entries(g))v[h]=qa(y);t[p]=v}else{if(p==="additionalProperties")continue;t[p]=g}return t}function Eu(s){return qa(s)}function Cu(s){if(typeof s=="object")return s;if(typeof s=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:s}}};throw new Error(`Unsupported speechConfig type: ${typeof s}`)}function wu(s){if("multiSpeakerVoiceConfig"in s)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return s}function za(s){if(s.functionDeclarations)for(const t of s.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=qa(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=qa(t.response));return s}function Fa(s){if(s==null)throw new Error("tools is required");if(!Array.isArray(s))throw new Error("tools is required and must be an array of Tools");const t=[];for(const a of s)t.push(a);return t}function Iy(s,t,a,o=1){const c=!t.startsWith(`${a}/`)&&t.split("/").length===o;return s.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${s.getProject()}/${t}`:t.startsWith(`${a}/`)?`projects/${s.getProject()}/locations/${s.getLocation()}/${t}`:c?`projects/${s.getProject()}/locations/${s.getLocation()}/${a}/${t}`:t:c?`${a}/${t}`:t}function Qn(s,t){if(typeof t!="string")throw new Error("name must be a string");return Iy(s,t,"cachedContents")}function yg(s){switch(s){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return s}}function As(s){return bu(s)}function My(s){return s!=null&&typeof s=="object"&&"name"in s}function Dy(s){return s!=null&&typeof s=="object"&&"video"in s}function ky(s){return s!=null&&typeof s=="object"&&"uri"in s}function bg(s){var t;let a;if(My(s)&&(a=s.name),!(ky(s)&&(a=s.uri,a===void 0))&&!(Dy(s)&&(a=(t=s.video)===null||t===void 0?void 0:t.uri,a===void 0))){if(typeof s=="string"&&(a=s),a===void 0)throw new Error("Could not extract file name from the provided input.");if(a.startsWith("https://")){const c=a.split("files/")[1].match(/[a-z0-9]+/);if(c===null)throw new Error(`Could not extract file name from URI ${a}`);a=c[0]}else a.startsWith("files/")&&(a=a.split("files/")[1]);return a}}function Sg(s,t){let a;return s.isVertexAI()?a=t?"publishers/google/models":"models":a=t?"models":"tunedModels",a}function Tg(s){for(const t of["models","tunedModels","publisherModels"])if(jy(s,t))return s[t];return[]}function jy(s,t){return s!==null&&typeof s=="object"&&t in s}function Uy(s,t={}){const a=s,o={name:a.name,description:a.description,parametersJsonSchema:a.inputSchema};return a.outputSchema&&(o.responseJsonSchema=a.outputSchema),t.behavior&&(o.behavior=t.behavior),{functionDeclarations:[o]}}function Ly(s,t={}){const a=[],o=new Set;for(const c of s){const d=c.name;if(o.has(d))throw new Error(`Duplicate function name ${d} found in MCP tools. Please ensure function names are unique.`);o.add(d);const p=Uy(c,t);p.functionDeclarations&&a.push(...p.functionDeclarations)}return{functionDeclarations:a}}function Ng(s,t){let a;if(typeof t=="string")if(s.isVertexAI())if(t.startsWith("gs://"))a={format:"jsonl",gcsUri:[t]};else if(t.startsWith("bq://"))a={format:"bigquery",bigqueryUri:t};else throw new Error(`Unsupported string source for Vertex AI: ${t}`);else if(t.startsWith("files/"))a={fileName:t};else throw new Error(`Unsupported string source for Gemini API: ${t}`);else if(Array.isArray(t)){if(s.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");a={inlinedRequests:t}}else a=t;const o=[a.gcsUri,a.bigqueryUri].filter(Boolean).length,c=[a.inlinedRequests,a.fileName].filter(Boolean).length;if(s.isVertexAI()){if(c>0||o!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(o>0||c!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return a}function Gy(s){if(typeof s!="string")return s;const t=s;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}function Eg(s){if(typeof s!="object"||s===null)return{};const t=s,a=t.inlinedResponses;if(typeof a!="object"||a===null)return s;const c=a.inlinedResponses;if(!Array.isArray(c)||c.length===0)return s;let d=!1;for(const p of c){if(typeof p!="object"||p===null)continue;const v=p.response;if(typeof v!="object"||v===null)continue;if(v.embedding!==void 0){d=!0;break}}return d&&(t.inlinedEmbedContentResponses=t.inlinedResponses,delete t.inlinedResponses),s}function Ya(s,t){const a=t;if(!s.isVertexAI()){if(/batches\/[^/]+$/.test(a))return a.split("/").pop();throw new Error(`Invalid batch job name: ${a}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(a))return a.split("/").pop();if(/^\d+$/.test(a))return a;throw new Error(`Invalid batch job name: ${a}.`)}function Cg(s){const t=s;return t==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":t==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":t==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":t==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":t==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":t==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":t==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Oy(s){const t={},a=u(s,["responsesFile"]);a!=null&&f(t,["fileName"],a);const o=u(s,["inlinedResponses","inlinedResponses"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(p=>vb(p))),f(t,["inlinedResponses"],d)}const c=u(s,["inlinedEmbedContentResponses","inlinedResponses"]);if(c!=null){let d=c;Array.isArray(d)&&(d=d.map(p=>p)),f(t,["inlinedEmbedContentResponses"],d)}return t}function Py(s){const t={},a=u(s,["predictionsFormat"]);a!=null&&f(t,["format"],a);const o=u(s,["gcsDestination","outputUriPrefix"]);o!=null&&f(t,["gcsUri"],o);const c=u(s,["bigqueryDestination","outputUri"]);return c!=null&&f(t,["bigqueryUri"],c),t}function Hy(s){const t={},a=u(s,["format"]);a!=null&&f(t,["predictionsFormat"],a);const o=u(s,["gcsUri"]);o!=null&&f(t,["gcsDestination","outputUriPrefix"],o);const c=u(s,["bigqueryUri"]);if(c!=null&&f(t,["bigqueryDestination","outputUri"],c),u(s,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(u(s,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(u(s,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}function Si(s){const t={},a=u(s,["name"]);a!=null&&f(t,["name"],a);const o=u(s,["metadata","displayName"]);o!=null&&f(t,["displayName"],o);const c=u(s,["metadata","state"]);c!=null&&f(t,["state"],Cg(c));const d=u(s,["metadata","createTime"]);d!=null&&f(t,["createTime"],d);const p=u(s,["metadata","endTime"]);p!=null&&f(t,["endTime"],p);const g=u(s,["metadata","updateTime"]);g!=null&&f(t,["updateTime"],g);const v=u(s,["metadata","model"]);v!=null&&f(t,["model"],v);const h=u(s,["metadata","output"]);return h!=null&&f(t,["dest"],Oy(Eg(h))),t}function iu(s){const t={},a=u(s,["name"]);a!=null&&f(t,["name"],a);const o=u(s,["displayName"]);o!=null&&f(t,["displayName"],o);const c=u(s,["state"]);c!=null&&f(t,["state"],Cg(c));const d=u(s,["error"]);d!=null&&f(t,["error"],d);const p=u(s,["createTime"]);p!=null&&f(t,["createTime"],p);const g=u(s,["startTime"]);g!=null&&f(t,["startTime"],g);const v=u(s,["endTime"]);v!=null&&f(t,["endTime"],v);const h=u(s,["updateTime"]);h!=null&&f(t,["updateTime"],h);const y=u(s,["model"]);y!=null&&f(t,["model"],y);const b=u(s,["inputConfig"]);b!=null&&f(t,["src"],By(b));const S=u(s,["outputConfig"]);S!=null&&f(t,["dest"],Py(Eg(S)));const N=u(s,["completionStats"]);return N!=null&&f(t,["completionStats"],N),t}function By(s){const t={},a=u(s,["instancesFormat"]);a!=null&&f(t,["format"],a);const o=u(s,["gcsSource","uris"]);o!=null&&f(t,["gcsUri"],o);const c=u(s,["bigquerySource","inputUri"]);return c!=null&&f(t,["bigqueryUri"],c),t}function Vy(s,t){const a={};if(u(t,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(u(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(u(t,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const o=u(t,["fileName"]);o!=null&&f(a,["fileName"],o);const c=u(t,["inlinedRequests"]);if(c!=null){let d=c;Array.isArray(d)&&(d=d.map(p=>xb(s,p))),f(a,["requests","requests"],d)}return a}function qy(s){const t={},a=u(s,["format"]);a!=null&&f(t,["instancesFormat"],a);const o=u(s,["gcsUri"]);o!=null&&f(t,["gcsSource","uris"],o);const c=u(s,["bigqueryUri"]);if(c!=null&&f(t,["bigquerySource","inputUri"],c),u(s,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(u(s,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}function Jy(s){const t={},a=u(s,["data"]);if(a!=null&&f(t,["data"],a),u(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=u(s,["mimeType"]);return o!=null&&f(t,["mimeType"],o),t}function zy(s,t){const a={},o=u(t,["name"]);return o!=null&&f(a,["_url","name"],Ya(s,o)),a}function Fy(s,t){const a={},o=u(t,["name"]);return o!=null&&f(a,["_url","name"],Ya(s,o)),a}function Yy(s){const t={},a=u(s,["content"]);a!=null&&f(t,["content"],a);const o=u(s,["citationMetadata"]);o!=null&&f(t,["citationMetadata"],$y(o));const c=u(s,["tokenCount"]);c!=null&&f(t,["tokenCount"],c);const d=u(s,["finishReason"]);d!=null&&f(t,["finishReason"],d);const p=u(s,["avgLogprobs"]);p!=null&&f(t,["avgLogprobs"],p);const g=u(s,["groundingMetadata"]);g!=null&&f(t,["groundingMetadata"],g);const v=u(s,["index"]);v!=null&&f(t,["index"],v);const h=u(s,["logprobsResult"]);h!=null&&f(t,["logprobsResult"],h);const y=u(s,["safetyRatings"]);if(y!=null){let S=y;Array.isArray(S)&&(S=S.map(N=>N)),f(t,["safetyRatings"],S)}const b=u(s,["urlContextMetadata"]);return b!=null&&f(t,["urlContextMetadata"],b),t}function $y(s){const t={},a=u(s,["citationSources"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(c=>c)),f(t,["citations"],o)}return t}function wg(s){const t={},a=u(s,["parts"]);if(a!=null){let c=a;Array.isArray(c)&&(c=c.map(d=>Cb(d))),f(t,["parts"],c)}const o=u(s,["role"]);return o!=null&&f(t,["role"],o),t}function Ky(s,t){const a={},o=u(s,["displayName"]);if(t!==void 0&&o!=null&&f(t,["batch","displayName"],o),u(s,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return a}function Xy(s,t){const a={},o=u(s,["displayName"]);t!==void 0&&o!=null&&f(t,["displayName"],o);const c=u(s,["dest"]);return t!==void 0&&c!=null&&f(t,["outputConfig"],Hy(Gy(c))),a}function qh(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["_url","model"],Xe(s,o));const c=u(t,["src"]);c!=null&&f(a,["batch","inputConfig"],Vy(s,Ng(s,c)));const d=u(t,["config"]);return d!=null&&Ky(d,a),a}function Qy(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["model"],Xe(s,o));const c=u(t,["src"]);c!=null&&f(a,["inputConfig"],qy(Ng(s,c)));const d=u(t,["config"]);return d!=null&&Xy(d,a),a}function Wy(s,t){const a={},o=u(s,["displayName"]);return t!==void 0&&o!=null&&f(t,["batch","displayName"],o),a}function Zy(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["_url","model"],Xe(s,o));const c=u(t,["src"]);c!=null&&f(a,["batch","inputConfig"],ob(s,c));const d=u(t,["config"]);return d!=null&&Wy(d,a),a}function eb(s,t){const a={},o=u(t,["name"]);return o!=null&&f(a,["_url","name"],Ya(s,o)),a}function tb(s,t){const a={},o=u(t,["name"]);return o!=null&&f(a,["_url","name"],Ya(s,o)),a}function nb(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["name"]);o!=null&&f(t,["name"],o);const c=u(s,["done"]);c!=null&&f(t,["done"],c);const d=u(s,["error"]);return d!=null&&f(t,["error"],d),t}function sb(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["name"]);o!=null&&f(t,["name"],o);const c=u(s,["done"]);c!=null&&f(t,["done"],c);const d=u(s,["error"]);return d!=null&&f(t,["error"],d),t}function ab(s,t){const a={},o=u(t,["contents"]);if(o!=null){let d=Nu(s,o);Array.isArray(d)&&(d=d.map(p=>p)),f(a,["requests[]","request","content"],d)}const c=u(t,["config"]);return c!=null&&(f(a,["_self"],lb(c,a)),ty(a,{"requests[].*":"requests[].request.*"})),a}function lb(s,t){const a={},o=u(s,["taskType"]);t!==void 0&&o!=null&&f(t,["requests[]","taskType"],o);const c=u(s,["title"]);t!==void 0&&c!=null&&f(t,["requests[]","title"],c);const d=u(s,["outputDimensionality"]);if(t!==void 0&&d!=null&&f(t,["requests[]","outputDimensionality"],d),u(s,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(u(s,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return a}function ob(s,t){const a={},o=u(t,["fileName"]);o!=null&&f(a,["file_name"],o);const c=u(t,["inlinedRequests"]);return c!=null&&f(a,["requests"],ab(s,c)),a}function ib(s){const t={};if(u(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const a=u(s,["fileUri"]);a!=null&&f(t,["fileUri"],a);const o=u(s,["mimeType"]);return o!=null&&f(t,["mimeType"],o),t}function rb(s){const t={},a=u(s,["id"]);a!=null&&f(t,["id"],a);const o=u(s,["args"]);o!=null&&f(t,["args"],o);const c=u(s,["name"]);if(c!=null&&f(t,["name"],c),u(s,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(u(s,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function cb(s){const t={},a=u(s,["allowedFunctionNames"]);a!=null&&f(t,["allowedFunctionNames"],a);const o=u(s,["mode"]);if(o!=null&&f(t,["mode"],o),u(s,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function ub(s,t,a){const o={},c=u(t,["systemInstruction"]);a!==void 0&&c!=null&&f(a,["systemInstruction"],wg(jt(c)));const d=u(t,["temperature"]);d!=null&&f(o,["temperature"],d);const p=u(t,["topP"]);p!=null&&f(o,["topP"],p);const g=u(t,["topK"]);g!=null&&f(o,["topK"],g);const v=u(t,["candidateCount"]);v!=null&&f(o,["candidateCount"],v);const h=u(t,["maxOutputTokens"]);h!=null&&f(o,["maxOutputTokens"],h);const y=u(t,["stopSequences"]);y!=null&&f(o,["stopSequences"],y);const b=u(t,["responseLogprobs"]);b!=null&&f(o,["responseLogprobs"],b);const S=u(t,["logprobs"]);S!=null&&f(o,["logprobs"],S);const N=u(t,["presencePenalty"]);N!=null&&f(o,["presencePenalty"],N);const k=u(t,["frequencyPenalty"]);k!=null&&f(o,["frequencyPenalty"],k);const w=u(t,["seed"]);w!=null&&f(o,["seed"],w);const M=u(t,["responseMimeType"]);M!=null&&f(o,["responseMimeType"],M);const J=u(t,["responseSchema"]);J!=null&&f(o,["responseSchema"],Eu(J));const ce=u(t,["responseJsonSchema"]);if(ce!=null&&f(o,["responseJsonSchema"],ce),u(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(u(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const ee=u(t,["safetySettings"]);if(a!==void 0&&ee!=null){let oe=ee;Array.isArray(oe)&&(oe=oe.map(se=>wb(se))),f(a,["safetySettings"],oe)}const P=u(t,["tools"]);if(a!==void 0&&P!=null){let oe=Fa(P);Array.isArray(oe)&&(oe=oe.map(se=>_b(za(se)))),f(a,["tools"],oe)}const Q=u(t,["toolConfig"]);if(a!==void 0&&Q!=null&&f(a,["toolConfig"],Ab(Q)),u(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const H=u(t,["cachedContent"]);a!==void 0&&H!=null&&f(a,["cachedContent"],Qn(s,H));const V=u(t,["responseModalities"]);V!=null&&f(o,["responseModalities"],V);const q=u(t,["mediaResolution"]);q!=null&&f(o,["mediaResolution"],q);const X=u(t,["speechConfig"]);if(X!=null&&f(o,["speechConfig"],Cu(X)),u(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const fe=u(t,["thinkingConfig"]);fe!=null&&f(o,["thinkingConfig"],fe);const F=u(t,["imageConfig"]);F!=null&&f(o,["imageConfig"],gb(F));const re=u(t,["enableEnhancedCivicAnswers"]);return re!=null&&f(o,["enableEnhancedCivicAnswers"],re),o}function db(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["candidates"]);if(o!=null){let v=o;Array.isArray(v)&&(v=v.map(h=>Yy(h))),f(t,["candidates"],v)}const c=u(s,["modelVersion"]);c!=null&&f(t,["modelVersion"],c);const d=u(s,["promptFeedback"]);d!=null&&f(t,["promptFeedback"],d);const p=u(s,["responseId"]);p!=null&&f(t,["responseId"],p);const g=u(s,["usageMetadata"]);return g!=null&&f(t,["usageMetadata"],g),t}function fb(s,t){const a={},o=u(t,["name"]);return o!=null&&f(a,["_url","name"],Ya(s,o)),a}function pb(s,t){const a={},o=u(t,["name"]);return o!=null&&f(a,["_url","name"],Ya(s,o)),a}function mb(s){const t={};if(u(s,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const a=u(s,["enableWidget"]);return a!=null&&f(t,["enableWidget"],a),t}function hb(s){const t={};if(u(s,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(u(s,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const a=u(s,["timeRangeFilter"]);return a!=null&&f(t,["timeRangeFilter"],a),t}function gb(s){const t={},a=u(s,["aspectRatio"]);a!=null&&f(t,["aspectRatio"],a);const o=u(s,["imageSize"]);if(o!=null&&f(t,["imageSize"],o),u(s,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(u(s,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(u(s,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function xb(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["request","model"],Xe(s,o));const c=u(t,["contents"]);if(c!=null){let g=hn(c);Array.isArray(g)&&(g=g.map(v=>wg(v))),f(a,["request","contents"],g)}const d=u(t,["metadata"]);d!=null&&f(a,["metadata"],d);const p=u(t,["config"]);return p!=null&&f(a,["request","generationConfig"],ub(s,p,u(a,["request"],{}))),a}function vb(s){const t={},a=u(s,["response"]);a!=null&&f(t,["response"],db(a));const o=u(s,["error"]);return o!=null&&f(t,["error"],o),t}function yb(s,t){const a={},o=u(s,["pageSize"]);t!==void 0&&o!=null&&f(t,["_query","pageSize"],o);const c=u(s,["pageToken"]);if(t!==void 0&&c!=null&&f(t,["_query","pageToken"],c),u(s,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return a}function bb(s,t){const a={},o=u(s,["pageSize"]);t!==void 0&&o!=null&&f(t,["_query","pageSize"],o);const c=u(s,["pageToken"]);t!==void 0&&c!=null&&f(t,["_query","pageToken"],c);const d=u(s,["filter"]);return t!==void 0&&d!=null&&f(t,["_query","filter"],d),a}function Sb(s){const t={},a=u(s,["config"]);return a!=null&&yb(a,t),t}function Tb(s){const t={},a=u(s,["config"]);return a!=null&&bb(a,t),t}function Nb(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["nextPageToken"]);o!=null&&f(t,["nextPageToken"],o);const c=u(s,["operations"]);if(c!=null){let d=c;Array.isArray(d)&&(d=d.map(p=>Si(p))),f(t,["batchJobs"],d)}return t}function Eb(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["nextPageToken"]);o!=null&&f(t,["nextPageToken"],o);const c=u(s,["batchPredictionJobs"]);if(c!=null){let d=c;Array.isArray(d)&&(d=d.map(p=>iu(p))),f(t,["batchJobs"],d)}return t}function Cb(s){const t={},a=u(s,["mediaResolution"]);a!=null&&f(t,["mediaResolution"],a);const o=u(s,["codeExecutionResult"]);o!=null&&f(t,["codeExecutionResult"],o);const c=u(s,["executableCode"]);c!=null&&f(t,["executableCode"],c);const d=u(s,["fileData"]);d!=null&&f(t,["fileData"],ib(d));const p=u(s,["functionCall"]);p!=null&&f(t,["functionCall"],rb(p));const g=u(s,["functionResponse"]);g!=null&&f(t,["functionResponse"],g);const v=u(s,["inlineData"]);v!=null&&f(t,["inlineData"],Jy(v));const h=u(s,["text"]);h!=null&&f(t,["text"],h);const y=u(s,["thought"]);y!=null&&f(t,["thought"],y);const b=u(s,["thoughtSignature"]);b!=null&&f(t,["thoughtSignature"],b);const S=u(s,["videoMetadata"]);return S!=null&&f(t,["videoMetadata"],S),t}function wb(s){const t={},a=u(s,["category"]);if(a!=null&&f(t,["category"],a),u(s,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const o=u(s,["threshold"]);return o!=null&&f(t,["threshold"],o),t}function Ab(s){const t={},a=u(s,["retrievalConfig"]);a!=null&&f(t,["retrievalConfig"],a);const o=u(s,["functionCallingConfig"]);return o!=null&&f(t,["functionCallingConfig"],cb(o)),t}function _b(s){const t={};if(u(s,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const a=u(s,["computerUse"]);a!=null&&f(t,["computerUse"],a);const o=u(s,["fileSearch"]);o!=null&&f(t,["fileSearch"],o);const c=u(s,["codeExecution"]);if(c!=null&&f(t,["codeExecution"],c),u(s,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=u(s,["functionDeclarations"]);if(d!=null){let y=d;Array.isArray(y)&&(y=y.map(b=>b)),f(t,["functionDeclarations"],y)}const p=u(s,["googleMaps"]);p!=null&&f(t,["googleMaps"],mb(p));const g=u(s,["googleSearch"]);g!=null&&f(t,["googleSearch"],hb(g));const v=u(s,["googleSearchRetrieval"]);v!=null&&f(t,["googleSearchRetrieval"],v);const h=u(s,["urlContext"]);return h!=null&&f(t,["urlContext"],h),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Kn;(function(s){s.PAGED_ITEM_BATCH_JOBS="batchJobs",s.PAGED_ITEM_MODELS="models",s.PAGED_ITEM_TUNING_JOBS="tuningJobs",s.PAGED_ITEM_FILES="files",s.PAGED_ITEM_CACHED_CONTENTS="cachedContents",s.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",s.PAGED_ITEM_DOCUMENTS="documents"})(Kn||(Kn={}));class Qs{constructor(t,a,o,c){this.pageInternal=[],this.paramsInternal={},this.requestInternal=a,this.init(t,o,c)}init(t,a,o){var c,d;this.nameInternal=t,this.pageInternal=a[this.nameInternal]||[],this.sdkHttpResponseInternal=a==null?void 0:a.sdkHttpResponse,this.idxInternal=0;let p={config:{}};!o||Object.keys(o).length===0?p={config:{}}:typeof o=="object"?p=Object.assign({},o):p=o,p.config&&(p.config.pageToken=a.nextPageToken),this.paramsInternal=p,this.pageInternalSize=(d=(c=p.config)===null||c===void 0?void 0:c.pageSize)!==null&&d!==void 0?d:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Rb extends Xn{constructor(t){super(),this.apiClient=t,this.list=async(a={})=>new Qs(Kn.PAGED_ITEM_BATCH_JOBS,o=>this.listInternal(o),await this.listInternal(a),a),this.create=async a=>(this.apiClient.isVertexAI()&&(a.config=this.formatDestination(a.src,a.config)),this.createInternal(a)),this.createEmbeddings=async a=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(a)}}createInlinedGenerateContentRequest(t){const a=qh(this.apiClient,t),o=a._url,c=Te("{model}:batchGenerateContent",o),g=a.batch.inputConfig.requests,v=g.requests,h=[];for(const y of v){const b=Object.assign({},y);if(b.systemInstruction){const S=b.systemInstruction;delete b.systemInstruction;const N=b.request;N.systemInstruction=S,b.request=N}h.push(b)}return g.requests=h,delete a.config,delete a._url,delete a._query,{path:c,body:a}}getGcsUri(t){if(typeof t=="string")return t.startsWith("gs://")?t:void 0;if(!Array.isArray(t)&&t.gcsUri&&t.gcsUri.length>0)return t.gcsUri[0]}getBigqueryUri(t){if(typeof t=="string")return t.startsWith("bq://")?t:void 0;if(!Array.isArray(t))return t.bigqueryUri}formatDestination(t,a){const o=a?Object.assign({},a):{},c=Date.now().toString();if(o.displayName||(o.displayName=`genaiBatchJob_${c}`),o.dest===void 0){const d=this.getGcsUri(t),p=this.getBigqueryUri(t);if(d)d.endsWith(".jsonl")?o.dest=`${d.slice(0,-6)}/dest`:o.dest=`${d}_dest_${c}`;else if(p)o.dest=`${p}_dest_${c}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return o}async createInternal(t){var a,o,c,d;let p,g="",v={};if(this.apiClient.isVertexAI()){const h=Qy(this.apiClient,t);return g=Te("batchPredictionJobs",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json()),p.then(y=>iu(y))}else{const h=qh(this.apiClient,t);return g=Te("{model}:batchGenerateContent",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal}).then(y=>y.json()),p.then(y=>Si(y))}}async createEmbeddingsInternal(t){var a,o;let c,d="",p={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const g=Zy(this.apiClient,t);return d=Te("{model}:asyncBatchEmbedContent",g._url),p=g._query,delete g._url,delete g._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),c.then(v=>Si(v))}}async get(t){var a,o,c,d;let p,g="",v={};if(this.apiClient.isVertexAI()){const h=pb(this.apiClient,t);return g=Te("batchPredictionJobs/{name}",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json()),p.then(y=>iu(y))}else{const h=fb(this.apiClient,t);return g=Te("batches/{name}",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal}).then(y=>y.json()),p.then(y=>Si(y))}}async cancel(t){var a,o,c,d;let p="",g={};if(this.apiClient.isVertexAI()){const v=Fy(this.apiClient,t);p=Te("batchPredictionJobs/{name}:cancel",v._url),g=v._query,delete v._url,delete v._query,await this.apiClient.request({path:p,queryParams:g,body:JSON.stringify(v),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal})}else{const v=zy(this.apiClient,t);p=Te("batches/{name}:cancel",v._url),g=v._query,delete v._url,delete v._query,await this.apiClient.request({path:p,queryParams:g,body:JSON.stringify(v),httpMethod:"POST",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal})}}async listInternal(t){var a,o,c,d;let p,g="",v={};if(this.apiClient.isVertexAI()){const h=Tb(t);return g=Te("batchPredictionJobs",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>{const b=Eb(y),S=new Ph;return Object.assign(S,b),S})}else{const h=Sb(t);return g=Te("batches",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>{const b=Nb(y),S=new Ph;return Object.assign(S,b),S})}}async delete(t){var a,o,c,d;let p,g="",v={};if(this.apiClient.isVertexAI()){const h=tb(this.apiClient,t);return g=Te("batchPredictionJobs/{name}",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>sb(y))}else{const h=eb(this.apiClient,t);return g=Te("batches/{name}",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>nb(y))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ib(s){const t={},a=u(s,["data"]);if(a!=null&&f(t,["data"],a),u(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=u(s,["mimeType"]);return o!=null&&f(t,["mimeType"],o),t}function Jh(s){const t={},a=u(s,["parts"]);if(a!=null){let c=a;Array.isArray(c)&&(c=c.map(d=>Zb(d))),f(t,["parts"],c)}const o=u(s,["role"]);return o!=null&&f(t,["role"],o),t}function Mb(s,t){const a={},o=u(s,["ttl"]);t!==void 0&&o!=null&&f(t,["ttl"],o);const c=u(s,["expireTime"]);t!==void 0&&c!=null&&f(t,["expireTime"],c);const d=u(s,["displayName"]);t!==void 0&&d!=null&&f(t,["displayName"],d);const p=u(s,["contents"]);if(t!==void 0&&p!=null){let y=hn(p);Array.isArray(y)&&(y=y.map(b=>Jh(b))),f(t,["contents"],y)}const g=u(s,["systemInstruction"]);t!==void 0&&g!=null&&f(t,["systemInstruction"],Jh(jt(g)));const v=u(s,["tools"]);if(t!==void 0&&v!=null){let y=v;Array.isArray(y)&&(y=y.map(b=>tS(b))),f(t,["tools"],y)}const h=u(s,["toolConfig"]);if(t!==void 0&&h!=null&&f(t,["toolConfig"],eS(h)),u(s,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return a}function Db(s,t){const a={},o=u(s,["ttl"]);t!==void 0&&o!=null&&f(t,["ttl"],o);const c=u(s,["expireTime"]);t!==void 0&&c!=null&&f(t,["expireTime"],c);const d=u(s,["displayName"]);t!==void 0&&d!=null&&f(t,["displayName"],d);const p=u(s,["contents"]);if(t!==void 0&&p!=null){let b=hn(p);Array.isArray(b)&&(b=b.map(S=>S)),f(t,["contents"],b)}const g=u(s,["systemInstruction"]);t!==void 0&&g!=null&&f(t,["systemInstruction"],jt(g));const v=u(s,["tools"]);if(t!==void 0&&v!=null){let b=v;Array.isArray(b)&&(b=b.map(S=>nS(S))),f(t,["tools"],b)}const h=u(s,["toolConfig"]);t!==void 0&&h!=null&&f(t,["toolConfig"],h);const y=u(s,["kmsKeyName"]);return t!==void 0&&y!=null&&f(t,["encryption_spec","kmsKeyName"],y),a}function kb(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["model"],mg(s,o));const c=u(t,["config"]);return c!=null&&Mb(c,a),a}function jb(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["model"],mg(s,o));const c=u(t,["config"]);return c!=null&&Db(c,a),a}function Ub(s,t){const a={},o=u(t,["name"]);return o!=null&&f(a,["_url","name"],Qn(s,o)),a}function Lb(s,t){const a={},o=u(t,["name"]);return o!=null&&f(a,["_url","name"],Qn(s,o)),a}function Gb(s){const t={},a=u(s,["sdkHttpResponse"]);return a!=null&&f(t,["sdkHttpResponse"],a),t}function Ob(s){const t={},a=u(s,["sdkHttpResponse"]);return a!=null&&f(t,["sdkHttpResponse"],a),t}function Pb(s){const t={};if(u(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const a=u(s,["fileUri"]);a!=null&&f(t,["fileUri"],a);const o=u(s,["mimeType"]);return o!=null&&f(t,["mimeType"],o),t}function Hb(s){const t={},a=u(s,["id"]);a!=null&&f(t,["id"],a);const o=u(s,["args"]);o!=null&&f(t,["args"],o);const c=u(s,["name"]);if(c!=null&&f(t,["name"],c),u(s,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(u(s,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function Bb(s){const t={},a=u(s,["allowedFunctionNames"]);a!=null&&f(t,["allowedFunctionNames"],a);const o=u(s,["mode"]);if(o!=null&&f(t,["mode"],o),u(s,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function Vb(s){const t={},a=u(s,["description"]);a!=null&&f(t,["description"],a);const o=u(s,["name"]);o!=null&&f(t,["name"],o);const c=u(s,["parameters"]);c!=null&&f(t,["parameters"],c);const d=u(s,["parametersJsonSchema"]);d!=null&&f(t,["parametersJsonSchema"],d);const p=u(s,["response"]);p!=null&&f(t,["response"],p);const g=u(s,["responseJsonSchema"]);if(g!=null&&f(t,["responseJsonSchema"],g),u(s,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return t}function qb(s,t){const a={},o=u(t,["name"]);return o!=null&&f(a,["_url","name"],Qn(s,o)),a}function Jb(s,t){const a={},o=u(t,["name"]);return o!=null&&f(a,["_url","name"],Qn(s,o)),a}function zb(s){const t={};if(u(s,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const a=u(s,["enableWidget"]);return a!=null&&f(t,["enableWidget"],a),t}function Fb(s){const t={};if(u(s,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(u(s,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const a=u(s,["timeRangeFilter"]);return a!=null&&f(t,["timeRangeFilter"],a),t}function Yb(s,t){const a={},o=u(s,["pageSize"]);t!==void 0&&o!=null&&f(t,["_query","pageSize"],o);const c=u(s,["pageToken"]);return t!==void 0&&c!=null&&f(t,["_query","pageToken"],c),a}function $b(s,t){const a={},o=u(s,["pageSize"]);t!==void 0&&o!=null&&f(t,["_query","pageSize"],o);const c=u(s,["pageToken"]);return t!==void 0&&c!=null&&f(t,["_query","pageToken"],c),a}function Kb(s){const t={},a=u(s,["config"]);return a!=null&&Yb(a,t),t}function Xb(s){const t={},a=u(s,["config"]);return a!=null&&$b(a,t),t}function Qb(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["nextPageToken"]);o!=null&&f(t,["nextPageToken"],o);const c=u(s,["cachedContents"]);if(c!=null){let d=c;Array.isArray(d)&&(d=d.map(p=>p)),f(t,["cachedContents"],d)}return t}function Wb(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["nextPageToken"]);o!=null&&f(t,["nextPageToken"],o);const c=u(s,["cachedContents"]);if(c!=null){let d=c;Array.isArray(d)&&(d=d.map(p=>p)),f(t,["cachedContents"],d)}return t}function Zb(s){const t={},a=u(s,["mediaResolution"]);a!=null&&f(t,["mediaResolution"],a);const o=u(s,["codeExecutionResult"]);o!=null&&f(t,["codeExecutionResult"],o);const c=u(s,["executableCode"]);c!=null&&f(t,["executableCode"],c);const d=u(s,["fileData"]);d!=null&&f(t,["fileData"],Pb(d));const p=u(s,["functionCall"]);p!=null&&f(t,["functionCall"],Hb(p));const g=u(s,["functionResponse"]);g!=null&&f(t,["functionResponse"],g);const v=u(s,["inlineData"]);v!=null&&f(t,["inlineData"],Ib(v));const h=u(s,["text"]);h!=null&&f(t,["text"],h);const y=u(s,["thought"]);y!=null&&f(t,["thought"],y);const b=u(s,["thoughtSignature"]);b!=null&&f(t,["thoughtSignature"],b);const S=u(s,["videoMetadata"]);return S!=null&&f(t,["videoMetadata"],S),t}function eS(s){const t={},a=u(s,["retrievalConfig"]);a!=null&&f(t,["retrievalConfig"],a);const o=u(s,["functionCallingConfig"]);return o!=null&&f(t,["functionCallingConfig"],Bb(o)),t}function tS(s){const t={};if(u(s,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const a=u(s,["computerUse"]);a!=null&&f(t,["computerUse"],a);const o=u(s,["fileSearch"]);o!=null&&f(t,["fileSearch"],o);const c=u(s,["codeExecution"]);if(c!=null&&f(t,["codeExecution"],c),u(s,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=u(s,["functionDeclarations"]);if(d!=null){let y=d;Array.isArray(y)&&(y=y.map(b=>b)),f(t,["functionDeclarations"],y)}const p=u(s,["googleMaps"]);p!=null&&f(t,["googleMaps"],zb(p));const g=u(s,["googleSearch"]);g!=null&&f(t,["googleSearch"],Fb(g));const v=u(s,["googleSearchRetrieval"]);v!=null&&f(t,["googleSearchRetrieval"],v);const h=u(s,["urlContext"]);return h!=null&&f(t,["urlContext"],h),t}function nS(s){const t={},a=u(s,["retrieval"]);a!=null&&f(t,["retrieval"],a);const o=u(s,["computerUse"]);if(o!=null&&f(t,["computerUse"],o),u(s,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const c=u(s,["codeExecution"]);c!=null&&f(t,["codeExecution"],c);const d=u(s,["enterpriseWebSearch"]);d!=null&&f(t,["enterpriseWebSearch"],d);const p=u(s,["functionDeclarations"]);if(p!=null){let b=p;Array.isArray(b)&&(b=b.map(S=>Vb(S))),f(t,["functionDeclarations"],b)}const g=u(s,["googleMaps"]);g!=null&&f(t,["googleMaps"],g);const v=u(s,["googleSearch"]);v!=null&&f(t,["googleSearch"],v);const h=u(s,["googleSearchRetrieval"]);h!=null&&f(t,["googleSearchRetrieval"],h);const y=u(s,["urlContext"]);return y!=null&&f(t,["urlContext"],y),t}function sS(s,t){const a={},o=u(s,["ttl"]);t!==void 0&&o!=null&&f(t,["ttl"],o);const c=u(s,["expireTime"]);return t!==void 0&&c!=null&&f(t,["expireTime"],c),a}function aS(s,t){const a={},o=u(s,["ttl"]);t!==void 0&&o!=null&&f(t,["ttl"],o);const c=u(s,["expireTime"]);return t!==void 0&&c!=null&&f(t,["expireTime"],c),a}function lS(s,t){const a={},o=u(t,["name"]);o!=null&&f(a,["_url","name"],Qn(s,o));const c=u(t,["config"]);return c!=null&&sS(c,a),a}function oS(s,t){const a={},o=u(t,["name"]);o!=null&&f(a,["_url","name"],Qn(s,o));const c=u(t,["config"]);return c!=null&&aS(c,a),a}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class iS extends Xn{constructor(t){super(),this.apiClient=t,this.list=async(a={})=>new Qs(Kn.PAGED_ITEM_CACHED_CONTENTS,o=>this.listInternal(o),await this.listInternal(a),a)}async create(t){var a,o,c,d;let p,g="",v={};if(this.apiClient.isVertexAI()){const h=jb(this.apiClient,t);return g=Te("cachedContents",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json()),p.then(y=>y)}else{const h=kb(this.apiClient,t);return g=Te("cachedContents",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal}).then(y=>y.json()),p.then(y=>y)}}async get(t){var a,o,c,d;let p,g="",v={};if(this.apiClient.isVertexAI()){const h=Jb(this.apiClient,t);return g=Te("{name}",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json()),p.then(y=>y)}else{const h=qb(this.apiClient,t);return g=Te("{name}",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal}).then(y=>y.json()),p.then(y=>y)}}async delete(t){var a,o,c,d;let p,g="",v={};if(this.apiClient.isVertexAI()){const h=Lb(this.apiClient,t);return g=Te("{name}",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>{const b=Ob(y),S=new Gh;return Object.assign(S,b),S})}else{const h=Ub(this.apiClient,t);return g=Te("{name}",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>{const b=Gb(y),S=new Gh;return Object.assign(S,b),S})}}async update(t){var a,o,c,d;let p,g="",v={};if(this.apiClient.isVertexAI()){const h=oS(this.apiClient,t);return g=Te("{name}",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json()),p.then(y=>y)}else{const h=lS(this.apiClient,t);return g=Te("{name}",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal}).then(y=>y.json()),p.then(y=>y)}}async listInternal(t){var a,o,c,d;let p,g="",v={};if(this.apiClient.isVertexAI()){const h=Xb(t);return g=Te("cachedContents",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>{const b=Wb(y),S=new Oh;return Object.assign(S,b),S})}else{const h=Kb(t);return g=Te("cachedContents",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>{const b=Qb(y),S=new Oh;return Object.assign(S,b),S})}}}function Ai(s,t){var a={};for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&t.indexOf(o)<0&&(a[o]=s[o]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,o=Object.getOwnPropertySymbols(s);c<o.length;c++)t.indexOf(o[c])<0&&Object.prototype.propertyIsEnumerable.call(s,o[c])&&(a[o[c]]=s[o[c]]);return a}function zh(s){var t=typeof Symbol=="function"&&Symbol.iterator,a=t&&s[t],o=0;if(a)return a.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&o>=s.length&&(s=void 0),{value:s&&s[o++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ue(s){return this instanceof Ue?(this.v=s,this):new Ue(s)}function bn(s,t,a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=a.apply(s,t||[]),c,d=[];return c=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),g("next"),g("throw"),g("return",p),c[Symbol.asyncIterator]=function(){return this},c;function p(N){return function(k){return Promise.resolve(k).then(N,b)}}function g(N,k){o[N]&&(c[N]=function(w){return new Promise(function(M,J){d.push([N,w,M,J])>1||v(N,w)})},k&&(c[N]=k(c[N])))}function v(N,k){try{h(o[N](k))}catch(w){S(d[0][3],w)}}function h(N){N.value instanceof Ue?Promise.resolve(N.value.v).then(y,b):S(d[0][2],N)}function y(N){v("next",N)}function b(N){v("throw",N)}function S(N,k){N(k),d.shift(),d.length&&v(d[0][0],d[0][1])}}function Sn(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=s[Symbol.asyncIterator],a;return t?t.call(s):(s=typeof zh=="function"?zh(s):s[Symbol.iterator](),a={},o("next"),o("throw"),o("return"),a[Symbol.asyncIterator]=function(){return this},a);function o(d){a[d]=s[d]&&function(p){return new Promise(function(g,v){p=s[d](p),c(g,v,p.done,p.value)})}}function c(d,p,g,v){Promise.resolve(v).then(function(h){d({value:h,done:g})},p)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rS(s){var t;if(s.candidates==null||s.candidates.length===0)return!1;const a=(t=s.candidates[0])===null||t===void 0?void 0:t.content;return a===void 0?!1:Ag(a)}function Ag(s){if(s.parts===void 0||s.parts.length===0)return!1;for(const t of s.parts)if(t===void 0||Object.keys(t).length===0)return!1;return!0}function cS(s){if(s.length!==0){for(const t of s)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function Fh(s){if(s===void 0||s.length===0)return[];const t=[],a=s.length;let o=0;for(;o<a;)if(s[o].role==="user")t.push(s[o]),o++;else{const c=[];let d=!0;for(;o<a&&s[o].role==="model";)c.push(s[o]),d&&!Ag(s[o])&&(d=!1),o++;d?t.push(...c):t.pop()}return t}class uS{constructor(t,a){this.modelsModule=t,this.apiClient=a}create(t){return new dS(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class dS{constructor(t,a,o,c={},d=[]){this.apiClient=t,this.modelsModule=a,this.model=o,this.config=c,this.history=d,this.sendPromise=Promise.resolve(),cS(d)}async sendMessage(t){var a;await this.sendPromise;const o=jt(t.message),c=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(o),config:(a=t.config)!==null&&a!==void 0?a:this.config});return this.sendPromise=(async()=>{var d,p,g;const v=await c,h=(p=(d=v.candidates)===null||d===void 0?void 0:d[0])===null||p===void 0?void 0:p.content,y=v.automaticFunctionCallingHistory,b=this.getHistory(!0).length;let S=[];y!=null&&(S=(g=y.slice(b))!==null&&g!==void 0?g:[]);const N=h?[h]:[];this.recordHistory(o,N,S)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),c}async sendMessageStream(t){var a;await this.sendPromise;const o=jt(t.message),c=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(o),config:(a=t.config)!==null&&a!==void 0?a:this.config});this.sendPromise=c.then(()=>{}).catch(()=>{});const d=await c;return this.processStreamResponse(d,o)}getHistory(t=!1){const a=t?Fh(this.history):this.history;return structuredClone(a)}processStreamResponse(t,a){return bn(this,arguments,function*(){var c,d,p,g,v,h;const y=[];try{for(var b=!0,S=Sn(t),N;N=yield Ue(S.next()),c=N.done,!c;b=!0){g=N.value,b=!1;const k=g;if(rS(k)){const w=(h=(v=k.candidates)===null||v===void 0?void 0:v[0])===null||h===void 0?void 0:h.content;w!==void 0&&y.push(w)}yield yield Ue(k)}}catch(k){d={error:k}}finally{try{!b&&!c&&(p=S.return)&&(yield Ue(p.call(S)))}finally{if(d)throw d.error}}this.recordHistory(a,y)})}recordHistory(t,a,o){let c=[];a.length>0&&a.every(d=>d.role!==void 0)?c=a:c.push({role:"model",parts:[]}),o&&o.length>0?this.history.push(...Fh(o)):this.history.push(t),this.history.push(...c)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ii extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,Ii.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function fS(s){const t={},a=u(s,["file"]);return a!=null&&f(t,["file"],a),t}function pS(s){const t={},a=u(s,["sdkHttpResponse"]);return a!=null&&f(t,["sdkHttpResponse"],a),t}function mS(s){const t={},a=u(s,["name"]);return a!=null&&f(t,["_url","file"],bg(a)),t}function hS(s){const t={},a=u(s,["sdkHttpResponse"]);return a!=null&&f(t,["sdkHttpResponse"],a),t}function gS(s){const t={},a=u(s,["name"]);return a!=null&&f(t,["_url","file"],bg(a)),t}function xS(s,t){const a={},o=u(s,["pageSize"]);t!==void 0&&o!=null&&f(t,["_query","pageSize"],o);const c=u(s,["pageToken"]);return t!==void 0&&c!=null&&f(t,["_query","pageToken"],c),a}function vS(s){const t={},a=u(s,["config"]);return a!=null&&xS(a,t),t}function yS(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["nextPageToken"]);o!=null&&f(t,["nextPageToken"],o);const c=u(s,["files"]);if(c!=null){let d=c;Array.isArray(d)&&(d=d.map(p=>p)),f(t,["files"],d)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class bS extends Xn{constructor(t){super(),this.apiClient=t,this.list=async(a={})=>new Qs(Kn.PAGED_ITEM_FILES,o=>this.listInternal(o),await this.listInternal(a),a)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(a=>a)}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var a,o;let c,d="",p={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const g=vS(t);return d=Te("files",g._url),p=g._query,delete g._url,delete g._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(g),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(h=>{const y=h;return y.sdkHttpResponse={headers:v.headers},y})),c.then(v=>{const h=yS(v),y=new Ey;return Object.assign(y,h),y})}}async createInternal(t){var a,o;let c,d="",p={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const g=fS(t);return d=Te("upload/v1beta/files",g._url),p=g._query,delete g._url,delete g._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),c.then(v=>{const h=pS(v),y=new Cy;return Object.assign(y,h),y})}}async get(t){var a,o;let c,d="",p={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const g=gS(t);return d=Te("files/{file}",g._url),p=g._query,delete g._url,delete g._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(g),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),c.then(v=>v)}}async delete(t){var a,o;let c,d="",p={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const g=mS(t);return d=Te("files/{file}",g._url),p=g._query,delete g._url,delete g._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(g),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(h=>{const y=h;return y.sdkHttpResponse={headers:v.headers},y})),c.then(v=>{const h=hS(v),y=new wy;return Object.assign(y,h),y})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ti(s){const t={},a=u(s,["data"]);if(a!=null&&f(t,["data"],a),u(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=u(s,["mimeType"]);return o!=null&&f(t,["mimeType"],o),t}function SS(s){const t={},a=u(s,["parts"]);if(a!=null){let c=a;Array.isArray(c)&&(c=c.map(d=>GS(d))),f(t,["parts"],c)}const o=u(s,["role"]);return o!=null&&f(t,["role"],o),t}function TS(s){const t={};if(u(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const a=u(s,["fileUri"]);a!=null&&f(t,["fileUri"],a);const o=u(s,["mimeType"]);return o!=null&&f(t,["mimeType"],o),t}function NS(s){const t={},a=u(s,["id"]);a!=null&&f(t,["id"],a);const o=u(s,["args"]);o!=null&&f(t,["args"],o);const c=u(s,["name"]);if(c!=null&&f(t,["name"],c),u(s,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(u(s,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function ES(s){const t={},a=u(s,["description"]);a!=null&&f(t,["description"],a);const o=u(s,["name"]);o!=null&&f(t,["name"],o);const c=u(s,["parameters"]);c!=null&&f(t,["parameters"],c);const d=u(s,["parametersJsonSchema"]);d!=null&&f(t,["parametersJsonSchema"],d);const p=u(s,["response"]);p!=null&&f(t,["response"],p);const g=u(s,["responseJsonSchema"]);if(g!=null&&f(t,["responseJsonSchema"],g),u(s,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return t}function CS(s){const t={},a=u(s,["modelSelectionConfig"]);a!=null&&f(t,["modelConfig"],a);const o=u(s,["responseJsonSchema"]);o!=null&&f(t,["responseJsonSchema"],o);const c=u(s,["audioTimestamp"]);c!=null&&f(t,["audioTimestamp"],c);const d=u(s,["candidateCount"]);d!=null&&f(t,["candidateCount"],d);const p=u(s,["enableAffectiveDialog"]);p!=null&&f(t,["enableAffectiveDialog"],p);const g=u(s,["frequencyPenalty"]);g!=null&&f(t,["frequencyPenalty"],g);const v=u(s,["logprobs"]);v!=null&&f(t,["logprobs"],v);const h=u(s,["maxOutputTokens"]);h!=null&&f(t,["maxOutputTokens"],h);const y=u(s,["mediaResolution"]);y!=null&&f(t,["mediaResolution"],y);const b=u(s,["presencePenalty"]);b!=null&&f(t,["presencePenalty"],b);const S=u(s,["responseLogprobs"]);S!=null&&f(t,["responseLogprobs"],S);const N=u(s,["responseMimeType"]);N!=null&&f(t,["responseMimeType"],N);const k=u(s,["responseModalities"]);k!=null&&f(t,["responseModalities"],k);const w=u(s,["responseSchema"]);w!=null&&f(t,["responseSchema"],w);const M=u(s,["routingConfig"]);M!=null&&f(t,["routingConfig"],M);const J=u(s,["seed"]);J!=null&&f(t,["seed"],J);const ce=u(s,["speechConfig"]);ce!=null&&f(t,["speechConfig"],ce);const ee=u(s,["stopSequences"]);ee!=null&&f(t,["stopSequences"],ee);const P=u(s,["temperature"]);P!=null&&f(t,["temperature"],P);const Q=u(s,["thinkingConfig"]);Q!=null&&f(t,["thinkingConfig"],Q);const H=u(s,["topK"]);H!=null&&f(t,["topK"],H);const V=u(s,["topP"]);if(V!=null&&f(t,["topP"],V),u(s,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function wS(s){const t={};if(u(s,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const a=u(s,["enableWidget"]);return a!=null&&f(t,["enableWidget"],a),t}function AS(s){const t={};if(u(s,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(u(s,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const a=u(s,["timeRangeFilter"]);return a!=null&&f(t,["timeRangeFilter"],a),t}function _S(s,t){const a={},o=u(s,["generationConfig"]);t!==void 0&&o!=null&&f(t,["setup","generationConfig"],o);const c=u(s,["responseModalities"]);t!==void 0&&c!=null&&f(t,["setup","generationConfig","responseModalities"],c);const d=u(s,["temperature"]);t!==void 0&&d!=null&&f(t,["setup","generationConfig","temperature"],d);const p=u(s,["topP"]);t!==void 0&&p!=null&&f(t,["setup","generationConfig","topP"],p);const g=u(s,["topK"]);t!==void 0&&g!=null&&f(t,["setup","generationConfig","topK"],g);const v=u(s,["maxOutputTokens"]);t!==void 0&&v!=null&&f(t,["setup","generationConfig","maxOutputTokens"],v);const h=u(s,["mediaResolution"]);t!==void 0&&h!=null&&f(t,["setup","generationConfig","mediaResolution"],h);const y=u(s,["seed"]);t!==void 0&&y!=null&&f(t,["setup","generationConfig","seed"],y);const b=u(s,["speechConfig"]);t!==void 0&&b!=null&&f(t,["setup","generationConfig","speechConfig"],wu(b));const S=u(s,["thinkingConfig"]);t!==void 0&&S!=null&&f(t,["setup","generationConfig","thinkingConfig"],S);const N=u(s,["enableAffectiveDialog"]);t!==void 0&&N!=null&&f(t,["setup","generationConfig","enableAffectiveDialog"],N);const k=u(s,["systemInstruction"]);t!==void 0&&k!=null&&f(t,["setup","systemInstruction"],SS(jt(k)));const w=u(s,["tools"]);if(t!==void 0&&w!=null){let H=Fa(w);Array.isArray(H)&&(H=H.map(V=>PS(za(V)))),f(t,["setup","tools"],H)}const M=u(s,["sessionResumption"]);t!==void 0&&M!=null&&f(t,["setup","sessionResumption"],OS(M));const J=u(s,["inputAudioTranscription"]);t!==void 0&&J!=null&&f(t,["setup","inputAudioTranscription"],J);const ce=u(s,["outputAudioTranscription"]);t!==void 0&&ce!=null&&f(t,["setup","outputAudioTranscription"],ce);const ee=u(s,["realtimeInputConfig"]);t!==void 0&&ee!=null&&f(t,["setup","realtimeInputConfig"],ee);const P=u(s,["contextWindowCompression"]);t!==void 0&&P!=null&&f(t,["setup","contextWindowCompression"],P);const Q=u(s,["proactivity"]);if(t!==void 0&&Q!=null&&f(t,["setup","proactivity"],Q),u(s,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return a}function RS(s,t){const a={},o=u(s,["generationConfig"]);t!==void 0&&o!=null&&f(t,["setup","generationConfig"],CS(o));const c=u(s,["responseModalities"]);t!==void 0&&c!=null&&f(t,["setup","generationConfig","responseModalities"],c);const d=u(s,["temperature"]);t!==void 0&&d!=null&&f(t,["setup","generationConfig","temperature"],d);const p=u(s,["topP"]);t!==void 0&&p!=null&&f(t,["setup","generationConfig","topP"],p);const g=u(s,["topK"]);t!==void 0&&g!=null&&f(t,["setup","generationConfig","topK"],g);const v=u(s,["maxOutputTokens"]);t!==void 0&&v!=null&&f(t,["setup","generationConfig","maxOutputTokens"],v);const h=u(s,["mediaResolution"]);t!==void 0&&h!=null&&f(t,["setup","generationConfig","mediaResolution"],h);const y=u(s,["seed"]);t!==void 0&&y!=null&&f(t,["setup","generationConfig","seed"],y);const b=u(s,["speechConfig"]);t!==void 0&&b!=null&&f(t,["setup","generationConfig","speechConfig"],wu(b));const S=u(s,["thinkingConfig"]);t!==void 0&&S!=null&&f(t,["setup","generationConfig","thinkingConfig"],S);const N=u(s,["enableAffectiveDialog"]);t!==void 0&&N!=null&&f(t,["setup","generationConfig","enableAffectiveDialog"],N);const k=u(s,["systemInstruction"]);t!==void 0&&k!=null&&f(t,["setup","systemInstruction"],jt(k));const w=u(s,["tools"]);if(t!==void 0&&w!=null){let V=Fa(w);Array.isArray(V)&&(V=V.map(q=>HS(za(q)))),f(t,["setup","tools"],V)}const M=u(s,["sessionResumption"]);t!==void 0&&M!=null&&f(t,["setup","sessionResumption"],M);const J=u(s,["inputAudioTranscription"]);t!==void 0&&J!=null&&f(t,["setup","inputAudioTranscription"],J);const ce=u(s,["outputAudioTranscription"]);t!==void 0&&ce!=null&&f(t,["setup","outputAudioTranscription"],ce);const ee=u(s,["realtimeInputConfig"]);t!==void 0&&ee!=null&&f(t,["setup","realtimeInputConfig"],ee);const P=u(s,["contextWindowCompression"]);t!==void 0&&P!=null&&f(t,["setup","contextWindowCompression"],P);const Q=u(s,["proactivity"]);t!==void 0&&Q!=null&&f(t,["setup","proactivity"],Q);const H=u(s,["explicitVadSignal"]);return t!==void 0&&H!=null&&f(t,["setup","explicitVadSignal"],H),a}function IS(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["setup","model"],Xe(s,o));const c=u(t,["config"]);return c!=null&&f(a,["config"],_S(c,a)),a}function MS(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["setup","model"],Xe(s,o));const c=u(t,["config"]);return c!=null&&f(a,["config"],RS(c,a)),a}function DS(s){const t={},a=u(s,["musicGenerationConfig"]);return a!=null&&f(t,["musicGenerationConfig"],a),t}function kS(s){const t={},a=u(s,["weightedPrompts"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(c=>c)),f(t,["weightedPrompts"],o)}return t}function jS(s){const t={},a=u(s,["media"]);if(a!=null){let h=hg(a);Array.isArray(h)&&(h=h.map(y=>Ti(y))),f(t,["mediaChunks"],h)}const o=u(s,["audio"]);o!=null&&f(t,["audio"],Ti(xg(o)));const c=u(s,["audioStreamEnd"]);c!=null&&f(t,["audioStreamEnd"],c);const d=u(s,["video"]);d!=null&&f(t,["video"],Ti(gg(d)));const p=u(s,["text"]);p!=null&&f(t,["text"],p);const g=u(s,["activityStart"]);g!=null&&f(t,["activityStart"],g);const v=u(s,["activityEnd"]);return v!=null&&f(t,["activityEnd"],v),t}function US(s){const t={},a=u(s,["media"]);if(a!=null){let h=hg(a);Array.isArray(h)&&(h=h.map(y=>y)),f(t,["mediaChunks"],h)}const o=u(s,["audio"]);o!=null&&f(t,["audio"],xg(o));const c=u(s,["audioStreamEnd"]);c!=null&&f(t,["audioStreamEnd"],c);const d=u(s,["video"]);d!=null&&f(t,["video"],gg(d));const p=u(s,["text"]);p!=null&&f(t,["text"],p);const g=u(s,["activityStart"]);g!=null&&f(t,["activityStart"],g);const v=u(s,["activityEnd"]);return v!=null&&f(t,["activityEnd"],v),t}function LS(s){const t={},a=u(s,["setupComplete"]);a!=null&&f(t,["setupComplete"],a);const o=u(s,["serverContent"]);o!=null&&f(t,["serverContent"],o);const c=u(s,["toolCall"]);c!=null&&f(t,["toolCall"],c);const d=u(s,["toolCallCancellation"]);d!=null&&f(t,["toolCallCancellation"],d);const p=u(s,["usageMetadata"]);p!=null&&f(t,["usageMetadata"],BS(p));const g=u(s,["goAway"]);g!=null&&f(t,["goAway"],g);const v=u(s,["sessionResumptionUpdate"]);v!=null&&f(t,["sessionResumptionUpdate"],v);const h=u(s,["voiceActivityDetectionSignal"]);return h!=null&&f(t,["voiceActivityDetectionSignal"],h),t}function GS(s){const t={},a=u(s,["mediaResolution"]);a!=null&&f(t,["mediaResolution"],a);const o=u(s,["codeExecutionResult"]);o!=null&&f(t,["codeExecutionResult"],o);const c=u(s,["executableCode"]);c!=null&&f(t,["executableCode"],c);const d=u(s,["fileData"]);d!=null&&f(t,["fileData"],TS(d));const p=u(s,["functionCall"]);p!=null&&f(t,["functionCall"],NS(p));const g=u(s,["functionResponse"]);g!=null&&f(t,["functionResponse"],g);const v=u(s,["inlineData"]);v!=null&&f(t,["inlineData"],Ti(v));const h=u(s,["text"]);h!=null&&f(t,["text"],h);const y=u(s,["thought"]);y!=null&&f(t,["thought"],y);const b=u(s,["thoughtSignature"]);b!=null&&f(t,["thoughtSignature"],b);const S=u(s,["videoMetadata"]);return S!=null&&f(t,["videoMetadata"],S),t}function OS(s){const t={},a=u(s,["handle"]);if(a!=null&&f(t,["handle"],a),u(s,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function PS(s){const t={};if(u(s,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const a=u(s,["computerUse"]);a!=null&&f(t,["computerUse"],a);const o=u(s,["fileSearch"]);o!=null&&f(t,["fileSearch"],o);const c=u(s,["codeExecution"]);if(c!=null&&f(t,["codeExecution"],c),u(s,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=u(s,["functionDeclarations"]);if(d!=null){let y=d;Array.isArray(y)&&(y=y.map(b=>b)),f(t,["functionDeclarations"],y)}const p=u(s,["googleMaps"]);p!=null&&f(t,["googleMaps"],wS(p));const g=u(s,["googleSearch"]);g!=null&&f(t,["googleSearch"],AS(g));const v=u(s,["googleSearchRetrieval"]);v!=null&&f(t,["googleSearchRetrieval"],v);const h=u(s,["urlContext"]);return h!=null&&f(t,["urlContext"],h),t}function HS(s){const t={},a=u(s,["retrieval"]);a!=null&&f(t,["retrieval"],a);const o=u(s,["computerUse"]);if(o!=null&&f(t,["computerUse"],o),u(s,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const c=u(s,["codeExecution"]);c!=null&&f(t,["codeExecution"],c);const d=u(s,["enterpriseWebSearch"]);d!=null&&f(t,["enterpriseWebSearch"],d);const p=u(s,["functionDeclarations"]);if(p!=null){let b=p;Array.isArray(b)&&(b=b.map(S=>ES(S))),f(t,["functionDeclarations"],b)}const g=u(s,["googleMaps"]);g!=null&&f(t,["googleMaps"],g);const v=u(s,["googleSearch"]);v!=null&&f(t,["googleSearch"],v);const h=u(s,["googleSearchRetrieval"]);h!=null&&f(t,["googleSearchRetrieval"],h);const y=u(s,["urlContext"]);return y!=null&&f(t,["urlContext"],y),t}function BS(s){const t={},a=u(s,["promptTokenCount"]);a!=null&&f(t,["promptTokenCount"],a);const o=u(s,["cachedContentTokenCount"]);o!=null&&f(t,["cachedContentTokenCount"],o);const c=u(s,["candidatesTokenCount"]);c!=null&&f(t,["responseTokenCount"],c);const d=u(s,["toolUsePromptTokenCount"]);d!=null&&f(t,["toolUsePromptTokenCount"],d);const p=u(s,["thoughtsTokenCount"]);p!=null&&f(t,["thoughtsTokenCount"],p);const g=u(s,["totalTokenCount"]);g!=null&&f(t,["totalTokenCount"],g);const v=u(s,["promptTokensDetails"]);if(v!=null){let N=v;Array.isArray(N)&&(N=N.map(k=>k)),f(t,["promptTokensDetails"],N)}const h=u(s,["cacheTokensDetails"]);if(h!=null){let N=h;Array.isArray(N)&&(N=N.map(k=>k)),f(t,["cacheTokensDetails"],N)}const y=u(s,["candidatesTokensDetails"]);if(y!=null){let N=y;Array.isArray(N)&&(N=N.map(k=>k)),f(t,["responseTokensDetails"],N)}const b=u(s,["toolUsePromptTokensDetails"]);if(b!=null){let N=b;Array.isArray(N)&&(N=N.map(k=>k)),f(t,["toolUsePromptTokensDetails"],N)}const S=u(s,["trafficType"]);return S!=null&&f(t,["trafficType"],S),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function VS(s){const t={},a=u(s,["data"]);if(a!=null&&f(t,["data"],a),u(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=u(s,["mimeType"]);return o!=null&&f(t,["mimeType"],o),t}function qS(s){const t={},a=u(s,["content"]);a!=null&&f(t,["content"],a);const o=u(s,["citationMetadata"]);o!=null&&f(t,["citationMetadata"],JS(o));const c=u(s,["tokenCount"]);c!=null&&f(t,["tokenCount"],c);const d=u(s,["finishReason"]);d!=null&&f(t,["finishReason"],d);const p=u(s,["avgLogprobs"]);p!=null&&f(t,["avgLogprobs"],p);const g=u(s,["groundingMetadata"]);g!=null&&f(t,["groundingMetadata"],g);const v=u(s,["index"]);v!=null&&f(t,["index"],v);const h=u(s,["logprobsResult"]);h!=null&&f(t,["logprobsResult"],h);const y=u(s,["safetyRatings"]);if(y!=null){let S=y;Array.isArray(S)&&(S=S.map(N=>N)),f(t,["safetyRatings"],S)}const b=u(s,["urlContextMetadata"]);return b!=null&&f(t,["urlContextMetadata"],b),t}function JS(s){const t={},a=u(s,["citationSources"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(c=>c)),f(t,["citations"],o)}return t}function zS(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["_url","model"],Xe(s,o));const c=u(t,["contents"]);if(c!=null){let d=hn(c);Array.isArray(d)&&(d=d.map(p=>p)),f(a,["contents"],d)}return a}function FS(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["tokensInfo"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(d=>d)),f(t,["tokensInfo"],c)}return t}function YS(s){const t={},a=u(s,["values"]);a!=null&&f(t,["values"],a);const o=u(s,["statistics"]);return o!=null&&f(t,["statistics"],$S(o)),t}function $S(s){const t={},a=u(s,["truncated"]);a!=null&&f(t,["truncated"],a);const o=u(s,["token_count"]);return o!=null&&f(t,["tokenCount"],o),t}function Mi(s){const t={},a=u(s,["parts"]);if(a!=null){let c=a;Array.isArray(c)&&(c=c.map(d=>sN(d))),f(t,["parts"],c)}const o=u(s,["role"]);return o!=null&&f(t,["role"],o),t}function KS(s){const t={},a=u(s,["controlType"]);a!=null&&f(t,["controlType"],a);const o=u(s,["enableControlImageComputation"]);return o!=null&&f(t,["computeControl"],o),t}function XS(s){const t={};if(u(s,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(u(s,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(u(s,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function QS(s,t){const a={},o=u(s,["systemInstruction"]);t!==void 0&&o!=null&&f(t,["systemInstruction"],jt(o));const c=u(s,["tools"]);if(t!==void 0&&c!=null){let p=c;Array.isArray(p)&&(p=p.map(g=>Mg(g))),f(t,["tools"],p)}const d=u(s,["generationConfig"]);return t!==void 0&&d!=null&&f(t,["generationConfig"],VT(d)),a}function WS(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["_url","model"],Xe(s,o));const c=u(t,["contents"]);if(c!=null){let p=hn(c);Array.isArray(p)&&(p=p.map(g=>Mi(g))),f(a,["contents"],p)}const d=u(t,["config"]);return d!=null&&XS(d),a}function ZS(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["_url","model"],Xe(s,o));const c=u(t,["contents"]);if(c!=null){let p=hn(c);Array.isArray(p)&&(p=p.map(g=>g)),f(a,["contents"],p)}const d=u(t,["config"]);return d!=null&&QS(d,a),a}function eT(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["totalTokens"]);o!=null&&f(t,["totalTokens"],o);const c=u(s,["cachedContentTokenCount"]);return c!=null&&f(t,["cachedContentTokenCount"],c),t}function tT(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["totalTokens"]);return o!=null&&f(t,["totalTokens"],o),t}function nT(s,t){const a={},o=u(t,["model"]);return o!=null&&f(a,["_url","name"],Xe(s,o)),a}function sT(s,t){const a={},o=u(t,["model"]);return o!=null&&f(a,["_url","name"],Xe(s,o)),a}function aT(s){const t={},a=u(s,["sdkHttpResponse"]);return a!=null&&f(t,["sdkHttpResponse"],a),t}function lT(s){const t={},a=u(s,["sdkHttpResponse"]);return a!=null&&f(t,["sdkHttpResponse"],a),t}function oT(s,t){const a={},o=u(s,["outputGcsUri"]);t!==void 0&&o!=null&&f(t,["parameters","storageUri"],o);const c=u(s,["negativePrompt"]);t!==void 0&&c!=null&&f(t,["parameters","negativePrompt"],c);const d=u(s,["numberOfImages"]);t!==void 0&&d!=null&&f(t,["parameters","sampleCount"],d);const p=u(s,["aspectRatio"]);t!==void 0&&p!=null&&f(t,["parameters","aspectRatio"],p);const g=u(s,["guidanceScale"]);t!==void 0&&g!=null&&f(t,["parameters","guidanceScale"],g);const v=u(s,["seed"]);t!==void 0&&v!=null&&f(t,["parameters","seed"],v);const h=u(s,["safetyFilterLevel"]);t!==void 0&&h!=null&&f(t,["parameters","safetySetting"],h);const y=u(s,["personGeneration"]);t!==void 0&&y!=null&&f(t,["parameters","personGeneration"],y);const b=u(s,["includeSafetyAttributes"]);t!==void 0&&b!=null&&f(t,["parameters","includeSafetyAttributes"],b);const S=u(s,["includeRaiReason"]);t!==void 0&&S!=null&&f(t,["parameters","includeRaiReason"],S);const N=u(s,["language"]);t!==void 0&&N!=null&&f(t,["parameters","language"],N);const k=u(s,["outputMimeType"]);t!==void 0&&k!=null&&f(t,["parameters","outputOptions","mimeType"],k);const w=u(s,["outputCompressionQuality"]);t!==void 0&&w!=null&&f(t,["parameters","outputOptions","compressionQuality"],w);const M=u(s,["addWatermark"]);t!==void 0&&M!=null&&f(t,["parameters","addWatermark"],M);const J=u(s,["labels"]);t!==void 0&&J!=null&&f(t,["labels"],J);const ce=u(s,["editMode"]);t!==void 0&&ce!=null&&f(t,["parameters","editMode"],ce);const ee=u(s,["baseSteps"]);return t!==void 0&&ee!=null&&f(t,["parameters","editConfig","baseSteps"],ee),a}function iT(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["_url","model"],Xe(s,o));const c=u(t,["prompt"]);c!=null&&f(a,["instances[0]","prompt"],c);const d=u(t,["referenceImages"]);if(d!=null){let g=d;Array.isArray(g)&&(g=g.map(v=>cN(v))),f(a,["instances[0]","referenceImages"],g)}const p=u(t,["config"]);return p!=null&&oT(p,a),a}function rT(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["predictions"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(d=>Di(d))),f(t,["generatedImages"],c)}return t}function cT(s,t){const a={},o=u(s,["taskType"]);t!==void 0&&o!=null&&f(t,["requests[]","taskType"],o);const c=u(s,["title"]);t!==void 0&&c!=null&&f(t,["requests[]","title"],c);const d=u(s,["outputDimensionality"]);if(t!==void 0&&d!=null&&f(t,["requests[]","outputDimensionality"],d),u(s,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(u(s,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return a}function uT(s,t){const a={},o=u(s,["taskType"]);t!==void 0&&o!=null&&f(t,["instances[]","task_type"],o);const c=u(s,["title"]);t!==void 0&&c!=null&&f(t,["instances[]","title"],c);const d=u(s,["outputDimensionality"]);t!==void 0&&d!=null&&f(t,["parameters","outputDimensionality"],d);const p=u(s,["mimeType"]);t!==void 0&&p!=null&&f(t,["instances[]","mimeType"],p);const g=u(s,["autoTruncate"]);return t!==void 0&&g!=null&&f(t,["parameters","autoTruncate"],g),a}function dT(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["_url","model"],Xe(s,o));const c=u(t,["contents"]);if(c!=null){let g=Nu(s,c);Array.isArray(g)&&(g=g.map(v=>v)),f(a,["requests[]","content"],g)}const d=u(t,["config"]);d!=null&&cT(d,a);const p=u(t,["model"]);return p!==void 0&&f(a,["requests[]","model"],Xe(s,p)),a}function fT(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["_url","model"],Xe(s,o));const c=u(t,["contents"]);if(c!=null){let p=Nu(s,c);Array.isArray(p)&&(p=p.map(g=>g)),f(a,["instances[]","content"],p)}const d=u(t,["config"]);return d!=null&&uT(d,a),a}function pT(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["embeddings"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(p=>p)),f(t,["embeddings"],d)}const c=u(s,["metadata"]);return c!=null&&f(t,["metadata"],c),t}function mT(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["predictions[]","embeddings"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(p=>YS(p))),f(t,["embeddings"],d)}const c=u(s,["metadata"]);return c!=null&&f(t,["metadata"],c),t}function hT(s){const t={},a=u(s,["endpoint"]);a!=null&&f(t,["name"],a);const o=u(s,["deployedModelId"]);return o!=null&&f(t,["deployedModelId"],o),t}function gT(s){const t={};if(u(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const a=u(s,["fileUri"]);a!=null&&f(t,["fileUri"],a);const o=u(s,["mimeType"]);return o!=null&&f(t,["mimeType"],o),t}function xT(s){const t={},a=u(s,["id"]);a!=null&&f(t,["id"],a);const o=u(s,["args"]);o!=null&&f(t,["args"],o);const c=u(s,["name"]);if(c!=null&&f(t,["name"],c),u(s,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(u(s,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function vT(s){const t={},a=u(s,["allowedFunctionNames"]);a!=null&&f(t,["allowedFunctionNames"],a);const o=u(s,["mode"]);if(o!=null&&f(t,["mode"],o),u(s,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function yT(s){const t={},a=u(s,["description"]);a!=null&&f(t,["description"],a);const o=u(s,["name"]);o!=null&&f(t,["name"],o);const c=u(s,["parameters"]);c!=null&&f(t,["parameters"],c);const d=u(s,["parametersJsonSchema"]);d!=null&&f(t,["parametersJsonSchema"],d);const p=u(s,["response"]);p!=null&&f(t,["response"],p);const g=u(s,["responseJsonSchema"]);if(g!=null&&f(t,["responseJsonSchema"],g),u(s,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return t}function bT(s,t,a){const o={},c=u(t,["systemInstruction"]);a!==void 0&&c!=null&&f(a,["systemInstruction"],Mi(jt(c)));const d=u(t,["temperature"]);d!=null&&f(o,["temperature"],d);const p=u(t,["topP"]);p!=null&&f(o,["topP"],p);const g=u(t,["topK"]);g!=null&&f(o,["topK"],g);const v=u(t,["candidateCount"]);v!=null&&f(o,["candidateCount"],v);const h=u(t,["maxOutputTokens"]);h!=null&&f(o,["maxOutputTokens"],h);const y=u(t,["stopSequences"]);y!=null&&f(o,["stopSequences"],y);const b=u(t,["responseLogprobs"]);b!=null&&f(o,["responseLogprobs"],b);const S=u(t,["logprobs"]);S!=null&&f(o,["logprobs"],S);const N=u(t,["presencePenalty"]);N!=null&&f(o,["presencePenalty"],N);const k=u(t,["frequencyPenalty"]);k!=null&&f(o,["frequencyPenalty"],k);const w=u(t,["seed"]);w!=null&&f(o,["seed"],w);const M=u(t,["responseMimeType"]);M!=null&&f(o,["responseMimeType"],M);const J=u(t,["responseSchema"]);J!=null&&f(o,["responseSchema"],Eu(J));const ce=u(t,["responseJsonSchema"]);if(ce!=null&&f(o,["responseJsonSchema"],ce),u(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(u(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const ee=u(t,["safetySettings"]);if(a!==void 0&&ee!=null){let oe=ee;Array.isArray(oe)&&(oe=oe.map(se=>uN(se))),f(a,["safetySettings"],oe)}const P=u(t,["tools"]);if(a!==void 0&&P!=null){let oe=Fa(P);Array.isArray(oe)&&(oe=oe.map(se=>xN(za(se)))),f(a,["tools"],oe)}const Q=u(t,["toolConfig"]);if(a!==void 0&&Q!=null&&f(a,["toolConfig"],gN(Q)),u(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const H=u(t,["cachedContent"]);a!==void 0&&H!=null&&f(a,["cachedContent"],Qn(s,H));const V=u(t,["responseModalities"]);V!=null&&f(o,["responseModalities"],V);const q=u(t,["mediaResolution"]);q!=null&&f(o,["mediaResolution"],q);const X=u(t,["speechConfig"]);if(X!=null&&f(o,["speechConfig"],Cu(X)),u(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const fe=u(t,["thinkingConfig"]);fe!=null&&f(o,["thinkingConfig"],fe);const F=u(t,["imageConfig"]);F!=null&&f(o,["imageConfig"],YT(F));const re=u(t,["enableEnhancedCivicAnswers"]);return re!=null&&f(o,["enableEnhancedCivicAnswers"],re),o}function ST(s,t,a){const o={},c=u(t,["systemInstruction"]);a!==void 0&&c!=null&&f(a,["systemInstruction"],jt(c));const d=u(t,["temperature"]);d!=null&&f(o,["temperature"],d);const p=u(t,["topP"]);p!=null&&f(o,["topP"],p);const g=u(t,["topK"]);g!=null&&f(o,["topK"],g);const v=u(t,["candidateCount"]);v!=null&&f(o,["candidateCount"],v);const h=u(t,["maxOutputTokens"]);h!=null&&f(o,["maxOutputTokens"],h);const y=u(t,["stopSequences"]);y!=null&&f(o,["stopSequences"],y);const b=u(t,["responseLogprobs"]);b!=null&&f(o,["responseLogprobs"],b);const S=u(t,["logprobs"]);S!=null&&f(o,["logprobs"],S);const N=u(t,["presencePenalty"]);N!=null&&f(o,["presencePenalty"],N);const k=u(t,["frequencyPenalty"]);k!=null&&f(o,["frequencyPenalty"],k);const w=u(t,["seed"]);w!=null&&f(o,["seed"],w);const M=u(t,["responseMimeType"]);M!=null&&f(o,["responseMimeType"],M);const J=u(t,["responseSchema"]);J!=null&&f(o,["responseSchema"],Eu(J));const ce=u(t,["responseJsonSchema"]);ce!=null&&f(o,["responseJsonSchema"],ce);const ee=u(t,["routingConfig"]);ee!=null&&f(o,["routingConfig"],ee);const P=u(t,["modelSelectionConfig"]);P!=null&&f(o,["modelConfig"],P);const Q=u(t,["safetySettings"]);if(a!==void 0&&Q!=null){let A=Q;Array.isArray(A)&&(A=A.map(U=>U)),f(a,["safetySettings"],A)}const H=u(t,["tools"]);if(a!==void 0&&H!=null){let A=Fa(H);Array.isArray(A)&&(A=A.map(U=>Mg(za(U)))),f(a,["tools"],A)}const V=u(t,["toolConfig"]);a!==void 0&&V!=null&&f(a,["toolConfig"],V);const q=u(t,["labels"]);a!==void 0&&q!=null&&f(a,["labels"],q);const X=u(t,["cachedContent"]);a!==void 0&&X!=null&&f(a,["cachedContent"],Qn(s,X));const fe=u(t,["responseModalities"]);fe!=null&&f(o,["responseModalities"],fe);const F=u(t,["mediaResolution"]);F!=null&&f(o,["mediaResolution"],F);const re=u(t,["speechConfig"]);re!=null&&f(o,["speechConfig"],Cu(re));const oe=u(t,["audioTimestamp"]);oe!=null&&f(o,["audioTimestamp"],oe);const se=u(t,["thinkingConfig"]);se!=null&&f(o,["thinkingConfig"],se);const ae=u(t,["imageConfig"]);if(ae!=null&&f(o,["imageConfig"],$T(ae)),u(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return o}function Yh(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["_url","model"],Xe(s,o));const c=u(t,["contents"]);if(c!=null){let p=hn(c);Array.isArray(p)&&(p=p.map(g=>Mi(g))),f(a,["contents"],p)}const d=u(t,["config"]);return d!=null&&f(a,["generationConfig"],bT(s,d,a)),a}function $h(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["_url","model"],Xe(s,o));const c=u(t,["contents"]);if(c!=null){let p=hn(c);Array.isArray(p)&&(p=p.map(g=>g)),f(a,["contents"],p)}const d=u(t,["config"]);return d!=null&&f(a,["generationConfig"],ST(s,d,a)),a}function Kh(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["candidates"]);if(o!=null){let v=o;Array.isArray(v)&&(v=v.map(h=>qS(h))),f(t,["candidates"],v)}const c=u(s,["modelVersion"]);c!=null&&f(t,["modelVersion"],c);const d=u(s,["promptFeedback"]);d!=null&&f(t,["promptFeedback"],d);const p=u(s,["responseId"]);p!=null&&f(t,["responseId"],p);const g=u(s,["usageMetadata"]);return g!=null&&f(t,["usageMetadata"],g),t}function Xh(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["candidates"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(y=>y)),f(t,["candidates"],h)}const c=u(s,["createTime"]);c!=null&&f(t,["createTime"],c);const d=u(s,["modelVersion"]);d!=null&&f(t,["modelVersion"],d);const p=u(s,["promptFeedback"]);p!=null&&f(t,["promptFeedback"],p);const g=u(s,["responseId"]);g!=null&&f(t,["responseId"],g);const v=u(s,["usageMetadata"]);return v!=null&&f(t,["usageMetadata"],v),t}function TT(s,t){const a={};if(u(s,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(u(s,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const o=u(s,["numberOfImages"]);t!==void 0&&o!=null&&f(t,["parameters","sampleCount"],o);const c=u(s,["aspectRatio"]);t!==void 0&&c!=null&&f(t,["parameters","aspectRatio"],c);const d=u(s,["guidanceScale"]);if(t!==void 0&&d!=null&&f(t,["parameters","guidanceScale"],d),u(s,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const p=u(s,["safetyFilterLevel"]);t!==void 0&&p!=null&&f(t,["parameters","safetySetting"],p);const g=u(s,["personGeneration"]);t!==void 0&&g!=null&&f(t,["parameters","personGeneration"],g);const v=u(s,["includeSafetyAttributes"]);t!==void 0&&v!=null&&f(t,["parameters","includeSafetyAttributes"],v);const h=u(s,["includeRaiReason"]);t!==void 0&&h!=null&&f(t,["parameters","includeRaiReason"],h);const y=u(s,["language"]);t!==void 0&&y!=null&&f(t,["parameters","language"],y);const b=u(s,["outputMimeType"]);t!==void 0&&b!=null&&f(t,["parameters","outputOptions","mimeType"],b);const S=u(s,["outputCompressionQuality"]);if(t!==void 0&&S!=null&&f(t,["parameters","outputOptions","compressionQuality"],S),u(s,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(u(s,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const N=u(s,["imageSize"]);if(t!==void 0&&N!=null&&f(t,["parameters","sampleImageSize"],N),u(s,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return a}function NT(s,t){const a={},o=u(s,["outputGcsUri"]);t!==void 0&&o!=null&&f(t,["parameters","storageUri"],o);const c=u(s,["negativePrompt"]);t!==void 0&&c!=null&&f(t,["parameters","negativePrompt"],c);const d=u(s,["numberOfImages"]);t!==void 0&&d!=null&&f(t,["parameters","sampleCount"],d);const p=u(s,["aspectRatio"]);t!==void 0&&p!=null&&f(t,["parameters","aspectRatio"],p);const g=u(s,["guidanceScale"]);t!==void 0&&g!=null&&f(t,["parameters","guidanceScale"],g);const v=u(s,["seed"]);t!==void 0&&v!=null&&f(t,["parameters","seed"],v);const h=u(s,["safetyFilterLevel"]);t!==void 0&&h!=null&&f(t,["parameters","safetySetting"],h);const y=u(s,["personGeneration"]);t!==void 0&&y!=null&&f(t,["parameters","personGeneration"],y);const b=u(s,["includeSafetyAttributes"]);t!==void 0&&b!=null&&f(t,["parameters","includeSafetyAttributes"],b);const S=u(s,["includeRaiReason"]);t!==void 0&&S!=null&&f(t,["parameters","includeRaiReason"],S);const N=u(s,["language"]);t!==void 0&&N!=null&&f(t,["parameters","language"],N);const k=u(s,["outputMimeType"]);t!==void 0&&k!=null&&f(t,["parameters","outputOptions","mimeType"],k);const w=u(s,["outputCompressionQuality"]);t!==void 0&&w!=null&&f(t,["parameters","outputOptions","compressionQuality"],w);const M=u(s,["addWatermark"]);t!==void 0&&M!=null&&f(t,["parameters","addWatermark"],M);const J=u(s,["labels"]);t!==void 0&&J!=null&&f(t,["labels"],J);const ce=u(s,["imageSize"]);t!==void 0&&ce!=null&&f(t,["parameters","sampleImageSize"],ce);const ee=u(s,["enhancePrompt"]);return t!==void 0&&ee!=null&&f(t,["parameters","enhancePrompt"],ee),a}function ET(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["_url","model"],Xe(s,o));const c=u(t,["prompt"]);c!=null&&f(a,["instances[0]","prompt"],c);const d=u(t,["config"]);return d!=null&&TT(d,a),a}function CT(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["_url","model"],Xe(s,o));const c=u(t,["prompt"]);c!=null&&f(a,["instances[0]","prompt"],c);const d=u(t,["config"]);return d!=null&&NT(d,a),a}function wT(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["predictions"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(p=>OT(p))),f(t,["generatedImages"],d)}const c=u(s,["positivePromptSafetyAttributes"]);return c!=null&&f(t,["positivePromptSafetyAttributes"],Rg(c)),t}function AT(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["predictions"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(p=>Di(p))),f(t,["generatedImages"],d)}const c=u(s,["positivePromptSafetyAttributes"]);return c!=null&&f(t,["positivePromptSafetyAttributes"],Ig(c)),t}function _T(s,t){const a={},o=u(s,["numberOfVideos"]);if(t!==void 0&&o!=null&&f(t,["parameters","sampleCount"],o),u(s,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(u(s,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const c=u(s,["durationSeconds"]);if(t!==void 0&&c!=null&&f(t,["parameters","durationSeconds"],c),u(s,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const d=u(s,["aspectRatio"]);t!==void 0&&d!=null&&f(t,["parameters","aspectRatio"],d);const p=u(s,["resolution"]);t!==void 0&&p!=null&&f(t,["parameters","resolution"],p);const g=u(s,["personGeneration"]);if(t!==void 0&&g!=null&&f(t,["parameters","personGeneration"],g),u(s,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const v=u(s,["negativePrompt"]);t!==void 0&&v!=null&&f(t,["parameters","negativePrompt"],v);const h=u(s,["enhancePrompt"]);if(t!==void 0&&h!=null&&f(t,["parameters","enhancePrompt"],h),u(s,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const y=u(s,["lastFrame"]);t!==void 0&&y!=null&&f(t,["instances[0]","lastFrame"],ki(y));const b=u(s,["referenceImages"]);if(t!==void 0&&b!=null){let S=b;Array.isArray(S)&&(S=S.map(N=>IN(N))),f(t,["instances[0]","referenceImages"],S)}if(u(s,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(u(s,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return a}function RT(s,t){const a={},o=u(s,["numberOfVideos"]);t!==void 0&&o!=null&&f(t,["parameters","sampleCount"],o);const c=u(s,["outputGcsUri"]);t!==void 0&&c!=null&&f(t,["parameters","storageUri"],c);const d=u(s,["fps"]);t!==void 0&&d!=null&&f(t,["parameters","fps"],d);const p=u(s,["durationSeconds"]);t!==void 0&&p!=null&&f(t,["parameters","durationSeconds"],p);const g=u(s,["seed"]);t!==void 0&&g!=null&&f(t,["parameters","seed"],g);const v=u(s,["aspectRatio"]);t!==void 0&&v!=null&&f(t,["parameters","aspectRatio"],v);const h=u(s,["resolution"]);t!==void 0&&h!=null&&f(t,["parameters","resolution"],h);const y=u(s,["personGeneration"]);t!==void 0&&y!=null&&f(t,["parameters","personGeneration"],y);const b=u(s,["pubsubTopic"]);t!==void 0&&b!=null&&f(t,["parameters","pubsubTopic"],b);const S=u(s,["negativePrompt"]);t!==void 0&&S!=null&&f(t,["parameters","negativePrompt"],S);const N=u(s,["enhancePrompt"]);t!==void 0&&N!=null&&f(t,["parameters","enhancePrompt"],N);const k=u(s,["generateAudio"]);t!==void 0&&k!=null&&f(t,["parameters","generateAudio"],k);const w=u(s,["lastFrame"]);t!==void 0&&w!=null&&f(t,["instances[0]","lastFrame"],Tn(w));const M=u(s,["referenceImages"]);if(t!==void 0&&M!=null){let ee=M;Array.isArray(ee)&&(ee=ee.map(P=>MN(P))),f(t,["instances[0]","referenceImages"],ee)}const J=u(s,["mask"]);t!==void 0&&J!=null&&f(t,["instances[0]","mask"],RN(J));const ce=u(s,["compressionQuality"]);return t!==void 0&&ce!=null&&f(t,["parameters","compressionQuality"],ce),a}function IT(s){const t={},a=u(s,["name"]);a!=null&&f(t,["name"],a);const o=u(s,["metadata"]);o!=null&&f(t,["metadata"],o);const c=u(s,["done"]);c!=null&&f(t,["done"],c);const d=u(s,["error"]);d!=null&&f(t,["error"],d);const p=u(s,["response","generateVideoResponse"]);return p!=null&&f(t,["response"],jT(p)),t}function MT(s){const t={},a=u(s,["name"]);a!=null&&f(t,["name"],a);const o=u(s,["metadata"]);o!=null&&f(t,["metadata"],o);const c=u(s,["done"]);c!=null&&f(t,["done"],c);const d=u(s,["error"]);d!=null&&f(t,["error"],d);const p=u(s,["response"]);return p!=null&&f(t,["response"],UT(p)),t}function DT(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["_url","model"],Xe(s,o));const c=u(t,["prompt"]);c!=null&&f(a,["instances[0]","prompt"],c);const d=u(t,["image"]);d!=null&&f(a,["instances[0]","image"],ki(d));const p=u(t,["video"]);p!=null&&f(a,["instances[0]","video"],Dg(p));const g=u(t,["source"]);g!=null&&LT(g,a);const v=u(t,["config"]);return v!=null&&_T(v,a),a}function kT(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["_url","model"],Xe(s,o));const c=u(t,["prompt"]);c!=null&&f(a,["instances[0]","prompt"],c);const d=u(t,["image"]);d!=null&&f(a,["instances[0]","image"],Tn(d));const p=u(t,["video"]);p!=null&&f(a,["instances[0]","video"],kg(p));const g=u(t,["source"]);g!=null&&GT(g,a);const v=u(t,["config"]);return v!=null&&RT(v,a),a}function jT(s){const t={},a=u(s,["generatedSamples"]);if(a!=null){let d=a;Array.isArray(d)&&(d=d.map(p=>HT(p))),f(t,["generatedVideos"],d)}const o=u(s,["raiMediaFilteredCount"]);o!=null&&f(t,["raiMediaFilteredCount"],o);const c=u(s,["raiMediaFilteredReasons"]);return c!=null&&f(t,["raiMediaFilteredReasons"],c),t}function UT(s){const t={},a=u(s,["videos"]);if(a!=null){let d=a;Array.isArray(d)&&(d=d.map(p=>BT(p))),f(t,["generatedVideos"],d)}const o=u(s,["raiMediaFilteredCount"]);o!=null&&f(t,["raiMediaFilteredCount"],o);const c=u(s,["raiMediaFilteredReasons"]);return c!=null&&f(t,["raiMediaFilteredReasons"],c),t}function LT(s,t){const a={},o=u(s,["prompt"]);t!==void 0&&o!=null&&f(t,["instances[0]","prompt"],o);const c=u(s,["image"]);t!==void 0&&c!=null&&f(t,["instances[0]","image"],ki(c));const d=u(s,["video"]);return t!==void 0&&d!=null&&f(t,["instances[0]","video"],Dg(d)),a}function GT(s,t){const a={},o=u(s,["prompt"]);t!==void 0&&o!=null&&f(t,["instances[0]","prompt"],o);const c=u(s,["image"]);t!==void 0&&c!=null&&f(t,["instances[0]","image"],Tn(c));const d=u(s,["video"]);return t!==void 0&&d!=null&&f(t,["instances[0]","video"],kg(d)),a}function OT(s){const t={},a=u(s,["_self"]);a!=null&&f(t,["image"],KT(a));const o=u(s,["raiFilteredReason"]);o!=null&&f(t,["raiFilteredReason"],o);const c=u(s,["_self"]);return c!=null&&f(t,["safetyAttributes"],Rg(c)),t}function Di(s){const t={},a=u(s,["_self"]);a!=null&&f(t,["image"],_g(a));const o=u(s,["raiFilteredReason"]);o!=null&&f(t,["raiFilteredReason"],o);const c=u(s,["_self"]);c!=null&&f(t,["safetyAttributes"],Ig(c));const d=u(s,["prompt"]);return d!=null&&f(t,["enhancedPrompt"],d),t}function PT(s){const t={},a=u(s,["_self"]);a!=null&&f(t,["mask"],_g(a));const o=u(s,["labels"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(d=>d)),f(t,["labels"],c)}return t}function HT(s){const t={},a=u(s,["video"]);return a!=null&&f(t,["video"],AN(a)),t}function BT(s){const t={},a=u(s,["_self"]);return a!=null&&f(t,["video"],_N(a)),t}function VT(s){const t={},a=u(s,["modelSelectionConfig"]);a!=null&&f(t,["modelConfig"],a);const o=u(s,["responseJsonSchema"]);o!=null&&f(t,["responseJsonSchema"],o);const c=u(s,["audioTimestamp"]);c!=null&&f(t,["audioTimestamp"],c);const d=u(s,["candidateCount"]);d!=null&&f(t,["candidateCount"],d);const p=u(s,["enableAffectiveDialog"]);p!=null&&f(t,["enableAffectiveDialog"],p);const g=u(s,["frequencyPenalty"]);g!=null&&f(t,["frequencyPenalty"],g);const v=u(s,["logprobs"]);v!=null&&f(t,["logprobs"],v);const h=u(s,["maxOutputTokens"]);h!=null&&f(t,["maxOutputTokens"],h);const y=u(s,["mediaResolution"]);y!=null&&f(t,["mediaResolution"],y);const b=u(s,["presencePenalty"]);b!=null&&f(t,["presencePenalty"],b);const S=u(s,["responseLogprobs"]);S!=null&&f(t,["responseLogprobs"],S);const N=u(s,["responseMimeType"]);N!=null&&f(t,["responseMimeType"],N);const k=u(s,["responseModalities"]);k!=null&&f(t,["responseModalities"],k);const w=u(s,["responseSchema"]);w!=null&&f(t,["responseSchema"],w);const M=u(s,["routingConfig"]);M!=null&&f(t,["routingConfig"],M);const J=u(s,["seed"]);J!=null&&f(t,["seed"],J);const ce=u(s,["speechConfig"]);ce!=null&&f(t,["speechConfig"],ce);const ee=u(s,["stopSequences"]);ee!=null&&f(t,["stopSequences"],ee);const P=u(s,["temperature"]);P!=null&&f(t,["temperature"],P);const Q=u(s,["thinkingConfig"]);Q!=null&&f(t,["thinkingConfig"],Q);const H=u(s,["topK"]);H!=null&&f(t,["topK"],H);const V=u(s,["topP"]);if(V!=null&&f(t,["topP"],V),u(s,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function qT(s,t){const a={},o=u(t,["model"]);return o!=null&&f(a,["_url","name"],Xe(s,o)),a}function JT(s,t){const a={},o=u(t,["model"]);return o!=null&&f(a,["_url","name"],Xe(s,o)),a}function zT(s){const t={};if(u(s,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const a=u(s,["enableWidget"]);return a!=null&&f(t,["enableWidget"],a),t}function FT(s){const t={};if(u(s,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(u(s,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const a=u(s,["timeRangeFilter"]);return a!=null&&f(t,["timeRangeFilter"],a),t}function YT(s){const t={},a=u(s,["aspectRatio"]);a!=null&&f(t,["aspectRatio"],a);const o=u(s,["imageSize"]);if(o!=null&&f(t,["imageSize"],o),u(s,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(u(s,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(u(s,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function $T(s){const t={},a=u(s,["aspectRatio"]);a!=null&&f(t,["aspectRatio"],a);const o=u(s,["imageSize"]);o!=null&&f(t,["imageSize"],o);const c=u(s,["personGeneration"]);c!=null&&f(t,["personGeneration"],c);const d=u(s,["outputMimeType"]);d!=null&&f(t,["imageOutputOptions","mimeType"],d);const p=u(s,["outputCompressionQuality"]);return p!=null&&f(t,["imageOutputOptions","compressionQuality"],p),t}function KT(s){const t={},a=u(s,["bytesBase64Encoded"]);a!=null&&f(t,["imageBytes"],As(a));const o=u(s,["mimeType"]);return o!=null&&f(t,["mimeType"],o),t}function _g(s){const t={},a=u(s,["gcsUri"]);a!=null&&f(t,["gcsUri"],a);const o=u(s,["bytesBase64Encoded"]);o!=null&&f(t,["imageBytes"],As(o));const c=u(s,["mimeType"]);return c!=null&&f(t,["mimeType"],c),t}function ki(s){const t={};if(u(s,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const a=u(s,["imageBytes"]);a!=null&&f(t,["bytesBase64Encoded"],As(a));const o=u(s,["mimeType"]);return o!=null&&f(t,["mimeType"],o),t}function Tn(s){const t={},a=u(s,["gcsUri"]);a!=null&&f(t,["gcsUri"],a);const o=u(s,["imageBytes"]);o!=null&&f(t,["bytesBase64Encoded"],As(o));const c=u(s,["mimeType"]);return c!=null&&f(t,["mimeType"],c),t}function XT(s,t,a){const o={},c=u(t,["pageSize"]);a!==void 0&&c!=null&&f(a,["_query","pageSize"],c);const d=u(t,["pageToken"]);a!==void 0&&d!=null&&f(a,["_query","pageToken"],d);const p=u(t,["filter"]);a!==void 0&&p!=null&&f(a,["_query","filter"],p);const g=u(t,["queryBase"]);return a!==void 0&&g!=null&&f(a,["_url","models_url"],Sg(s,g)),o}function QT(s,t,a){const o={},c=u(t,["pageSize"]);a!==void 0&&c!=null&&f(a,["_query","pageSize"],c);const d=u(t,["pageToken"]);a!==void 0&&d!=null&&f(a,["_query","pageToken"],d);const p=u(t,["filter"]);a!==void 0&&p!=null&&f(a,["_query","filter"],p);const g=u(t,["queryBase"]);return a!==void 0&&g!=null&&f(a,["_url","models_url"],Sg(s,g)),o}function WT(s,t){const a={},o=u(t,["config"]);return o!=null&&XT(s,o,a),a}function ZT(s,t){const a={},o=u(t,["config"]);return o!=null&&QT(s,o,a),a}function eN(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["nextPageToken"]);o!=null&&f(t,["nextPageToken"],o);const c=u(s,["_self"]);if(c!=null){let d=Tg(c);Array.isArray(d)&&(d=d.map(p=>ru(p))),f(t,["models"],d)}return t}function tN(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["nextPageToken"]);o!=null&&f(t,["nextPageToken"],o);const c=u(s,["_self"]);if(c!=null){let d=Tg(c);Array.isArray(d)&&(d=d.map(p=>cu(p))),f(t,["models"],d)}return t}function nN(s){const t={},a=u(s,["maskMode"]);a!=null&&f(t,["maskMode"],a);const o=u(s,["segmentationClasses"]);o!=null&&f(t,["maskClasses"],o);const c=u(s,["maskDilation"]);return c!=null&&f(t,["dilation"],c),t}function ru(s){const t={},a=u(s,["name"]);a!=null&&f(t,["name"],a);const o=u(s,["displayName"]);o!=null&&f(t,["displayName"],o);const c=u(s,["description"]);c!=null&&f(t,["description"],c);const d=u(s,["version"]);d!=null&&f(t,["version"],d);const p=u(s,["_self"]);p!=null&&f(t,["tunedModelInfo"],vN(p));const g=u(s,["inputTokenLimit"]);g!=null&&f(t,["inputTokenLimit"],g);const v=u(s,["outputTokenLimit"]);v!=null&&f(t,["outputTokenLimit"],v);const h=u(s,["supportedGenerationMethods"]);h!=null&&f(t,["supportedActions"],h);const y=u(s,["temperature"]);y!=null&&f(t,["temperature"],y);const b=u(s,["maxTemperature"]);b!=null&&f(t,["maxTemperature"],b);const S=u(s,["topP"]);S!=null&&f(t,["topP"],S);const N=u(s,["topK"]);N!=null&&f(t,["topK"],N);const k=u(s,["thinking"]);return k!=null&&f(t,["thinking"],k),t}function cu(s){const t={},a=u(s,["name"]);a!=null&&f(t,["name"],a);const o=u(s,["displayName"]);o!=null&&f(t,["displayName"],o);const c=u(s,["description"]);c!=null&&f(t,["description"],c);const d=u(s,["versionId"]);d!=null&&f(t,["version"],d);const p=u(s,["deployedModels"]);if(p!=null){let b=p;Array.isArray(b)&&(b=b.map(S=>hT(S))),f(t,["endpoints"],b)}const g=u(s,["labels"]);g!=null&&f(t,["labels"],g);const v=u(s,["_self"]);v!=null&&f(t,["tunedModelInfo"],yN(v));const h=u(s,["defaultCheckpointId"]);h!=null&&f(t,["defaultCheckpointId"],h);const y=u(s,["checkpoints"]);if(y!=null){let b=y;Array.isArray(b)&&(b=b.map(S=>S)),f(t,["checkpoints"],b)}return t}function sN(s){const t={},a=u(s,["mediaResolution"]);a!=null&&f(t,["mediaResolution"],a);const o=u(s,["codeExecutionResult"]);o!=null&&f(t,["codeExecutionResult"],o);const c=u(s,["executableCode"]);c!=null&&f(t,["executableCode"],c);const d=u(s,["fileData"]);d!=null&&f(t,["fileData"],gT(d));const p=u(s,["functionCall"]);p!=null&&f(t,["functionCall"],xT(p));const g=u(s,["functionResponse"]);g!=null&&f(t,["functionResponse"],g);const v=u(s,["inlineData"]);v!=null&&f(t,["inlineData"],VS(v));const h=u(s,["text"]);h!=null&&f(t,["text"],h);const y=u(s,["thought"]);y!=null&&f(t,["thought"],y);const b=u(s,["thoughtSignature"]);b!=null&&f(t,["thoughtSignature"],b);const S=u(s,["videoMetadata"]);return S!=null&&f(t,["videoMetadata"],S),t}function aN(s){const t={},a=u(s,["productImage"]);return a!=null&&f(t,["image"],Tn(a)),t}function lN(s,t){const a={},o=u(s,["numberOfImages"]);t!==void 0&&o!=null&&f(t,["parameters","sampleCount"],o);const c=u(s,["baseSteps"]);t!==void 0&&c!=null&&f(t,["parameters","baseSteps"],c);const d=u(s,["outputGcsUri"]);t!==void 0&&d!=null&&f(t,["parameters","storageUri"],d);const p=u(s,["seed"]);t!==void 0&&p!=null&&f(t,["parameters","seed"],p);const g=u(s,["safetyFilterLevel"]);t!==void 0&&g!=null&&f(t,["parameters","safetySetting"],g);const v=u(s,["personGeneration"]);t!==void 0&&v!=null&&f(t,["parameters","personGeneration"],v);const h=u(s,["addWatermark"]);t!==void 0&&h!=null&&f(t,["parameters","addWatermark"],h);const y=u(s,["outputMimeType"]);t!==void 0&&y!=null&&f(t,["parameters","outputOptions","mimeType"],y);const b=u(s,["outputCompressionQuality"]);t!==void 0&&b!=null&&f(t,["parameters","outputOptions","compressionQuality"],b);const S=u(s,["enhancePrompt"]);t!==void 0&&S!=null&&f(t,["parameters","enhancePrompt"],S);const N=u(s,["labels"]);return t!==void 0&&N!=null&&f(t,["labels"],N),a}function oN(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["_url","model"],Xe(s,o));const c=u(t,["source"]);c!=null&&rN(c,a);const d=u(t,["config"]);return d!=null&&lN(d,a),a}function iN(s){const t={},a=u(s,["predictions"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(c=>Di(c))),f(t,["generatedImages"],o)}return t}function rN(s,t){const a={},o=u(s,["prompt"]);t!==void 0&&o!=null&&f(t,["instances[0]","prompt"],o);const c=u(s,["personImage"]);t!==void 0&&c!=null&&f(t,["instances[0]","personImage","image"],Tn(c));const d=u(s,["productImages"]);if(t!==void 0&&d!=null){let p=d;Array.isArray(p)&&(p=p.map(g=>aN(g))),f(t,["instances[0]","productImages"],p)}return a}function cN(s){const t={},a=u(s,["referenceImage"]);a!=null&&f(t,["referenceImage"],Tn(a));const o=u(s,["referenceId"]);o!=null&&f(t,["referenceId"],o);const c=u(s,["referenceType"]);c!=null&&f(t,["referenceType"],c);const d=u(s,["maskImageConfig"]);d!=null&&f(t,["maskImageConfig"],nN(d));const p=u(s,["controlImageConfig"]);p!=null&&f(t,["controlImageConfig"],KS(p));const g=u(s,["styleImageConfig"]);g!=null&&f(t,["styleImageConfig"],g);const v=u(s,["subjectImageConfig"]);return v!=null&&f(t,["subjectImageConfig"],v),t}function Rg(s){const t={},a=u(s,["safetyAttributes","categories"]);a!=null&&f(t,["categories"],a);const o=u(s,["safetyAttributes","scores"]);o!=null&&f(t,["scores"],o);const c=u(s,["contentType"]);return c!=null&&f(t,["contentType"],c),t}function Ig(s){const t={},a=u(s,["safetyAttributes","categories"]);a!=null&&f(t,["categories"],a);const o=u(s,["safetyAttributes","scores"]);o!=null&&f(t,["scores"],o);const c=u(s,["contentType"]);return c!=null&&f(t,["contentType"],c),t}function uN(s){const t={},a=u(s,["category"]);if(a!=null&&f(t,["category"],a),u(s,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const o=u(s,["threshold"]);return o!=null&&f(t,["threshold"],o),t}function dN(s){const t={},a=u(s,["image"]);return a!=null&&f(t,["image"],Tn(a)),t}function fN(s,t){const a={},o=u(s,["mode"]);t!==void 0&&o!=null&&f(t,["parameters","mode"],o);const c=u(s,["maxPredictions"]);t!==void 0&&c!=null&&f(t,["parameters","maxPredictions"],c);const d=u(s,["confidenceThreshold"]);t!==void 0&&d!=null&&f(t,["parameters","confidenceThreshold"],d);const p=u(s,["maskDilation"]);t!==void 0&&p!=null&&f(t,["parameters","maskDilation"],p);const g=u(s,["binaryColorThreshold"]);t!==void 0&&g!=null&&f(t,["parameters","binaryColorThreshold"],g);const v=u(s,["labels"]);return t!==void 0&&v!=null&&f(t,["labels"],v),a}function pN(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["_url","model"],Xe(s,o));const c=u(t,["source"]);c!=null&&hN(c,a);const d=u(t,["config"]);return d!=null&&fN(d,a),a}function mN(s){const t={},a=u(s,["predictions"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(c=>PT(c))),f(t,["generatedMasks"],o)}return t}function hN(s,t){const a={},o=u(s,["prompt"]);t!==void 0&&o!=null&&f(t,["instances[0]","prompt"],o);const c=u(s,["image"]);t!==void 0&&c!=null&&f(t,["instances[0]","image"],Tn(c));const d=u(s,["scribbleImage"]);return t!==void 0&&d!=null&&f(t,["instances[0]","scribble"],dN(d)),a}function gN(s){const t={},a=u(s,["retrievalConfig"]);a!=null&&f(t,["retrievalConfig"],a);const o=u(s,["functionCallingConfig"]);return o!=null&&f(t,["functionCallingConfig"],vT(o)),t}function xN(s){const t={};if(u(s,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const a=u(s,["computerUse"]);a!=null&&f(t,["computerUse"],a);const o=u(s,["fileSearch"]);o!=null&&f(t,["fileSearch"],o);const c=u(s,["codeExecution"]);if(c!=null&&f(t,["codeExecution"],c),u(s,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=u(s,["functionDeclarations"]);if(d!=null){let y=d;Array.isArray(y)&&(y=y.map(b=>b)),f(t,["functionDeclarations"],y)}const p=u(s,["googleMaps"]);p!=null&&f(t,["googleMaps"],zT(p));const g=u(s,["googleSearch"]);g!=null&&f(t,["googleSearch"],FT(g));const v=u(s,["googleSearchRetrieval"]);v!=null&&f(t,["googleSearchRetrieval"],v);const h=u(s,["urlContext"]);return h!=null&&f(t,["urlContext"],h),t}function Mg(s){const t={},a=u(s,["retrieval"]);a!=null&&f(t,["retrieval"],a);const o=u(s,["computerUse"]);if(o!=null&&f(t,["computerUse"],o),u(s,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const c=u(s,["codeExecution"]);c!=null&&f(t,["codeExecution"],c);const d=u(s,["enterpriseWebSearch"]);d!=null&&f(t,["enterpriseWebSearch"],d);const p=u(s,["functionDeclarations"]);if(p!=null){let b=p;Array.isArray(b)&&(b=b.map(S=>yT(S))),f(t,["functionDeclarations"],b)}const g=u(s,["googleMaps"]);g!=null&&f(t,["googleMaps"],g);const v=u(s,["googleSearch"]);v!=null&&f(t,["googleSearch"],v);const h=u(s,["googleSearchRetrieval"]);h!=null&&f(t,["googleSearchRetrieval"],h);const y=u(s,["urlContext"]);return y!=null&&f(t,["urlContext"],y),t}function vN(s){const t={},a=u(s,["baseModel"]);a!=null&&f(t,["baseModel"],a);const o=u(s,["createTime"]);o!=null&&f(t,["createTime"],o);const c=u(s,["updateTime"]);return c!=null&&f(t,["updateTime"],c),t}function yN(s){const t={},a=u(s,["labels","google-vertex-llm-tuning-base-model-id"]);a!=null&&f(t,["baseModel"],a);const o=u(s,["createTime"]);o!=null&&f(t,["createTime"],o);const c=u(s,["updateTime"]);return c!=null&&f(t,["updateTime"],c),t}function bN(s,t){const a={},o=u(s,["displayName"]);t!==void 0&&o!=null&&f(t,["displayName"],o);const c=u(s,["description"]);t!==void 0&&c!=null&&f(t,["description"],c);const d=u(s,["defaultCheckpointId"]);return t!==void 0&&d!=null&&f(t,["defaultCheckpointId"],d),a}function SN(s,t){const a={},o=u(s,["displayName"]);t!==void 0&&o!=null&&f(t,["displayName"],o);const c=u(s,["description"]);t!==void 0&&c!=null&&f(t,["description"],c);const d=u(s,["defaultCheckpointId"]);return t!==void 0&&d!=null&&f(t,["defaultCheckpointId"],d),a}function TN(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["_url","name"],Xe(s,o));const c=u(t,["config"]);return c!=null&&bN(c,a),a}function NN(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["_url","model"],Xe(s,o));const c=u(t,["config"]);return c!=null&&SN(c,a),a}function EN(s,t){const a={},o=u(s,["outputGcsUri"]);t!==void 0&&o!=null&&f(t,["parameters","storageUri"],o);const c=u(s,["safetyFilterLevel"]);t!==void 0&&c!=null&&f(t,["parameters","safetySetting"],c);const d=u(s,["personGeneration"]);t!==void 0&&d!=null&&f(t,["parameters","personGeneration"],d);const p=u(s,["includeRaiReason"]);t!==void 0&&p!=null&&f(t,["parameters","includeRaiReason"],p);const g=u(s,["outputMimeType"]);t!==void 0&&g!=null&&f(t,["parameters","outputOptions","mimeType"],g);const v=u(s,["outputCompressionQuality"]);t!==void 0&&v!=null&&f(t,["parameters","outputOptions","compressionQuality"],v);const h=u(s,["enhanceInputImage"]);t!==void 0&&h!=null&&f(t,["parameters","upscaleConfig","enhanceInputImage"],h);const y=u(s,["imagePreservationFactor"]);t!==void 0&&y!=null&&f(t,["parameters","upscaleConfig","imagePreservationFactor"],y);const b=u(s,["labels"]);t!==void 0&&b!=null&&f(t,["labels"],b);const S=u(s,["numberOfImages"]);t!==void 0&&S!=null&&f(t,["parameters","sampleCount"],S);const N=u(s,["mode"]);return t!==void 0&&N!=null&&f(t,["parameters","mode"],N),a}function CN(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["_url","model"],Xe(s,o));const c=u(t,["image"]);c!=null&&f(a,["instances[0]","image"],Tn(c));const d=u(t,["upscaleFactor"]);d!=null&&f(a,["parameters","upscaleConfig","upscaleFactor"],d);const p=u(t,["config"]);return p!=null&&EN(p,a),a}function wN(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["predictions"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(d=>Di(d))),f(t,["generatedImages"],c)}return t}function AN(s){const t={},a=u(s,["uri"]);a!=null&&f(t,["uri"],a);const o=u(s,["encodedVideo"]);o!=null&&f(t,["videoBytes"],As(o));const c=u(s,["encoding"]);return c!=null&&f(t,["mimeType"],c),t}function _N(s){const t={},a=u(s,["gcsUri"]);a!=null&&f(t,["uri"],a);const o=u(s,["bytesBase64Encoded"]);o!=null&&f(t,["videoBytes"],As(o));const c=u(s,["mimeType"]);return c!=null&&f(t,["mimeType"],c),t}function RN(s){const t={},a=u(s,["image"]);a!=null&&f(t,["_self"],Tn(a));const o=u(s,["maskMode"]);return o!=null&&f(t,["maskMode"],o),t}function IN(s){const t={},a=u(s,["image"]);a!=null&&f(t,["image"],ki(a));const o=u(s,["referenceType"]);return o!=null&&f(t,["referenceType"],o),t}function MN(s){const t={},a=u(s,["image"]);a!=null&&f(t,["image"],Tn(a));const o=u(s,["referenceType"]);return o!=null&&f(t,["referenceType"],o),t}function Dg(s){const t={},a=u(s,["uri"]);a!=null&&f(t,["uri"],a);const o=u(s,["videoBytes"]);o!=null&&f(t,["encodedVideo"],As(o));const c=u(s,["mimeType"]);return c!=null&&f(t,["encoding"],c),t}function kg(s){const t={},a=u(s,["uri"]);a!=null&&f(t,["gcsUri"],a);const o=u(s,["videoBytes"]);o!=null&&f(t,["bytesBase64Encoded"],As(o));const c=u(s,["mimeType"]);return c!=null&&f(t,["mimeType"],c),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function DN(s,t){const a={},o=u(s,["displayName"]);return t!==void 0&&o!=null&&f(t,["displayName"],o),a}function kN(s){const t={},a=u(s,["config"]);return a!=null&&DN(a,t),t}function jN(s,t){const a={},o=u(s,["force"]);return t!==void 0&&o!=null&&f(t,["_query","force"],o),a}function UN(s){const t={},a=u(s,["name"]);a!=null&&f(t,["_url","name"],a);const o=u(s,["config"]);return o!=null&&jN(o,t),t}function LN(s){const t={},a=u(s,["name"]);return a!=null&&f(t,["_url","name"],a),t}function GN(s,t){const a={},o=u(s,["customMetadata"]);if(t!==void 0&&o!=null){let d=o;Array.isArray(d)&&(d=d.map(p=>p)),f(t,["customMetadata"],d)}const c=u(s,["chunkingConfig"]);return t!==void 0&&c!=null&&f(t,["chunkingConfig"],c),a}function ON(s){const t={},a=u(s,["name"]);a!=null&&f(t,["name"],a);const o=u(s,["metadata"]);o!=null&&f(t,["metadata"],o);const c=u(s,["done"]);c!=null&&f(t,["done"],c);const d=u(s,["error"]);d!=null&&f(t,["error"],d);const p=u(s,["response"]);return p!=null&&f(t,["response"],HN(p)),t}function PN(s){const t={},a=u(s,["fileSearchStoreName"]);a!=null&&f(t,["_url","file_search_store_name"],a);const o=u(s,["fileName"]);o!=null&&f(t,["fileName"],o);const c=u(s,["config"]);return c!=null&&GN(c,t),t}function HN(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["parent"]);o!=null&&f(t,["parent"],o);const c=u(s,["documentName"]);return c!=null&&f(t,["documentName"],c),t}function BN(s,t){const a={},o=u(s,["pageSize"]);t!==void 0&&o!=null&&f(t,["_query","pageSize"],o);const c=u(s,["pageToken"]);return t!==void 0&&c!=null&&f(t,["_query","pageToken"],c),a}function VN(s){const t={},a=u(s,["config"]);return a!=null&&BN(a,t),t}function qN(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["nextPageToken"]);o!=null&&f(t,["nextPageToken"],o);const c=u(s,["fileSearchStores"]);if(c!=null){let d=c;Array.isArray(d)&&(d=d.map(p=>p)),f(t,["fileSearchStores"],d)}return t}function jg(s,t){const a={},o=u(s,["mimeType"]);t!==void 0&&o!=null&&f(t,["mimeType"],o);const c=u(s,["displayName"]);t!==void 0&&c!=null&&f(t,["displayName"],c);const d=u(s,["customMetadata"]);if(t!==void 0&&d!=null){let g=d;Array.isArray(g)&&(g=g.map(v=>v)),f(t,["customMetadata"],g)}const p=u(s,["chunkingConfig"]);return t!==void 0&&p!=null&&f(t,["chunkingConfig"],p),a}function JN(s){const t={},a=u(s,["fileSearchStoreName"]);a!=null&&f(t,["_url","file_search_store_name"],a);const o=u(s,["config"]);return o!=null&&jg(o,t),t}function zN(s){const t={},a=u(s,["sdkHttpResponse"]);return a!=null&&f(t,["sdkHttpResponse"],a),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const FN="Content-Type",YN="X-Server-Timeout",$N="User-Agent",uu="x-goog-api-client",KN="1.35.0",XN=`google-genai-sdk/${KN}`,QN="v1beta1",WN="v1beta";class ZN{constructor(t){var a,o;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const c={};this.clientOptions.vertexai?(c.apiVersion=(a=this.clientOptions.apiVersion)!==null&&a!==void 0?a:QN,c.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(c.apiVersion=(o=this.clientOptions.apiVersion)!==null&&o!==void 0?o:WN,c.baseUrl="https://generativelanguage.googleapis.com/"),c.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=c,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(c,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const t=new Headers;return await this.clientOptions.auth.addAuthHeaders(t),t}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const o=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&o.push(t.apiVersion),o.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),a=new URL(t);return a.protocol=a.protocol=="http:"?"ws":"wss",a.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,a,o){const c=[this.getRequestUrlInternal(a)];return o&&c.push(this.getBaseResourcePath()),t!==""&&c.push(t),new URL(`${c.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let a=this.clientOptions.httpOptions;t.httpOptions&&(a=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const o=this.shouldPrependVertexProjectPath(t),c=this.constructUrl(t.path,a,o);if(t.queryParams)for(const[p,g]of Object.entries(t.queryParams))c.searchParams.append(p,String(g));let d={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else d.body=t.body;return d=await this.includeExtraHttpOptionsToRequestInit(d,a,c.toString(),t.abortSignal),this.unaryApiCall(c,d,t.httpMethod)}patchHttpOptions(t,a){const o=JSON.parse(JSON.stringify(t));for(const[c,d]of Object.entries(a))typeof d=="object"?o[c]=Object.assign(Object.assign({},o[c]),d):d!==void 0&&(o[c]=d);return o}async requestStream(t){let a=this.clientOptions.httpOptions;t.httpOptions&&(a=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const o=this.shouldPrependVertexProjectPath(t),c=this.constructUrl(t.path,a,o);(!c.searchParams.has("alt")||c.searchParams.get("alt")!=="sse")&&c.searchParams.set("alt","sse");let d={};return d.body=t.body,d=await this.includeExtraHttpOptionsToRequestInit(d,a,c.toString(),t.abortSignal),this.streamApiCall(c,d,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,a,o,c){if(a&&a.timeout||c){const d=new AbortController,p=d.signal;if(a.timeout&&(a==null?void 0:a.timeout)>0){const g=setTimeout(()=>d.abort(),a.timeout);g&&typeof g.unref=="function"&&g.unref()}c&&c.addEventListener("abort",()=>{d.abort()}),t.signal=p}return a&&a.extraBody!==null&&eE(t,a.extraBody),t.headers=await this.getHeadersInternal(a,o),t}async unaryApiCall(t,a,o){return this.apiCall(t.toString(),Object.assign(Object.assign({},a),{method:o})).then(async c=>(await Qh(c),new lu(c))).catch(c=>{throw c instanceof Error?c:new Error(JSON.stringify(c))})}async streamApiCall(t,a,o){return this.apiCall(t.toString(),Object.assign(Object.assign({},a),{method:o})).then(async c=>(await Qh(c),this.processStreamResponse(c))).catch(c=>{throw c instanceof Error?c:new Error(JSON.stringify(c))})}processStreamResponse(t){return bn(this,arguments,function*(){var o;const c=(o=t==null?void 0:t.body)===null||o===void 0?void 0:o.getReader(),d=new TextDecoder("utf-8");if(!c)throw new Error("Response body is empty");try{let p="";const g="data:",v=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:h,value:y}=yield Ue(c.read());if(h){if(p.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const b=d.decode(y,{stream:!0});try{const k=JSON.parse(b);if("error"in k){const w=JSON.parse(JSON.stringify(k.error)),M=w.status,J=w.code,ce=`got status: ${M}. ${JSON.stringify(k)}`;if(J>=400&&J<600)throw new Ii({message:ce,status:J})}}catch(k){if(k.name==="ApiError")throw k}p+=b;let S=-1,N=0;for(;;){S=-1,N=0;for(const M of v){const J=p.indexOf(M);J!==-1&&(S===-1||J<S)&&(S=J,N=M.length)}if(S===-1)break;const k=p.substring(0,S);p=p.substring(S+N);const w=k.trim();if(w.startsWith(g)){const M=w.substring(g.length).trim();try{const J=new Response(M,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield Ue(new lu(J))}catch(J){throw new Error(`exception parsing stream chunk ${M}. ${J}`)}}}}}finally{c.releaseLock()}})}async apiCall(t,a){return fetch(t,a).catch(o=>{throw new Error(`exception ${o} sending request`)})}getDefaultHeaders(){const t={},a=XN+" "+this.clientOptions.userAgentExtra;return t[$N]=a,t[uu]=a,t[FN]="application/json",t}async getHeadersInternal(t,a){const o=new Headers;if(t&&t.headers){for(const[c,d]of Object.entries(t.headers))o.append(c,d);t.timeout&&t.timeout>0&&o.append(YN,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(o,a),o}getFileName(t){var a;let o="";return typeof t=="string"&&(o=t.replace(/[/\\]+$/,""),o=(a=o.split(/[/\\]/).pop())!==null&&a!==void 0?a:""),o}async uploadFile(t,a){var o;const c={};a!=null&&(c.mimeType=a.mimeType,c.name=a.name,c.displayName=a.displayName),c.name&&!c.name.startsWith("files/")&&(c.name=`files/${c.name}`);const d=this.clientOptions.uploader,p=await d.stat(t);c.sizeBytes=String(p.size);const g=(o=a==null?void 0:a.mimeType)!==null&&o!==void 0?o:p.type;if(g===void 0||g==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");c.mimeType=g;const v={file:c},h=this.getFileName(t),y=Te("upload/v1beta/files",v._url),b=await this.fetchUploadUrl(y,c.sizeBytes,c.mimeType,h,v,a==null?void 0:a.httpOptions);return d.upload(t,b,this)}async uploadFileToFileSearchStore(t,a,o){var c;const d=this.clientOptions.uploader,p=await d.stat(a),g=String(p.size),v=(c=o==null?void 0:o.mimeType)!==null&&c!==void 0?c:p.type;if(v===void 0||v==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const h=`upload/v1beta/${t}:uploadToFileSearchStore`,y=this.getFileName(a),b={};o!=null&&jg(o,b);const S=await this.fetchUploadUrl(h,g,v,y,b,o==null?void 0:o.httpOptions);return d.uploadToFileSearchStore(a,S,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,a,o,c,d,p){var g;let v={};p?v=p:v={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${a}`,"X-Goog-Upload-Header-Content-Type":`${o}`},c?{"X-Goog-Upload-File-Name":c}:{})};const h=await this.request({path:t,body:JSON.stringify(d),httpMethod:"POST",httpOptions:v});if(!h||!(h!=null&&h.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const y=(g=h==null?void 0:h.headers)===null||g===void 0?void 0:g["x-goog-upload-url"];if(y===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return y}}async function Qh(s){var t;if(s===void 0)throw new Error("response is undefined");if(!s.ok){const a=s.status;let o;!((t=s.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?o=await s.json():o={error:{message:await s.text(),code:s.status,status:s.statusText}};const c=JSON.stringify(o);throw a>=400&&a<600?new Ii({message:c,status:a}):new Error(c)}}function eE(s,t){if(!t||Object.keys(t).length===0)return;if(s.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let a={};if(typeof s.body=="string"&&s.body.length>0)try{const d=JSON.parse(s.body);if(typeof d=="object"&&d!==null&&!Array.isArray(d))a=d;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function o(d,p){const g=Object.assign({},d);for(const v in p)if(Object.prototype.hasOwnProperty.call(p,v)){const h=p[v],y=g[v];h&&typeof h=="object"&&!Array.isArray(h)&&y&&typeof y=="object"&&!Array.isArray(y)?g[v]=o(y,h):(y&&h&&typeof y!=typeof h&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${v}". Original type: ${typeof y}, New type: ${typeof h}. Overwriting.`),g[v]=h)}return g}const c=o(a,t);s.body=JSON.stringify(c)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const tE="mcp_used/unknown";let nE=!1;function Ug(s){for(const t of s)if(sE(t)||typeof t=="object"&&"inputSchema"in t)return!0;return nE}function Lg(s){var t;const a=(t=s[uu])!==null&&t!==void 0?t:"";s[uu]=(a+` ${tE}`).trimStart()}function sE(s){return s!==null&&typeof s=="object"&&s instanceof Au}function aE(s){return bn(this,arguments,function*(a,o=100){let c,d=0;for(;d<o;){const p=yield Ue(a.listTools({cursor:c}));for(const g of p.tools)yield yield Ue(g),d++;if(!p.nextCursor)break;c=p.nextCursor}})}class Au{constructor(t=[],a){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=a}static create(t,a){return new Au(t,a)}async initialize(){var t,a,o,c;if(this.mcpTools.length>0)return;const d={},p=[];for(const y of this.mcpClients)try{for(var g=!0,v=(a=void 0,Sn(aE(y))),h;h=await v.next(),t=h.done,!t;g=!0){c=h.value,g=!1;const b=c;p.push(b);const S=b.name;if(d[S])throw new Error(`Duplicate function name ${S} found in MCP tools. Please ensure function names are unique.`);d[S]=y}}catch(b){a={error:b}}finally{try{!g&&!t&&(o=v.return)&&await o.call(v)}finally{if(a)throw a.error}}this.mcpTools=p,this.functionNameToMcpClient=d}async tool(){return await this.initialize(),Ly(this.mcpTools,this.config)}async callTool(t){await this.initialize();const a=[];for(const o of t)if(o.name in this.functionNameToMcpClient){const c=this.functionNameToMcpClient[o.name];let d;this.config.timeout&&(d={timeout:this.config.timeout});const p=await c.callTool({name:o.name,arguments:o.args},void 0,d);a.push({functionResponse:{name:o.name,response:p.isError?{error:p}:p}})}return a}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function lE(s,t,a){const o=new _y;let c;a.data instanceof Blob?c=JSON.parse(await a.data.text()):c=JSON.parse(a.data),Object.assign(o,c),t(o)}class oE{constructor(t,a,o){this.apiClient=t,this.auth=a,this.webSocketFactory=o}async connect(t){var a,o;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const c=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion(),p=cE(this.apiClient.getDefaultHeaders()),g=this.apiClient.getApiKey(),v=`${c}/ws/google.ai.generativelanguage.${d}.GenerativeService.BidiGenerateMusic?key=${g}`;let h=()=>{};const y=new Promise(ee=>{h=ee}),b=t.callbacks,S=function(){h({})},N=this.apiClient,k={onopen:S,onmessage:ee=>{lE(N,b.onmessage,ee)},onerror:(a=b==null?void 0:b.onerror)!==null&&a!==void 0?a:function(ee){},onclose:(o=b==null?void 0:b.onclose)!==null&&o!==void 0?o:function(ee){}},w=this.webSocketFactory.create(v,rE(p),k);w.connect(),await y;const ce={setup:{model:Xe(this.apiClient,t.model)}};return w.send(JSON.stringify(ce)),new iE(w,this.apiClient)}}class iE{constructor(t,a){this.conn=t,this.apiClient=a}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const a=kS(t);this.conn.send(JSON.stringify({clientContent:a}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const a=DS(t);this.conn.send(JSON.stringify(a))}sendPlaybackControl(t){const a={playbackControl:t};this.conn.send(JSON.stringify(a))}play(){this.sendPlaybackControl(Ba.PLAY)}pause(){this.sendPlaybackControl(Ba.PAUSE)}stop(){this.sendPlaybackControl(Ba.STOP)}resetContext(){this.sendPlaybackControl(Ba.RESET_CONTEXT)}close(){this.conn.close()}}function rE(s){const t={};return s.forEach((a,o)=>{t[o]=a}),t}function cE(s){const t=new Headers;for(const[a,o]of Object.entries(s))t.append(a,o);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const uE="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function dE(s,t,a){const o=new Ay;let c;a.data instanceof Blob?c=await a.data.text():a.data instanceof ArrayBuffer?c=new TextDecoder().decode(a.data):c=a.data;const d=JSON.parse(c);if(s.isVertexAI()){const p=LS(d);Object.assign(o,p)}else Object.assign(o,d);t(o)}class fE{constructor(t,a,o){this.apiClient=t,this.auth=a,this.webSocketFactory=o,this.music=new oE(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var a,o,c,d,p,g;if(t.config&&t.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const v=this.apiClient.getWebsocketBaseUrl(),h=this.apiClient.getApiVersion();let y;const b=this.apiClient.getHeaders();t.config&&t.config.tools&&Ug(t.config.tools)&&Lg(b);const S=gE(b);if(this.apiClient.isVertexAI())y=`${v}/ws/google.cloud.aiplatform.${h}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(S,y);else{const X=this.apiClient.getApiKey();let fe="BidiGenerateContent",F="key";X!=null&&X.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),h!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),fe="BidiGenerateContentConstrained",F="access_token"),y=`${v}/ws/google.ai.generativelanguage.${h}.GenerativeService.${fe}?${F}=${X}`}let N=()=>{};const k=new Promise(X=>{N=X}),w=t.callbacks,M=function(){var X;(X=w==null?void 0:w.onopen)===null||X===void 0||X.call(w),N({})},J=this.apiClient,ce={onopen:M,onmessage:X=>{dE(J,w.onmessage,X)},onerror:(a=w==null?void 0:w.onerror)!==null&&a!==void 0?a:function(X){},onclose:(o=w==null?void 0:w.onclose)!==null&&o!==void 0?o:function(X){}},ee=this.webSocketFactory.create(y,hE(S),ce);ee.connect(),await k;let P=Xe(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&P.startsWith("publishers/")){const X=this.apiClient.getProject(),fe=this.apiClient.getLocation();P=`projects/${X}/locations/${fe}/`+P}let Q={};this.apiClient.isVertexAI()&&((c=t.config)===null||c===void 0?void 0:c.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[Ei.AUDIO]}:t.config.responseModalities=[Ei.AUDIO]),!((d=t.config)===null||d===void 0)&&d.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const H=(g=(p=t.config)===null||p===void 0?void 0:p.tools)!==null&&g!==void 0?g:[],V=[];for(const X of H)if(this.isCallableTool(X)){const fe=X;V.push(await fe.tool())}else V.push(X);V.length>0&&(t.config.tools=V);const q={model:P,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?Q=MS(this.apiClient,q):Q=IS(this.apiClient,q),delete Q.config,ee.send(JSON.stringify(Q)),new mE(ee,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const pE={turnComplete:!0};class mE{constructor(t,a){this.conn=t,this.apiClient=a}tLiveClientContent(t,a){if(a.turns!==null&&a.turns!==void 0){let o=[];try{o=hn(a.turns),t.isVertexAI()||(o=o.map(c=>Mi(c)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof a.turns}'`)}return{clientContent:{turns:o,turnComplete:a.turnComplete}}}return{clientContent:{turnComplete:a.turnComplete}}}tLiveClienttToolResponse(t,a){let o=[];if(a.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(a.functionResponses)?o=a.functionResponses:o=[a.functionResponses],o.length===0)throw new Error("functionResponses is required.");for(const d of o){if(typeof d!="object"||d===null||!("name"in d)||!("response"in d))throw new Error(`Could not parse function response, type '${typeof d}'.`);if(!t.isVertexAI()&&!("id"in d))throw new Error(uE)}return{toolResponse:{functionResponses:o}}}sendClientContent(t){t=Object.assign(Object.assign({},pE),t);const a=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(a))}sendRealtimeInput(t){let a={};this.apiClient.isVertexAI()?a={realtimeInput:US(t)}:a={realtimeInput:jS(t)},this.conn.send(JSON.stringify(a))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const a=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(a))}close(){this.conn.close()}}function hE(s){const t={};return s.forEach((a,o)=>{t[o]=a}),t}function gE(s){const t=new Headers;for(const[a,o]of Object.entries(s))t.append(a,o);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Wh=10;function Zh(s){var t,a,o;if(!((t=s==null?void 0:s.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let c=!1;for(const p of(a=s==null?void 0:s.tools)!==null&&a!==void 0?a:[])if(Ja(p)){c=!0;break}if(!c)return!0;const d=(o=s==null?void 0:s.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls;return d&&(d<0||!Number.isInteger(d))||d==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",d),!0):!1}function Ja(s){return"callTool"in s&&typeof s.callTool=="function"}function xE(s){var t,a,o;return(o=(a=(t=s.config)===null||t===void 0?void 0:t.tools)===null||a===void 0?void 0:a.some(c=>Ja(c)))!==null&&o!==void 0?o:!1}function eg(s){var t;const a=[];return!((t=s==null?void 0:s.config)===null||t===void 0)&&t.tools&&s.config.tools.forEach((o,c)=>{if(Ja(o))return;const d=o;d.functionDeclarations&&d.functionDeclarations.length>0&&a.push(c)}),a}function tg(s){var t;return!(!((t=s==null?void 0:s.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vE extends Xn{constructor(t){super(),this.apiClient=t,this.generateContent=async a=>{var o,c,d,p,g;const v=await this.processParamsMaybeAddMcpUsage(a);if(this.maybeMoveToResponseJsonSchem(a),!xE(a)||Zh(a.config))return await this.generateContentInternal(v);const h=eg(a);if(h.length>0){const w=h.map(M=>`tools[${M}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${w}.`)}let y,b;const S=hn(v.contents),N=(d=(c=(o=v.config)===null||o===void 0?void 0:o.automaticFunctionCalling)===null||c===void 0?void 0:c.maximumRemoteCalls)!==null&&d!==void 0?d:Wh;let k=0;for(;k<N&&(y=await this.generateContentInternal(v),!(!y.functionCalls||y.functionCalls.length===0));){const w=y.candidates[0].content,M=[];for(const J of(g=(p=a.config)===null||p===void 0?void 0:p.tools)!==null&&g!==void 0?g:[])if(Ja(J)){const ee=await J.callTool(y.functionCalls);M.push(...ee)}k++,b={role:"user",parts:M},v.contents=hn(v.contents),v.contents.push(w),v.contents.push(b),tg(v.config)&&(S.push(w),S.push(b))}return tg(v.config)&&(y.automaticFunctionCallingHistory=S),y},this.generateContentStream=async a=>{var o,c,d,p,g;if(this.maybeMoveToResponseJsonSchem(a),Zh(a.config)){const b=await this.processParamsMaybeAddMcpUsage(a);return await this.generateContentStreamInternal(b)}const v=eg(a);if(v.length>0){const b=v.map(S=>`tools[${S}]`).join(", ");throw new Error(`Incompatible tools found at ${b}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const h=(d=(c=(o=a==null?void 0:a.config)===null||o===void 0?void 0:o.toolConfig)===null||c===void 0?void 0:c.functionCallingConfig)===null||d===void 0?void 0:d.streamFunctionCallArguments,y=(g=(p=a==null?void 0:a.config)===null||p===void 0?void 0:p.automaticFunctionCalling)===null||g===void 0?void 0:g.disable;if(h&&!y)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(a)},this.generateImages=async a=>await this.generateImagesInternal(a).then(o=>{var c;let d;const p=[];if(o!=null&&o.generatedImages)for(const v of o.generatedImages)v&&(v!=null&&v.safetyAttributes)&&((c=v==null?void 0:v.safetyAttributes)===null||c===void 0?void 0:c.contentType)==="Positive Prompt"?d=v==null?void 0:v.safetyAttributes:p.push(v);let g;return d?g={generatedImages:p,positivePromptSafetyAttributes:d,sdkHttpResponse:o.sdkHttpResponse}:g={generatedImages:p,sdkHttpResponse:o.sdkHttpResponse},g}),this.list=async a=>{var o;const p={config:Object.assign(Object.assign({},{queryBase:!0}),a==null?void 0:a.config)};if(this.apiClient.isVertexAI()&&!p.config.queryBase){if(!((o=p.config)===null||o===void 0)&&o.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");p.config.filter="labels.tune-type:*"}return new Qs(Kn.PAGED_ITEM_MODELS,g=>this.listInternal(g),await this.listInternal(p),p)},this.editImage=async a=>{const o={model:a.model,prompt:a.prompt,referenceImages:[],config:a.config};return a.referenceImages&&a.referenceImages&&(o.referenceImages=a.referenceImages.map(c=>c.toReferenceImageAPI())),await this.editImageInternal(o)},this.upscaleImage=async a=>{let o={numberOfImages:1,mode:"upscale"};a.config&&(o=Object.assign(Object.assign({},o),a.config));const c={model:a.model,image:a.image,upscaleFactor:a.upscaleFactor,config:o};return await this.upscaleImageInternal(c)},this.generateVideos=async a=>{var o,c,d,p,g,v;if((a.prompt||a.image||a.video)&&a.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((o=a.video)===null||o===void 0)&&o.uri&&(!((c=a.video)===null||c===void 0)&&c.videoBytes)?a.video={uri:a.video.uri,mimeType:a.video.mimeType}:!((p=(d=a.source)===null||d===void 0?void 0:d.video)===null||p===void 0)&&p.uri&&(!((v=(g=a.source)===null||g===void 0?void 0:g.video)===null||v===void 0)&&v.videoBytes)&&(a.source.video={uri:a.source.video.uri,mimeType:a.source.video.mimeType})),await this.generateVideosInternal(a)}}maybeMoveToResponseJsonSchem(t){t.config&&t.config.responseSchema&&(t.config.responseJsonSchema||Object.keys(t.config.responseSchema).includes("$schema")&&(t.config.responseJsonSchema=t.config.responseSchema,delete t.config.responseSchema))}async processParamsMaybeAddMcpUsage(t){var a,o,c;const d=(a=t.config)===null||a===void 0?void 0:a.tools;if(!d)return t;const p=await Promise.all(d.map(async v=>Ja(v)?await v.tool():v)),g={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:p})};if(g.config.tools=p,t.config&&t.config.tools&&Ug(t.config.tools)){const v=(c=(o=t.config.httpOptions)===null||o===void 0?void 0:o.headers)!==null&&c!==void 0?c:{};let h=Object.assign({},v);Object.keys(h).length===0&&(h=this.apiClient.getDefaultHeaders()),Lg(h),g.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:h})}return g}async initAfcToolsMap(t){var a,o,c;const d=new Map;for(const p of(o=(a=t.config)===null||a===void 0?void 0:a.tools)!==null&&o!==void 0?o:[])if(Ja(p)){const g=p,v=await g.tool();for(const h of(c=v.functionDeclarations)!==null&&c!==void 0?c:[]){if(!h.name)throw new Error("Function declaration name is required.");if(d.has(h.name))throw new Error(`Duplicate tool declaration name: ${h.name}`);d.set(h.name,g)}}return d}async processAfcStream(t){var a,o,c;const d=(c=(o=(a=t.config)===null||a===void 0?void 0:a.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&c!==void 0?c:Wh;let p=!1,g=0;const v=await this.initAfcToolsMap(t);return(function(h,y,b){return bn(this,arguments,function*(){for(var S,N,k,w,M,J;g<d;){p&&(g++,p=!1);const Q=yield Ue(h.processParamsMaybeAddMcpUsage(b)),H=yield Ue(h.generateContentStreamInternal(Q)),V=[],q=[];try{for(var ce=!0,ee=(N=void 0,Sn(H)),P;P=yield Ue(ee.next()),S=P.done,!S;ce=!0){w=P.value,ce=!1;const X=w;if(yield yield Ue(X),X.candidates&&(!((M=X.candidates[0])===null||M===void 0)&&M.content)){q.push(X.candidates[0].content);for(const fe of(J=X.candidates[0].content.parts)!==null&&J!==void 0?J:[])if(g<d&&fe.functionCall){if(!fe.functionCall.name)throw new Error("Function call name was not returned by the model.");if(y.has(fe.functionCall.name)){const F=yield Ue(y.get(fe.functionCall.name).callTool([fe.functionCall]));V.push(...F)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${y.keys()}, mising tool: ${fe.functionCall.name}`)}}}}catch(X){N={error:X}}finally{try{!ce&&!S&&(k=ee.return)&&(yield Ue(k.call(ee)))}finally{if(N)throw N.error}}if(V.length>0){p=!0;const X=new zl;X.candidates=[{content:{role:"user",parts:V}}],yield yield Ue(X);const fe=[];fe.push(...q),fe.push({role:"user",parts:V});const F=hn(b.contents).concat(fe);b.contents=F}else break}})})(this,v,t)}async generateContentInternal(t){var a,o,c,d;let p,g="",v={};if(this.apiClient.isVertexAI()){const h=$h(this.apiClient,t);return g=Te("{model}:generateContent",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>{const b=Xh(y),S=new zl;return Object.assign(S,b),S})}else{const h=Yh(this.apiClient,t);return g=Te("{model}:generateContent",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>{const b=Kh(y),S=new zl;return Object.assign(S,b),S})}}async generateContentStreamInternal(t){var a,o,c,d;let p,g="",v={};if(this.apiClient.isVertexAI()){const h=$h(this.apiClient,t);return g=Te("{model}:streamGenerateContent?alt=sse",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.requestStream({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}),p.then(function(b){return bn(this,arguments,function*(){var S,N,k,w;try{for(var M=!0,J=Sn(b),ce;ce=yield Ue(J.next()),S=ce.done,!S;M=!0){w=ce.value,M=!1;const ee=w,P=Xh(yield Ue(ee.json()));P.sdkHttpResponse={headers:ee.headers};const Q=new zl;Object.assign(Q,P),yield yield Ue(Q)}}catch(ee){N={error:ee}}finally{try{!M&&!S&&(k=J.return)&&(yield Ue(k.call(J)))}finally{if(N)throw N.error}}})})}else{const h=Yh(this.apiClient,t);return g=Te("{model}:streamGenerateContent?alt=sse",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.requestStream({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal}),p.then(function(b){return bn(this,arguments,function*(){var S,N,k,w;try{for(var M=!0,J=Sn(b),ce;ce=yield Ue(J.next()),S=ce.done,!S;M=!0){w=ce.value,M=!1;const ee=w,P=Kh(yield Ue(ee.json()));P.sdkHttpResponse={headers:ee.headers};const Q=new zl;Object.assign(Q,P),yield yield Ue(Q)}}catch(ee){N={error:ee}}finally{try{!M&&!S&&(k=J.return)&&(yield Ue(k.call(J)))}finally{if(N)throw N.error}}})})}}async embedContent(t){var a,o,c,d;let p,g="",v={};if(this.apiClient.isVertexAI()){const h=fT(this.apiClient,t);return g=Te("{model}:predict",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>{const b=mT(y),S=new Ih;return Object.assign(S,b),S})}else{const h=dT(this.apiClient,t);return g=Te("{model}:batchEmbedContents",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>{const b=pT(y),S=new Ih;return Object.assign(S,b),S})}}async generateImagesInternal(t){var a,o,c,d;let p,g="",v={};if(this.apiClient.isVertexAI()){const h=CT(this.apiClient,t);return g=Te("{model}:predict",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>{const b=AT(y),S=new Mh;return Object.assign(S,b),S})}else{const h=ET(this.apiClient,t);return g=Te("{model}:predict",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>{const b=wT(y),S=new Mh;return Object.assign(S,b),S})}}async editImageInternal(t){var a,o;let c,d="",p={};if(this.apiClient.isVertexAI()){const g=iT(this.apiClient,t);return d=Te("{model}:predict",g._url),p=g._query,delete g._url,delete g._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(h=>{const y=h;return y.sdkHttpResponse={headers:v.headers},y})),c.then(v=>{const h=rT(v),y=new gy;return Object.assign(y,h),y})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var a,o;let c,d="",p={};if(this.apiClient.isVertexAI()){const g=CN(this.apiClient,t);return d=Te("{model}:predict",g._url),p=g._query,delete g._url,delete g._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(h=>{const y=h;return y.sdkHttpResponse={headers:v.headers},y})),c.then(v=>{const h=wN(v),y=new xy;return Object.assign(y,h),y})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(t){var a,o;let c,d="",p={};if(this.apiClient.isVertexAI()){const g=oN(this.apiClient,t);return d=Te("{model}:predict",g._url),p=g._query,delete g._url,delete g._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),c.then(v=>{const h=iN(v),y=new vy;return Object.assign(y,h),y})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(t){var a,o;let c,d="",p={};if(this.apiClient.isVertexAI()){const g=pN(this.apiClient,t);return d=Te("{model}:predict",g._url),p=g._query,delete g._url,delete g._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),c.then(v=>{const h=mN(v),y=new yy;return Object.assign(y,h),y})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var a,o,c,d;let p,g="",v={};if(this.apiClient.isVertexAI()){const h=JT(this.apiClient,t);return g=Te("{name}",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json()),p.then(y=>cu(y))}else{const h=qT(this.apiClient,t);return g=Te("{name}",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal}).then(y=>y.json()),p.then(y=>ru(y))}}async listInternal(t){var a,o,c,d;let p,g="",v={};if(this.apiClient.isVertexAI()){const h=ZT(this.apiClient,t);return g=Te("{models_url}",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>{const b=tN(y),S=new Dh;return Object.assign(S,b),S})}else{const h=WT(this.apiClient,t);return g=Te("{models_url}",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>{const b=eN(y),S=new Dh;return Object.assign(S,b),S})}}async update(t){var a,o,c,d;let p,g="",v={};if(this.apiClient.isVertexAI()){const h=NN(this.apiClient,t);return g=Te("{model}",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json()),p.then(y=>cu(y))}else{const h=TN(this.apiClient,t);return g=Te("{name}",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal}).then(y=>y.json()),p.then(y=>ru(y))}}async delete(t){var a,o,c,d;let p,g="",v={};if(this.apiClient.isVertexAI()){const h=sT(this.apiClient,t);return g=Te("{name}",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>{const b=lT(y),S=new kh;return Object.assign(S,b),S})}else{const h=nT(this.apiClient,t);return g=Te("{name}",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>{const b=aT(y),S=new kh;return Object.assign(S,b),S})}}async countTokens(t){var a,o,c,d;let p,g="",v={};if(this.apiClient.isVertexAI()){const h=ZS(this.apiClient,t);return g=Te("{model}:countTokens",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>{const b=tT(y),S=new jh;return Object.assign(S,b),S})}else{const h=WS(this.apiClient,t);return g=Te("{model}:countTokens",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>{const b=eT(y),S=new jh;return Object.assign(S,b),S})}}async computeTokens(t){var a,o;let c,d="",p={};if(this.apiClient.isVertexAI()){const g=zS(this.apiClient,t);return d=Te("{model}:computeTokens",g._url),p=g._query,delete g._url,delete g._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(h=>{const y=h;return y.sdkHttpResponse={headers:v.headers},y})),c.then(v=>{const h=FS(v),y=new by;return Object.assign(y,h),y})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(t){var a,o,c,d;let p,g="",v={};if(this.apiClient.isVertexAI()){const h=kT(this.apiClient,t);return g=Te("{model}:predictLongRunning",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json()),p.then(y=>{const b=MT(y),S=new Ci;return Object.assign(S,b),S})}else{const h=DT(this.apiClient,t);return g=Te("{model}:predictLongRunning",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal}).then(y=>y.json()),p.then(y=>{const b=IT(y),S=new Ci;return Object.assign(S,b),S})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class yE extends Xn{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const a=t.operation,o=t.config;if(a.name===void 0||a.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const c=a.name.split("/operations/")[0];let d;o&&"httpOptions"in o&&(d=o.httpOptions);const p=await this.fetchPredictVideosOperationInternal({operationName:a.name,resourceName:c,config:{httpOptions:d}});return a._fromAPIResponse({apiResponse:p,_isVertexAI:!0})}else{const c=await this.getVideosOperationInternal({operationName:a.name,config:o});return a._fromAPIResponse({apiResponse:c,_isVertexAI:!1})}}async get(t){const a=t.operation,o=t.config;if(a.name===void 0||a.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const c=a.name.split("/operations/")[0];let d;o&&"httpOptions"in o&&(d=o.httpOptions);const p=await this.fetchPredictVideosOperationInternal({operationName:a.name,resourceName:c,config:{httpOptions:d}});return a._fromAPIResponse({apiResponse:p,_isVertexAI:!0})}else{const c=await this.getVideosOperationInternal({operationName:a.name,config:o});return a._fromAPIResponse({apiResponse:c,_isVertexAI:!1})}}async getVideosOperationInternal(t){var a,o,c,d;let p,g="",v={};if(this.apiClient.isVertexAI()){const h=uy(t);return g=Te("{operationName}",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json()),p}else{const h=cy(t);return g=Te("{operationName}",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal}).then(y=>y.json()),p}}async fetchPredictVideosOperationInternal(t){var a,o;let c,d="",p={};if(this.apiClient.isVertexAI()){const g=ny(t);return d=Te("{resourceName}:fetchPredictOperation",g._url),p=g._query,delete g._url,delete g._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),c}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bE(s){const t={},a=u(s,["data"]);if(a!=null&&f(t,["data"],a),u(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=u(s,["mimeType"]);return o!=null&&f(t,["mimeType"],o),t}function SE(s){const t={},a=u(s,["parts"]);if(a!=null){let c=a;Array.isArray(c)&&(c=c.map(d=>IE(d))),f(t,["parts"],c)}const o=u(s,["role"]);return o!=null&&f(t,["role"],o),t}function TE(s,t,a){const o={},c=u(t,["expireTime"]);a!==void 0&&c!=null&&f(a,["expireTime"],c);const d=u(t,["newSessionExpireTime"]);a!==void 0&&d!=null&&f(a,["newSessionExpireTime"],d);const p=u(t,["uses"]);a!==void 0&&p!=null&&f(a,["uses"],p);const g=u(t,["liveConnectConstraints"]);a!==void 0&&g!=null&&f(a,["bidiGenerateContentSetup"],RE(s,g));const v=u(t,["lockAdditionalFields"]);return a!==void 0&&v!=null&&f(a,["fieldMask"],v),o}function NE(s,t){const a={},o=u(t,["config"]);return o!=null&&f(a,["config"],TE(s,o,a)),a}function EE(s){const t={};if(u(s,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const a=u(s,["fileUri"]);a!=null&&f(t,["fileUri"],a);const o=u(s,["mimeType"]);return o!=null&&f(t,["mimeType"],o),t}function CE(s){const t={},a=u(s,["id"]);a!=null&&f(t,["id"],a);const o=u(s,["args"]);o!=null&&f(t,["args"],o);const c=u(s,["name"]);if(c!=null&&f(t,["name"],c),u(s,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(u(s,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function wE(s){const t={};if(u(s,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const a=u(s,["enableWidget"]);return a!=null&&f(t,["enableWidget"],a),t}function AE(s){const t={};if(u(s,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(u(s,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const a=u(s,["timeRangeFilter"]);return a!=null&&f(t,["timeRangeFilter"],a),t}function _E(s,t){const a={},o=u(s,["generationConfig"]);t!==void 0&&o!=null&&f(t,["setup","generationConfig"],o);const c=u(s,["responseModalities"]);t!==void 0&&c!=null&&f(t,["setup","generationConfig","responseModalities"],c);const d=u(s,["temperature"]);t!==void 0&&d!=null&&f(t,["setup","generationConfig","temperature"],d);const p=u(s,["topP"]);t!==void 0&&p!=null&&f(t,["setup","generationConfig","topP"],p);const g=u(s,["topK"]);t!==void 0&&g!=null&&f(t,["setup","generationConfig","topK"],g);const v=u(s,["maxOutputTokens"]);t!==void 0&&v!=null&&f(t,["setup","generationConfig","maxOutputTokens"],v);const h=u(s,["mediaResolution"]);t!==void 0&&h!=null&&f(t,["setup","generationConfig","mediaResolution"],h);const y=u(s,["seed"]);t!==void 0&&y!=null&&f(t,["setup","generationConfig","seed"],y);const b=u(s,["speechConfig"]);t!==void 0&&b!=null&&f(t,["setup","generationConfig","speechConfig"],wu(b));const S=u(s,["thinkingConfig"]);t!==void 0&&S!=null&&f(t,["setup","generationConfig","thinkingConfig"],S);const N=u(s,["enableAffectiveDialog"]);t!==void 0&&N!=null&&f(t,["setup","generationConfig","enableAffectiveDialog"],N);const k=u(s,["systemInstruction"]);t!==void 0&&k!=null&&f(t,["setup","systemInstruction"],SE(jt(k)));const w=u(s,["tools"]);if(t!==void 0&&w!=null){let H=Fa(w);Array.isArray(H)&&(H=H.map(V=>DE(za(V)))),f(t,["setup","tools"],H)}const M=u(s,["sessionResumption"]);t!==void 0&&M!=null&&f(t,["setup","sessionResumption"],ME(M));const J=u(s,["inputAudioTranscription"]);t!==void 0&&J!=null&&f(t,["setup","inputAudioTranscription"],J);const ce=u(s,["outputAudioTranscription"]);t!==void 0&&ce!=null&&f(t,["setup","outputAudioTranscription"],ce);const ee=u(s,["realtimeInputConfig"]);t!==void 0&&ee!=null&&f(t,["setup","realtimeInputConfig"],ee);const P=u(s,["contextWindowCompression"]);t!==void 0&&P!=null&&f(t,["setup","contextWindowCompression"],P);const Q=u(s,["proactivity"]);if(t!==void 0&&Q!=null&&f(t,["setup","proactivity"],Q),u(s,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return a}function RE(s,t){const a={},o=u(t,["model"]);o!=null&&f(a,["setup","model"],Xe(s,o));const c=u(t,["config"]);return c!=null&&f(a,["config"],_E(c,a)),a}function IE(s){const t={},a=u(s,["mediaResolution"]);a!=null&&f(t,["mediaResolution"],a);const o=u(s,["codeExecutionResult"]);o!=null&&f(t,["codeExecutionResult"],o);const c=u(s,["executableCode"]);c!=null&&f(t,["executableCode"],c);const d=u(s,["fileData"]);d!=null&&f(t,["fileData"],EE(d));const p=u(s,["functionCall"]);p!=null&&f(t,["functionCall"],CE(p));const g=u(s,["functionResponse"]);g!=null&&f(t,["functionResponse"],g);const v=u(s,["inlineData"]);v!=null&&f(t,["inlineData"],bE(v));const h=u(s,["text"]);h!=null&&f(t,["text"],h);const y=u(s,["thought"]);y!=null&&f(t,["thought"],y);const b=u(s,["thoughtSignature"]);b!=null&&f(t,["thoughtSignature"],b);const S=u(s,["videoMetadata"]);return S!=null&&f(t,["videoMetadata"],S),t}function ME(s){const t={},a=u(s,["handle"]);if(a!=null&&f(t,["handle"],a),u(s,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function DE(s){const t={};if(u(s,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const a=u(s,["computerUse"]);a!=null&&f(t,["computerUse"],a);const o=u(s,["fileSearch"]);o!=null&&f(t,["fileSearch"],o);const c=u(s,["codeExecution"]);if(c!=null&&f(t,["codeExecution"],c),u(s,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=u(s,["functionDeclarations"]);if(d!=null){let y=d;Array.isArray(y)&&(y=y.map(b=>b)),f(t,["functionDeclarations"],y)}const p=u(s,["googleMaps"]);p!=null&&f(t,["googleMaps"],wE(p));const g=u(s,["googleSearch"]);g!=null&&f(t,["googleSearch"],AE(g));const v=u(s,["googleSearchRetrieval"]);v!=null&&f(t,["googleSearchRetrieval"],v);const h=u(s,["urlContext"]);return h!=null&&f(t,["urlContext"],h),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function kE(s){const t=[];for(const a in s)if(Object.prototype.hasOwnProperty.call(s,a)){const o=s[a];if(typeof o=="object"&&o!=null&&Object.keys(o).length>0){const c=Object.keys(o).map(d=>`${a}.${d}`);t.push(...c)}else t.push(a)}return t.join(",")}function jE(s,t){let a=null;const o=s.bidiGenerateContentSetup;if(typeof o=="object"&&o!==null&&"setup"in o){const d=o.setup;typeof d=="object"&&d!==null?(s.bidiGenerateContentSetup=d,a=d):delete s.bidiGenerateContentSetup}else o!==void 0&&delete s.bidiGenerateContentSetup;const c=s.fieldMask;if(a){const d=kE(a);if(Array.isArray(t==null?void 0:t.lockAdditionalFields)&&(t==null?void 0:t.lockAdditionalFields.length)===0)d?s.fieldMask=d:delete s.fieldMask;else if(t!=null&&t.lockAdditionalFields&&t.lockAdditionalFields.length>0&&c!==null&&Array.isArray(c)&&c.length>0){const p=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let g=[];c.length>0&&(g=c.map(h=>p.includes(h)?`generationConfig.${h}`:h));const v=[];d&&v.push(d),g.length>0&&v.push(...g),v.length>0?s.fieldMask=v.join(","):delete s.fieldMask}else delete s.fieldMask}else c!==null&&Array.isArray(c)&&c.length>0?s.fieldMask=c.join(","):delete s.fieldMask;return s}class UE extends Xn{constructor(t){super(),this.apiClient=t}async create(t){var a,o;let c,d="",p={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const g=NE(this.apiClient,t);d=Te("auth_tokens",g._url),p=g._query,delete g.config,delete g._url,delete g._query;const v=jE(g,t.config);return c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(v),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),c.then(h=>h)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function LE(s,t){const a={},o=u(s,["force"]);return t!==void 0&&o!=null&&f(t,["_query","force"],o),a}function GE(s){const t={},a=u(s,["name"]);a!=null&&f(t,["_url","name"],a);const o=u(s,["config"]);return o!=null&&LE(o,t),t}function OE(s){const t={},a=u(s,["name"]);return a!=null&&f(t,["_url","name"],a),t}function PE(s,t){const a={},o=u(s,["pageSize"]);t!==void 0&&o!=null&&f(t,["_query","pageSize"],o);const c=u(s,["pageToken"]);return t!==void 0&&c!=null&&f(t,["_query","pageToken"],c),a}function HE(s){const t={},a=u(s,["parent"]);a!=null&&f(t,["_url","parent"],a);const o=u(s,["config"]);return o!=null&&PE(o,t),t}function BE(s){const t={},a=u(s,["sdkHttpResponse"]);a!=null&&f(t,["sdkHttpResponse"],a);const o=u(s,["nextPageToken"]);o!=null&&f(t,["nextPageToken"],o);const c=u(s,["documents"]);if(c!=null){let d=c;Array.isArray(d)&&(d=d.map(p=>p)),f(t,["documents"],d)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class VE extends Xn{constructor(t){super(),this.apiClient=t,this.list=async a=>new Qs(Kn.PAGED_ITEM_DOCUMENTS,o=>this.listInternal({parent:a.parent,config:o.config}),await this.listInternal(a),a)}async get(t){var a,o;let c,d="",p={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const g=OE(t);return d=Te("{name}",g._url),p=g._query,delete g._url,delete g._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(g),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),c.then(v=>v)}}async delete(t){var a,o;let c="",d={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const p=GE(t);c=Te("{name}",p._url),d=p._query,delete p._url,delete p._query,await this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(t){var a,o;let c,d="",p={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const g=HE(t);return d=Te("{parent}/documents",g._url),p=g._query,delete g._url,delete g._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(g),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),c.then(v=>{const h=BE(v),y=new Sy;return Object.assign(y,h),y})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qE extends Xn{constructor(t,a=new VE(t)){super(),this.apiClient=t,this.documents=a,this.list=async(o={})=>new Qs(Kn.PAGED_ITEM_FILE_SEARCH_STORES,c=>this.listInternal(c),await this.listInternal(o),o)}async uploadToFileSearchStore(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(t.fileSearchStoreName,t.file,t.config)}async create(t){var a,o;let c,d="",p={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const g=kN(t);return d=Te("fileSearchStores",g._url),p=g._query,delete g._url,delete g._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),c.then(v=>v)}}async get(t){var a,o;let c,d="",p={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const g=LN(t);return d=Te("{name}",g._url),p=g._query,delete g._url,delete g._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(g),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),c.then(v=>v)}}async delete(t){var a,o;let c="",d={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const p=UN(t);c=Te("{name}",p._url),d=p._query,delete p._url,delete p._query,await this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(t){var a,o;let c,d="",p={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const g=VN(t);return d=Te("fileSearchStores",g._url),p=g._query,delete g._url,delete g._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(g),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),c.then(v=>{const h=qN(v),y=new Ty;return Object.assign(y,h),y})}}async uploadToFileSearchStoreInternal(t){var a,o;let c,d="",p={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const g=JN(t);return d=Te("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",g._url),p=g._query,delete g._url,delete g._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),c.then(v=>{const h=zN(v),y=new Ny;return Object.assign(y,h),y})}}async importFile(t){var a,o;let c,d="",p={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const g=PN(t);return d=Te("{file_search_store_name}:importFile",g._url),p=g._query,delete g._url,delete g._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),c.then(v=>{const h=ON(v),y=new Su;return Object.assign(y,h),y})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Gg=function(){const{crypto:s}=globalThis;if(s!=null&&s.randomUUID)return Gg=s.randomUUID.bind(s),s.randomUUID();const t=new Uint8Array(1),a=s?()=>s.getRandomValues(t)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,o=>(+o^a()&15>>+o/4).toString(16))};const JE=()=>Gg();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function du(s){return typeof s=="object"&&s!==null&&("name"in s&&s.name==="AbortError"||"message"in s&&String(s.message).includes("FetchRequestCanceledException"))}const fu=s=>{if(s instanceof Error)return s;if(typeof s=="object"&&s!==null){try{if(Object.prototype.toString.call(s)==="[object Error]"){const t=new Error(s.message,s.cause?{cause:s.cause}:{});return s.stack&&(t.stack=s.stack),s.cause&&!t.cause&&(t.cause=s.cause),s.name&&(t.name=s.name),t}}catch{}try{return new Error(JSON.stringify(s))}catch{}}return new Error(s)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class gn extends Error{}class Bt extends gn{constructor(t,a,o,c){super(`${Bt.makeMessage(t,a,o)}`),this.status=t,this.headers=c,this.error=a}static makeMessage(t,a,o){const c=a!=null&&a.message?typeof a.message=="string"?a.message:JSON.stringify(a.message):a?JSON.stringify(a):o;return t&&c?`${t} ${c}`:t?`${t} status code (no body)`:c||"(no status code or body)"}static generate(t,a,o,c){if(!t||!c)return new ji({message:o,cause:fu(a)});const d=a;return t===400?new Pg(t,d,o,c):t===401?new Hg(t,d,o,c):t===403?new Bg(t,d,o,c):t===404?new Vg(t,d,o,c):t===409?new qg(t,d,o,c):t===422?new Jg(t,d,o,c):t===429?new zg(t,d,o,c):t>=500?new Fg(t,d,o,c):new Bt(t,d,o,c)}}class pu extends Bt{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class ji extends Bt{constructor({message:t,cause:a}){super(void 0,void 0,t||"Connection error.",void 0),a&&(this.cause=a)}}class Og extends ji{constructor({message:t}={}){super({message:t??"Request timed out."})}}class Pg extends Bt{}class Hg extends Bt{}class Bg extends Bt{}class Vg extends Bt{}class qg extends Bt{}class Jg extends Bt{}class zg extends Bt{}class Fg extends Bt{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const zE=/^[a-z][a-z0-9+.-]*:/i,FE=s=>zE.test(s);let mu=s=>(mu=Array.isArray,mu(s));const YE=mu;let $E=YE;const ng=$E;function KE(s){if(!s)return!0;for(const t in s)return!1;return!0}function XE(s,t){return Object.prototype.hasOwnProperty.call(s,t)}const QE=(s,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new gn(`${s} must be an integer`);if(t<0)throw new gn(`${s} must be a positive integer`);return t},WE=s=>{try{return JSON.parse(s)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ZE=s=>new Promise(t=>setTimeout(t,s));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ha="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eC(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const tC=()=>{var s,t,a,o,c;const d=eC();if(d==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ha,"X-Stainless-OS":ag(Deno.build.os),"X-Stainless-Arch":sg(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(t=(s=Deno.version)===null||s===void 0?void 0:s.deno)!==null&&t!==void 0?t:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ha,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(d==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ha,"X-Stainless-OS":ag((a=globalThis.process.platform)!==null&&a!==void 0?a:"unknown"),"X-Stainless-Arch":sg((o=globalThis.process.arch)!==null&&o!==void 0?o:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(c=globalThis.process.version)!==null&&c!==void 0?c:"unknown"};const p=nC();return p?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ha,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${p.browser}`,"X-Stainless-Runtime-Version":p.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ha,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function nC(){if(typeof navigator>"u"||!navigator)return null;const s=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:a}of s){const o=a.exec(navigator.userAgent);if(o){const c=o[1]||0,d=o[2]||0,p=o[3]||0;return{browser:t,version:`${c}.${d}.${p}`}}}return null}const sg=s=>s==="x32"?"x32":s==="x86_64"||s==="x64"?"x64":s==="arm"?"arm":s==="aarch64"||s==="arm64"?"arm64":s?`other:${s}`:"unknown",ag=s=>(s=s.toLowerCase(),s.includes("ios")?"iOS":s==="android"?"Android":s==="darwin"?"MacOS":s==="win32"?"Windows":s==="freebsd"?"FreeBSD":s==="openbsd"?"OpenBSD":s==="linux"?"Linux":s?`Other:${s}`:"Unknown");let hi;const sC=()=>hi??(hi=tC());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function aC(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Yg(...s){const t=globalThis.ReadableStream;if(typeof t>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...s)}function lC(s){let t=Symbol.asyncIterator in s?s[Symbol.asyncIterator]():s[Symbol.iterator]();return Yg({start(){},async pull(a){const{done:o,value:c}=await t.next();o?a.close():a.enqueue(c)},async cancel(){var a;await((a=t.return)===null||a===void 0?void 0:a.call(t))}})}function $g(s){if(s[Symbol.asyncIterator])return s;const t=s.getReader();return{async next(){try{const a=await t.read();return a!=null&&a.done&&t.releaseLock(),a}catch(a){throw t.releaseLock(),a}},async return(){const a=t.cancel();return t.releaseLock(),await a,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function oC(s){var t,a;if(s===null||typeof s!="object")return;if(s[Symbol.asyncIterator]){await((a=(t=s[Symbol.asyncIterator]()).return)===null||a===void 0?void 0:a.call(t));return}const o=s.getReader(),c=o.cancel();o.releaseLock(),await c}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const iC=({headers:s,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Kg=()=>{var s;if(typeof File>"u"){const{process:t}=globalThis,a=typeof((s=t==null?void 0:t.versions)===null||s===void 0?void 0:s.node)=="string"&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(a?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function tu(s,t,a){return Kg(),new File(s,t??"unknown_file",a)}function rC(s){return(typeof s=="object"&&s!==null&&("name"in s&&s.name&&String(s.name)||"url"in s&&s.url&&String(s.url)||"filename"in s&&s.filename&&String(s.filename)||"path"in s&&s.path&&String(s.path))||"").split(/[\\/]/).pop()||void 0}const cC=s=>s!=null&&typeof s=="object"&&typeof s[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Xg=s=>s!=null&&typeof s=="object"&&typeof s.size=="number"&&typeof s.type=="string"&&typeof s.text=="function"&&typeof s.slice=="function"&&typeof s.arrayBuffer=="function",uC=s=>s!=null&&typeof s=="object"&&typeof s.name=="string"&&typeof s.lastModified=="number"&&Xg(s),dC=s=>s!=null&&typeof s=="object"&&typeof s.url=="string"&&typeof s.blob=="function";async function fC(s,t,a){if(Kg(),s=await s,uC(s))return s instanceof File?s:tu([await s.arrayBuffer()],s.name);if(dC(s)){const c=await s.blob();return t||(t=new URL(s.url).pathname.split(/[\\/]/).pop()),tu(await hu(c),t,a)}const o=await hu(s);if(t||(t=rC(s)),!(a!=null&&a.type)){const c=o.find(d=>typeof d=="object"&&"type"in d&&d.type);typeof c=="string"&&(a=Object.assign(Object.assign({},a),{type:c}))}return tu(o,t,a)}async function hu(s){var t,a,o,c,d;let p=[];if(typeof s=="string"||ArrayBuffer.isView(s)||s instanceof ArrayBuffer)p.push(s);else if(Xg(s))p.push(s instanceof Blob?s:await s.arrayBuffer());else if(cC(s))try{for(var g=!0,v=Sn(s),h;h=await v.next(),t=h.done,!t;g=!0){c=h.value,g=!1;const y=c;p.push(...await hu(y))}}catch(y){a={error:y}}finally{try{!g&&!t&&(o=v.return)&&await o.call(v)}finally{if(a)throw a.error}}else{const y=(d=s==null?void 0:s.constructor)===null||d===void 0?void 0:d.name;throw new Error(`Unexpected data type: ${typeof s}${y?`; constructor: ${y}`:""}${pC(s)}`)}return p}function pC(s){return typeof s!="object"||s===null?"":`; props: [${Object.getOwnPropertyNames(s).map(a=>`"${a}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Qg{constructor(t){this._client=t}}Qg._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Wg(s){return s.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const lg=Object.freeze(Object.create(null)),mC=(s=Wg)=>(function(a,...o){if(a.length===1)return a[0];let c=!1;const d=[],p=a.reduce((y,b,S)=>{var N,k,w;/[?#]/.test(b)&&(c=!0);const M=o[S];let J=(c?encodeURIComponent:s)(""+M);return S!==o.length&&(M==null||typeof M=="object"&&M.toString===((w=Object.getPrototypeOf((k=Object.getPrototypeOf((N=M.hasOwnProperty)!==null&&N!==void 0?N:lg))!==null&&k!==void 0?k:lg))===null||w===void 0?void 0:w.toString))&&(J=M+"",d.push({start:y.length+b.length,length:J.length,error:`Value of type ${Object.prototype.toString.call(M).slice(8,-1)} is not a valid path parameter`})),y+b+(S===o.length?"":J)},""),g=p.split(/[?#]/,1)[0],v=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let h;for(;(h=v.exec(g))!==null;)d.push({start:h.index,length:h[0].length,error:`Value "${h[0]}" can't be safely passed as a path parameter`});if(d.sort((y,b)=>y.start-b.start),d.length>0){let y=0;const b=d.reduce((S,N)=>{const k=" ".repeat(N.start-y),w="^".repeat(N.length);return y=N.start+N.length,S+k+w},"");throw new gn(`Path parameters result in path with invalid segments:
${d.map(S=>S.error).join(`
`)}
${p}
${b}`)}return p}),gi=mC(Wg);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Zg extends Qg{create(t,a){var o;const{api_version:c=this._client.apiVersion}=t,d=Ai(t,["api_version"]);if("model"in d&&"agent_config"in d)throw new gn("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in d&&"generation_config"in d)throw new gn("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(gi`/${c}/interactions`,Object.assign(Object.assign({body:d},a),{stream:(o=t.stream)!==null&&o!==void 0?o:!1}))}delete(t,a={},o){const{api_version:c=this._client.apiVersion}=a??{};return this._client.delete(gi`/${c}/interactions/${t}`,o)}cancel(t,a={},o){const{api_version:c=this._client.apiVersion}=a??{};return this._client.post(gi`/${c}/interactions/${t}/cancel`,o)}get(t,a={},o){var c;const d=a??{},{api_version:p=this._client.apiVersion}=d,g=Ai(d,["api_version"]);return this._client.get(gi`/${p}/interactions/${t}`,Object.assign(Object.assign({query:g},o),{stream:(c=a==null?void 0:a.stream)!==null&&c!==void 0?c:!1}))}}Zg._key=Object.freeze(["interactions"]);class e0 extends Zg{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hC(s){let t=0;for(const c of s)t+=c.length;const a=new Uint8Array(t);let o=0;for(const c of s)a.set(c,o),o+=c.length;return a}let xi;function _u(s){let t;return(xi??(t=new globalThis.TextEncoder,xi=t.encode.bind(t)))(s)}let vi;function og(s){let t;return(vi??(t=new globalThis.TextDecoder,vi=t.decode.bind(t)))(s)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ui{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(t){if(t==null)return[];const a=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?_u(t):t;this.buffer=hC([this.buffer,a]);const o=[];let c;for(;(c=gC(this.buffer,this.carriageReturnIndex))!=null;){if(c.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=c.index;continue}if(this.carriageReturnIndex!=null&&(c.index!==this.carriageReturnIndex+1||c.carriage)){o.push(og(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const d=this.carriageReturnIndex!==null?c.preceding-1:c.preceding,p=og(this.buffer.subarray(0,d));o.push(p),this.buffer=this.buffer.subarray(c.index),this.carriageReturnIndex=null}return o}flush(){return this.buffer.length?this.decode(`
`):[]}}Ui.NEWLINE_CHARS=new Set([`
`,"\r"]);Ui.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function gC(s,t){for(let c=t??0;c<s.length;c++){if(s[c]===10)return{preceding:c,index:c+1,carriage:!1};if(s[c]===13)return{preceding:c,index:c+1,carriage:!0}}return null}function xC(s){for(let o=0;o<s.length-1;o++){if(s[o]===10&&s[o+1]===10||s[o]===13&&s[o+1]===13)return o+2;if(s[o]===13&&s[o+1]===10&&o+3<s.length&&s[o+2]===13&&s[o+3]===10)return o+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const _i={off:0,error:200,warn:300,info:400,debug:500},ig=(s,t,a)=>{if(s){if(XE(_i,s))return s;Ht(a).warn(`${t} was set to ${JSON.stringify(s)}, expected one of ${JSON.stringify(Object.keys(_i))}`)}};function Yl(){}function yi(s,t,a){return!t||_i[s]>_i[a]?Yl:t[s].bind(t)}const vC={error:Yl,warn:Yl,info:Yl,debug:Yl};let rg=new WeakMap;function Ht(s){var t;const a=s.logger,o=(t=s.logLevel)!==null&&t!==void 0?t:"off";if(!a)return vC;const c=rg.get(a);if(c&&c[0]===o)return c[1];const d={error:yi("error",a,o),warn:yi("warn",a,o),info:yi("info",a,o),debug:yi("debug",a,o)};return rg.set(a,[o,d]),d}const Ks=s=>(s.options&&(s.options=Object.assign({},s.options),delete s.options.headers),s.headers&&(s.headers=Object.fromEntries((s.headers instanceof Headers?[...s.headers]:Object.entries(s.headers)).map(([t,a])=>[t,t.toLowerCase()==="x-goog-api-key"||t.toLowerCase()==="authorization"||t.toLowerCase()==="cookie"||t.toLowerCase()==="set-cookie"?"***":a]))),"retryOfRequestLogID"in s&&(s.retryOfRequestLogID&&(s.retryOf=s.retryOfRequestLogID),delete s.retryOfRequestLogID),s);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Va{constructor(t,a,o){this.iterator=t,this.controller=a,this.client=o}static fromSSEResponse(t,a,o){let c=!1;const d=o?Ht(o):console;function p(){return bn(this,arguments,function*(){var v,h,y,b;if(c)throw new gn("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");c=!0;let S=!1;try{try{for(var N=!0,k=Sn(yC(t,a)),w;w=yield Ue(k.next()),v=w.done,!v;N=!0){b=w.value,N=!1;const M=b;if(!S)if(M.data.startsWith("[DONE]")){S=!0;continue}else try{yield yield Ue(JSON.parse(M.data))}catch(J){throw d.error("Could not parse message into JSON:",M.data),d.error("From chunk:",M.raw),J}}}catch(M){h={error:M}}finally{try{!N&&!v&&(y=k.return)&&(yield Ue(y.call(k)))}finally{if(h)throw h.error}}S=!0}catch(M){if(du(M))return yield Ue(void 0);throw M}finally{S||a.abort()}})}return new Va(p,a,o)}static fromReadableStream(t,a,o){let c=!1;function d(){return bn(this,arguments,function*(){var v,h,y,b;const S=new Ui,N=$g(t);try{for(var k=!0,w=Sn(N),M;M=yield Ue(w.next()),v=M.done,!v;k=!0){b=M.value,k=!1;const J=b;for(const ce of S.decode(J))yield yield Ue(ce)}}catch(J){h={error:J}}finally{try{!k&&!v&&(y=w.return)&&(yield Ue(y.call(w)))}finally{if(h)throw h.error}}for(const J of S.flush())yield yield Ue(J)})}function p(){return bn(this,arguments,function*(){var v,h,y,b;if(c)throw new gn("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");c=!0;let S=!1;try{try{for(var N=!0,k=Sn(d()),w;w=yield Ue(k.next()),v=w.done,!v;N=!0){b=w.value,N=!1;const M=b;S||M&&(yield yield Ue(JSON.parse(M)))}}catch(M){h={error:M}}finally{try{!N&&!v&&(y=k.return)&&(yield Ue(y.call(k)))}finally{if(h)throw h.error}}S=!0}catch(M){if(du(M))return yield Ue(void 0);throw M}finally{S||a.abort()}})}return new Va(p,a,o)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],a=[],o=this.iterator(),c=d=>({next:()=>{if(d.length===0){const p=o.next();t.push(p),a.push(p)}return d.shift()}});return[new Va(()=>c(t),this.controller,this.client),new Va(()=>c(a),this.controller,this.client)]}toReadableStream(){const t=this;let a;return Yg({async start(){a=t[Symbol.asyncIterator]()},async pull(o){try{const{value:c,done:d}=await a.next();if(d)return o.close();const p=_u(JSON.stringify(c)+`
`);o.enqueue(p)}catch(c){o.error(c)}},async cancel(){var o;await((o=a.return)===null||o===void 0?void 0:o.call(a))}})}}function yC(s,t){return bn(this,arguments,function*(){var o,c,d,p;if(!s.body)throw t.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new gn("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new gn("Attempted to iterate over a response with no body");const g=new SC,v=new Ui,h=$g(s.body);try{for(var y=!0,b=Sn(bC(h)),S;S=yield Ue(b.next()),o=S.done,!o;y=!0){p=S.value,y=!1;const N=p;for(const k of v.decode(N)){const w=g.decode(k);w&&(yield yield Ue(w))}}}catch(N){c={error:N}}finally{try{!y&&!o&&(d=b.return)&&(yield Ue(d.call(b)))}finally{if(c)throw c.error}}for(const N of v.flush()){const k=g.decode(N);k&&(yield yield Ue(k))}})}function bC(s){return bn(this,arguments,function*(){var a,o,c,d;let p=new Uint8Array;try{for(var g=!0,v=Sn(s),h;h=yield Ue(v.next()),a=h.done,!a;g=!0){d=h.value,g=!1;const y=d;if(y==null)continue;const b=y instanceof ArrayBuffer?new Uint8Array(y):typeof y=="string"?_u(y):y;let S=new Uint8Array(p.length+b.length);S.set(p),S.set(b,p.length),p=S;let N;for(;(N=xC(p))!==-1;)yield yield Ue(p.slice(0,N)),p=p.slice(N)}}catch(y){o={error:y}}finally{try{!g&&!a&&(c=v.return)&&(yield Ue(c.call(v)))}finally{if(o)throw o.error}}p.length>0&&(yield yield Ue(p))})}class SC{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const d={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],d}if(this.chunks.push(t),t.startsWith(":"))return null;let[a,o,c]=TC(t,":");return c.startsWith(" ")&&(c=c.substring(1)),a==="event"?this.event=c:a==="data"&&this.data.push(c),null}}function TC(s,t){const a=s.indexOf(t);return a!==-1?[s.substring(0,a),t,s.substring(a+t.length)]:[s,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function NC(s,t){const{response:a,requestLogID:o,retryOfRequestLogID:c,startTime:d}=t,p=await(async()=>{var g;if(t.options.stream)return Ht(s).debug("response",a.status,a.url,a.headers,a.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(a,t.controller,s):Va.fromSSEResponse(a,t.controller,s);if(a.status===204)return null;if(t.options.__binaryResponse)return a;const v=a.headers.get("content-type"),h=(g=v==null?void 0:v.split(";")[0])===null||g===void 0?void 0:g.trim();return(h==null?void 0:h.includes("application/json"))||(h==null?void 0:h.endsWith("+json"))?await a.json():await a.text()})();return Ht(s).debug(`[${o}] response parsed`,Ks({retryOfRequestLogID:c,url:a.url,status:a.status,body:p,durationMs:Date.now()-d})),p}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ru extends Promise{constructor(t,a,o=NC){super(c=>{c(null)}),this.responsePromise=a,this.parseResponse=o,this.client=t}_thenUnwrap(t){return new Ru(this.client,this.responsePromise,async(a,o)=>t(await this.parseResponse(a,o),o))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,a]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:a}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(t=>this.parseResponse(this.client,t))),this.parsedPromise}then(t,a){return this.parse().then(t,a)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const t0=Symbol("brand.privateNullableHeaders");function*EC(s){if(!s)return;if(t0 in s){const{values:o,nulls:c}=s;yield*o.entries();for(const d of c)yield[d,null];return}let t=!1,a;s instanceof Headers?a=s.entries():ng(s)?a=s:(t=!0,a=Object.entries(s??{}));for(let o of a){const c=o[0];if(typeof c!="string")throw new TypeError("expected header name to be a string");const d=ng(o[1])?o[1]:[o[1]];let p=!1;for(const g of d)g!==void 0&&(t&&!p&&(p=!0,yield[c,null]),yield[c,g])}}const Fl=s=>{const t=new Headers,a=new Set;for(const o of s){const c=new Set;for(const[d,p]of EC(o)){const g=d.toLowerCase();c.has(g)||(t.delete(d),c.add(g)),p===null?(t.delete(d),a.add(g)):(t.append(d,p),a.delete(g))}}return{[t0]:!0,values:t,nulls:a}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const nu=s=>{var t,a,o,c,d,p;if(typeof globalThis.process<"u")return(o=(a=(t=Xv)===null||t===void 0?void 0:t[s])===null||a===void 0?void 0:a.trim())!==null&&o!==void 0?o:void 0;if(typeof globalThis.Deno<"u")return(p=(d=(c=globalThis.Deno.env)===null||c===void 0?void 0:c.get)===null||d===void 0?void 0:d.call(c,s))===null||p===void 0?void 0:p.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var n0;class Li{constructor(t){var a,o,c,d,p,g,v,{baseURL:h=nu("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:y=(a=nu("GEMINI_API_KEY"))!==null&&a!==void 0?a:null,apiVersion:b="v1beta"}=t,S=Ai(t,["baseURL","apiKey","apiVersion"]);const N=Object.assign(Object.assign({apiKey:y,apiVersion:b},S),{baseURL:h||"https://generativelanguage.googleapis.com"});this.baseURL=N.baseURL,this.timeout=(o=N.timeout)!==null&&o!==void 0?o:Li.DEFAULT_TIMEOUT,this.logger=(c=N.logger)!==null&&c!==void 0?c:console;const k="warn";this.logLevel=k,this.logLevel=(p=(d=ig(N.logLevel,"ClientOptions.logLevel",this))!==null&&d!==void 0?d:ig(nu("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&p!==void 0?p:k,this.fetchOptions=N.fetchOptions,this.maxRetries=(g=N.maxRetries)!==null&&g!==void 0?g:2,this.fetch=(v=N.fetch)!==null&&v!==void 0?v:aC(),this.encoder=iC,this._options=N,this.apiKey=y,this.apiVersion=b,this.clientAdapter=N.clientAdapter}withOptions(t){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),t))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:t,nulls:a}){if(!(t.has("authorization")||t.has("x-goog-api-key"))&&!(this.apiKey&&t.get("x-goog-api-key"))&&!a.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(t){const a=Fl([t.headers]);if(!(a.values.has("authorization")||a.values.has("x-goog-api-key"))){if(this.apiKey)return Fl([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return Fl([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(t){return Object.entries(t).filter(([a,o])=>typeof o<"u").map(([a,o])=>{if(typeof o=="string"||typeof o=="number"||typeof o=="boolean")return`${encodeURIComponent(a)}=${encodeURIComponent(o)}`;if(o===null)return`${encodeURIComponent(a)}=`;throw new gn(`Cannot stringify type ${typeof o}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Ha}`}defaultIdempotencyKey(){return`stainless-node-retry-${JE()}`}makeStatusError(t,a,o,c){return Bt.generate(t,a,o,c)}buildURL(t,a,o){const c=!this.baseURLOverridden()&&o||this.baseURL,d=FE(t)?new URL(t):new URL(c+(c.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),p=this.defaultQuery();return KE(p)||(a=Object.assign(Object.assign({},p),a)),typeof a=="object"&&a&&!Array.isArray(a)&&(d.search=this.stringifyQuery(a)),d.toString()}async prepareOptions(t){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!t.path.startsWith(`/${this.apiVersion}/projects/`)){const a=t.path.slice(this.apiVersion.length+1);t.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${a}`}}async prepareRequest(t,{url:a,options:o}){}get(t,a){return this.methodRequest("get",t,a)}post(t,a){return this.methodRequest("post",t,a)}patch(t,a){return this.methodRequest("patch",t,a)}put(t,a){return this.methodRequest("put",t,a)}delete(t,a){return this.methodRequest("delete",t,a)}methodRequest(t,a,o){return this.request(Promise.resolve(o).then(c=>Object.assign({method:t,path:a},c)))}request(t,a=null){return new Ru(this,this.makeRequest(t,a,void 0))}async makeRequest(t,a,o){var c,d,p;const g=await t,v=(c=g.maxRetries)!==null&&c!==void 0?c:this.maxRetries;a==null&&(a=v),await this.prepareOptions(g);const{req:h,url:y,timeout:b}=await this.buildRequest(g,{retryCount:v-a});await this.prepareRequest(h,{url:y,options:g});const S="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),N=o===void 0?"":`, retryOf: ${o}`,k=Date.now();if(Ht(this).debug(`[${S}] sending request`,Ks({retryOfRequestLogID:o,method:g.method,url:y,options:g,headers:h.headers})),!((d=g.signal)===null||d===void 0)&&d.aborted)throw new pu;const w=new AbortController,M=await this.fetchWithTimeout(y,h,b,w).catch(fu),J=Date.now();if(M instanceof globalThis.Error){const ee=`retrying, ${a} attempts remaining`;if(!((p=g.signal)===null||p===void 0)&&p.aborted)throw new pu;const P=du(M)||/timed? ?out/i.test(String(M)+("cause"in M?String(M.cause):""));if(a)return Ht(this).info(`[${S}] connection ${P?"timed out":"failed"} - ${ee}`),Ht(this).debug(`[${S}] connection ${P?"timed out":"failed"} (${ee})`,Ks({retryOfRequestLogID:o,url:y,durationMs:J-k,message:M.message})),this.retryRequest(g,a,o??S);throw Ht(this).info(`[${S}] connection ${P?"timed out":"failed"} - error; no more retries left`),Ht(this).debug(`[${S}] connection ${P?"timed out":"failed"} (error; no more retries left)`,Ks({retryOfRequestLogID:o,url:y,durationMs:J-k,message:M.message})),P?new Og:new ji({cause:M})}const ce=`[${S}${N}] ${h.method} ${y} ${M.ok?"succeeded":"failed"} with status ${M.status} in ${J-k}ms`;if(!M.ok){const ee=await this.shouldRetry(M);if(a&&ee){const X=`retrying, ${a} attempts remaining`;return await oC(M.body),Ht(this).info(`${ce} - ${X}`),Ht(this).debug(`[${S}] response error (${X})`,Ks({retryOfRequestLogID:o,url:M.url,status:M.status,headers:M.headers,durationMs:J-k})),this.retryRequest(g,a,o??S,M.headers)}const P=ee?"error; no more retries left":"error; not retryable";Ht(this).info(`${ce} - ${P}`);const Q=await M.text().catch(X=>fu(X).message),H=WE(Q),V=H?void 0:Q;throw Ht(this).debug(`[${S}] response error (${P})`,Ks({retryOfRequestLogID:o,url:M.url,status:M.status,headers:M.headers,message:V,durationMs:Date.now()-k})),this.makeStatusError(M.status,H,V,M.headers)}return Ht(this).info(ce),Ht(this).debug(`[${S}] response start`,Ks({retryOfRequestLogID:o,url:M.url,status:M.status,headers:M.headers,durationMs:J-k})),{response:M,options:g,controller:w,requestLogID:S,retryOfRequestLogID:o,startTime:k}}async fetchWithTimeout(t,a,o,c){const d=a||{},{signal:p,method:g}=d,v=Ai(d,["signal","method"]);p&&p.addEventListener("abort",()=>c.abort());const h=setTimeout(()=>c.abort(),o),y=globalThis.ReadableStream&&v.body instanceof globalThis.ReadableStream||typeof v.body=="object"&&v.body!==null&&Symbol.asyncIterator in v.body,b=Object.assign(Object.assign(Object.assign({signal:c.signal},y?{duplex:"half"}:{}),{method:"GET"}),v);g&&(b.method=g.toUpperCase());try{return await this.fetch.call(void 0,t,b)}finally{clearTimeout(h)}}async shouldRetry(t){const a=t.headers.get("x-should-retry");return a==="true"?!0:a==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,a,o,c){var d;let p;const g=c==null?void 0:c.get("retry-after-ms");if(g){const h=parseFloat(g);Number.isNaN(h)||(p=h)}const v=c==null?void 0:c.get("retry-after");if(v&&!p){const h=parseFloat(v);Number.isNaN(h)?p=Date.parse(v)-Date.now():p=h*1e3}if(!(p&&0<=p&&p<60*1e3)){const h=(d=t.maxRetries)!==null&&d!==void 0?d:this.maxRetries;p=this.calculateDefaultRetryTimeoutMillis(a,h)}return await ZE(p),this.makeRequest(t,a-1,o)}calculateDefaultRetryTimeoutMillis(t,a){const d=a-t,p=Math.min(.5*Math.pow(2,d),8),g=1-Math.random()*.25;return p*g*1e3}async buildRequest(t,{retryCount:a=0}={}){var o,c,d;const p=Object.assign({},t),{method:g,path:v,query:h,defaultBaseURL:y}=p,b=this.buildURL(v,h,y);"timeout"in p&&QE("timeout",p.timeout),p.timeout=(o=p.timeout)!==null&&o!==void 0?o:this.timeout;const{bodyHeaders:S,body:N}=this.buildBody({options:p}),k=await this.buildHeaders({options:t,method:g,bodyHeaders:S,retryCount:a});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:g,headers:k},p.signal&&{signal:p.signal}),globalThis.ReadableStream&&N instanceof globalThis.ReadableStream&&{duplex:"half"}),N&&{body:N}),(c=this.fetchOptions)!==null&&c!==void 0?c:{}),(d=p.fetchOptions)!==null&&d!==void 0?d:{}),url:b,timeout:p.timeout}}async buildHeaders({options:t,method:a,bodyHeaders:o,retryCount:c}){let d={};this.idempotencyHeader&&a!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),d[this.idempotencyHeader]=t.idempotencyKey);const p=await this.authHeaders(t);let g=Fl([d,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(c)},t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{}),sC()),this._options.defaultHeaders,o,t.headers,p]);return this.validateHeaders(g),g.values}buildBody({options:{body:t,headers:a}}){if(!t)return{bodyHeaders:void 0,body:void 0};const o=Fl([a]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||typeof t=="string"&&o.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:typeof t=="object"&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&typeof t.next=="function")?{bodyHeaders:void 0,body:lC(t)}:this.encoder({body:t,headers:o})}}Li.DEFAULT_TIMEOUT=6e4;class Ct extends Li{constructor(){super(...arguments),this.interactions=new e0(this)}}n0=Ct;Ct.GeminiNextGenAPIClient=n0;Ct.GeminiNextGenAPIClientError=gn;Ct.APIError=Bt;Ct.APIConnectionError=ji;Ct.APIConnectionTimeoutError=Og;Ct.APIUserAbortError=pu;Ct.NotFoundError=Vg;Ct.ConflictError=qg;Ct.RateLimitError=zg;Ct.BadRequestError=Pg;Ct.AuthenticationError=Hg;Ct.InternalServerError=Fg;Ct.PermissionDeniedError=Bg;Ct.UnprocessableEntityError=Jg;Ct.toFile=fC;Ct.Interactions=e0;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function CC(s,t){const a={},o=u(s,["name"]);return o!=null&&f(a,["_url","name"],o),a}function wC(s,t){const a={},o=u(s,["name"]);return o!=null&&f(a,["_url","name"],o),a}function AC(s,t){const a={},o=u(s,["sdkHttpResponse"]);return o!=null&&f(a,["sdkHttpResponse"],o),a}function _C(s,t){const a={},o=u(s,["sdkHttpResponse"]);return o!=null&&f(a,["sdkHttpResponse"],o),a}function RC(s,t,a){const o={};if(u(s,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const c=u(s,["tunedModelDisplayName"]);if(t!==void 0&&c!=null&&f(t,["displayName"],c),u(s,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const d=u(s,["epochCount"]);t!==void 0&&d!=null&&f(t,["tuningTask","hyperparameters","epochCount"],d);const p=u(s,["learningRateMultiplier"]);if(p!=null&&f(o,["tuningTask","hyperparameters","learningRateMultiplier"],p),u(s,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(u(s,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(u(s,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const g=u(s,["batchSize"]);t!==void 0&&g!=null&&f(t,["tuningTask","hyperparameters","batchSize"],g);const v=u(s,["learningRate"]);if(t!==void 0&&v!=null&&f(t,["tuningTask","hyperparameters","learningRate"],v),u(s,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(u(s,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return o}function IC(s,t,a){const o={};let c=u(a,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const N=u(s,["validationDataset"]);t!==void 0&&N!=null&&f(t,["supervisedTuningSpec"],cg(N))}else if(c==="PREFERENCE_TUNING"){const N=u(s,["validationDataset"]);t!==void 0&&N!=null&&f(t,["preferenceOptimizationSpec"],cg(N))}const d=u(s,["tunedModelDisplayName"]);t!==void 0&&d!=null&&f(t,["tunedModelDisplayName"],d);const p=u(s,["description"]);t!==void 0&&p!=null&&f(t,["description"],p);let g=u(a,["config","method"]);if(g===void 0&&(g="SUPERVISED_FINE_TUNING"),g==="SUPERVISED_FINE_TUNING"){const N=u(s,["epochCount"]);t!==void 0&&N!=null&&f(t,["supervisedTuningSpec","hyperParameters","epochCount"],N)}else if(g==="PREFERENCE_TUNING"){const N=u(s,["epochCount"]);t!==void 0&&N!=null&&f(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],N)}let v=u(a,["config","method"]);if(v===void 0&&(v="SUPERVISED_FINE_TUNING"),v==="SUPERVISED_FINE_TUNING"){const N=u(s,["learningRateMultiplier"]);t!==void 0&&N!=null&&f(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],N)}else if(v==="PREFERENCE_TUNING"){const N=u(s,["learningRateMultiplier"]);t!==void 0&&N!=null&&f(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],N)}let h=u(a,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const N=u(s,["exportLastCheckpointOnly"]);t!==void 0&&N!=null&&f(t,["supervisedTuningSpec","exportLastCheckpointOnly"],N)}else if(h==="PREFERENCE_TUNING"){const N=u(s,["exportLastCheckpointOnly"]);t!==void 0&&N!=null&&f(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],N)}let y=u(a,["config","method"]);if(y===void 0&&(y="SUPERVISED_FINE_TUNING"),y==="SUPERVISED_FINE_TUNING"){const N=u(s,["adapterSize"]);t!==void 0&&N!=null&&f(t,["supervisedTuningSpec","hyperParameters","adapterSize"],N)}else if(y==="PREFERENCE_TUNING"){const N=u(s,["adapterSize"]);t!==void 0&&N!=null&&f(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],N)}if(u(s,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(u(s,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const b=u(s,["labels"]);t!==void 0&&b!=null&&f(t,["labels"],b);const S=u(s,["beta"]);return t!==void 0&&S!=null&&f(t,["preferenceOptimizationSpec","hyperParameters","beta"],S),o}function MC(s,t){const a={},o=u(s,["baseModel"]);o!=null&&f(a,["baseModel"],o);const c=u(s,["preTunedModel"]);c!=null&&f(a,["preTunedModel"],c);const d=u(s,["trainingDataset"]);d!=null&&VC(d);const p=u(s,["config"]);return p!=null&&RC(p,a),a}function DC(s,t){const a={},o=u(s,["baseModel"]);o!=null&&f(a,["baseModel"],o);const c=u(s,["preTunedModel"]);c!=null&&f(a,["preTunedModel"],c);const d=u(s,["trainingDataset"]);d!=null&&qC(d,a,t);const p=u(s,["config"]);return p!=null&&IC(p,a,t),a}function kC(s,t){const a={},o=u(s,["name"]);return o!=null&&f(a,["_url","name"],o),a}function jC(s,t){const a={},o=u(s,["name"]);return o!=null&&f(a,["_url","name"],o),a}function UC(s,t,a){const o={},c=u(s,["pageSize"]);t!==void 0&&c!=null&&f(t,["_query","pageSize"],c);const d=u(s,["pageToken"]);t!==void 0&&d!=null&&f(t,["_query","pageToken"],d);const p=u(s,["filter"]);return t!==void 0&&p!=null&&f(t,["_query","filter"],p),o}function LC(s,t,a){const o={},c=u(s,["pageSize"]);t!==void 0&&c!=null&&f(t,["_query","pageSize"],c);const d=u(s,["pageToken"]);t!==void 0&&d!=null&&f(t,["_query","pageToken"],d);const p=u(s,["filter"]);return t!==void 0&&p!=null&&f(t,["_query","filter"],p),o}function GC(s,t){const a={},o=u(s,["config"]);return o!=null&&UC(o,a),a}function OC(s,t){const a={},o=u(s,["config"]);return o!=null&&LC(o,a),a}function PC(s,t){const a={},o=u(s,["sdkHttpResponse"]);o!=null&&f(a,["sdkHttpResponse"],o);const c=u(s,["nextPageToken"]);c!=null&&f(a,["nextPageToken"],c);const d=u(s,["tunedModels"]);if(d!=null){let p=d;Array.isArray(p)&&(p=p.map(g=>s0(g))),f(a,["tuningJobs"],p)}return a}function HC(s,t){const a={},o=u(s,["sdkHttpResponse"]);o!=null&&f(a,["sdkHttpResponse"],o);const c=u(s,["nextPageToken"]);c!=null&&f(a,["nextPageToken"],c);const d=u(s,["tuningJobs"]);if(d!=null){let p=d;Array.isArray(p)&&(p=p.map(g=>gu(g))),f(a,["tuningJobs"],p)}return a}function BC(s,t){const a={},o=u(s,["name"]);o!=null&&f(a,["model"],o);const c=u(s,["name"]);return c!=null&&f(a,["endpoint"],c),a}function VC(s,t){const a={};if(u(s,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(u(s,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const o=u(s,["examples"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(d=>d)),f(a,["examples","examples"],c)}return a}function qC(s,t,a){const o={};let c=u(a,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const p=u(s,["gcsUri"]);t!==void 0&&p!=null&&f(t,["supervisedTuningSpec","trainingDatasetUri"],p)}else if(c==="PREFERENCE_TUNING"){const p=u(s,["gcsUri"]);t!==void 0&&p!=null&&f(t,["preferenceOptimizationSpec","trainingDatasetUri"],p)}let d=u(a,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const p=u(s,["vertexDatasetResource"]);t!==void 0&&p!=null&&f(t,["supervisedTuningSpec","trainingDatasetUri"],p)}else if(d==="PREFERENCE_TUNING"){const p=u(s,["vertexDatasetResource"]);t!==void 0&&p!=null&&f(t,["preferenceOptimizationSpec","trainingDatasetUri"],p)}if(u(s,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return o}function s0(s,t){const a={},o=u(s,["sdkHttpResponse"]);o!=null&&f(a,["sdkHttpResponse"],o);const c=u(s,["name"]);c!=null&&f(a,["name"],c);const d=u(s,["state"]);d!=null&&f(a,["state"],yg(d));const p=u(s,["createTime"]);p!=null&&f(a,["createTime"],p);const g=u(s,["tuningTask","startTime"]);g!=null&&f(a,["startTime"],g);const v=u(s,["tuningTask","completeTime"]);v!=null&&f(a,["endTime"],v);const h=u(s,["updateTime"]);h!=null&&f(a,["updateTime"],h);const y=u(s,["description"]);y!=null&&f(a,["description"],y);const b=u(s,["baseModel"]);b!=null&&f(a,["baseModel"],b);const S=u(s,["_self"]);return S!=null&&f(a,["tunedModel"],BC(S)),a}function gu(s,t){const a={},o=u(s,["sdkHttpResponse"]);o!=null&&f(a,["sdkHttpResponse"],o);const c=u(s,["name"]);c!=null&&f(a,["name"],c);const d=u(s,["state"]);d!=null&&f(a,["state"],yg(d));const p=u(s,["createTime"]);p!=null&&f(a,["createTime"],p);const g=u(s,["startTime"]);g!=null&&f(a,["startTime"],g);const v=u(s,["endTime"]);v!=null&&f(a,["endTime"],v);const h=u(s,["updateTime"]);h!=null&&f(a,["updateTime"],h);const y=u(s,["error"]);y!=null&&f(a,["error"],y);const b=u(s,["description"]);b!=null&&f(a,["description"],b);const S=u(s,["baseModel"]);S!=null&&f(a,["baseModel"],S);const N=u(s,["tunedModel"]);N!=null&&f(a,["tunedModel"],N);const k=u(s,["preTunedModel"]);k!=null&&f(a,["preTunedModel"],k);const w=u(s,["supervisedTuningSpec"]);w!=null&&f(a,["supervisedTuningSpec"],w);const M=u(s,["preferenceOptimizationSpec"]);M!=null&&f(a,["preferenceOptimizationSpec"],M);const J=u(s,["tuningDataStats"]);J!=null&&f(a,["tuningDataStats"],J);const ce=u(s,["encryptionSpec"]);ce!=null&&f(a,["encryptionSpec"],ce);const ee=u(s,["partnerModelTuningSpec"]);ee!=null&&f(a,["partnerModelTuningSpec"],ee);const P=u(s,["customBaseModel"]);P!=null&&f(a,["customBaseModel"],P);const Q=u(s,["experiment"]);Q!=null&&f(a,["experiment"],Q);const H=u(s,["labels"]);H!=null&&f(a,["labels"],H);const V=u(s,["outputUri"]);V!=null&&f(a,["outputUri"],V);const q=u(s,["pipelineJob"]);q!=null&&f(a,["pipelineJob"],q);const X=u(s,["serviceAccount"]);X!=null&&f(a,["serviceAccount"],X);const fe=u(s,["tunedModelDisplayName"]);fe!=null&&f(a,["tunedModelDisplayName"],fe);const F=u(s,["veoTuningSpec"]);return F!=null&&f(a,["veoTuningSpec"],F),a}function JC(s,t){const a={},o=u(s,["sdkHttpResponse"]);o!=null&&f(a,["sdkHttpResponse"],o);const c=u(s,["name"]);c!=null&&f(a,["name"],c);const d=u(s,["metadata"]);d!=null&&f(a,["metadata"],d);const p=u(s,["done"]);p!=null&&f(a,["done"],p);const g=u(s,["error"]);return g!=null&&f(a,["error"],g),a}function cg(s,t){const a={},o=u(s,["gcsUri"]);o!=null&&f(a,["validationDatasetUri"],o);const c=u(s,["vertexDatasetResource"]);return c!=null&&f(a,["validationDatasetUri"],c),a}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class zC extends Xn{constructor(t){super(),this.apiClient=t,this.list=async(a={})=>new Qs(Kn.PAGED_ITEM_TUNING_JOBS,o=>this.listInternal(o),await this.listInternal(a),a),this.get=async a=>await this.getInternal(a),this.tune=async a=>{var o;if(this.apiClient.isVertexAI())if(a.baseModel.startsWith("projects/")){const c={tunedModelName:a.baseModel};!((o=a.config)===null||o===void 0)&&o.preTunedModelCheckpointId&&(c.checkpointId=a.config.preTunedModelCheckpointId);const d=Object.assign(Object.assign({},a),{preTunedModel:c});return d.baseModel=void 0,await this.tuneInternal(d)}else{const c=Object.assign({},a);return await this.tuneInternal(c)}else{const c=Object.assign({},a),d=await this.tuneMldevInternal(c);let p="";return d.metadata!==void 0&&d.metadata.tunedModel!==void 0?p=d.metadata.tunedModel:d.name!==void 0&&d.name.includes("/operations/")&&(p=d.name.split("/operations/")[0]),{name:p,state:au.JOB_STATE_QUEUED}}}}async getInternal(t){var a,o,c,d;let p,g="",v={};if(this.apiClient.isVertexAI()){const h=jC(t);return g=Te("{name}",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>gu(y))}else{const h=kC(t);return g=Te("{name}",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>s0(y))}}async listInternal(t){var a,o,c,d;let p,g="",v={};if(this.apiClient.isVertexAI()){const h=OC(t);return g=Te("tuningJobs",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>{const b=HC(y),S=new Uh;return Object.assign(S,b),S})}else{const h=GC(t);return g=Te("tunedModels",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>{const b=PC(y),S=new Uh;return Object.assign(S,b),S})}}async cancel(t){var a,o,c,d;let p,g="",v={};if(this.apiClient.isVertexAI()){const h=wC(t);return g=Te("{name}:cancel",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>{const b=_C(y),S=new Lh;return Object.assign(S,b),S})}else{const h=CC(t);return g=Te("{name}:cancel",h._url),v=h._query,delete h._url,delete h._query,p=this.apiClient.request({path:g,queryParams:v,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(c=t.config)===null||c===void 0?void 0:c.httpOptions,abortSignal:(d=t.config)===null||d===void 0?void 0:d.abortSignal}).then(y=>y.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:y.headers},S})),p.then(y=>{const b=AC(y),S=new Lh;return Object.assign(S,b),S})}}async tuneInternal(t){var a,o;let c,d="",p={};if(this.apiClient.isVertexAI()){const g=DC(t,t);return d=Te("tuningJobs",g._url),p=g._query,delete g._url,delete g._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(h=>{const y=h;return y.sdkHttpResponse={headers:v.headers},y})),c.then(v=>gu(v))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var a,o;let c,d="",p={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const g=MC(t);return d=Te("tunedModels",g._url),p=g._query,delete g._url,delete g._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(h=>{const y=h;return y.sdkHttpResponse={headers:v.headers},y})),c.then(v=>JC(v))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class FC{async download(t,a){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const YC=1024*1024*8,$C=3,KC=1e3,XC=2,Ri="x-goog-upload-status";async function QC(s,t,a){var o;const c=await a0(s,t,a),d=await(c==null?void 0:c.json());if(((o=c==null?void 0:c.headers)===null||o===void 0?void 0:o[Ri])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return d.file}async function WC(s,t,a){var o;const c=await a0(s,t,a),d=await(c==null?void 0:c.json());if(((o=c==null?void 0:c.headers)===null||o===void 0?void 0:o[Ri])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const p=pg(d),g=new Tu;return Object.assign(g,p),g}async function a0(s,t,a){var o,c;let d=0,p=0,g=new lu(new Response),v="upload";for(d=s.size;p<d;){const h=Math.min(YC,d-p),y=s.slice(p,p+h);p+h>=d&&(v+=", finalize");let b=0,S=KC;for(;b<$C&&(g=await a.request({path:"",body:y,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":v,"X-Goog-Upload-Offset":String(p),"Content-Length":String(h)}}}),!(!((o=g==null?void 0:g.headers)===null||o===void 0)&&o[Ri]));)b++,await ew(S),S=S*XC;if(p+=h,((c=g==null?void 0:g.headers)===null||c===void 0?void 0:c[Ri])!=="active")break;if(d<=p)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return g}async function ZC(s){return{size:s.size,type:s.type}}function ew(s){return new Promise(t=>setTimeout(t,s))}class tw{async upload(t,a,o){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await QC(t,a,o)}async uploadToFileSearchStore(t,a,o){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await WC(t,a,o)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await ZC(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nw{create(t,a,o){return new sw(t,a,o)}}class sw{constructor(t,a,o){this.url=t,this.headers=a,this.callbacks=o}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ug="x-goog-api-key";class aw{constructor(t){this.apiKey=t}async addAuthHeaders(t,a){if(t.get(ug)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(ug,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const lw="gl-node/";class l0{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const t=this.httpOptions;t!=null&&t.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const a=new Ct({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:t==null?void 0:t.timeout});return this._interactions=a.interactions,this._interactions}constructor(t){var a;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(a=t.vertexai)!==null&&a!==void 0?a:!1,this.apiKey=t.apiKey;const o=ey(t.httpOptions,t.vertexai,void 0,void 0);o&&(t.httpOptions?t.httpOptions.baseUrl=o:t.httpOptions={baseUrl:o}),this.apiVersion=t.apiVersion,this.httpOptions=t.httpOptions;const c=new aw(this.apiKey);this.apiClient=new ZN({auth:c,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:lw+"web",uploader:new tw,downloader:new FC}),this.models=new vE(this.apiClient),this.live=new fE(this.apiClient,c,new nw),this.batches=new Rb(this.apiClient),this.chats=new uS(this.models,this.apiClient),this.caches=new iS(this.apiClient),this.files=new bS(this.apiClient),this.operations=new yE(this.apiClient),this.authTokens=new UE(this.apiClient),this.tunings=new zC(this.apiClient),this.fileSearchStores=new qE(this.apiClient)}}const Iu=new l0({apiKey:"AIzaSyCguOQ--Mcwq2QG4-ybJCVqT_8IyTMxHZM"}),ow=async(s,t,a,o)=>{if(!s||s.length===0)return[{type:"summary",message:"Add items to your roadmap to generate AI insights.",impactLevel:"low"}];const c=t.map(v=>`${v.id}: ${v.title}`).join(", "),p=[...a.map(v=>({...v,type:"Goal Update"})),...o.map(v=>({...v,type:"Item Update",goalId:v.itemId}))].sort((v,h)=>{const y="createdAt"in v?new Date(v.createdAt).getTime():new Date(v.updatedAt).getTime();return("createdAt"in h?new Date(h.createdAt).getTime():new Date(h.updatedAt).getTime())-y}).slice(0,20).map(v=>{const h="createdAt"in v?v.createdAt:v.updatedAt;return`[${v.type}] Date: ${h}, Health: ${"status"in v?v.status:v.health}, Text: "${v.content}"`}).join(`
`),g=`You are a sophisticated Program Manager AI. Analyze the following Roadmap Data and RECENT TEXT UPDATES to identify risks, conflicts, and insights.

  STRATEGIC CONTEXT (GOALS):
  ${c}

  ROADMAP ITEMS:
  ${JSON.stringify(s.map(v=>({title:v.title,owner:v.owner,start:v.startDate,end:v.endDate,status:v.status})))}

  RECENT TEXT UPDATES (Scan these for hidden risks!):
  ${p}

  INSTRUCTIONS:
  1. **Scan Text for Risks**: Look specifically at the "Text" fields in the updates. Are there mentions of "delay", "blocked", "waiting", "risk", "vendor", "hiring", or "tech debt"?
  2. **Identify Contradictions**: If an item Status is "Green" or "In Progress" but the Text says "We are blocked", flag this as a high impact risk.
  3. **Resource/Timing Conflicts**: Look for owners with too many overlapping items.
  4. **Output**: Return a JSON array of 3-5 insights.
  
  JSON Schema:
  Array of objects: {
    "type": "conflict" | "suggestion" | "summary" | "alignment_gap" | "hidden_risk",
    "message": "Concise, actionable insight text.",
    "impactLevel": "high" | "medium" | "low"
  }`;try{const v=await Iu.models.generateContent({model:"gemini-3-flash-preview",contents:g,config:{responseMimeType:"application/json",responseSchema:{type:Ge.ARRAY,items:{type:Ge.OBJECT,properties:{type:{type:Ge.STRING},message:{type:Ge.STRING},impactLevel:{type:Ge.STRING}},required:["type","message","impactLevel"]}}}});return JSON.parse(v.text||"[]")}catch(v){return console.error("Gemini analysis failed:",v),v.status===429||v.code===429||v.message&&(v.message.includes("429")||v.message.includes("quota")||v.message.includes("RESOURCE_EXHAUSTED"))?[{type:"summary",message:" AI Insights Paused: Usage limit reached. The analysis will resume automatically when quota replenishes.",impactLevel:"low"}]:[{type:"summary",message:"Unable to generate insights at this moment.",impactLevel:"low"}]}},iw=async(s,t)=>{const a=t.length?t.map(c=>`id: ${c.id}, title: "${c.title}"`).join(`
`):"No existing goals.",o=`You are a program manager. The user stated this objective: "${s}"
Existing goals (id and title only):
${a}
Tasks:
1. Propose a short goal title and a 1-2 sentence goal description.
2. If this objective clearly refers to ONE existing goal above, set matchedGoalId to that goal's id. Otherwise omit matchedGoalId.
Return JSON: { "goalTitle": string, "goalDescription": string, "matchedGoalId": string or omit }`;try{const c=await Iu.models.generateContent({model:"gemini-3-flash-preview",contents:o,config:{responseMimeType:"application/json",responseSchema:{type:Ge.OBJECT,properties:{goalTitle:{type:Ge.STRING},goalDescription:{type:Ge.STRING},matchedGoalId:{type:Ge.STRING}},required:["goalTitle","goalDescription"]}}}),d=JSON.parse(c.text||"{}");return{goalTitle:d.goalTitle||"",goalDescription:d.goalDescription||"",matchedGoalId:d.matchedGoalId||void 0}}catch(c){return console.error("suggestGoalFromObjective failed:",c),{goalTitle:s.slice(0,50),goalDescription:s,matchedGoalId:void 0}}},rw=async(s,t,a,o)=>{const c=a.length?a.map(g=>`id: ${g.id}, title: "${g.title}"`).join(`
`):"No existing goals.",d=o.length?o.map(g=>{const v=`name: "${g.name}", department: ${g.department}, role: ${g.role}`,h=[g.team&&`team: ${g.team}`,g.responsibilities&&`what they do: ${g.responsibilities}`].filter(Boolean).join(", ");return h?`${v}, ${h}`:v}).join(`
`):"No employees listed.",p=`You are a program manager. Break this project into concrete tasks and assign owners from the team list. Use each person's role and "what they do" to pick the best owner for each task; not everyone in a department does the same job.
Project title: "${s}"
Project description: "${t}"
Existing goals (optional context): ${c}
Team (use exact "name" as owner): ${d}
Return JSON: goalId (optional), goalTitle, goalDescription (if relevant), tasks: array of { title, description, department, owner (exact name from list), priority (Low/Medium/High/Critical), team? }. If no employees or no good fit, set owner to "Unassigned".`;try{const g=await Iu.models.generateContent({model:"gemini-3-flash-preview",contents:p,config:{responseMimeType:"application/json",responseSchema:{type:Ge.OBJECT,properties:{goalId:{type:Ge.STRING},goalTitle:{type:Ge.STRING},goalDescription:{type:Ge.STRING},tasks:{type:Ge.ARRAY,items:{type:Ge.OBJECT,properties:{title:{type:Ge.STRING},description:{type:Ge.STRING},department:{type:Ge.STRING},team:{type:Ge.STRING},owner:{type:Ge.STRING},priority:{type:Ge.STRING}},required:["title","description","department","owner","priority"]}}},required:["tasks"]}}}),v=JSON.parse(g.text||"{}"),h=Array.isArray(v.tasks)?v.tasks.map(y=>({title:y.title,description:y.description,department:y.department||"Operations",team:y.team,owner:y.owner||"Unassigned",priority:y.priority||"Medium"})):[];return{goalId:v.goalId,goalTitle:v.goalTitle,goalDescription:v.goalDescription,tasks:h}}catch(g){return console.error("breakDownObjective failed:",g),{tasks:[]}}},cw=({isOpen:s,onClose:t,goals:a,employees:o,departments:c,onSave:d})=>{const[p,g]=I.useState(1),[v,h]=I.useState(""),[y,b]=I.useState(!1),[S,N]=I.useState(null),[k,w]=I.useState(null),[M,J]=I.useState(""),[ce,ee]=I.useState(""),[P,Q]=I.useState(null),[H,V]=I.useState([]),[q,X]=I.useState(null),fe=()=>{g(1),h(""),w(null),J(""),ee(""),Q(null),V([]),X(null),N(null)},F=()=>{fe(),t()},re=async()=>{const _=v.trim();if(!_){N('Enter an objective (e.g. "collectingcars wants to launch a merch store").');return}N(null),b(!0);try{const O=await iw(_,a);w(O),J(O.goalTitle),ee(O.goalDescription),g(2)}catch{N("Could not suggest a project. Try again.")}finally{b(!1)}},oe=async()=>{if(!M.trim()){N("Enter a project title.");return}const _=`proj-${Math.random().toString(36).substr(2,6)}`;X(_),N(null),b(!0);try{const O=await rw(M.trim(),ce.trim(),a,o);Q(O);const z=O.tasks&&O.tasks.length>0?O.tasks.map(ne=>({title:ne.title||"",description:ne.description||"",department:ne.department||c[0]||"Operations",owner:ne.owner||"Unassigned",priority:ne.priority||Ee.MEDIUM})):[{title:"",description:"",department:c[0]||"Operations",owner:"Unassigned",priority:Ee.MEDIUM}];V(z),g(3)}catch{N("Could not break down tasks. Try again.")}finally{b(!1)}},se=()=>{var O;if(!M.trim()){N("Enter a project title.");return}N(null);const _=`proj-${Math.random().toString(36).substr(2,6)}`;X(_),V([{title:"",description:"",department:c[0]||"Operations",owner:((O=o[0])==null?void 0:O.name)||"Unassigned",priority:Ee.MEDIUM}]),g(3)},ae=(_,O,z)=>{const ne=[...H];ne[_]={...ne[_],[O]:z},V(ne)},A=()=>{var _;V([...H,{title:"",description:"",department:c[0]||"Operations",owner:((_=o[0])==null?void 0:_.name)||"Unassigned",priority:Ee.MEDIUM}])},U=_=>{H.length<=1||V(H.filter((O,z)=>z!==_))},ue=()=>{var nt,G;const _=H.filter(he=>he.title&&he.title.trim());if(_.length===0){N("Add at least one task with a title.");return}if(!q)return;const O=new Date,z=O.toISOString().split("T")[0],ne="2026-12-31",xe=O.toISOString(),ge=((G=(nt=_[0])==null?void 0:nt.owner)==null?void 0:G.trim())||"Unassigned",Se={id:q,title:M.trim(),description:ce.trim(),owner:ge,status:we.NOT_STARTED,startDate:z,endDate:ne,createdAt:xe},_e=_.map((he,be)=>({id:`pt-${Math.random().toString(36).substr(2,6)}`,projectId:q,title:(he.title||"").trim(),description:(he.description||"").trim()||"",owner:(he.owner||"Unassigned").trim(),status:we.NOT_STARTED,priority:he.priority||Ee.MEDIUM,startDate:z,endDate:ne,order:be,createdAt:xe,department:he.department,team:void 0}));d(Se,_e),F()},{labelClass:L,inputClass:W,selectClass:C}=yu;return i.jsxs(gt,{isOpen:s,onClose:F,title:"New project",maxWidth:"max-w-3xl",children:[p===1&&i.jsxs("div",{className:"space-y-5",children:[i.jsx("p",{className:"text-sm text-slate-600",children:"Enter the high-level objective. We'll suggest a project title and break it into tasks (separate from your goals)."}),i.jsxs("div",{children:[i.jsx("label",{className:L,children:"Objective"}),i.jsx("textarea",{className:`${W} min-h-[100px]`,placeholder:"e.g. collectingcars wants to launch a merch store",value:v,onChange:_=>h(_.target.value)})]}),S&&i.jsx("p",{className:"text-sm text-red-600",children:S}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{type:"button",onClick:F,className:"px-4 py-2.5 rounded-lg border border-slate-300 text-slate-700 hover:bg-slate-50",children:"Cancel"}),i.jsx("button",{type:"button",onClick:re,disabled:y,className:"px-4 py-2.5 rounded-lg bg-teal-600 text-white hover:bg-teal-700 disabled:opacity-50",children:y?"...":"Next"})]})]}),p===2&&k&&i.jsxs("div",{className:"space-y-5",children:[i.jsx("p",{className:"text-sm text-slate-600",children:"Confirm or edit the project title and description, then we'll break it into tasks."}),i.jsxs("div",{children:[i.jsx("label",{className:L,children:"Project title"}),i.jsx("input",{className:W,value:M,onChange:_=>J(_.target.value),placeholder:"e.g. Launch merch store"})]}),i.jsxs("div",{children:[i.jsx("label",{className:L,children:"Project description"}),i.jsx("textarea",{className:`${W} min-h-[80px]`,value:ce,onChange:_=>ee(_.target.value),placeholder:"What success looks like..."})]}),i.jsxs("div",{children:[i.jsx("span",{className:L,children:"How do you want to add tasks?"}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mt-2",children:[i.jsxs("button",{type:"button",onClick:oe,disabled:y,className:"flex-1 px-4 py-3 rounded-lg border-2 border-teal-500 bg-teal-50 text-teal-800 hover:bg-teal-100 disabled:opacity-50 text-left",children:[i.jsx("span",{className:"font-medium block",children:"Use AI to generate tasks"}),i.jsx("span",{className:"text-xs text-slate-600",children:"We'll break the project into tasks and suggest owners from your team."})]}),i.jsxs("button",{type:"button",onClick:se,className:"flex-1 px-4 py-3 rounded-lg border-2 border-slate-300 bg-white text-slate-700 hover:bg-slate-50 text-left",children:[i.jsx("span",{className:"font-medium block",children:"Add tasks manually"}),i.jsx("span",{className:"text-xs text-slate-600",children:"You add and assign each task yourself."})]})]})]}),S&&i.jsx("p",{className:"text-sm text-red-600",children:S}),i.jsx("div",{className:"flex justify-between",children:i.jsx("button",{type:"button",onClick:()=>g(1),className:"px-4 py-2.5 rounded-lg border border-slate-300 text-slate-700 hover:bg-slate-50",children:"Back"})})]}),p===3&&q&&i.jsxs("div",{className:"space-y-5",children:[i.jsx("p",{className:"text-sm text-slate-600",children:"Edit tasks and owners, then save. These are stored in the Projects and ProjectTasks sheets (not in Goals)."}),i.jsx("div",{className:"space-y-3 max-h-[50vh] overflow-y-auto",children:H.map((_,O)=>i.jsxs("div",{className:"p-4 border border-slate-200 rounded-lg bg-slate-50/50 space-y-3",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("span",{className:"text-xs font-medium text-slate-500",children:["Task ",O+1]}),i.jsx("button",{type:"button",onClick:()=>U(O),disabled:H.length<=1,className:"text-slate-400 hover:text-red-600 disabled:opacity-40 text-xs",children:"Remove"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsx("div",{className:"md:col-span-2",children:i.jsx("input",{className:W,placeholder:"Title",value:_.title||"",onChange:z=>ae(O,"title",z.target.value)})}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("textarea",{className:`${W} min-h-[60px]`,placeholder:"Description",value:_.description||"",onChange:z=>ae(O,"description",z.target.value)})}),i.jsx("div",{children:i.jsx("select",{className:C,value:_.department||"",onChange:z=>ae(O,"department",z.target.value),children:c.map(z=>i.jsx("option",{value:z,children:z},z))})}),i.jsx("div",{children:i.jsxs("select",{className:C,value:_.owner||"",onChange:z=>ae(O,"owner",z.target.value),children:[i.jsx("option",{value:"Unassigned",children:"Unassigned"}),o.map(z=>i.jsxs("option",{value:z.name,children:[z.name," ",z.department?`(${z.department})`:""]},z.id)),o.length===0&&i.jsx("option",{value:"Unassigned",children:"No employees loaded"})]})}),i.jsx("div",{children:i.jsx("select",{className:C,value:_.priority||Ee.MEDIUM,onChange:z=>ae(O,"priority",z.target.value),children:Object.values(Ee).map(z=>i.jsx("option",{value:z,children:z},z))})})]})]},O))}),i.jsx("button",{type:"button",onClick:A,className:"w-full py-2.5 rounded-lg border border-dashed border-slate-300 text-slate-600 hover:bg-slate-50 text-sm",children:"+ Add task"}),S&&i.jsx("p",{className:"text-sm text-red-600",children:S}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("button",{type:"button",onClick:()=>g(2),className:"px-4 py-2.5 rounded-lg border border-slate-300 text-slate-700 hover:bg-slate-50",children:"Back"}),i.jsx("button",{type:"button",onClick:ue,className:"px-4 py-2.5 rounded-lg bg-teal-600 text-white hover:bg-teal-700",children:"Save project"})]})]})]})};function uw({project:s,employees:t,departments:a,onSave:o,onCancel:c,inputClass:d,selectClass:p,labelClass:g}){const[v,h]=I.useState(s.title),[y,b]=I.useState(s.description||""),[S,N]=I.useState(s.owner),[k,w]=I.useState(s.status),[M,J]=I.useState(s.priority||Ee.MEDIUM),[ce,ee]=I.useState(s.startDate||""),[P,Q]=I.useState(s.endDate||""),[H,V]=I.useState(s.department||""),[q,X]=I.useState(!1),fe=async F=>{F.preventDefault(),v.trim()&&(X(!0),await o({title:v.trim(),description:y.trim(),owner:S,status:k,priority:M,startDate:ce,endDate:P,department:H||void 0}),X(!1))};return i.jsxs("form",{onSubmit:fe,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:g,children:"Title"}),i.jsx("input",{className:d,value:v,onChange:F=>h(F.target.value),required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:g,children:"Description"}),i.jsx("textarea",{className:`${d} min-h-[80px]`,value:y,onChange:F=>b(F.target.value)})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:g,children:"Owner"}),i.jsxs("select",{className:p,value:S,onChange:F=>N(F.target.value),children:[t.map(F=>i.jsxs("option",{value:F.name,children:[F.name," ",F.department?`(${F.department})`:""]},F.id)),t.length===0&&i.jsx("option",{value:"Unassigned",children:"Unassigned"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:g,children:"Department"}),i.jsxs("select",{className:p,value:H,onChange:F=>V(F.target.value),children:[i.jsx("option",{value:"",children:""}),a.map(F=>i.jsx("option",{value:F,children:F},F))]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:g,children:"Status"}),i.jsx("select",{className:p,value:k,onChange:F=>w(F.target.value),children:Object.values(we).map(F=>i.jsx("option",{value:F,children:F},F))})]}),i.jsxs("div",{children:[i.jsx("label",{className:g,children:"Priority"}),i.jsx("select",{className:p,value:M,onChange:F=>J(F.target.value),children:Object.values(Ee).map(F=>i.jsx("option",{value:F,children:F},F))})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:g,children:"Start date"}),i.jsx("input",{type:"date",className:d,value:ce,onChange:F=>ee(F.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:g,children:"End date"}),i.jsx("input",{type:"date",className:d,value:P,onChange:F=>Q(F.target.value)})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[i.jsx("button",{type:"button",onClick:c,className:"px-4 py-2 rounded-lg border border-slate-300 text-slate-700 hover:bg-slate-50",children:"Cancel"}),i.jsx("button",{type:"submit",disabled:q,className:"px-4 py-2 rounded-lg bg-teal-600 text-white hover:bg-teal-700 disabled:opacity-50",children:q?"Saving...":"Save"})]})]})}function dw({task:s,employees:t,departments:a,onSave:o,onCancel:c,inputClass:d,selectClass:p,labelClass:g}){const[v,h]=I.useState(s.title),[y,b]=I.useState(s.description||""),[S,N]=I.useState(s.owner),[k,w]=I.useState(s.status),[M,J]=I.useState(s.priority),[ce,ee]=I.useState(s.startDate||""),[P,Q]=I.useState(s.endDate||""),[H,V]=I.useState(s.department||""),[q,X]=I.useState(!1),fe=async F=>{F.preventDefault(),v.trim()&&(X(!0),await o({title:v.trim(),description:y.trim(),owner:S,status:k,priority:M,startDate:ce,endDate:P,department:H||void 0}),X(!1))};return i.jsxs("form",{onSubmit:fe,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:g,children:"Title"}),i.jsx("input",{className:d,value:v,onChange:F=>h(F.target.value),required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:g,children:"Description"}),i.jsx("textarea",{className:`${d} min-h-[60px]`,value:y,onChange:F=>b(F.target.value)})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:g,children:"Owner"}),i.jsxs("select",{className:p,value:S,onChange:F=>N(F.target.value),children:[i.jsx("option",{value:"Unassigned",children:"Unassigned"}),t.map(F=>i.jsxs("option",{value:F.name,children:[F.name," ",F.department?`(${F.department})`:""]},F.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:g,children:"Department"}),i.jsxs("select",{className:p,value:H,onChange:F=>V(F.target.value),children:[i.jsx("option",{value:"",children:""}),a.map(F=>i.jsx("option",{value:F,children:F},F))]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:g,children:"Status"}),i.jsx("select",{className:p,value:k,onChange:F=>w(F.target.value),children:Object.values(we).map(F=>i.jsx("option",{value:F,children:F},F))})]}),i.jsxs("div",{children:[i.jsx("label",{className:g,children:"Priority"}),i.jsx("select",{className:p,value:M,onChange:F=>J(F.target.value),children:Object.values(Ee).map(F=>i.jsx("option",{value:F,children:F},F))})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:g,children:"Start date"}),i.jsx("input",{type:"date",className:d,value:ce,onChange:F=>ee(F.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:g,children:"End date"}),i.jsx("input",{type:"date",className:d,value:P,onChange:F=>Q(F.target.value)})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[i.jsx("button",{type:"button",onClick:c,className:"px-4 py-2 rounded-lg border border-slate-300 text-slate-700 hover:bg-slate-50",children:"Cancel"}),i.jsx("button",{type:"submit",disabled:q,className:"px-4 py-2 rounded-lg bg-teal-600 text-white hover:bg-teal-700 disabled:opacity-50",children:q?"Saving...":"Save"})]})]})}function fw({employees:s,departments:t,onSave:a,onCancel:o,inputClass:c,selectClass:d,labelClass:p}){var F;const g=new Date().toISOString().split("T")[0],[v,h]=I.useState(""),[y,b]=I.useState(""),[S,N]=I.useState(((F=s[0])==null?void 0:F.name)||"Unassigned"),[k,w]=I.useState(we.NOT_STARTED),[M,J]=I.useState(Ee.MEDIUM),[ce,ee]=I.useState(g),[P,Q]=I.useState("2026-12-31"),[H,V]=I.useState(t[0]||""),[q,X]=I.useState(!1),fe=async re=>{re.preventDefault(),v.trim()&&(X(!0),await a({title:v.trim(),description:y.trim(),owner:S,status:k,priority:M,startDate:ce,endDate:P,department:H||void 0}),X(!1))};return i.jsxs("form",{onSubmit:fe,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:p,children:"Title"}),i.jsx("input",{className:c,value:v,onChange:re=>h(re.target.value),placeholder:"Task title",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:p,children:"Description"}),i.jsx("textarea",{className:`${c} min-h-[60px]`,value:y,onChange:re=>b(re.target.value),placeholder:"Optional"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:p,children:"Owner"}),i.jsxs("select",{className:d,value:S,onChange:re=>N(re.target.value),children:[i.jsx("option",{value:"Unassigned",children:"Unassigned"}),s.map(re=>i.jsxs("option",{value:re.name,children:[re.name," ",re.department?`(${re.department})`:""]},re.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:p,children:"Department"}),i.jsx("select",{className:d,value:H,onChange:re=>V(re.target.value),children:t.map(re=>i.jsx("option",{value:re,children:re},re))})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:p,children:"Status"}),i.jsx("select",{className:d,value:k,onChange:re=>w(re.target.value),children:Object.values(we).map(re=>i.jsx("option",{value:re,children:re},re))})]}),i.jsxs("div",{children:[i.jsx("label",{className:p,children:"Priority"}),i.jsx("select",{className:d,value:M,onChange:re=>J(re.target.value),children:Object.values(Ee).map(re=>i.jsx("option",{value:re,children:re},re))})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:p,children:"Start date"}),i.jsx("input",{type:"date",className:c,value:ce,onChange:re=>ee(re.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:p,children:"End date"}),i.jsx("input",{type:"date",className:c,value:P,onChange:re=>Q(re.target.value)})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[i.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 rounded-lg border border-slate-300 text-slate-700 hover:bg-slate-50",children:"Cancel"}),i.jsx("button",{type:"submit",disabled:q,className:"px-4 py-2 rounded-lg bg-teal-600 text-white hover:bg-teal-700 disabled:opacity-50",children:q?"Adding...":"Add task"})]})]})}function pw({milestone:s,onSave:t,onCancel:a,inputClass:o,labelClass:c}){const[d,p]=I.useState(s.title),[g,v]=I.useState(s.dueDate||""),[h,y]=I.useState(!1),b=async S=>{S.preventDefault(),d.trim()&&(y(!0),await t({title:d.trim(),dueDate:g}),y(!1))};return i.jsxs("form",{onSubmit:b,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:c,children:"Milestone title"}),i.jsx("input",{className:o,value:d,onChange:S=>p(S.target.value),placeholder:"e.g. Design approved",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:c,children:"Due date"}),i.jsx("input",{type:"date",className:o,value:g,onChange:S=>v(S.target.value)})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[i.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 rounded-lg border border-slate-300 text-slate-700 hover:bg-slate-50",children:"Cancel"}),i.jsx("button",{type:"submit",disabled:h,className:"px-4 py-2 rounded-lg bg-teal-600 text-white hover:bg-teal-700 disabled:opacity-50",children:h?"Saving...":"Save"})]})]})}function mw({onSave:s,onCancel:t,inputClass:a,labelClass:o}){const c=new Date;c.setMonth(c.getMonth()+1);const[d,p]=I.useState(""),[g,v]=I.useState(c.toISOString().split("T")[0]),[h,y]=I.useState(!1),b=async S=>{S.preventDefault(),d.trim()&&(y(!0),await s({title:d.trim(),dueDate:g}),y(!1))};return i.jsxs("form",{onSubmit:b,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:o,children:"Milestone title"}),i.jsx("input",{className:a,value:d,onChange:S=>p(S.target.value),placeholder:"e.g. Design approved",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:o,children:"Due date"}),i.jsx("input",{type:"date",className:a,value:g,onChange:S=>v(S.target.value)})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[i.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 rounded-lg border border-slate-300 text-slate-700 hover:bg-slate-50",children:"Cancel"}),i.jsx("button",{type:"submit",disabled:h,className:"px-4 py-2 rounded-lg bg-teal-600 text-white hover:bg-teal-700 disabled:opacity-50",children:h?"Adding...":"Add milestone"})]})]})}function hw({onSave:s,onCancel:t,inputClass:a,labelClass:o}){const c=new Date;c.setDate(c.getDate()+14);const[d,p]=I.useState(""),[g,v]=I.useState(c.toISOString().split("T")[0]),[h,y]=I.useState(!1),b=async S=>{S.preventDefault(),d.trim()&&(y(!0),await s({title:d.trim(),dueDate:g}),y(!1))};return i.jsxs("form",{onSubmit:b,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:o,children:"Checkpoint title"}),i.jsx("input",{className:a,value:d,onChange:S=>p(S.target.value),placeholder:"e.g. Week 2 review, Design approved",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:o,children:"Due date"}),i.jsx("input",{type:"date",className:a,value:g,onChange:S=>v(S.target.value)})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[i.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 rounded-lg border border-slate-300 text-slate-700 hover:bg-slate-50",children:"Cancel"}),i.jsx("button",{type:"submit",disabled:h,className:"px-4 py-2 rounded-lg bg-teal-600 text-white hover:bg-teal-700 disabled:opacity-50",children:h?"Adding...":"Log progress"})]})]})}const gw=({currentUser:s,projects:t,projectTasks:a,projectMilestones:o,taskMilestones:c,employees:d,departments:p,onNewProjectClick:g,onUpdateProject:v,onDeleteProject:h,onUpdateTask:y,onAddTask:b,onDeleteTask:S,onAddProjectMilestone:N,onUpdateProjectMilestone:k,onToggleProjectMilestone:w,onDeleteProjectMilestone:M,onAddTaskMilestone:J,onUpdateTaskMilestone:ce,onToggleTaskMilestone:ee,onDeleteTaskMilestone:P})=>{const[Q,H]=I.useState(null),[V,q]=I.useState(null),[X,fe]=I.useState(null),[F,re]=I.useState(null),[oe,se]=I.useState(null),[ae,A]=I.useState(null),[U,ue]=I.useState(new Set(t.map(G=>G.id))),[L,W]=I.useState(new Set),C=I.useMemo(()=>{const G={};return a.forEach(he=>{G[he.projectId]||(G[he.projectId]=[]),G[he.projectId].push(he)}),Object.keys(G).forEach(he=>G[he].sort((be,Pe)=>(be.order??0)-(Pe.order??0))),G},[a]),_=I.useMemo(()=>{const G={};return c.forEach(he=>{G[he.taskId]||(G[he.taskId]=[]),G[he.taskId].push(he)}),G},[c]),O=I.useMemo(()=>{const G={};return o.forEach(he=>{G[he.projectId]||(G[he.projectId]=[]),G[he.projectId].push(he)}),G},[o]),z=G=>{W(he=>{const be=new Set(he);return be.has(G)?be.delete(G):be.add(G),be})},ne=G=>{switch(G){case we.DONE:return"bg-emerald-50 text-emerald-700 border-emerald-200";case we.IN_PROGRESS:return"bg-blue-50 text-blue-700 border-blue-200";case we.BLOCKED:return"bg-rose-50 text-rose-700 border-rose-200";case we.PAUSED:return"bg-amber-50 text-amber-700 border-amber-200";default:return"bg-slate-100 text-slate-600 border-slate-200"}},xe=G=>{switch(G){case Ee.CRITICAL:return"bg-red-50 text-red-700";case Ee.HIGH:return"bg-orange-50 text-orange-700";case Ee.MEDIUM:return"bg-blue-50 text-blue-700";default:return"bg-slate-100 text-slate-600"}},ge=G=>{ue(he=>{const be=new Set(he);return be.has(G)?be.delete(G):be.add(G),be})},{labelClass:Se,inputClass:_e,selectClass:nt}=yu;return i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"bg-white rounded-xl border border-slate-300 p-6 shadow-sm",children:[i.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Project Manager"}),i.jsx("p",{className:"text-sm text-slate-600 mb-6 max-w-2xl",children:"Create and manage projects, tasks, and milestones. Edit any field below; changes sync to your Google Sheets."}),s.accessLevel==="Admin"&&i.jsxs("button",{type:"button",onClick:g,className:"inline-flex items-center gap-2 px-5 py-3 rounded-lg bg-teal-600 text-white font-medium hover:bg-teal-700 transition-colors",children:[i.jsx("span",{children:"New project"}),i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})})]})]}),t.length>0?i.jsxs("div",{className:"space-y-6",children:[i.jsx("h3",{className:"text-base font-semibold text-slate-800",children:"Projects"}),t.map(G=>{const he=C[G.id]||[],be=O[G.id]||[],Pe=d.find(me=>me.name===G.owner||me.id===G.owner),ke=U.has(G.id);return i.jsxs("div",{className:"bg-white rounded-xl border border-slate-300 overflow-hidden shadow-sm",children:[i.jsxs("div",{className:"p-5 border-b border-slate-100",children:[i.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-1",children:[i.jsx("span",{className:`text-xs font-medium px-2 py-0.5 rounded border ${ne(G.status)}`,children:G.status}),G.priority&&i.jsx("span",{className:`text-xs font-medium px-2 py-0.5 rounded ${xe(G.priority)}`,children:G.priority})]}),i.jsxs("div",{className:"flex items-start justify-between gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h4",{className:"text-base font-semibold text-slate-900",children:G.title}),G.description&&i.jsx("p",{className:"text-sm text-slate-600 mt-1",children:G.description}),i.jsxs("p",{className:"text-xs text-slate-500 mt-2",children:["Owner: ",G.owner,Pe!=null&&Pe.department?`  ${Pe.department}`:"",G.startDate&&`  ${G.startDate}  ${G.endDate||""}`]})]}),i.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[i.jsx("button",{type:"button",onClick:()=>H(G),className:"p-2 rounded-lg text-slate-500 hover:bg-slate-100 hover:text-teal-600",title:"Edit project",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),i.jsx("button",{type:"button",onClick:()=>{window.confirm(`Delete project "${G.title}" and all its tasks and milestones?`)&&h(G.id)},className:"p-2 rounded-lg text-slate-500 hover:bg-rose-50 hover:text-rose-600",title:"Delete project",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),i.jsx("button",{type:"button",onClick:()=>ge(G.id),className:"p-2 rounded-lg text-slate-500 hover:bg-slate-100",title:ke?"Collapse":"Expand",children:i.jsx("svg",{className:`w-4 h-4 transition-transform ${ke?"":"rotate-180"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]})]})]}),ke&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"px-5 py-3 border-t border-slate-100",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Tasks"}),i.jsx("button",{type:"button",onClick:()=>fe(G.id),className:"text-xs font-medium text-teal-600 hover:text-teal-700",children:"+ Add task"})]}),i.jsxs("ul",{className:"divide-y divide-slate-100",children:[he.map((me,Ze)=>{const ut=_[me.id]||[],Ut=L.has(me.id);return i.jsxs("li",{className:"border-b border-slate-100 last:border-0",children:[i.jsxs("div",{className:"py-3 flex items-center gap-3 group",children:[i.jsxs("div",{className:"flex flex-col gap-0 shrink-0",children:[i.jsx("button",{type:"button",disabled:Ze===0,onClick:()=>{if(Ze>0){const Fe=he[Ze-1],Lt=Fe.order??Ze-1,_s=me.order??Ze;y({...Fe,id:Fe.id,order:_s}),y({...me,id:me.id,order:Lt})}},className:"p-0.5 rounded text-slate-400 hover:bg-slate-100 hover:text-slate-600 disabled:opacity-30 disabled:cursor-not-allowed",title:"Move up",children:i.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 15l7-7 7 7"})})}),i.jsx("button",{type:"button",disabled:Ze===he.length-1,onClick:()=>{if(Ze<he.length-1){const Fe=he[Ze+1],Lt=Fe.order??Ze+1,_s=me.order??Ze;y({...Fe,id:Fe.id,order:_s}),y({...me,id:me.id,order:Lt})}},className:"p-0.5 rounded text-slate-400 hover:bg-slate-100 hover:text-slate-600 disabled:opacity-30 disabled:cursor-not-allowed",title:"Move down",children:i.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]}),i.jsx("span",{className:`text-[10px] font-medium px-2 py-0.5 rounded border shrink-0 ${ne(me.status)}`,children:me.status}),i.jsx("span",{className:`text-[10px] font-medium px-2 py-0.5 rounded shrink-0 ${xe(me.priority)}`,children:me.priority}),i.jsx("span",{className:"text-sm font-medium text-slate-800 flex-1 min-w-0 truncate",children:me.title}),i.jsx("span",{className:"text-xs text-slate-500 shrink-0",children:me.owner}),i.jsxs("button",{type:"button",onClick:()=>z(me.id),className:"text-xs font-medium text-teal-600 hover:text-teal-700 shrink-0",title:"Log progress",children:["Progress (",ut.length,")"]}),i.jsxs("div",{className:"flex items-center gap-0 opacity-0 group-hover:opacity-100 transition-opacity",children:[i.jsx("button",{type:"button",onClick:()=>q(me),className:"p-1.5 rounded text-slate-400 hover:bg-slate-100 hover:text-teal-600",title:"Edit task",children:i.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),i.jsx("button",{type:"button",onClick:()=>{window.confirm(`Delete task "${me.title}"?`)&&S(me.id)},className:"p-1.5 rounded text-slate-400 hover:bg-rose-50 hover:text-rose-600",title:"Delete task",children:i.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),Ut&&i.jsxs("div",{className:"pl-12 pr-5 pb-3 pt-1 bg-slate-50/70 border-t border-slate-100",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Progress checkpoints"}),i.jsx("button",{type:"button",onClick:()=>A(me.id),className:"text-xs font-medium text-teal-600 hover:text-teal-700",children:"+ Log progress"})]}),i.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Log milestones every 2 weeks (or as needed) to track progress on this task."}),i.jsxs("ul",{className:"space-y-2",children:[ut.map(Fe=>i.jsxs("li",{className:"flex items-center gap-3 py-1.5 group",children:[i.jsx("input",{type:"checkbox",checked:Fe.completed,onChange:()=>ee(Fe.id,!Fe.completed),className:"rounded border-slate-300 text-teal-600 focus:ring-teal-500"}),i.jsx("span",{className:`text-sm flex-1 ${Fe.completed?"line-through text-slate-500":"text-slate-800"}`,children:Fe.title}),i.jsx("span",{className:"text-xs text-slate-500",children:Fe.dueDate}),i.jsxs("div",{className:"flex items-center gap-0 opacity-0 group-hover:opacity-100 transition-opacity",children:[i.jsx("button",{type:"button",onClick:()=>{const Lt=window.prompt("Checkpoint title",Fe.title);Lt!=null&&Lt.trim()&&ce({id:Fe.id,title:Lt.trim()})},className:"p-1.5 rounded text-slate-400 hover:bg-slate-100 hover:text-teal-600",title:"Edit",children:i.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),i.jsx("button",{type:"button",onClick:()=>{window.confirm(`Delete "${Fe.title}"?`)&&P(Fe.id)},className:"p-1.5 rounded text-slate-400 hover:bg-rose-50 hover:text-rose-600",title:"Delete",children:i.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},Fe.id)),ut.length===0&&i.jsx("li",{className:"py-2 text-sm text-slate-400",children:'No progress logged yet. Use "+ Log progress" (e.g. every 2 weeks).'})]})]})]},me.id)}),he.length===0&&i.jsx("li",{className:"py-2 text-sm text-slate-400",children:"No tasks yet."})]})]}),i.jsxs("div",{className:"px-5 py-3 border-t border-slate-100 bg-slate-50/50",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Project milestones"}),i.jsx("button",{type:"button",onClick:()=>re(G.id),className:"text-xs font-medium text-teal-600 hover:text-teal-700",children:"+ Add milestone"})]}),i.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Project-level checkpoints (saved to ProjectMilestones tab)."}),i.jsxs("ul",{className:"space-y-2",children:[be.map(me=>i.jsxs("li",{className:"flex items-center gap-3 py-1.5 group",children:[i.jsx("input",{type:"checkbox",checked:me.completed,onChange:()=>w(me.id,!me.completed),className:"rounded border-slate-300 text-teal-600 focus:ring-teal-500"}),i.jsx("span",{className:`text-sm flex-1 ${me.completed?"line-through text-slate-500":"text-slate-800"}`,children:me.title}),i.jsx("span",{className:"text-xs text-slate-500",children:me.dueDate}),i.jsxs("div",{className:"flex items-center gap-0 opacity-0 group-hover:opacity-100 transition-opacity",children:[i.jsx("button",{type:"button",onClick:()=>se(me),className:"p-1.5 rounded text-slate-400 hover:bg-slate-100 hover:text-teal-600",title:"Edit",children:i.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),i.jsx("button",{type:"button",onClick:()=>{window.confirm(`Delete "${me.title}"?`)&&M(me.id)},className:"p-1.5 rounded text-slate-400 hover:bg-rose-50 hover:text-rose-600",title:"Delete",children:i.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},me.id)),be.length===0&&i.jsx("li",{className:"py-2 text-sm text-slate-400",children:'No project milestones yet. Use "+ Add milestone" (saved to ProjectMilestones tab).'})]})]})]})]},G.id)})]}):i.jsx("div",{className:"bg-slate-50 rounded-xl border border-slate-200 p-8 text-center text-slate-500 text-sm",children:'No projects yet. Create one with "New project" above.'}),i.jsx(gt,{isOpen:!!Q,onClose:()=>H(null),title:"Edit project",maxWidth:"max-w-lg",children:Q&&i.jsx(uw,{project:Q,employees:d,departments:p,onSave:async G=>{await v({...Q,...G}),H(null)},onCancel:()=>H(null),inputClass:_e,selectClass:nt,labelClass:Se})}),i.jsx(gt,{isOpen:!!V,onClose:()=>q(null),title:"Edit task",maxWidth:"max-w-lg",children:V&&i.jsx(dw,{task:V,employees:d,departments:p,onSave:async G=>{await y({...V,...G}),q(null)},onCancel:()=>q(null),inputClass:_e,selectClass:nt,labelClass:Se})}),i.jsx(gt,{isOpen:!!X,onClose:()=>fe(null),title:"Add task",maxWidth:"max-w-lg",children:X&&i.jsx(fw,{projectId:X,employees:d,departments:p,onSave:async G=>{await b(X,G),fe(null)},onCancel:()=>fe(null),inputClass:_e,selectClass:nt,labelClass:Se})}),i.jsx(gt,{isOpen:!!F,onClose:()=>re(null),title:"Add project milestone",maxWidth:"max-w-md",children:F&&i.jsx(mw,{projectId:F,onSave:async G=>{await N(F,G),re(null)},onCancel:()=>re(null),inputClass:_e,labelClass:Se})}),i.jsx(gt,{isOpen:!!oe,onClose:()=>se(null),title:"Edit project milestone",maxWidth:"max-w-md",children:oe&&i.jsx(pw,{milestone:oe,onSave:async G=>{await k({...oe,...G}),se(null)},onCancel:()=>se(null),inputClass:_e,labelClass:Se})}),i.jsx(gt,{isOpen:!!ae,onClose:()=>A(null),title:"Log progress",maxWidth:"max-w-md",children:ae&&i.jsx(hw,{taskId:ae,onSave:async G=>{await J(ae,G),A(null)},onCancel:()=>A(null),inputClass:_e,labelClass:Se})})]})},xw=new l0({apiKey:"AIzaSyCguOQ--Mcwq2QG4-ybJCVqT_8IyTMxHZM"}),vw=async s=>{const{domain:t,email:a,apiToken:o,projectKeys:c}=s,d=`project IN (${c}) AND status != Done`,p=`https://${t}/rest/api/3/search?jql=${encodeURIComponent(d)}&maxResults=50`,g=await fetch(p,{method:"GET",headers:{Authorization:`Basic ${btoa(`${a}:${o}`)}`,Accept:"application/json"}});if(!g.ok)throw new Error(`Jira API returned ${g.status}`);return(await g.json()).issues||[]},yw=async(s,t)=>{if(s.length===0)return[];const a=`Map these Jira issues to our Roadmap format.
  Jira Issues: ${JSON.stringify(s.slice(0,10).map(o=>{var c,d,p,g,v,h;return{key:o.key,summary:o.fields.summary,description:((v=(g=(p=(d=(c=o.fields.description)==null?void 0:c.content)==null?void 0:d[0])==null?void 0:p.content)==null?void 0:g[0])==null?void 0:v.text)||"",status:o.fields.status.name,priority:o.fields.priority.name,assignee:((h=o.fields.assignee)==null?void 0:h.displayName)||"Unassigned"}}))}
  
  Available Strategic Pillars (Goal IDs): ${JSON.stringify(t.map(o=>({id:o.id,title:o.title})))}
  
  Return a JSON array of objects that match our RoadmapItem interface. 
  Rules:
  1. Map Jira status to one of: "Not Started", "In Progress", "Done", "Blocked", "Paused".
  2. Map Jira priority to: Low, Medium, High, or Critical.
  3. Assign each issue to the most relevant Strategic Pillar ID.
  4. Set department as "Product" or "Tech" based on project context.`;try{const o=await xw.models.generateContent({model:"gemini-3-flash-preview",contents:a,config:{responseMimeType:"application/json",responseSchema:{type:Ge.ARRAY,items:{type:Ge.OBJECT,properties:{id:{type:Ge.STRING},goalId:{type:Ge.STRING},owner:{type:Ge.STRING},title:{type:Ge.STRING},description:{type:Ge.STRING},department:{type:Ge.STRING},status:{type:Ge.STRING},priority:{type:Ge.STRING},startDate:{type:Ge.STRING},endDate:{type:Ge.STRING},progress:{type:Ge.NUMBER},jiraId:{type:Ge.STRING},jiraUrl:{type:Ge.STRING}},required:["title","goalId","status","priority","department"]}}}});return JSON.parse(o.text||"[]").map(d=>({...d,id:d.id||`jira-${d.jiraId||Math.random().toString(36).substr(2,5)}`,tags:["jira-sync"],startDate:d.startDate||new Date().toISOString().split("T")[0],endDate:d.endDate||"2026-12-31",progress:d.progress||0}))}catch(o){return console.warn("Gemini Jira mapping failed (likely quota), using basic fallback mapping:",o),s.map(c=>{var d,p,g,v,h,y,b;return{id:`jira-${c.key}`,jiraId:c.key,jiraUrl:"",title:c.fields.summary,description:((h=(v=(g=(p=(d=c.fields.description)==null?void 0:d.content)==null?void 0:p[0])==null?void 0:g.content)==null?void 0:v[0])==null?void 0:h.text)||"Imported from Jira",owner:((y=c.fields.assignee)==null?void 0:y.displayName)||"Unassigned",status:we.NOT_STARTED,priority:Ee.MEDIUM,department:"Tech",goalId:((b=t[0])==null?void 0:b.id)||"1",startDate:new Date().toISOString().split("T")[0],endDate:"2026-12-31",tags:["jira-sync","fallback-mapped"],progress:0}})}},bw=()=>{const s=new Date;return{month:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][s.getMonth()],year:s.getFullYear()}},Sw=()=>{try{const s=localStorage.getItem("omnimap_global_period");if(s){const t=JSON.parse(s);if(t.month&&t.year)return t}}catch{}return bw()},Tw=()=>{const[s,t]=I.useState(null),[a,o]=I.useState(wv),[c,d]=I.useState(Cv),[p,g]=I.useState([]),[v,h]=I.useState([]),[y,b]=I.useState([]),[S,N]=I.useState([]),[k,w]=I.useState([]),[M,J]=I.useState([]),[ce,ee]=I.useState([]),[P,Q]=I.useState([]),[H,V]=I.useState([]),[q,X]=I.useState("alignment"),[fe,F]=I.useState(Sw);I.useEffect(()=>{localStorage.setItem("omnimap_global_period",JSON.stringify(fe))},[fe]);const[re,oe]=I.useState([]),[se,ae]=I.useState(!1),[A,U]=I.useState(!1),[ue,L]=I.useState(null),[W,C]=I.useState(null),[_,O]=I.useState(new Set),[z,ne]=I.useState(null),[xe,ge]=I.useState(void 0),[Se,_e]=I.useState(void 0),[nt,G]=I.useState(void 0),[he,be]=I.useState(void 0),[Pe,ke]=I.useState(void 0),[me,Ze]=I.useState(void 0),[ut,Ut]=I.useState(void 0),[Fe,Lt]=I.useState(!1),[_s,Ws]=I.useState(!1),[Gt,$a]=I.useState(!1),[$t,Zs]=I.useState(null),Wn=I.useCallback((D,le)=>{const Z=le.filter(ye=>ye.reportsTo&&ye.reportsTo.toLowerCase()===D.toLowerCase());let ve=[];return Z.forEach(ye=>{ve.push(ye.name),ve.push(ye.id),ve=[...ve,...Wn(ye.name,le)]}),ve},[]),ea=I.useMemo(()=>{if(!s)return[];if(s.accessLevel==="Admin")return[];const D=[s.id,s.name];if(s.accessLevel==="Manager"){const le=Wn(s.name,p);return[...D,...le]}return D},[s,p,Wn]),Nn=I.useMemo(()=>!s||s.accessLevel==="Admin"?a:a.filter(D=>{const le=D.owner.toLowerCase().trim();return ea.some(Z=>{const ve=Z.toLowerCase().trim();return ve===le||ve.includes(le)||le.includes(ve)})}),[a,ea,s]),Rs=I.useMemo(()=>!s||s.accessLevel==="Admin"?p:p.filter(D=>ea.some(le=>{const Z=le.toLowerCase().trim(),ve=D.name.toLowerCase().trim();return Z===D.id||Z===ve||Z.includes(ve)||ve.includes(Z)})),[p,ea,s]),Gi=I.useMemo(()=>s?s.accessLevel==="Admin"?p:s.salesPerformanceAccess&&s.salesPerformanceAccess.length>0?s.salesPerformanceAccess.some(D=>D.toLowerCase()==="all")?p.filter(D=>D.department.toLowerCase().includes("sales")):p.filter(D=>{var le;return D.team?(le=s.salesPerformanceAccess)==null?void 0:le.some(Z=>{var ve;return(ve=D.team)==null?void 0:ve.toLowerCase().includes(Z.toLowerCase())}):!1}):s.accessLevel==="Manager"&&s.department.toLowerCase().includes("sales")?p:Rs:[],[s,p,Rs]),Zn=I.useMemo(()=>s?s.accessLevel==="Admin"||s.salesPerformanceAccess&&s.salesPerformanceAccess.length>0?!0:s.department.toLowerCase().includes("sales"):!1,[s]),wt=I.useMemo(()=>{const D=new Set;return p.forEach(le=>D.add(le.department)),D.size===0&&["Product","Marketing","Operations","Sales","Tech"].forEach(le=>D.add(le)),Array.from(D).sort()},[p]),Kt=I.useCallback(async()=>{if(Ie.getScriptUrl()){U(!0),L(null);try{const D=await Ie.fetchData();if(D){if(D.items&&Array.isArray(D.items)&&o(D.items),D.updates){const le=D.updates.map(Z=>({...Z,id:String(Z.id),goalId:String(Z.goalId),authorId:String(Z.authorId)}));h(le)}if(D.itemUpdates&&b(D.itemUpdates),D.salesData&&(console.log("[SalesData] Received",D.salesData.length,"records"),console.log("[SalesData] Sample:",D.salesData.slice(0,5)),N(D.salesData)),D.salesActions&&w(D.salesActions),D._salesDebug&&console.log("[SalesDebug] Sheet structure:",D._salesDebug),D.rocks&&D.rocks.length>0){const le=D.rocks.map((Z,ve)=>{const ye=Am(ve,Z.title);return{...Z,id:String(Z.id),color:ye.color,icon:ye.icon}});d(le)}else if(D.items&&D.items.length>0){const Z=Array.from(new Set(D.items.map(ve=>ve.goalId))).map((ve,ye)=>({id:String(ve),title:`Goal ${ve}`,description:"Imported from Roadmap Items",...Am(ye,"Generic")}));d(Z)}if(D.employees){const le=D.employees.filter(Z=>Z.email);console.log("[App] Loaded",D.employees.length,"employees"),console.log("[App] Employees with emails:",le.length),le.length>0&&console.log("[App] Sample employees with emails:",le.slice(0,5).map(Z=>({name:Z.name,email:Z.email,id:Z.id}))),g(D.employees)}D.projects&&Array.isArray(D.projects)&&J(D.projects),D.projectTasks&&Array.isArray(D.projectTasks)&&ee(D.projectTasks),D.projectMilestones&&Array.isArray(D.projectMilestones)&&Q(D.projectMilestones),D.taskMilestones&&Array.isArray(D.taskMilestones)&&V(D.taskMilestones),C(new Date)}}catch(D){console.error("Sync Error",D),L(D.message||"Failed to fetch from Google Sheets.")}finally{U(!1)}}},[]),Dt=async D=>{U(!0),ne(null);try{const le=await vw(D),Z=await yw(le,c);o(ve=>[...ve.filter(je=>!je.jiraId),...Z]),C(new Date)}catch(le){alert(`Jira Sync Failed: ${le instanceof Error?le.message:String(le)}`)}finally{U(!1)}},Kl=async D=>{const le=localStorage.getItem("omnimap_hibob_config");if(!le){alert("Please configure HiBob settings in the sync menu first.");return}const Z=y.filter(Re=>Re.itemId===D.id),ve=Z.length,ye=ve>0?`Push '${D.title}' to HiBob?

This will also sync ${ve} monthly update${ve>1?"s":""} as check-ins.`:`Push '${D.title}' to HiBob now?`;if(window.confirm(ye)){O(Re=>new Set(Re).add(D.id));try{const Re=JSON.parse(le),pt=await Ie.pushSingleGoalToHiBob(D,Re);if(pt.success){let Oe=" Goal pushed successfully!";if(pt.hibobGoalId){const ns={...D,hibobGoalId:pt.hibobGoalId};if(console.log("[HiBob] Saving hibobGoalId:",pt.hibobGoalId,"for item:",D.id),o(Ot=>Ot.map(Qe=>Qe.id===D.id?ns:Qe)),Ie.upsertItem(ns).catch(Ot=>console.error("[HiBob] Failed to save hibobGoalId:",Ot)),Z.length>0){console.log(`[HiBob] Pushing ${Z.length} existing check-ins for: ${D.title}`);let Ot=0,Qe=0;for(const dt of Z)try{const la=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(dt.month||"Jan"),sn=`${dt.year||new Date().getFullYear()}-${String(la+1).padStart(2,"0")}-01`,el=await Ie.pushCheckInToHiBob(pt.hibobGoalId,Re,sn,dt.content||"",String(dt.health??"green").toUpperCase());el.success||el.fallbackUsed?(Ot++,console.log(`[HiBob] Check-in pushed: ${dt.month} ${dt.year}`)):(Qe++,console.error(`[HiBob] Check-in failed: ${dt.month} ${dt.year}`,el.message)),await new Promise(oa=>setTimeout(oa,300))}catch(aa){Qe++,console.error(`[HiBob] Check-in exception for ${dt.month} ${dt.year}:`,aa)}Ot>0&&(Oe+=`

 ${Ot} check-in${Ot>1?"s":""} synced to HiBob.`),Qe>0&&(Oe+=`
 ${Qe} check-in${Qe>1?"s":""} failed (check console).`)}}alert(Oe)}else alert(` Failed: ${pt.message}`)}catch(Re){alert("Error pushing goal: "+(Re instanceof Error?Re.message:String(Re)))}finally{O(Re=>{const pt=new Set(Re);return pt.delete(D.id),pt})}}},Ka=I.useCallback(async()=>{if(Nn.length!==0){ae(!0);try{const D=await ow(Nn,c,v,y);oe(D)}catch(D){console.error(D)}finally{ae(!1)}}},[Nn,c,v,y]);I.useEffect(()=>{const D=()=>{if($n.hasActiveSession()){const le=$n.getStoredUser();if(le&&p.length>0){const Z=$n.matchEmployeeByEmail(le,p);Z&&t(Z)}}};p.length>0&&D()},[p]),I.useEffect(()=>{const D=()=>{t(null)};return window.addEventListener("google-signout",D),()=>{window.removeEventListener("google-signout",D)}},[]),I.useEffect(()=>{Ie.getScriptUrl()&&Kt()},[Kt]),I.useEffect(()=>{Ka()},[Ka]);const Xl=async D=>{const le={...D,id:D.id||`item-${Math.random().toString(36).substr(2,5)}`};o(Z=>Z.find(ye=>ye.id===le.id)?Z.map(ye=>ye.id===le.id?{...ye,...le}:ye):[...Z,le]),ne(null),Ie.upsertItem(le).catch(Z=>console.error("Bg Sync failed",Z))},Is=async D=>{const le=localStorage.getItem("omnimap_hibob_config");if(!le){alert("HiBob config missing. Please configure HiBob credentials in the Bulk Creator modal first.");return}let Z;try{Z=JSON.parse(le)}catch{alert("Invalid HiBob config format. Please reconfigure in the Bulk Creator modal.");return}if(!Z.serviceId||!Z.token){alert("HiBob credentials incomplete. Please enter Service ID and Token in the Bulk Creator modal.");return}if(D.length===0){alert("No items selected to push.");return}const ve=[];console.log(`[HiBob Push] Starting push sequence for ${D.length} goals`),console.log(`[HiBob Push] Config serviceId: ${Z.serviceId.substring(0,4)}...`),O(new Set(D.map(je=>je.id)));try{for(let je=0;je<D.length;je++){const Re=D[je];if(console.log(`[HiBob Push] Processing ${je+1}/${D.length}: ${Re.title}`),!Re.title||!Re.owner){ve.push({title:Re.title||"Untitled",success:!1,message:`Missing required fields: ${Re.title?"":"title"} ${Re.owner?"":"owner"}`.trim()});continue}let pt;p.find(Oe=>Oe.name===Re.owner||Oe.id===Re.owner||Oe.name.toLowerCase().includes(Re.owner.toLowerCase())||Re.owner.toLowerCase().includes(Oe.name.toLowerCase()));try{const Oe=await Ie.pushSingleGoalToHiBob(Re,Z,pt);if(console.log(`[HiBob Push] Result for ${Re.title}:`,Oe),Oe.success&&Oe.hibobGoalId){const ns={...Re,hibobGoalId:Oe.hibobGoalId};console.log("[HiBob] Saving hibobGoalId to sheet:",Oe.hibobGoalId,"for item:",Re.id),o(Qe=>Qe.map(dt=>dt.id===Re.id?ns:dt)),Ie.upsertItem(ns).then(Qe=>console.log("[HiBob] Sheet upsert result:",Qe?" SUCCESS":" FAILED")).catch(Qe=>console.error("[HiBob] Failed to save hibobGoalId:",Qe));const Ot=y.filter(Qe=>Qe.itemId===Re.id);if(Ot.length>0){console.log(`[HiBob] Pushing ${Ot.length} existing check-ins for goal: ${Re.title}`);for(const Qe of Ot)try{const aa=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(Qe.month||"Jan"),la=`${Qe.year||new Date().getFullYear()}-${String(aa+1).padStart(2,"0")}-01`;try{const sn=await Ie.pushCheckInToHiBob(Oe.hibobGoalId,Z,la,Qe.content||"",String(Qe.health??"green").toUpperCase());sn.fallbackUsed?console.log(`[HiBob] Check-in failed for "${Re.title}", but goal update succeeded (appears as OmniMap activity)`):sn.success?console.log(`[HiBob] Check-in pushed successfully for "${Re.title}"`):console.error(`[HiBob] Failed to push check-in for "${Re.title}":`,sn.message)}catch(sn){console.error(`[HiBob] Exception pushing check-in for "${Re.title}":`,sn)}await new Promise(sn=>setTimeout(sn,300))}catch(dt){console.error(`[HiBob] Failed to push check-in for ${Qe.month} ${Qe.year}:`,dt)}}}ve.push({title:Re.title,success:Oe.success,message:Oe.message||(Oe.success?"Success":"Unknown error")})}catch(Oe){console.error(`[HiBob Push] Exception for ${Re.title}:`,Oe),ve.push({title:Re.title,success:!1,message:Oe instanceof Error?Oe.message:"Unknown network error"})}je<D.length-1&&await new Promise(Oe=>setTimeout(Oe,500))}}finally{O(new Set)}console.log(`[HiBob Push] Completed. Success: ${ve.filter(je=>je.success).length}, Failed: ${ve.filter(je=>!je.success).length}`);const ye=ve.filter(je=>!je.success);ye.length>0&&(console.error("[HiBob Push] FAILURES:",ye),ye.forEach(je=>{console.error(`[HiBob Push] Failed: "${je.title}" - ${je.message}`)})),Zs(ve)},ta=async(D,le)=>{o(Z=>[...Z,...D]),Ws(!1),Ie.upsertItems(D).catch(Z=>console.error("Batch Sync failed",Z)),le&&Is(D)},na=async(D,le)=>{J(Z=>[...Z,D]),ee(Z=>[...Z,...le]),$a(!1),Ie.upsertProject(D).catch(Z=>console.error("Project sync failed",Z)),Ie.upsertProjectTasks(le).catch(Z=>console.error("Project tasks sync failed",Z))},Rn=async D=>{J(le=>le.map(Z=>Z.id===D.id?{...Z,...D}:Z)),await Ie.upsertProject(D).catch(le=>console.error("Project update sync failed",le))},sa=async D=>{const le=ce.filter(ye=>ye.projectId===D).map(ye=>ye.id),Z=P.filter(ye=>ye.projectId===D).map(ye=>ye.id),ve=H.filter(ye=>le.includes(ye.taskId)).map(ye=>ye.id);for(const ye of ve)await Ie.deleteTaskMilestone(ye).catch(()=>{});for(const ye of le)await Ie.deleteProjectTask(ye).catch(()=>{});for(const ye of Z)await Ie.deleteProjectMilestone(ye).catch(()=>{});await Ie.deleteProject(D).catch(ye=>console.error("Project delete sync failed",ye)),V(ye=>ye.filter(je=>!le.includes(je.taskId))),ee(ye=>ye.filter(je=>je.projectId!==D)),Q(ye=>ye.filter(je=>je.projectId!==D)),J(ye=>ye.filter(je=>je.id!==D))},Ms=async D=>{ee(le=>le.map(Z=>Z.id===D.id?{...Z,...D}:Z)),await Ie.upsertProjectTasks([D]).catch(le=>console.error("Task update sync failed",le))},Oi=async(D,le)=>{const Z=new Date().toISOString(),ve=ce.filter(Re=>Re.projectId===D).map(Re=>Re.order??0),ye=ve.length?Math.max(...ve)+1:0,je={...le,id:`pt-${Math.random().toString(36).substr(2,6)}`,projectId:D,createdAt:Z,startDate:le.startDate||Z.split("T")[0],endDate:le.endDate||"2026-12-31",order:ye};ee(Re=>[...Re,je]),await Ie.upsertProjectTasks([je]).catch(Re=>console.error("Task add sync failed",Re))},Ql=async D=>{const le=H.filter(Z=>Z.taskId===D).map(Z=>Z.id);for(const Z of le)await Ie.deleteTaskMilestone(Z).catch(()=>{});V(Z=>Z.filter(ve=>ve.taskId!==D)),ee(Z=>Z.filter(ve=>ve.id!==D)),await Ie.deleteProjectTask(D).catch(Z=>console.error("Task delete sync failed",Z))},Xa=async(D,le)=>{const Z={...le,id:`pm-${Math.random().toString(36).substr(2,6)}`,projectId:D,completed:!1};Q(ve=>[...ve,Z]),await Ie.upsertProjectMilestone(Z).catch(ve=>console.error("Milestone add sync failed",ve))},Ds=async D=>{Q(le=>le.map(Z=>Z.id===D.id?{...Z,...D}:Z)),await Ie.upsertProjectMilestone(D).catch(le=>console.error("Milestone update sync failed",le))},Pi=async(D,le)=>{const Z=P.find(ye=>ye.id===D);if(!Z)return;const ve={...Z,completed:le,completedAt:le?new Date().toISOString():void 0};Q(ye=>ye.map(je=>je.id===D?ve:je)),await Ie.upsertProjectMilestone(ve).catch(ye=>console.error("Milestone toggle sync failed",ye))},Wl=async D=>{Q(le=>le.filter(Z=>Z.id!==D)),await Ie.deleteProjectMilestone(D).catch(le=>console.error("Milestone delete sync failed",le))},Zl=async(D,le)=>{const Z={...le,id:`tm-${Math.random().toString(36).substr(2,6)}`,taskId:D,completed:!1};V(ve=>[...ve,Z]),await Ie.upsertTaskMilestone(Z).catch(ve=>console.error("Task milestone add sync failed",ve))},eo=async D=>{V(le=>le.map(Z=>Z.id===D.id?{...Z,...D}:Z)),await Ie.upsertTaskMilestone(D).catch(le=>console.error("Task milestone update sync failed",le))},Qa=async(D,le)=>{const Z=H.find(ye=>ye.id===D);if(!Z)return;const ve={...Z,completed:le,completedAt:le?new Date().toISOString():void 0};V(ye=>ye.map(je=>je.id===D?ve:je)),await Ie.upsertTaskMilestone(ve).catch(ye=>console.error("Task milestone toggle sync failed",ye))},Wa=async D=>{V(le=>le.filter(Z=>Z.id!==D)),await Ie.deleteTaskMilestone(D).catch(le=>console.error("Task milestone delete sync failed",le))},to=async D=>{Ws(!1),Is(D)},no=async D=>{const le={...D,id:`action-${Math.random().toString(36).substr(2,5)}`};w(Z=>[...Z,le]),Ie.upsertSalesAction(le).catch(Z=>console.error("Bg Sync failed",Z))},En=async(D,le)=>{w(Z=>Z.map(ve=>ve.id===D?{...ve,isCompleted:le}:ve)),Ie.toggleSalesAction(D,le).catch(Z=>console.error("Bg Sync failed",Z))},ft=D=>{_e(D),ne("item")},At=D=>{const le=a.find(Z=>Z.id===D.id)||D;ke(le),Ze(void 0),ne("itemUpdate")},es=D=>{if(ut){const le=a.find(Z=>Z.id===ut.id)||ut;ke(le),Ze(D),ne("itemUpdate")}},ts=D=>{Ut(D),ne("history")};if(!s)return i.jsxs("div",{className:"min-h-screen bg-slate-100",children:[i.jsx("div",{className:"absolute top-4 right-4 z-50",children:i.jsx(Im,{onSync:Kt,onJiraSync:()=>ne("jira"),isSyncing:A,lastSync:W,globalPeriod:fe,onPeriodChange:F})}),i.jsx(zv,{employees:p,onLogin:t,onAuthError:D=>{console.error("Authentication error:",D),L(D)}}),i.jsx(gt,{isOpen:z==="jira",onClose:()=>ne(null),title:"Connect to Jira Backlog",children:i.jsx(Mm,{onSync:Dt,isSyncing:A,onCancel:()=>ne(null)})})]});const Za=[{id:"alignment",label:"Big Rocks"},{id:"individual",label:s.accessLevel==="IC"?"My Goals":"Goals & Team"},{id:"updates",label:"Updates"},{id:"timeline",label:"Gantt"}];return Zn&&Za.push({id:"sales",label:"Sales Perf"}),s.accessLevel==="Admin"&&Za.push({id:"projectmanager",label:"Project Manager"}),i.jsxs("div",{className:"min-h-screen bg-slate-100 flex flex-col",children:[i.jsx("header",{className:"sticky top-0 z-50 bg-white border-b border-slate-300 shadow-sm",children:i.jsxs("div",{className:"max-w-7xl mx-auto px-6 h-16 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-teal-600 rounded-lg",children:i.jsxs("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"})]})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg font-bold text-slate-900 leading-none",children:"OmniMap"}),i.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:s.accessLevel==="IC"?"Personal Dashboard":s.accessLevel==="Manager"?"Team Overview":"Admin Console"})]})]}),i.jsx("nav",{className:"hidden md:flex bg-slate-100 p-1 rounded-lg",children:Za.map(D=>i.jsx("button",{onClick:()=>X(D.id),className:`
                  px-4 py-2 rounded-md text-sm font-medium transition-all
                  ${q===D.id?"bg-white text-slate-900 shadow-sm":"text-slate-600 hover:text-slate-900"}
                `,children:D.label},D.id))}),i.jsxs("div",{className:"flex items-center gap-3",children:[s.accessLevel==="Admin"&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>Ws(!0),className:"text-sm font-medium text-teal-600 hover:text-teal-700 bg-teal-50 hover:bg-teal-100 px-4 py-2 rounded-lg transition-colors",children:"Bulk Creator"}),i.jsx(Im,{onSync:Kt,onJiraSync:()=>ne("jira"),isSyncing:A,lastSync:W,globalPeriod:fe,onPeriodChange:F})]}),i.jsx("div",{className:"h-8 w-px bg-slate-200 hidden md:block"}),i.jsxs("button",{onClick:()=>Lt(!0),className:"flex items-center gap-3 hover:bg-slate-100 transition-colors rounded-lg py-1.5 px-2",children:[i.jsxs("div",{className:"text-right hidden md:block",children:[i.jsx("div",{className:"text-sm font-semibold text-slate-900 leading-none",children:s.name}),i.jsx("span",{className:"text-xs text-slate-500",children:"Profile"})]}),i.jsx("img",{src:s.avatarUrl,className:"w-9 h-9 rounded-full border border-slate-300 object-cover",alt:"Profile"})]})]})]})}),i.jsxs("main",{className:"flex-1 max-w-7xl mx-auto px-6 py-8 w-full space-y-8",children:[q!=="sales"&&q!=="projectmanager"&&i.jsx(Lv,{insights:re,loading:se,onRefresh:Ka}),i.jsx("div",{className:"pb-20",children:q==="alignment"?i.jsx(Mv,{currentUser:s,goals:c,items:Nn,employees:p,updates:v,onEditGoal:s.accessLevel==="Admin"?D=>{ge(D),ne("goal")}:void 0,onAddGoal:s.accessLevel==="Admin"?()=>{ge(void 0),ne("goal")}:void 0,onEditItem:ft,onAddUpdate:D=>{G(D),be(void 0),ne("update")},onEditUpdate:D=>{be(D),G(c.find(le=>le.id===D.goalId)),ne("update")},onViewHistory:ts,onPushToHiBob:Kl,pushingItems:_}):q==="individual"?i.jsx(kv,{currentUser:s,items:Nn,goals:c,employees:Rs,onEditItem:ft,onAddItem:()=>{_e(void 0),ne("item")},onViewHistory:ts,onPushToHiBob:Kl,pushingItems:_}):q==="updates"?i.jsx(Uv,{items:Nn,updates:y,employees:Rs,goals:c,currentUser:s,onAddUpdate:At,onViewHistory:ts,initialMonth:fe.month,initialYear:fe.year}):q==="sales"&&Zn?i.jsx(Yv,{employees:Gi,salesData:S,salesActions:k,currentUser:s,onAddAction:no,onToggleAction:En}):q==="sales"?i.jsx("div",{className:"text-center py-20 text-slate-500",children:"Access Restricted"}):q==="projectmanager"&&s.accessLevel==="Admin"?i.jsx(gw,{currentUser:s,projects:M,projectTasks:ce,projectMilestones:P,taskMilestones:H,employees:Rs,departments:wt,onNewProjectClick:()=>$a(!0),onUpdateProject:Rn,onDeleteProject:sa,onUpdateTask:Ms,onAddTask:Oi,onDeleteTask:Ql,onAddProjectMilestone:Xa,onUpdateProjectMilestone:Ds,onToggleProjectMilestone:Pi,onDeleteProjectMilestone:Wl,onAddTaskMilestone:Zl,onUpdateTaskMilestone:eo,onToggleTaskMilestone:Qa,onDeleteTaskMilestone:Wa}):i.jsx(_v,{items:Nn,onItemClick:ts})})]}),s&&i.jsx($v,{isOpen:Fe,onClose:()=>Lt(!1),currentUser:s,items:a,goals:c,onSaveItem:Xl,onEditItem:ft,onSignOut:()=>{Lt(!1),$n.signOut(),t(null)}}),s&&s.accessLevel==="Admin"&&i.jsx(cw,{isOpen:Gt,onClose:()=>$a(!1),goals:c,employees:p,departments:wt,onSave:na}),s&&s.accessLevel==="Admin"&&i.jsx(Kv,{isOpen:_s,onClose:()=>Ws(!1),employees:p,goals:c,items:a,onSave:ta,onBulkPush:to}),i.jsx(gt,{isOpen:!!$t,onClose:()=>Zs(null),title:"HiBob Sync Report",maxWidth:"max-w-4xl",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex gap-4",children:[i.jsxs("div",{className:"flex-1 bg-emerald-50 border border-emerald-100 p-3 rounded-xl flex items-center justify-between",children:[i.jsx("span",{className:"text-emerald-700 font-bold text-xs uppercase tracking-widest",children:"Success"}),i.jsx("span",{className:"text-xl font-black text-emerald-600",children:$t==null?void 0:$t.filter(D=>D.success).length})]}),i.jsxs("div",{className:"flex-1 bg-rose-50 border border-rose-100 p-3 rounded-xl flex items-center justify-between",children:[i.jsx("span",{className:"text-rose-700 font-bold text-xs uppercase tracking-widest",children:"Failed"}),i.jsx("span",{className:"text-xl font-black text-rose-600",children:$t==null?void 0:$t.filter(D=>!D.success).length})]})]}),i.jsx("div",{className:"border border-slate-300 rounded-xl overflow-hidden max-h-[60vh] overflow-y-auto",children:i.jsxs("table",{className:"w-full text-left border-collapse",children:[i.jsx("thead",{className:"bg-slate-100 sticky top-0",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-3 text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Goal Title"}),i.jsx("th",{className:"p-3 text-[10px] font-black text-slate-500 uppercase tracking-widest w-24",children:"Status"}),i.jsx("th",{className:"p-3 text-[10px] font-black text-slate-500 uppercase tracking-widest w-1/2",children:"Details / Error Message"})]})}),i.jsx("tbody",{className:"divide-y divide-slate-100 bg-white",children:$t==null?void 0:$t.map((D,le)=>i.jsxs("tr",{className:D.success?"bg-white":"bg-rose-50/30",children:[i.jsx("td",{className:"p-3 text-xs font-bold text-slate-700 truncate max-w-[200px]",title:D.title,children:D.title}),i.jsx("td",{className:"p-3",children:D.success?i.jsxs("span",{className:"inline-flex items-center gap-1 text-[10px] font-bold text-emerald-600 bg-emerald-50 px-2 py-1 rounded border border-emerald-100",children:[i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),"Synced"]}):i.jsxs("span",{className:"inline-flex items-center gap-1 text-[10px] font-bold text-rose-600 bg-rose-50 px-2 py-1 rounded border border-rose-100",children:[i.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),"Failed"]})}),i.jsx("td",{className:"p-3 text-xs font-mono text-slate-500 break-all",children:D.message})]},le))})]})}),i.jsx("div",{className:"flex justify-end pt-2",children:i.jsx("button",{onClick:()=>Zs(null),className:"bg-slate-900 text-white px-6 py-2 rounded-lg text-xs font-black uppercase tracking-widest hover:bg-slate-800 transition-colors",children:"Close Report"})})]})}),i.jsx(gt,{isOpen:z==="jira",onClose:()=>ne(null),title:"Connect to Jira Backlog",children:i.jsx(Mm,{onSync:Dt,isSyncing:A,onCancel:()=>ne(null)})}),i.jsx(gt,{isOpen:z==="goal",onClose:()=>ne(null),title:xe?"Edit Big Rock":"New Big Rock",children:i.jsx(Ov,{goal:xe,onSave:async D=>{const le=D.id||`goal-${Math.random().toString(36).substr(2,5)}`;d(Z=>xe?Z.map(ve=>ve.id===le?{...ve,...D}:ve):[...Z,{...D,id:le}]),ne(null),Ie.upsertGoal({...D,id:le}).catch(Z=>console.error(Z))},onCancel:()=>ne(null)})}),i.jsx(gt,{isOpen:z==="item",onClose:()=>ne(null),title:Se?"Edit Goal":"New Goal",children:i.jsx(Pv,{item:Se,goals:c,employees:p,departments:wt,onSave:Xl,onCancel:()=>ne(null)})}),i.jsx(gt,{isOpen:z==="update",onClose:()=>ne(null),title:nt?`Update: ${nt.title}`:"Strategy Update",children:nt&&i.jsx(Hv,{goal:nt,existingUpdate:he,onSave:async D=>{const le=!!he,Z={...D,id:le?D.id:`upd-${Math.random().toString(36).substr(2,5)}`,createdAt:le?D.createdAt:new Date().toISOString(),authorId:le?D.authorId:s.id};h(ve=>le?ve.map(ye=>ye.id===Z.id?{...ye,...Z}:ye):[...ve,Z]),ne(null),Ie.upsertUpdate(Z).catch(ve=>console.error(ve))},onCancel:()=>ne(null)})}),i.jsx(gt,{isOpen:z==="itemUpdate",onClose:()=>ne(null),title:me?"Edit Progress Update":"Log Progress Update",children:Pe&&i.jsx(Bv,{item:Pe,existingUpdate:me,onSave:async D=>{const le={...D,id:D.id||`i-upd-${Math.random().toString(36).substr(2,5)}`,updatedAt:new Date().toISOString()};if(b(Z=>[...Z.filter(ye=>ye.id!==le.id),le]),ne(null),Ie.upsertItemUpdate(le).catch(Z=>console.error(Z)),console.log("[HiBob Debug] Item for update:",Pe.title,"HiBob Goal ID:",Pe.hibobGoalId||"NOT SET"),Pe.hibobGoalId){const Z=localStorage.getItem("omnimap_hibob_config");if(Z)try{const ve=JSON.parse(Z);if(ve.serviceId&&ve.token){const je=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(le.month||"Jan"),Re=`${le.year||new Date().getFullYear()}-${String(je+1).padStart(2,"0")}-01`,pt=await Ie.pushCheckInToHiBob(Pe.hibobGoalId,ve,Re,le.content||"",String(le.health??"green").toUpperCase());pt.fallbackUsed?console.log("[HiBob] Check-in failed, but goal update succeeded (appears as OmniMap activity)"):pt.success?console.log("[HiBob] Check-in pushed successfully"):console.error("[HiBob] Failed to push check-in:",pt.message)}}catch(ve){console.error("[HiBob] Failed to push check-in:",ve)}}else console.warn("[HiBob] No HiBob Goal ID found for this item. Push it to HiBob first.")},onCancel:()=>ne(null)})}),ut&&i.jsx(Vv,{item:a.find(D=>D.id===ut.id)||ut,updates:y.filter(D=>D.itemId===ut.id),isOpen:z==="history",onClose:()=>ne(null),onAddUpdate:D=>{const le=a.find(Z=>Z.id===D.id)||D;At(le)},onEdit:ft,onEditUpdate:es})]})},o0=document.getElementById("root");if(!o0)throw new Error("Could not find root element to mount to");const Nw=Ev.createRoot(o0);Nw.render(i.jsx(fg.StrictMode,{children:i.jsx(Tw,{})}));
